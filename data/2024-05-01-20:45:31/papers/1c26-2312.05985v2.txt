  1. 1 Introduction
    1. 1.1 The Extended Two-Way Fixed Effects Estimator
    2. 1.2 Restrictions in the ETWFE Model
    3. 1.3 Sparse Fusion Penalties
    4. 1.4 Demonstrating the Efficacy of FETWFE
    5. 1.5 Related Literature
    6. 1.6 Organization of the Paper
    7. 1.7 Notation
  2. 2 Basic Setup and Assumptions
  3. 3 Difference-in-Differences Assumptions
    1. 3.1 Parallel Trends Assumptions
    2. 3.2 Linearity Assumption (Assumption LINS)
  4. 4 Causal Estimands
    1. 4.1 Conditional Average Treatment Effect Estimands
      1. 4.1.1 Propensity-Weighted Conditional Average Treatment Effects
    2. 4.2 Marginal Average Treatment Effects
      1. 4.2.1 The Average Effect of the Treatment on Treated Units
  5. 5 Fused Extended Two-Way Fixed Effects
    1. 5.1 Restrictions in the ETWFE Estimator
    2. 5.2 Fusion Penalization in FETWFE
    3. 5.3 Constructing the FETWFE Optimization Problem
    4. 5.4 Causal Estimators
  6. 6 Theoretical Results and Discussion
    1. 6.1 Consistency
    2. 6.2 Restriction Selection Consistency
    3. 6.3 Asymptotic Normality and Oracle Property
      1. 6.3.1 Oracle Property
      2. 6.3.2 Asymptotically Valid Confidence Intervals
  7. 7 Simulation Studies
    1. 7.1 Estimation Error
    2. 7.2 Restriction Selection Consistency
    3. 7.3 Asymptotic Distribution
  8. 8 Empirical Application
  9. 9 Conclusion
    1. 9.1 Future Work
  10. A More on Parallel Trends and Assumption (CIUN)
    1. A.1 Relationships Between Unconfounded Treatment Assignment, Marginally Randomized Treatment Assignment, and Parallel Trends Assumptions
    2. A.2 Neither Conditional Nor Marginal Parallel Trends is Strictly More Plausible
    3. A.3 Parallel Trends, Assumption (CIUN), and Regression (1.5)
      1. A.3.1 Discussion of Theorem A.5
  11. B Additional Results For Simulation Studies
  12. C Theorem C.1
  13. D Extensions of Main Results
  14. E Proofs of Main Results
    1. E.1 Proofs of Theorems D.1 and 6.1
    2. E.2 Proofs of Theorems D.2, 6.3, and 6.4
    3. E.3 Proof of Theorem D.3
  15. F Proof of Theorem C.1
  16. G Proofs of Results Stated in the Appendix
    1. G.1 Proofs of Results from Appendix A
    2. G.2 Proofs of Supporting Results for Main Theorems
  17. H Proofs of Lemmas From Proof of Theorem C.1
  18. I Statements and Proofs of Other Results

\externaldocument

appendix

# Fused Extended Two-Way Fixed Effects for Difference-in-Differences With
Staggered Adoptions

Gregory Faletto gregory.faletto@marshall.usc.edu University of Southern
California

(April 30, 2024)

###### Abstract

To address the bias of the canonical two-way fixed effects estimator for
difference-in-differences under staggered adoptions, Wooldridge (2021)
proposed the extended two-way fixed effects estimator, which adds many
parameters. However, this reduces efficiency. Restricting some of these
parameters to be equal (for example, subsequent treatment effects within a
cohort) helps, but ad hoc restrictions may reintroduce bias. We propose a
machine learning estimator with a single tuning parameter, fused extended two-
way fixed effects (FETWFE), that enables automatic data-driven selection of
these restrictions. We prove that under an appropriate sparsity assumption
FETWFE identifies the correct restrictions with probability tending to one,
which improves efficiency. We also prove the consistency, oracle property, and
asymptotic normality of FETWFE for several classes of heterogeneous marginal
treatment effect estimators under either conditional or marginal parallel
trends, and we prove the same results for conditional average treatment
effects under conditional parallel trends. We demonstrate FETWFE in simulation
studies and an empirical application.

Keywords: Difference-in-differences, staggered adoptions, treatment effect
heterogeneity, bridge regression, fused lasso.

##  1 Introduction

We investigate difference-in-differences estimation under staggered adoptions.
Suppose Nğ‘Nitalic_N units are observed at Tâ‰¥2ğ‘‡2T\geq 2italic_T â‰¥ 2
times, where our theoretical results will assume Nğ‘Nitalic_N grows
asymptotically while Tğ‘‡Titalic_T is fixed. For convenience we assume a
balanced panel where all units are observed at all times, so we have
Nâ¢Tğ‘ğ‘‡NTitalic_N italic_T observations.

Suppose Râ‰¤Tâˆ’1ğ‘…ğ‘‡1R\leq T-1italic_R â‰¤ italic_T - 1 cohorts start
receiving a treatment at times
râˆˆâ„›={r1,r2,â€¦,rR}âŠ†{2,â€¦,T}ğ‘Ÿâ„›subscriptğ‘Ÿ1subscriptğ‘Ÿ2â€¦subscriptğ‘Ÿğ‘…2â€¦ğ‘‡r\in\mathcal{R}=\\{r_{1},r_{2},\ldots,r_{R}\\}\subseteq\\{2,\ldots,T\\}italic_r
âˆˆ caligraphic_R = { italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ,
italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , â€¦ , italic_r
start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT } âŠ† { 2 , â€¦ , italic_T }.
For example, we might want to investigate the effect of a law or policy that
is implemented state-by-state across time (Callaway and Santâ€™Anna, 2021;
Goodman-Bacon, 2021; Borusyak etÂ al., 2024), or the effect of a product or
service that is released across different regions over time (DeÂ Chaisemartin
and dâ€™Haultfoeuille, 2020). We consider settings where the treatment is an
absorbing state, so that once a unit starts being treated, they continue
receiving treatment thereafter, but this can be relaxed with little
complication. Since no cohort enters at time t=1ğ‘¡1t=1italic_t = 1 and we
assume the probability of never selecting into treatment is strictly positive
for all units (see Assumption F2 in Section 2), for sufficiently large
Nğ‘Nitalic_N we have untreated units available as a baseline comparison for
all treated cohorts at all times.

For iâˆˆ{1,â€¦,N}=:[N]i\in\\{1,\ldots,N\\}=:[N]italic_i âˆˆ { 1 , â€¦ ,
italic_N } = : [ italic_N ] and tâˆˆ[T]ğ‘¡delimited-[]ğ‘‡t\in[T]italic_t âˆˆ [
italic_T ], we encode the treatment status for each unit in a random variable
Wiâˆˆ{0}âˆªâ„›subscriptğ‘Šğ‘–0â„›W_{i}\in\\{0\\}\cup\mathcal{R}italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ { 0 } âˆª caligraphic_R,
where Wi=rsubscriptğ‘Šğ‘–ğ‘ŸW_{i}=ritalic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT = italic_r if unit iğ‘–iitalic_i is in cohort
râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R or
Wi=0subscriptğ‘Šğ‘–0W_{i}=0italic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT = 0 if unit iğ‘–iitalic_i is never treated. Let
y~(iâ¢t)â¢(r)subscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿ\tilde{y}_{(it)}(r)over~ start_ARG italic_y
end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r
) be the potential outcome for unit iğ‘–iitalic_i at time tğ‘¡titalic_t if
they were in cohort rğ‘Ÿritalic_r. We will be interested in estimating
treatment effects of the form

| Ï„ATTâ¢(r,t):=ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ’y~(iâ¢t)â¢(0)âˆ£Wi=r],râˆˆâ„›,tâ‰¥r,formulae-sequenceassignsubscriptğœATTğ‘Ÿğ‘¡ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿconditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–ğ‘Ÿformulae-sequenceğ‘Ÿâ„›ğ‘¡ğ‘Ÿ\displaystyle\tau_{\text{ATT}}(r,t):=\mathbb{E}\left[\tilde{y}_{(it)}(r)-% \tilde{y}_{(it)}(0)\mid W_{i}=r\right],\qquad r\in\mathcal{R},t\geq r,italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) := blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] , italic_r âˆˆ caligraphic_R , italic_t â‰¥ italic_r , |  | (1.1)  
---|---|---|---  
  
as well as conditional treatment effects that depend on the value of unit
covariates; see (1.6), to come. It is well-known that in the
T=2ğ‘‡2T=2italic_T = 2, â„›={2}â„›2\mathcal{R}=\\{2\\}caligraphic_R = { 2 }
case, under no anticipation and parallel trends assumptions

| Ï„ATTâ¢(2,2)=ğ”¼â¢[y~iâ¢2â¢(2)âˆ’y~iâ¢1â¢(2)âˆ£Wi=2]âˆ’ğ”¼â¢[y~iâ¢2â¢(0)âˆ’y~iâ¢1â¢(0)âˆ£Wi=0],subscriptğœATT22ğ”¼delimited-[]subscript~ğ‘¦ğ‘–22conditionalsubscript~ğ‘¦ğ‘–12subscriptğ‘Šğ‘–2ğ”¼delimited-[]subscript~ğ‘¦ğ‘–20conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0\tau_{\text{ATT}}(2,2)=\mathbb{E}\left[\tilde{y}_{i2}(2)-\tilde{y}_{i1}(2)\mid W% _{i}=2\right]-\mathbb{E}\left[\tilde{y}_{i2}(0)-\tilde{y}_{i1}(0)\mid W_{i}=0% \right],italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( 2 , 2 ) = blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i 2 end_POSTSUBSCRIPT ( 2 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i 1 end_POSTSUBSCRIPT ( 2 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 2 ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i 2 end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i 1 end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] , |  | (1.2)  
---|---|---|---  
  
and this treatment effect can be estimated consistently by the canonical two-
way fixed effects regression

| y~iâ¢t=Î±iâˆ—+Î³tâˆ—+Ï„âˆ—â‹…âˆ‘râˆˆâ„›ğŸ™â¢{Wi=r}â¢ğŸ™â¢{tâ‰¥r}+Ïµiâ¢t,subscript~ğ‘¦ğ‘–ğ‘¡superscriptsubscriptğ›¼ğ‘–superscriptsubscriptğ›¾ğ‘¡â‹…superscriptğœsubscriptğ‘Ÿâ„›1subscriptğ‘Šğ‘–ğ‘Ÿ1ğ‘¡ğ‘Ÿsubscriptitalic-Ïµğ‘–ğ‘¡\tilde{y}_{it}=\alpha_{i}^{*}+\gamma_{t}^{*}+\tau^{*}\cdot\sum_{r\in\mathcal{R% }}\mathbbm{1}\\{W_{i}=r\\}\mathbbm{1}\\{t\geq r\\}+\epsilon_{it},over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT = italic_Î± start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Ï„ start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT â‹… âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } blackboard_1 { italic_t â‰¥ italic_r } + italic_Ïµ start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT , |  | (1.3)  
---|---|---|---  
  
where Î±iâˆ—superscriptsubscriptğ›¼ğ‘–\alpha_{i}^{*}italic_Î±
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT are fixed effects corresponding to units,
Î³tâˆ—superscriptsubscriptğ›¾ğ‘¡\gamma_{t}^{*}italic_Î³ start_POSTSUBSCRIPT
italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT are
fixed effects corresponding to time,
ğŸ™â¢{â‹…}1â‹…\mathbbm{1}\\{\cdot\\}blackboard_1 { â‹… } is an indicator
variable that equals 1 on the event â‹…â‹…\cdotâ‹… and 0 otherwise,
Ïµiâ¢tsubscriptitalic-Ïµğ‘–ğ‘¡\epsilon_{it}italic_Ïµ start_POSTSUBSCRIPT
italic_i italic_t end_POSTSUBSCRIPT is a noise term, and for conciseness we
denote
y~iâ¢t:=y~iâ¢tâ¢(Wi)assignsubscript~ğ‘¦ğ‘–ğ‘¡subscript~ğ‘¦ğ‘–ğ‘¡subscriptğ‘Šğ‘–\tilde{y}_{it}:=\tilde{y}_{it}(W_{i})over~
start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_t
end_POSTSUBSCRIPT := over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT
italic_i italic_t end_POSTSUBSCRIPT ( italic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT ), the observed response for unit iğ‘–iitalic_i at time
tğ‘¡titalic_t.

In the more general Tâ‰¥2ğ‘‡2T\geq 2italic_T â‰¥ 2 and arbitrary
â„›â„›\mathcal{R}caligraphic_R setting, one might hope that regression (1.3)
would aggregate the treatment effects in a sensible way to estimate some form
of an average treatment effect, but it is now well-known that this isnâ€™t the
case, and many alternative estimators have been proposed (Borusyak and
Jaravel, 2018; DeÂ Chaisemartin and dâ€™Haultfoeuille, 2020; Sun and Abraham,
2021; Goodman-Bacon, 2021; Callaway and Santâ€™Anna, 2021).

###  1.1 The Extended Two-Way Fixed Effects Estimator

Most of the alternative estimators proposed in these and other works depart
from ordinary least squares (OLS) estimation, but Wooldridge (2021)111Along
with Sun and Abraham (2021). shows that linear regression can still be
unbiased provided that enough parameters are estimated. He first shows that
(1.2) is also the estimand for Ï„ğœ\tauitalic_Ï„ in the regression

| y~iâ¢t=Î·âˆ—+Î½2âˆ—â‹…ğŸ™â¢{Wi=2}+Î³2âˆ—+Ï„âˆ—â‹…ğŸ™â¢{Wi=r}â¢ğŸ™â¢{t=2}+Ïµiâ¢t,subscript~ğ‘¦ğ‘–ğ‘¡superscriptğœ‚â‹…superscriptsubscriptğœˆ21subscriptğ‘Šğ‘–2superscriptsubscriptğ›¾2â‹…superscriptğœ1subscriptğ‘Šğ‘–ğ‘Ÿ1ğ‘¡2subscriptitalic-Ïµğ‘–ğ‘¡\tilde{y}_{it}=\eta^{*}+\nu_{2}^{*}\cdot\mathbbm{1}\\{W_{i}=2\\}+\gamma_{2}^{*}+% \tau^{*}\cdot\mathbbm{1}\\{W_{i}=r\\}\mathbbm{1}\\{t=2\\}+\epsilon_{it},over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT = italic_Î· start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Î½ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT â‹… blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 2 } + italic_Î³ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Ï„ start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT â‹… blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } blackboard_1 { italic_t = 2 } + italic_Ïµ start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT , |  | (1.4)  
---|---|---|---  
  
where Î·ğœ‚\etaitalic_Î· can be interpreted as the expected outcome for the
never-treated units at t=1ğ‘¡1t=1italic_t = 1,
Î½2subscriptğœˆ2\nu_{2}italic_Î½ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT is
the selection bias for the treated units at t=1ğ‘¡1t=1italic_t = 1, and
Î³2subscriptğ›¾2\gamma_{2}italic_Î³ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT is
the trend in the untreated potential outcomes. Wooldridge proposes
generalizing this to the arbitrary Tğ‘‡Titalic_T case and allowing for each
parameter to be linear in covariates rather than constant. This leads to a
linear model on cohort dummy variables, time dummies, covariates, treatment
indicators, and interactions of those terms: for all
iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ],
tâˆˆ[T]ğ‘¡delimited-[]ğ‘‡t\in[T]italic_t âˆˆ [ italic_T ], and
râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R,

| y~iâ¢t=Î·âˆ—+Î³tâˆ—+ğ‘¿iâŠ¤â¢(ğœ¿âˆ—+ğƒtâˆ—)+âˆ‘râˆˆâ„›ğŸ™â¢{Wi=r}â¢(Î½râˆ—+ğ‘¿iâŠ¤â¢ğœ»râˆ—+ğŸ™â¢{tâ‰¥r}â¢(Ï„râ¢tâˆ—+ğ‘¿Ë™(iâ¢r)âŠ¤â¢ğ†râ¢tâˆ—))+Ïµiâ¢t.subscript~ğ‘¦ğ‘–ğ‘¡superscriptğœ‚superscriptsubscriptğ›¾ğ‘¡superscriptsubscriptğ‘¿ğ‘–topsuperscriptğœ¿superscriptsubscriptğƒğ‘¡subscriptğ‘Ÿâ„›1subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğœˆğ‘Ÿsuperscriptsubscriptğ‘¿ğ‘–topsuperscriptsubscriptğœ»ğ‘Ÿ1ğ‘¡ğ‘Ÿsuperscriptsubscriptğœğ‘Ÿğ‘¡superscriptsubscriptbold-Ë™ğ‘¿ğ‘–ğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡subscriptitalic-Ïµğ‘–ğ‘¡\tilde{y}_{it}=\eta^{*}+\gamma_{t}^{*}+\boldsymbol{X}_{i}^{\top}(\boldsymbol{% \kappa}^{*}+\boldsymbol{\xi}_{t}^{*})+\sum_{r\in\mathcal{R}}\mathbbm{1}\\{W_{i}% =r\\}\left(\nu_{r}^{*}+\boldsymbol{X}_{i}^{\top}\boldsymbol{\zeta}_{r}^{*}+% \mathbbm{1}\\{t\geq r\\}(\tau_{rt}^{*}+\boldsymbol{\dot{X}}_{(ir)}^{\top}% \boldsymbol{\rho}_{rt}^{*})\right)+\epsilon_{it}.over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT = italic_Î· start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_Îº start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) + âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } ( italic_Î½ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¶ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + blackboard_1 { italic_t â‰¥ italic_r } ( italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + overbold_Ë™ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT ( italic_i italic_r ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) ) + italic_Ïµ start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT . |  | (1.5)  
---|---|---|---  
  
Here
ğ‘¿iâˆˆâ„dsubscriptğ‘¿ğ‘–superscriptâ„ğ‘‘\boldsymbol{X}_{i}\in\mathbb{R}^{d}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT is a set of time-invariant
(pre-treatment) covariates,
Î·âˆ—+ğ‘¿iâŠ¤â¢ğœ¿âˆ—superscriptğœ‚superscriptsubscriptğ‘¿ğ‘–topsuperscriptğœ¿\eta^{*}+\boldsymbol{X}_{i}^{\top}\boldsymbol{\kappa}^{*}italic_Î·
start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤
end_POSTSUPERSCRIPT bold_italic_Îº start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT is the conditionally expected outcome of the never-treated
units at t=1ğ‘¡1t=1italic_t = 1, the
Î³tâˆ—+ğ‘¿iâŠ¤â¢ğƒtâˆ—superscriptsubscriptğ›¾ğ‘¡superscriptsubscriptğ‘¿ğ‘–topsuperscriptsubscriptğƒğ‘¡\gamma_{t}^{*}+\boldsymbol{X}_{i}^{\top}\boldsymbol{\xi}_{t}^{*}italic_Î³
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT + bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT terms are the conditional trends in the untreated
potential outcomes,
Î½râˆ—+ğ‘¿iâŠ¤â¢ğœ»râˆ—superscriptsubscriptğœˆğ‘Ÿsuperscriptsubscriptğ‘¿ğ‘–topsuperscriptsubscriptğœ»ğ‘Ÿ\nu_{r}^{*}+\boldsymbol{X}_{i}^{\top}\boldsymbol{\zeta}_{r}^{*}italic_Î½
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT + bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¶
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT is the conditional selection bias for cohort
rğ‘Ÿritalic_r, and
Ï„râ¢tâˆ—+ğ‘¿Ë™(iâ¢r)âŠ¤â¢ğ†râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡superscriptsubscriptbold-Ë™ğ‘¿ğ‘–ğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡\tau_{rt}^{*}+\boldsymbol{\dot{X}}_{(ir)}^{\top}\boldsymbol{\rho}_{rt}^{*}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT + overbold_Ë™ start_ARG bold_italic_X end_ARG
start_POSTSUBSCRIPT ( italic_i italic_r ) end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT is the conditional treatment effect for cohort
rğ‘Ÿritalic_r at time tğ‘¡titalic_t. (See Assumption (LINS) in Section 3.2 for
more details.)

Wooldridge calls (1.5) the extended two-way fixed effects (ETWFE) estimator
(Wooldridge, 2021, Equation 6.33) and shows that in this regression
Ï„râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡\tau_{rt}^{*}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT is unbiased for
Ï„ATTâ¢(r,t)subscriptğœATTğ‘Ÿğ‘¡\tau_{\text{ATT}}(r,t)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) under
conditional no-anticipation and parallel trends assumptions; see Assumptions
(CNAS) and (CCTS) in Section 3. The ETWFE estimator can also be used to
estimate conditional average treatment effects on the treated units

| Ï„CATTâ¢(r,t,ğ’™):=ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ’y~(iâ¢t)â¢(0)âˆ£Wi=r,ğ‘¿i=ğ’™],iâˆˆ[N],râˆˆâ„›,tâˆˆ{r,â€¦,T}.formulae-sequenceassignsubscriptğœCATTğ‘Ÿğ‘¡ğ’™ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿconditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™formulae-sequenceğ‘–delimited-[]ğ‘formulae-sequenceğ‘Ÿâ„›ğ‘¡ğ‘Ÿâ€¦ğ‘‡\tau_{\text{CATT}}(r,t,\boldsymbol{x}):=\mathbb{E}[\tilde{y}_{(it)}(r)-\tilde{% y}_{(it)}(0)\mid W_{i}=r,\boldsymbol{X}_{i}=\boldsymbol{x}],\qquad i\in[N],r% \in\mathcal{R},t\in\\{r,\ldots,T\\}.italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) := blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] , italic_i âˆˆ [ italic_N ] , italic_r âˆˆ caligraphic_R , italic_t âˆˆ { italic_r , â€¦ , italic_T } . |  | (1.6)  
---|---|---|---  
  
###  1.2 Restrictions in the ETWFE Model

As Wooldridge (2021, Section 6.5) points out, the ETWFE estimator (1.5) may
contain a large number of parameters to estimate if Rğ‘…Ritalic_R,
Tğ‘‡Titalic_T, or dğ‘‘ditalic_d is moderately large relative to Nğ‘Nitalic_N.
In this case, ordinary least squares estimation of (1.5) may lead to very
imprecise estimates of at least some of the parameters, trading the bias
problem that model (1.3) has for a low-efficiency (or high-variance) problem.

Wooldridge (2021) suggests some possible ways to mitigate this problem by
imposing restrictions in order to reduce the number of parameters to be
estimated. For example, one might assume that the treatment effects only vary
across cohorts and not with time, so that
Ï„râ¢t=Ï„rsubscriptğœğ‘Ÿğ‘¡subscriptğœğ‘Ÿ\tau_{rt}=\tau_{r}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT = italic_Ï„
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT for all
râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R, tâ‰¥rğ‘¡ğ‘Ÿt\geq
ritalic_t â‰¥ italic_r. (Other works that consider similar restrictions
include Borusyak and Jaravel (2018) and Borusyak etÂ al. (2024).) If many of
these restrictions hold, then imposing them results in more efficient
estimation of the treatment effects than regression (1.5). However, imposing
these restrictions in an ad hoc way could reintroduce bias if the wrong
restrictions are imposed, or leave unnecessary inefficiency if not enough
restrictions are imposed.

The first goal of this paper is to propose a novel estimator that imposes
these restrictions in an automatic, data-driven way. We propose the fused
extended two-way fixed effects (FETWFE) estimator, a novel machine learning
method for difference-in-differences estimation. Before we describe FETWFE, we
discuss sparse fusion penalties in linear regression, which play a key role in
our estimator.

###  1.3 Sparse Fusion Penalties

Given a NÃ—pğ‘ğ‘N\times pitalic_N Ã— italic_p real-valued design matrix
ğ‘¿ğ‘¿\boldsymbol{X}bold_italic_X and a response
ğ’šâˆˆâ„Nğ’šsuperscriptâ„ğ‘\boldsymbol{y}\in\mathbb{R}^{N}bold_italic_y âˆˆ
blackboard_R start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT, the well-
known lasso (Tibshirani, 1996) estimator is defined by the optimization
problem

| ğœ·^â¢(Î»N)âˆˆbold-^ğœ·subscriptğœ†ğ‘absent\displaystyle\boldsymbol{\hat{\beta}}(\lambda_{N})\in\leavevmode\nobreak\ overbold_^ start_ARG bold_italic_Î² end_ARG ( italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) âˆˆ | argâ¡minğœ·âˆˆâ„pâ¢{âˆ‘i=1N(yiâˆ’ğœ·âŠ¤â¢ğ‘¿i)2+Î»Nâ¢âˆ‘j=1p|Î²j|}ğœ·superscriptâ„ğ‘superscriptsubscriptğ‘–1ğ‘superscriptsubscriptğ‘¦ğ‘–superscriptğœ·topsubscriptğ‘¿ğ‘–2subscriptğœ†ğ‘superscriptsubscriptğ‘—1ğ‘subscriptğ›½ğ‘—\displaystyle\underset{\boldsymbol{\beta}\in\mathbb{R}^{p}}{\arg\min}\left\\{% \sum_{i=1}^{N}\left(y_{i}-\boldsymbol{\beta}^{\top}\boldsymbol{X}_{i}\right)^{% 2}+\lambda_{N}\sum_{j=1}^{p}|\beta_{j}|\right\\}start_UNDERACCENT bold_italic_Î² âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT end_UNDERACCENT start_ARG roman_arg roman_min end_ARG { âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - bold_italic_Î² start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT | italic_Î² start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | } |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | argâ¡minğœ·âˆˆâ„pâ¢{âˆ¥ğ’šâˆ’ğ‘¿â¢ğœ·âˆ¥22+Î»Nâ¢âˆ¥ğœ·âˆ¥1},ğœ·superscriptâ„ğ‘superscriptsubscriptdelimited-âˆ¥âˆ¥ğ’šğ‘¿ğœ·22subscriptğœ†ğ‘subscriptdelimited-âˆ¥âˆ¥ğœ·1\displaystyle\underset{\boldsymbol{\beta}\in\mathbb{R}^{p}}{\arg\min}\left\\{% \left\lVert\boldsymbol{y}-\boldsymbol{X}\boldsymbol{\beta}\right\rVert_{2}^{2}% +\lambda_{N}\lVert\boldsymbol{\beta}\rVert_{1}\right\\},start_UNDERACCENT bold_italic_Î² âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT end_UNDERACCENT start_ARG roman_arg roman_min end_ARG { âˆ¥ bold_italic_y - bold_italic_X bold_italic_Î² âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ bold_italic_Î² âˆ¥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT } , |   
  
where Î»Nsubscriptğœ†ğ‘\lambda_{N}italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT is a tuning parameter that can be chosen from a set of candidate values by cross-validation or a criterion like BIC, and recall that the â„“qsubscriptâ„“ğ‘\ell_{q}roman_â„“ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT norm222It is a norm for finite qâ‰¥1ğ‘1q\geq 1italic_q â‰¥ 1, though we also consider qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 ), in which case âˆ¥â‹…âˆ¥qsubscriptdelimited-âˆ¥âˆ¥â‹…ğ‘\lVert\cdot\rVert_{q}âˆ¥ â‹… âˆ¥ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT does not satisfy the triangle inequality. of an nğ‘›nitalic_n-vector ğ’—=(v1,v2,â€¦,vn)âŠ¤ğ’—superscriptsubscriptğ‘£1subscriptğ‘£2â€¦subscriptğ‘£ğ‘›top\boldsymbol{v}=(v_{1},v_{2},\ldots,v_{n})^{\top}bold_italic_v = ( italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , â€¦ , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT is defined as âˆ¥ğ’—âˆ¥q:=(âˆ‘i=1n|vi|q)1/qassignsubscriptdelimited-âˆ¥âˆ¥ğ’—ğ‘superscriptsuperscriptsubscriptğ‘–1ğ‘›superscriptsubscriptğ‘£ğ‘–ğ‘1ğ‘\lVert\boldsymbol{v}\rVert_{q}:=\left(\sum_{i=1}^{n}|v_{i}|^{q}\right)^{1/q}âˆ¥ bold_italic_v âˆ¥ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT := ( âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT | italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 1 / italic_q end_POSTSUPERSCRIPT . The â„“1subscriptâ„“1\ell_{1}roman_â„“ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT penalty term leads to sparse estimated coefficients ğœ·^â¢(Î»N)bold-^ğœ·subscriptğœ†ğ‘\boldsymbol{\hat{\beta}}(\lambda_{N})overbold_^ start_ARG bold_italic_Î² end_ARG ( italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) with entries set exactly equal to 0.

The fused lasso (Tibshirani etÂ al., 2005) adds a second tuning parameter and
â„“1subscriptâ„“1\ell_{1}roman_â„“ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
penalty term:

| ğœ·^â¢(Î»N(1),Î»N(2))âˆˆbold-^ğœ·superscriptsubscriptğœ†ğ‘1superscriptsubscriptğœ†ğ‘2absent\displaystyle\boldsymbol{\hat{\beta}}(\lambda_{N}^{(1)},\lambda_{N}^{(2)})\in% \leavevmode\nobreak\ overbold_^ start_ARG bold_italic_Î² end_ARG ( italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT , italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ) âˆˆ | argâ¡minğœ·âˆˆâ„pâ¢{âˆ‘i=1N(yiâˆ’ğœ·âŠ¤â¢ğ‘¿i)2+Î»N(1)â¢âˆ‘j=1p|Î²j|+Î»N(2)â¢âˆ‘j=2p|Î²jâˆ’Î²jâˆ’1|}.ğœ·superscriptâ„ğ‘superscriptsubscriptğ‘–1ğ‘superscriptsubscriptğ‘¦ğ‘–superscriptğœ·topsubscriptğ‘¿ğ‘–2superscriptsubscriptğœ†ğ‘1superscriptsubscriptğ‘—1ğ‘subscriptğ›½ğ‘—superscriptsubscriptğœ†ğ‘2superscriptsubscriptğ‘—2ğ‘subscriptğ›½ğ‘—subscriptğ›½ğ‘—1\displaystyle\underset{\boldsymbol{\beta}\in\mathbb{R}^{p}}{\arg\min}\left\\{% \sum_{i=1}^{N}\left(y_{i}-\boldsymbol{\beta}^{\top}\boldsymbol{X}_{i}\right)^{% 2}+\lambda_{N}^{(1)}\sum_{j=1}^{p}|\beta_{j}|+\lambda_{N}^{(2)}\sum_{j=2}^{p}|% \beta_{j}-\beta_{j-1}|\right\\}.start_UNDERACCENT bold_italic_Î² âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT end_UNDERACCENT start_ARG roman_arg roman_min end_ARG { âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - bold_italic_Î² start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT | italic_Î² start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | + italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_j = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT | italic_Î² start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT italic_j - 1 end_POSTSUBSCRIPT | } . |   
---|---|---|---  
  
The fused lasso tends to yield solutions that both set some individual
coefficients exactly equal to 0 (due to the first
â„“1subscriptâ„“1\ell_{1}roman_â„“ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
penalty term) and also set the differences between some adjacent pairs of
coefficients exactly equal to 0 (due to the second
â„“1subscriptâ„“1\ell_{1}roman_â„“ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
penalty term). That is, some adjacent pairs of coefficients are set exactly
equal to each other, or fused together.

FETWFE uses â„“qsubscriptâ„“ğ‘\ell_{q}roman_â„“ start_POSTSUBSCRIPT italic_q
end_POSTSUBSCRIPT fusion penalties for qâˆˆ(0,2]ğ‘02q\in(0,2]italic_q âˆˆ ( 0
, 2 ] (bridge regularization) to shrink certain sets of parameters in (1.5)
towards each other in a way that aligns with intuition and previously proposed
restrictions. See Figure 1 for a visual depiction of which of the marginal
average treatment effects Ï„^râ¢tsubscript^ğœğ‘Ÿğ‘¡\hat{\tau}_{rt}over^
start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t
end_POSTSUBSCRIPT we propose penalizing towards each other, and see further
details about the FETWFE penalty term (5.1) in Section 5. A lasso estimator is
within our framework if one chooses q=1ğ‘1q=1italic_q = 1. Choices of
qâˆˆ(0,1]ğ‘01q\in(0,1]italic_q âˆˆ ( 0 , 1 ] will result in sparse solutions,
and choices of qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 ) will allow for
convergence at 1/N1ğ‘1/\sqrt{N}1 / square-root start_ARG italic_N end_ARG
rates and asymptotic normality of the estimated coefficients. These fusion
penalties allow the restrictions to be selected in a hands-off, automatic way
that comes with theoretical guarantees.

rğ‘Ÿritalic_rtğ‘¡titalic_t1234562345Ï„^22subscript^ğœ22\hat{\tau}_{22}over^
start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT 22
end_POSTSUBSCRIPTÏ„^23subscript^ğœ23\hat{\tau}_{23}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 23
end_POSTSUBSCRIPTÏ„^24subscript^ğœ24\hat{\tau}_{24}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 24
end_POSTSUBSCRIPTÏ„^25subscript^ğœ25\hat{\tau}_{25}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 25
end_POSTSUBSCRIPTÏ„^26subscript^ğœ26\hat{\tau}_{26}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 26
end_POSTSUBSCRIPTÏ„^33subscript^ğœ33\hat{\tau}_{33}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 33
end_POSTSUBSCRIPTÏ„^34subscript^ğœ34\hat{\tau}_{34}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 34
end_POSTSUBSCRIPTÏ„^35subscript^ğœ35\hat{\tau}_{35}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 35
end_POSTSUBSCRIPTÏ„^36subscript^ğœ36\hat{\tau}_{36}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 36
end_POSTSUBSCRIPTÏ„^44subscript^ğœ44\hat{\tau}_{44}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 44
end_POSTSUBSCRIPTÏ„^45subscript^ğœ45\hat{\tau}_{45}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 45
end_POSTSUBSCRIPTÏ„^46subscript^ğœ46\hat{\tau}_{46}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 46
end_POSTSUBSCRIPTÏ„^55subscript^ğœ55\hat{\tau}_{55}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 55
end_POSTSUBSCRIPTÏ„^56subscript^ğœ56\hat{\tau}_{56}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 56 end_POSTSUBSCRIPT Figure 1: Visualization of
which of the estimated marginal average treatment effect terms
Ï„^râ¢tsubscript^ğœğ‘Ÿğ‘¡\hat{\tau}_{rt}over^ start_ARG italic_Ï„ end_ARG
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT from regression (1.5)
(which estimate the average treatment effects
Ï„ATTâ¢(r,t)subscriptğœATTğ‘Ÿğ‘¡\tau_{\text{ATT}}(r,t)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) from
Equation 1.1) we penalize towards each other in the FETWFE penalty (5.1). In
this setting, T=6ğ‘‡6T=6italic_T = 6 and
â„›={2,â€¦,5}â„›2â€¦5\mathcal{R}=\\{2,\ldots,5\\}caligraphic_R = { 2 , â€¦ , 5
}. The horizontal axis depicts time and the vertical axis depicts cohorts.
FETWFE works well under an assumption that the linked treatment effects tend
to be close together, and at least some of them are exactly equal. See further
details in Section 5.

###  1.4 Demonstrating the Efficacy of FETWFE

The second goal of this paper is to provide theoretical guarantees for the
performance of FETWFE. We prove that under a suitable sparsity assumption on
the true coefficients and regularity conditions, FETWFE learns the correct
restrictions with probability tending to one (Theorem 6.2). FETWFE then
estimates only the needed parameters, improving efficiency. We also prove that
for qâˆˆ(0,2]ğ‘02q\in(0,2]italic_q âˆˆ ( 0 , 2 ] our proposed estimators of
two classes of heterogeneous marginal average treatment effects are consistent
under either conditional or marginal parallel trends, and two classes of
conditional average treatment effect estimators are consistent under
conditional parallel trends (Theorem 6.1). To the best of our knowledge, this
is the first work establishing the consistency of a difference-in-differences
estimator for marginal average treatment effects under either form of parallel
trends. For estimating propensity-weighted conditional average treatment
effects, the generalized propensity scores can be estimated by an arbitrary
nonparametric estimator with theoretical convergence guarantees, so our theory
applies to propensity score estimators as simple as multinomial logit or as
flexible as deep neural networks (Farrell etÂ al., 2021) or random forests
(Gao etÂ al., 2022).

We also show that our treatment effect estimators are asymptotically normal
for qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 ) and we provide feasible,
provably consistent finite-sample variance estimators (Theorems 6.4 and D.3).
For probability-weighted treatment effect estimates, we propose both an
asymptotically normal test statistic if the generalized propensity scores are
estimated on a separate data set from FETWFE (Theorem 6.4b) and an
asymptotically subgaussian test statistic if both models are estimated on the
same data set (Theorem 6.4c). The data-driven restrictions FETWFE learns
improve parameter estimation while preserving asymptotic unbiasedness and
consistency, allowing for the construction of asymptotically valid confidence
intervals.

Under the assumptions of Theorem 6.3 we show that FETWFE has an oracle
property (Fan and Li, 2001; Fan and Peng, 2004): the asymptotic variance of
its estimates depend only on the parameters of the smaller restricted model,
and it converges at the same 1/N1ğ‘1/\sqrt{N}1 / square-root start_ARG
italic_N end_ARG rate as an OLS-estimated model on the true restricted model
even if the number of covariates grows to infinity with Nğ‘Nitalic_N. Our
theoretical guarantees leverage extensions of the bridge regression theory of
Kock (2013) (Theorems F.4 and F.5 in the appendix) that may be of independent
interest.

Finally, a third goal of this paper is to show that FETWFE is useful in
practice through simulation studies that we conduct in Section 7 comparing the
FETWFE estimator to competitor estimators. We also illustrate FETWFE in an
empirical application in Section 8.

###  1.5 Related Literature

There has been an abundance of recent research on difference-in-differences
and it is not possible to cite all of the work in this stream; see DeÂ
Chaisemartin and dâ€™Haultfoeuille (2023); Sun and Shapiro (2022); Roth etÂ
al. (2023), and Callaway (2023) for recent reviews. Lechner etÂ al. (2011)
reviews earlier literature. Chiu etÂ al. (2023) review the literature from a
political science perspective. deÂ Chaisemartin and Dâ€™HaultfÅ“uille (2023)
and Arkhangelsky and Imbens (2023) review causal inference in panel data more
broadly. Beyond those reviews and the papers we have already cited, throughout
the paper we cite papers in the difference-in-differences literature and
relate them to FETWFE; see Sections 3 and 4 and Appendix A, in particular.

Besides Wooldridge (2021), there are many other estimators that target similar
estimands to ours, and we discuss several of these in Section 4, though none
of these are machine learning estimators. It is also natural to compare FETWFE
to other machine learning and non- and semi-parametric difference-in-
differences estimators. Generally these methods are more flexible in the kinds
of models than they can estimate than FETWFE (which is a regularized linear
model, though our theoretical results allow for nonparametric estimation of
the generalized propensity scores), but much less flexible in the estimands
they target. Further, these methods tend to require assumptions that an
estimator is available that achieves consistency at particular rates, so
applying these results would involve further checking the required assumptions
for a particular estimator. In contrast, we provide â€œend-to-end" assumptions
for the consistency of three classes of estimators (5.6), (5.9), and (5.10)
and the oracle property and asymptotic normality of (5.9) and (5.10).

The parametric and semi-parametric estimators proposed by Zimmert (2020),
Santâ€™Anna and Zhao (2020), and Chang (2020) yield theoretical results for a
wide variety of machine learning estimators with theoretical guarantees under
conditional parallel trends assumptions, but only in the T=2ğ‘‡2T=2italic_T =
2 setting and only for a single average treatment effect estimand
(specifically, our estimand in Equation 4.11). Blackwell etÂ al. (2024)
accomplish similar goals with different estimands under different assumptions,
focusing mainly on a setting with T=2ğ‘‡2T=2italic_T = 2 and a single mediator
of interest. Nie etÂ al. (2021) propose related non-parametric estimators that
achieve 1/N1ğ‘1/\sqrt{N}1 / square-root start_ARG italic_N end_ARG convergence
and asymptotic normality in the T=2ğ‘‡2T=2italic_T = 2 repeated cross-sections
setting only for an average treatment effect, and consistency for conditional
average treatment effects at much slower rates, in contrast to the
1/N1ğ‘1/\sqrt{N}1 / square-root start_ARG italic_N end_ARG rate for
conditional average treatment effects estimated by FETWFE (see Theorem D.3).
Hatamyar etÂ al. (2023) provide similar semi-parametric estimators for both
marginal and conditional average treatment effects in the staggered adoptions
setting with arbitrary Tğ‘‡Titalic_T, but they do not provide any theoretical
guarantees.

Gavrilova etÂ al. (2023) propose an approach using random forests that is
somewhat more flexible in its estimands. Their approach allows for arbitrary
Tğ‘‡Titalic_T, though they focus on the case with only one treated cohort that
starts an absorbing treatment at time t=2ğ‘¡2t=2italic_t = 2, providing a
brief sketch as to how their method might be extended to allow for staggered
adoptions. Further, their method requires splitting the data and estimating
completely separate models to estimate the treatment effect of the treated
cohort at each time 2,3,â€¦,T23â€¦ğ‘‡2,3,\ldots,T2 , 3 , â€¦ , italic_T, while
FETWFE allows for the full sample to be used to jointly estimate all treatment
effects simultaneously. Indeed, a central idea of our method is that the
fusion penalties we use allow FETWFE to borrow strength across cohorts and
time in order to improve estimation efficiency. (None of the above works
mentions fusion penalties.)

Our work also contributes to the much broader topic of estimating conditional
average treatment effects. In Section 4 we mention some prominent works in
this stream of literature.

Outside of causal inference, our approach is clearly closely related to both
the fused lasso (Tibshirani etÂ al., 2005) and the generalized lasso
(Tibshirani and Taylor, 2011); see (5.4). Our work also draws much from the
bridge regression theory of Kock (2013), and, in turn, Huang etÂ al. (2008).
Kaddoura and Westerlund (2022) propose a linear panel data model with a fused
lasso-like penalty, though not for causal inference. Park and Yamauchi (2023)
propose a related Bayesian approach. Heiler and Mareckova (2021) also propose
a penalized panel data model that combines categories, but not in the causal
inference setting. Similarly, Kwon (2021) proposes a shrinkage estimator for
linear panel data models (though not for causal inference) and cites more
related work in this stream.

FETWFE also relates more specifically to the generalized fused lasso (HÃ¶fling
etÂ al., 2010; Xin etÂ al., 2014). Like FETWFE, the generalized fused lasso
involves applying â„“qsubscriptâ„“ğ‘\ell_{q}roman_â„“ start_POSTSUBSCRIPT
italic_q end_POSTSUBSCRIPT penalties to the absolute differences between a
variety of pairs of coefficients, though the generalized fused lasso only uses
the q=1ğ‘1q=1italic_q = 1 case. Some works that prove theoretical results for
the generalized fused lasso include Viallon etÂ al. (2013) and Viallon etÂ al.
(2016). Viallon etÂ al. (2013) prove consistency for the generalized fused
lasso under different assumptions from ours, including a restriction to the
fixed pğ‘pitalic_p case. They prove selection consistency and asymptotic
normality only for an adaptive (Zou, 2006) version of their method. Viallon
etÂ al. (2016) prove similar results (with similar limitations) for a broader
class of generalized linear models.

###  1.6 Organization of the Paper

After we introduce some notation, we establish our setup and basic assumptions
in Section 2 and present our difference-in-differences assumptions in Section
3. In particular, we provide a testable sufficient condition (CIUN) for
several kinds of estimators, including FETWFE, to be consistent under either
marginal or conditional parallel trends. In Section 4 we introduce causal
estimands that FETWFE can be used to estimate, and in Section 5 we propose the
fused extended two-way fixed effects model, as well as our estimators for our
proposed causal estimands. We present our theoretical guarantees for FETWFE in
Section 6. In Section 7 we demonstrate the superior performance of FETWFE in
our setting against extended two-way fixed effects (ETWFE), bridge-penalized
ETWFE, and a slightly more flexible model than (1.3) in simulation studies. We
illustrate the usefulness of FETWFE in an empirical application using data
from Stevenson and Wolfers (2006) in Section 8. Finally, Section 9 concludes.

###  1.7 Notation

Throughout we will use subscripts like
y~(iâ¢t)subscript~ğ‘¦ğ‘–ğ‘¡\tilde{y}_{(it)}over~ start_ARG italic_y end_ARG
start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT to refer to the
ithsuperscriptğ‘–thi^{\text{th}}italic_i start_POSTSUPERSCRIPT th
end_POSTSUPERSCRIPT unit at the tthsuperscriptğ‘¡tht^{\text{th}}italic_t
start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT time,
ğ’š~(iâ‹…)âˆˆâ„T\boldsymbol{\tilde{y}}_{(i\cdot)}\in\mathbb{R}^{T}overbold_~
start_ARG bold_italic_y end_ARG start_POSTSUBSCRIPT ( italic_i â‹… )
end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_T
end_POSTSUPERSCRIPT to refer to all response observations corresponding to
unit iğ‘–iitalic_i, and so on. For matrices,
ğ’(iâ¢t)â£â‹…subscriptğ’ğ‘–ğ‘¡â‹…\boldsymbol{Z}_{(it)\cdot}bold_italic_Z
start_POSTSUBSCRIPT ( italic_i italic_t ) â‹… end_POSTSUBSCRIPT refers to the
row corresponding to unit iğ‘–iitalic_i at time tğ‘¡titalic_t,
ğ’(iâ‹…)j\boldsymbol{Z}_{(i\cdot)j}bold_italic_Z start_POSTSUBSCRIPT (
italic_i â‹… ) italic_j end_POSTSUBSCRIPT refers to the Tğ‘‡Titalic_T
observations of the jthsuperscriptğ‘—thj^{\text{th}}italic_j
start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT feature in unit iğ‘–iitalic_i,
and so on. We will assume that unit-specific covariates are time invariant,
and it will be more convenient to refer to the covariates for unit
iğ‘–iitalic_i with the notation
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT.

Recall that for a sequence of random variables {XN}subscriptğ‘‹ğ‘\\{X_{N}\\}{
italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT } and a sequence of
positive real numbers {aN}subscriptğ‘ğ‘\\{a_{N}\\}{ italic_a
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT }, we say that
XN=ğ’ªâ„™â¢(aN)subscriptğ‘‹ğ‘subscriptğ’ªâ„™subscriptğ‘ğ‘X_{N}=\mathcal{O}_{\mathbb{P}}(a_{N})italic_X
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = caligraphic_O
start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( italic_a
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) if for every Ïµ>0italic-
Ïµ0\epsilon>0italic_Ïµ > 0 there exists a finite MÏµ>0subscriptğ‘€italic-
Ïµ0M_{\epsilon}>0italic_M start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT > 0
and NÏµ>0subscriptğ‘italic-Ïµ0N_{\epsilon}>0italic_N start_POSTSUBSCRIPT
italic_Ïµ end_POSTSUBSCRIPT > 0 such that for all N>NÏµğ‘subscriptğ‘italic-
ÏµN>N_{\epsilon}italic_N > italic_N start_POSTSUBSCRIPT italic_Ïµ
end_POSTSUBSCRIPT,

| â„™â¢(|XNaN|>MÏµ)<Ïµ.â„™subscriptğ‘‹ğ‘subscriptğ‘ğ‘subscriptğ‘€italic-Ïµitalic-Ïµ\mathbb{P}\left(\left|\frac{X_{N}}{a_{N}}\right|>M_{\epsilon}\right)<\epsilon.blackboard_P ( | divide start_ARG italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG | > italic_M start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ) < italic_Ïµ . |   
---|---|---  
  
If aNâ†’0â†’subscriptğ‘ğ‘0a_{N}\to 0italic_a start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT â†’ 0,
XN=ğ’ªâ„™â¢(aN)subscriptğ‘‹ğ‘subscriptğ’ªâ„™subscriptğ‘ğ‘X_{N}=\mathcal{O}_{\mathbb{P}}(a_{N})italic_X
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = caligraphic_O
start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( italic_a
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) is sufficient for
XNâ†’ğ‘0ğ‘â†’subscriptğ‘‹ğ‘0X_{N}\xrightarrow{p}0italic_X start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT start_ARROW overitalic_p â†’ end_ARROW 0, and
aNsubscriptğ‘ğ‘a_{N}italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
can be interpreted as the rate of convergence (DasGupta, 2008, Chapter 1).

##  2 Basic Setup and Assumptions

We will expand on the setup from the introduction. For each
iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ], assume

| ğ’š~(iâ‹…)=ğ”¼â¢[ğ’š~(iâ‹…)âˆ£Wi,ğ‘¿i]+ciâ¢ğŸT+ğ’–(iâ‹…),\boldsymbol{\tilde{y}}_{(i\cdot)}=\mathbb{E}[\boldsymbol{\tilde{y}}_{(i\cdot)}% \mid W_{i},\boldsymbol{X}_{i}]+c_{i}\boldsymbol{1}_{T}+\boldsymbol{u}_{(i\cdot% )},overbold_~ start_ARG bold_italic_y end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT = blackboard_E [ overbold_~ start_ARG bold_italic_y end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] + italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_1 start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT + bold_italic_u start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT , |   
---|---|---  
  
where ciâˆˆâ„subscriptğ‘ğ‘–â„c_{i}\in\mathbb{R}italic_c start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT âˆˆ blackboard_R and
ğ’–(iâ‹…)âˆˆâ„T\boldsymbol{u}_{(i\cdot)}\in\mathbb{R}^{T}bold_italic_u
start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT are both random variables
and ğŸTsubscript1ğ‘‡\boldsymbol{1}_{T}bold_1 start_POSTSUBSCRIPT italic_T
end_POSTSUBSCRIPT is a Tğ‘‡Titalic_T-vector with 1 in every entry.

Assumption (F1):
ğ”¼â¢[ciâˆ£Wi,ğ‘¿i]=0ğ”¼delimited-[]conditionalsubscriptğ‘ğ‘–subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–0\mathbb{E}[c_{i}\mid
W_{i},\boldsymbol{X}_{i}]=0blackboard_E [ italic_c start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT ] = 0,
ğ”¼â¢[ğ’–(iâ‹…)âˆ£ci,Wi,ğ‘¿i]=ğŸ,\mathbb{E}[\boldsymbol{u}_{(i\cdot)}\mid
c_{i},W_{i},\boldsymbol{X}_{i}]=% \boldsymbol{0},blackboard_E [ bold_italic_u
start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆ£ italic_c
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT ] = bold_0 ,
Varâ¢(ciâˆ£Wi,ğ‘¿i)=Ïƒc2Varconditionalsubscriptğ‘ğ‘–subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–superscriptsubscriptğœğ‘2\mathrm{Var}(c_{i}\mid
W_{i},\boldsymbol{X}_{i})=\sigma_{c}^{2}roman_Var ( italic_c
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_Ïƒ
start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT, and
Varâ¢(ğ’–(iâ‹…)âˆ£ci,Wi,ğ‘¿i)=Ïƒ2â¢ğ‘°T\mathrm{Var}(\boldsymbol{u}_{(i\cdot)}\mid
c_{i},W_{i},\boldsymbol{X}_{i})=% \sigma^{2}\boldsymbol{I}_{T}roman_Var (
bold_italic_u start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆ£
italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_Ïƒ
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I start_POSTSUBSCRIPT
italic_T end_POSTSUBSCRIPT almost surely, where
Ïƒc2superscriptsubscriptğœğ‘2\sigma_{c}^{2}italic_Ïƒ start_POSTSUBSCRIPT
italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT and
Ïƒ2superscriptğœ2\sigma^{2}italic_Ïƒ start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT are assumed to be known and finite and
ğ‘°Tâˆˆâ„TÃ—Tsubscriptğ‘°ğ‘‡superscriptâ„ğ‘‡ğ‘‡\boldsymbol{I}_{T}\in\mathbb{R}^{T\times
T}bold_italic_I start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT âˆˆ
blackboard_R start_POSTSUPERSCRIPT italic_T Ã— italic_T end_POSTSUPERSCRIPT is
the identity matrix.

With Assumption (F1) we can use a generalized least squares transform to
create a data set with conditionally uncorrelated rows. Let
Ïµ(iâ‹…):=ciâ¢ğŸT+ğ’–(iâ‹…)\boldsymbol{\epsilon}_{(i\cdot)}:=c_{i}\boldsymbol{1}_{T}+\boldsymbol{u}_{(i%
\cdot)}bold_italic_Ïµ start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT
:= italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_1
start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT + bold_italic_u
start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT, and observe that for
every iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ] almost surely
Var(Ïµ(iâ‹…)âˆ£Wi,ğ‘¿i)=Ïƒ2ğ‘°T+Ïƒc2ğŸTğŸTâŠ¤=:ğ›€âˆˆâ„TÃ—T\mathrm{Var}(\boldsymbol{\epsilon}_{(i\cdot)}\mid
W_{i},\boldsymbol{X}_{i})=%
\sigma^{2}\boldsymbol{I}_{T}+\sigma_{c}^{2}\boldsymbol{1}_{T}\boldsymbol{1}_{T%
}^{\top}=:\boldsymbol{\Omega}\in\mathbb{R}^{T\times T}roman_Var (
bold_italic_Ïµ start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆ£
italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_Ïƒ
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I start_POSTSUBSCRIPT
italic_T end_POSTSUBSCRIPT + italic_Ïƒ start_POSTSUBSCRIPT italic_c
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_1
start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT bold_1 start_POSTSUBSCRIPT
italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT = :
bold_Î© âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_T Ã— italic_T
end_POSTSUPERSCRIPT. Under (F1), for every
iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ] almost surely
ğ”¼â¢[Ïƒâ¢ğ›€âˆ’1/2â¢Ïµ(iâ‹…)âˆ£Wi,ğ‘¿i]=ğŸ\mathbb{E}[\sigma\boldsymbol{\Omega}^{-1/2}\boldsymbol{\epsilon}_{(i\cdot)}%
\mid W_{i},\boldsymbol{X}_{i}]=\boldsymbol{0}blackboard_E [ italic_Ïƒ bold_Î©
start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT bold_italic_Ïµ
start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = bold_0 and

| Varâ¢(Ïƒâ¢ğ›€âˆ’1/2â¢Ïµ(iâ‹…)âˆ£Wi,ğ‘¿i)=Ïƒ2â¢ğ›€âˆ’1/2â¢Varâ¢(Ïµ(iâ‹…)âˆ£Wi,ğ‘¿i)â¢ğ›€âˆ’1/2=Ïƒ2â¢ğ‘°T.\mathrm{Var}(\sigma\boldsymbol{\Omega}^{-1/2}\boldsymbol{\epsilon}_{(i\cdot)}% \mid W_{i},\boldsymbol{X}_{i})=\sigma^{2}\boldsymbol{\Omega}^{-1/2}\mathrm{Var% }(\boldsymbol{\epsilon}_{(i\cdot)}\mid W_{i},\boldsymbol{X}_{i})\boldsymbol{% \Omega}^{-1/2}=\sigma^{2}\boldsymbol{I}_{T}.roman_Var ( italic_Ïƒ bold_Î© start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT bold_italic_Ïµ start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_Î© start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT roman_Var ( bold_italic_Ïµ start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) bold_Î© start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT = italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT . |  | (2.1)  
---|---|---|---  
  
We can carry out this transformation for any known finite and symmetric
positive definite
ğ›€=Varâ¢(Ïµ(iâ‹…)âˆ£Wi,ğ‘¿i)\boldsymbol{\Omega}=\mathrm{Var}(\boldsymbol{\epsilon}_{(i\cdot)}\mid
W_{i},% \boldsymbol{X}_{i})bold_Î© = roman_Var ( bold_italic_Ïµ
start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ). All of our results can be
easily adapted to apply for any such ğ›€ğ›€\boldsymbol{\Omega}bold_Î©, though
we focus on the specified setting for concreteness.

Next we make an assumption on the joint distribution of the potential
outcomes, treatment, and covariates. Let

| Ï€râ¢(ğ’™):=â„™â¢(Wi=râˆ£ğ‘¿i=ğ’™),râˆˆ{0}âˆªâ„›formulae-sequenceassignsubscriptğœ‹ğ‘Ÿğ’™â„™subscriptğ‘Šğ‘–conditionalğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™ğ‘Ÿ0â„›\pi_{r}(\boldsymbol{x}):=\mathbb{P}(W_{i}=r\mid\boldsymbol{X}_{i}=\boldsymbol{% x}),\qquad r\in\\{0\\}\cup\mathcal{R}italic_Ï€ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) := blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r âˆ£ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ) , italic_r âˆˆ { 0 } âˆª caligraphic_R |  | (2.2)  
---|---|---|---  
  
be the conditional probability of a unitâ€™s treatment status, a propensity
score.

Assumption (F2): The Nğ‘Nitalic_N joint random variables
(Wi,ğ‘¿i,ci,ğ’–(iâ‹…))i=1N(W_{i},\boldsymbol{X}_{i},c_{i},\boldsymbol{u}_{(i\cdot)})_{i=1}^{N}(
italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT ( italic_i â‹…
) end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT are independent and
identically distributed (iid). Further, assume that for all
râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 } âˆª
caligraphic_R, almost surely
0<Ï€râ¢(ğ‘¿i)<10subscriptğœ‹ğ‘Ÿsubscriptğ‘¿ğ‘–10<\pi_{r}(\boldsymbol{X}_{i})<10
< italic_Ï€ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) < 1.

Notice that for each ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT all of the potential outcomes
y~iâ¢tâ¢(r)subscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿ\tilde{y}_{it}(r)over~ start_ARG italic_y
end_ARG start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT ( italic_r )
are well-defined under Assumption (F2) since treatment probabilities are
always strictly between 0 and 1. So far we have made no assumptions on the
relationship between the treatment assignments and the potential outcomes for
a given unit, but we do so in the next section.

##  3 Difference-in-Differences Assumptions

We will use the generalizations of the no anticipation and common trends
assumptions described in the introductionâ€”Assumptions (CNAS) and (CCTS),
respectivelyâ€”that were proposed by Wooldridge (2021), in addition to some
variations and other assumptions.

Assumption (CNAS) (â€œconditional no-anticipation with staggered
interventions"): For treatment cohorts râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r
âˆˆ caligraphic_R, almost surely

| ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ’y~(iâ¢t)â¢(0)âˆ£Wi=r,ğ‘¿i]=0âˆ€iâˆˆ[N],t<r.formulae-sequenceğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿconditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–0formulae-sequencefor-allğ‘–delimited-[]ğ‘ğ‘¡ğ‘Ÿ\mathbb{E}[\tilde{y}_{(it)}(r)-\tilde{y}_{(it)}(0)\mid W_{i}=r,\boldsymbol{X}_% {i}]=0\qquad\forall i\in[N],t<r.blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = 0 âˆ€ italic_i âˆˆ [ italic_N ] , italic_t < italic_r . |   
---|---|---  
  
This requires that before treatment, in conditional expectation each
individualâ€™s expected outcome is identical to what it would have been if the
unit were never treated. Some works (two recent examples are Caetano etÂ al.
(2022) and Ghanem etÂ al. 2024) define the potential outcomes of the units at
each time in terms of their treatment status at that time rather than in terms
of their cohort membership. In our notation, this amounts to assuming that
y~(iâ¢t)â¢(r)=y~(iâ¢t)â¢(0)subscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿsubscript~ğ‘¦ğ‘–ğ‘¡0\tilde{y}_{(it)}(r)=\tilde{y}_{(it)}(0)over~
start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t )
end_POSTSUBSCRIPT ( italic_r ) = over~ start_ARG italic_y end_ARG
start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) almost
surely for t<rğ‘¡ğ‘Ÿt<ritalic_t < italic_r. As Wooldridge (2021, Section 6.3)
points out, this stronger assumption is sufficient for (CNAS). Such a
framework may not be troubling, but we only need the weaker assumption (CNAS).
See further discussion in Wooldridge (2021, Sections 5.3, 6.1, 6.3).

###  3.1 Parallel Trends Assumptions

We will discuss and use a variety of parallel or common trends assumptions.

Assumption (CCTS) (â€œconditional common trends with staggered
interventions"): For all râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ
caligraphic_R, iâˆˆ[N],tâˆˆ{2,â€¦,T}formulae-
sequenceğ‘–delimited-[]ğ‘ğ‘¡2â€¦ğ‘‡i\in[N],t\in\\{2,\ldots,T\\}italic_i âˆˆ [
italic_N ] , italic_t âˆˆ { 2 , â€¦ , italic_T }, almost surely

| ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i]=ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i].ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=r,\boldsymbol{X}_% {i}]=\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,% \boldsymbol{X}_{i}].blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] . |  | (3.1)  
---|---|---|---  
  
Assumption (CCTS) requires that each unitâ€™s untreated potential outcomes
y~(iâ¢t)â¢(0)subscript~ğ‘¦ğ‘–ğ‘¡0\tilde{y}_{(it)}(0)over~ start_ARG italic_y
end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 )
follow the same trend over time in conditional expectation regardless of when
or if they are treated. Assumption (CCTS) is used by Callaway (2023,
Assumption 5), and also by Gavrilova etÂ al. (2023, Assumption 1) in the
â„›={2}â„›2\mathcal{R}=\\{2\\}caligraphic_R = { 2 } case. Assumption (CCTS)
has become widely adopted in the T=2ğ‘‡2T=2italic_T = 2 setting; early
examples include Heckman etÂ al. (1997, Assumption A-5), Heckman etÂ al.
(1998, Equation 12), and Abadie (2005, Assumption 3.1), and some more recent
examples include Santâ€™Anna and Zhao (2020, Assumption 2), Zimmert (2020,
Assumption 6(iv)), Chang (2020, Assumption 2.1), Roth etÂ al. (2023,
Assumption 6), and Ghanem etÂ al. (2024, Assumption PT-X).

We also consider versions of (CCTS) that only apply before or after treatment
begins for each cohort.

Assumption (CCTSB) (â€œconditional common trends before treatment"): (3.1)
holds almost surely for all
râˆˆâ„›âˆ–{2}ğ‘Ÿâ„›2r\in\mathcal{R}\setminus\\{2\\}italic_r âˆˆ caligraphic_R
âˆ– { 2 }, iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ], and
tâˆˆ{2,â€¦,râˆ’1}ğ‘¡2â€¦ğ‘Ÿ1t\in\\{2,\ldots,r-1\\}italic_t âˆˆ { 2 , â€¦ ,
italic_r - 1 }.

Assumption (CCTSA) (â€œconditional common trends after treatment"): (3.1)
holds almost surely for all râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ
caligraphic_R, iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ], and
tâˆˆ{r,â€¦,T}ğ‘¡ğ‘Ÿâ€¦ğ‘‡t\in\\{r,\ldots,T\\}italic_t âˆˆ { italic_r , â€¦ ,
italic_T }.

Assumption (CCTSB) requires that (CCTS) holds only until the period before
each unit is treated, while (CCTSA) requires (CCTS) to hold after treatment
begins. Many previous works have distinguished between the parallel trends
before treatment versus after treatment, noting that (CCTSB) can be directly
tested under assumption (CNAS) while (CCTSA) cannot, since untreated potential
outcomes are not observed for units after treatment, and noting that parallel
trends holding before treatment is no guarantee of holding after treatment.
See Bilinski and Hatfield (2018); Kahn-Lang and Lang (2020); Dette (2020); Sun
and Abraham (2021); Ban and Kedagni (2022); Callaway and Santâ€™Anna (2022);
Roth (2022), Henderson and Sperlich (2022, Equation 22), Borusyak etÂ al.
(2024); Rambachan and Roth (2023), and Callaway (2023, Section 3.3). See
Wooldridge (2021, Section 7.1, Equation 7.4) for an example of how (CCTSB) can
be tested under (CNAS).

We can contrast (CCTS) with an unconditional or marginal version, which
Wooldridge (2021) calls Assumption (CTS).

Assumption (CTS) (â€œcommon trends with staggered interventions"): Almost
surely for all râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R

| ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r]=ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0],iâˆˆ[N],tâˆˆ{2,â€¦,T}.formulae-sequenceğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0formulae-sequenceğ‘–delimited-[]ğ‘ğ‘¡2â€¦ğ‘‡\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=r]=\mathbb{E}[% \tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0],\qquad i\in[N],t\in\\{2,% \ldots,T\\}.blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] = blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] , italic_i âˆˆ [ italic_N ] , italic_t âˆˆ { 2 , â€¦ , italic_T } . |  | (3.2)  
---|---|---|---  
  
We will also refer to a version of (CTS) that holds only after treatment:

Assumption (CTSA) (â€œcommon trends with staggered interventions after
treatment"): (3.2) holds almost surely for all
iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ],
râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R, and
tâˆˆ{r,â€¦,T}ğ‘¡ğ‘Ÿâ€¦ğ‘‡t\in\\{r,\ldots,T\\}italic_t âˆˆ { italic_r , â€¦ ,
italic_T }.

Because (CTS) does not account for covariates, (CCTS) is often thought of as
more plausible than (CTS). We generally agree, though in Appendix A.2 we add
some nuance by pointing out that (CTS) can hold when (CCTS) does not hold
(Theorem A.2). In such a setting it is not possible to estimate conditional
average treatment effects using regression (1.5); we show this formally in
Theorem A.5(a) in the appendix. Further, it turns out that even marginal
average treatment effect estimates from models like FETWFE that rely on (CCTS)
will in general be inconsistent.

However, (CTS) holding is enough to estimate marginal average treatment
effects consistently using many estimators, so it is reasonable to wonder
whether regression (1.5) might be able to estimate treatment effects
consistently under (CTS) and some additional assumptions. The following
assumption will turn out to allow FETWFE to consistently estimate marginal
average treatment effects if (CTS) holds, even if (CCTS) does not.

Assumption (CIUN) (â€œconditional independence of trends of the untreated
potential outcomes for never-treated units"): Almost surely for all
iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ] and any
tâˆˆ{2,â€¦,T}ğ‘¡2â€¦ğ‘‡t\in\\{2,\ldots,T\\}italic_t âˆˆ { 2 , â€¦ , italic_T
},

| ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0]=ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i].ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0\right]=% \mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,% \boldsymbol{X}_{i}\right].blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] = blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] . |   
---|---|---  
  
Assumption (CIUN) requires that the trends in the untreated potential outcomes
are mean-independent of the covariates conditional on treatment status for
units that are untreated. Since (CIUN) depends only on the observed potential
outcomes, it can be tested, as we discuss in the next section.

###  3.2 Linearity Assumption (Assumption LINS)

We present an assumption that is slightly different than one introduced by
Wooldridge (2021) on the functional forms of the conditional distributions of
the untreated potential outcomes, the trends
y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)subscript~ğ‘¦ğ‘–ğ‘¡0subscript~ğ‘¦ğ‘–10\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)over~
start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t )
end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT
( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ), and the difference-in-differences
estimands.

Assumption (LINS): For each Nâˆˆâ„•ğ‘â„•N\in\mathbb{N}italic_N âˆˆ
blackboard_N, assume we observe dNsubscriptğ‘‘ğ‘d_{N}italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT covariates, where
dNsubscriptğ‘‘ğ‘d_{N}italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
may be fixed or increasing in Nğ‘Nitalic_N. There exist fixed parameters
Î·âˆ—âˆˆâ„,{Î½râˆ—}râˆˆâ„›âˆˆâ„formulae-
sequencesuperscriptğœ‚â„subscriptsuperscriptsubscriptğœˆğ‘Ÿğ‘Ÿâ„›â„\eta^{*}\in\mathbb{R},\\{\nu_{r}^{*}\\}_{r\in\mathcal{R}}\in\mathbb{R}italic_Î·
start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆˆ blackboard_R , { italic_Î½
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R
end_POSTSUBSCRIPT âˆˆ blackboard_R,
{Î³tâˆ—}tâˆˆ{2,â€¦,T}âˆˆâ„subscriptsuperscriptsubscriptğ›¾ğ‘¡ğ‘¡2â€¦ğ‘‡â„\\{\gamma_{t}^{*}\\}_{t\in\\{2,\ldots,T\\}}\in\mathbb{R}{
italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_t âˆˆ { 2 , â€¦ ,
italic_T } end_POSTSUBSCRIPT âˆˆ blackboard_R, and
{Ï„râ¢tâˆ—}râˆˆâ„›,tâ‰¥râˆˆâ„subscriptsuperscriptsubscriptğœğ‘Ÿğ‘¡formulae-
sequenceğ‘Ÿâ„›ğ‘¡ğ‘Ÿâ„\\{\tau_{rt}^{*}\\}_{r\in\mathcal{R},t\geq
r}\in\mathbb{R}{ italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT }
start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R , italic_t â‰¥ italic_r
end_POSTSUBSCRIPT âˆˆ blackboard_R, along with fixed sequences of parameters
{ğœ¿Nâˆ—}Nâˆˆâ„•âˆˆâ„dN,{ğœ»râ¢Nâˆ—}râˆˆâ„›,Nâˆˆâ„•âˆˆâ„dN,{ğƒtâ¢Nâˆ—}tâˆˆ{2,â€¦,T},Nâˆˆâ„•âˆˆâ„dNformulae-
sequencesubscriptsuperscriptsubscriptğœ¿ğ‘ğ‘â„•superscriptâ„subscriptğ‘‘ğ‘formulae-
sequencesubscriptsuperscriptsubscriptğœ»ğ‘Ÿğ‘formulae-
sequenceğ‘Ÿâ„›ğ‘â„•superscriptâ„subscriptğ‘‘ğ‘subscriptsuperscriptsubscriptğƒğ‘¡ğ‘formulae-
sequenceğ‘¡2â€¦ğ‘‡ğ‘â„•superscriptâ„subscriptğ‘‘ğ‘\\{\boldsymbol{\kappa}_{N}^{*}\\}_{N\in\mathbb{N}}\in\mathbb{R}^{d_{N}},\\{%
\boldsymbol{\zeta}_{rN}^{*}\\}_{r\in\mathcal{R},N\in\mathbb{N}}\in\mathbb{R}^{d%
_{N}},\\{\boldsymbol{\xi}_{tN}^{*}\\}_{t\in\\{2,\ldots,T\\},N\in\mathbb{N}}\in%
\mathbb{R}^{d_{N}}{ bold_italic_Îº start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT }
start_POSTSUBSCRIPT italic_N âˆˆ blackboard_N end_POSTSUBSCRIPT âˆˆ
blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , { bold_italic_Î¶ start_POSTSUBSCRIPT
italic_r italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R ,
italic_N âˆˆ blackboard_N end_POSTSUBSCRIPT âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
end_POSTSUPERSCRIPT , { bold_italic_Î¾ start_POSTSUBSCRIPT italic_t italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT }
start_POSTSUBSCRIPT italic_t âˆˆ { 2 , â€¦ , italic_T } , italic_N âˆˆ
blackboard_N end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT, and
{ğ†râ¢tâ¢Nâˆ—}râˆˆâ„›,tâ‰¥r,Nâˆˆâ„•âˆˆâ„dNsubscriptsuperscriptsubscriptğ†ğ‘Ÿğ‘¡ğ‘formulae-
sequenceğ‘Ÿâ„›formulae-
sequenceğ‘¡ğ‘Ÿğ‘â„•superscriptâ„subscriptğ‘‘ğ‘\\{\boldsymbol{\rho}_{rtN}^{*}\\}_{r\in\mathcal{R},t\geq
r,N\in\mathbb{N}}\in% \mathbb{R}^{d_{N}}{ bold_italic_Ï start_POSTSUBSCRIPT
italic_r italic_t italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R ,
italic_t â‰¥ italic_r , italic_N âˆˆ blackboard_N end_POSTSUBSCRIPT âˆˆ
blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT end_POSTSUPERSCRIPT such that for each
Nâˆˆâ„•ğ‘â„•N\in\mathbb{N}italic_N âˆˆ blackboard_N, for all
iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ] and any fixed
ğ’™âˆˆâ„dNğ’™superscriptâ„subscriptğ‘‘ğ‘\boldsymbol{x}\in\mathbb{R}^{d_{N}}bold_italic_x
âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT end_POSTSUPERSCRIPT in the support of the random vector
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT it holds that

| ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]=ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™absent\displaystyle\mathbb{E}\left[\tilde{y}_{(i1)}(0)\mid W_{i}=0,\boldsymbol{X}_{i% }=\boldsymbol{x}\right]=\leavevmode\nobreak\ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] = | Î·âˆ—+ğ’™âŠ¤â¢ğœ¿Nâˆ—,superscriptğœ‚superscriptğ’™topsuperscriptsubscriptğœ¿ğ‘\displaystyle\eta^{*}+\boldsymbol{x}^{\top}\boldsymbol{\kappa}_{N}^{*},italic_Î· start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_x start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Îº start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , |  | (3.3)  
---|---|---|---|---  
| ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tilde{y}_{(i1)}(0)\mid W_{i}=r,\boldsymbol{X}_{i% }=\boldsymbol{x}\right]\qquadblackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |  |   
| âˆ’ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]=ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™absent\displaystyle-\mathbb{E}\left[\tilde{y}_{(i1)}(0)\mid W_{i}=0,\boldsymbol{X}_{% i}=\boldsymbol{x}\right]=\leavevmode\nobreak\ \- blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] = | Î½râˆ—+ğ’™âŠ¤â¢ğœ»râ¢Nâˆ—âˆ€râˆˆâ„›,superscriptsubscriptğœˆğ‘Ÿsuperscriptğ’™topsuperscriptsubscriptğœ»ğ‘Ÿğ‘for-allğ‘Ÿâ„›\displaystyle\nu_{r}^{*}+\boldsymbol{x}^{\top}\boldsymbol{\zeta}_{rN}^{*}% \qquad\forall r\in\mathcal{R},italic_Î½ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_x start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¶ start_POSTSUBSCRIPT italic_r italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ€ italic_r âˆˆ caligraphic_R , |  | (3.4)  
| ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]=ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™absent\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}% =0,\boldsymbol{X}_{i}=\boldsymbol{x}\right]=\leavevmode\nobreak\ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] = | Î³tâˆ—+ğ’™âŠ¤â¢ğƒtâ¢Nâˆ—,tâˆˆ{2,â€¦,T},andformulae-sequencesuperscriptsubscriptğ›¾ğ‘¡superscriptğ’™topsuperscriptsubscriptğƒğ‘¡ğ‘ğ‘¡2â€¦ğ‘‡and\displaystyle\gamma_{t}^{*}+\boldsymbol{x}^{\top}\boldsymbol{\xi}_{tN}^{*},% \qquad t\in\\{2,\ldots,T\\},\qquad\text{and}italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_x start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT italic_t italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , italic_t âˆˆ { 2 , â€¦ , italic_T } , and |  | (3.5)  
| ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ’y~(iâ¢1)â¢(r)âˆ£Wi=r,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿconditionalsubscript~ğ‘¦ğ‘–1ğ‘Ÿsubscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}(r)-\tilde{y}_{(i1)}(r)\mid W_{i}% =r,\boldsymbol{X}_{i}=\boldsymbol{x}\right]\qquadblackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |  |   
| âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]=ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™absent\displaystyle-\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i% }=0,\boldsymbol{X}_{i}=\boldsymbol{x}\right]=\leavevmode\nobreak\ \- blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] = | Ï„râ¢tâˆ—+ğ’™Ë™râŠ¤â¢ğ†râ¢tâ¢Nâˆ—,râˆˆâ„›,tâ‰¥r,formulae-sequencesuperscriptsubscriptğœğ‘Ÿğ‘¡superscriptsubscriptbold-Ë™ğ’™ğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡ğ‘ğ‘Ÿâ„›ğ‘¡ğ‘Ÿ\displaystyle\tau_{rt}^{*}+\boldsymbol{\dot{x}}_{r}^{\top}\boldsymbol{\rho}_{% rtN}^{*},\qquad r\in\mathcal{R},t\geq r,italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + overbold_Ë™ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , italic_r âˆˆ caligraphic_R , italic_t â‰¥ italic_r , |  | (3.6)  
  
where

| ğ’™Ë™r:=ğ’™âˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r]assignsubscriptbold-Ë™ğ’™ğ‘Ÿğ’™ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\boldsymbol{\dot{x}}_{r}:=\boldsymbol{x}-\mathbb{E}\left[\boldsymbol{X}_{i}% \mid W_{i}=r\right]overbold_Ë™ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT := bold_italic_x - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |   
---|---|---  
  
are covariate vectors that are centered with respect to their cohort means.
(For conciseness, hereafter we omit Nğ‘Nitalic_N from the subscripts of the
parameters defined here that may vary with Nğ‘Nitalic_N.)

The version of this assumption presented by Wooldridge (2021) uses a slightly
different expression for (3.6) and requires
dN=dsubscriptğ‘‘ğ‘ğ‘‘d_{N}=ditalic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT = italic_d to be fixed, since ETWFE is inconsistent in the
high-dimensional setting we consider. Notice the similarity of the quantity on
the left side of (3.6) to the canonical two-period difference-in-differences
estimand (1.2). Wooldridge (2021) shows that Assumption (LINS), along with
Assumptions (CNAS) and (CCTS), make (1.5) correctly specified for the
potential outcomes and the the left side of (3.6) equal to the conditional
average treatment effects. See also our derivation (A.8) and Theorem C.1(a) in
the appendix.

######  Remark 3.1.

We can gain insight on (CCTS) by re-arranging and using the conditional
independence from Wisubscriptğ‘Šğ‘–W_{i}italic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT to arrive at the following equivalent condition:

|  | ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ£Wi=r,ğ‘¿i]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ£Wi=0,ğ‘¿i]ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–\displaystyle\mathbb{E}[\tilde{y}_{(it)}(0)\mid W_{i}=r,\boldsymbol{X}_{i}]-% \mathbb{E}[\tilde{y}_{(it)}(0)\mid W_{i}=0,\boldsymbol{X}_{i}]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i]âˆ’ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i],râˆˆâ„›,iâˆˆ[N],tâˆˆ{2,â€¦,T}.formulae-sequenceğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ‘Ÿâ„›formulae-sequenceğ‘–delimited-[]ğ‘ğ‘¡2â€¦ğ‘‡\displaystyle\mathbb{E}[\tilde{y}_{(i1)}(0)\mid W_{i}=r,\boldsymbol{X}_{i}]-% \mathbb{E}[\tilde{y}_{(i1)}(0)\mid W_{i}=0,\boldsymbol{X}_{i}],\qquad r\in% \mathcal{R},i\in[N],t\in\\{2,\ldots,T\\}.blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] , italic_r âˆˆ caligraphic_R , italic_i âˆˆ [ italic_N ] , italic_t âˆˆ { 2 , â€¦ , italic_T } . |  | (3.7)  
  
(This is similar to a framing used by, for example, Heckman etÂ al. (1998,
Equations 10 and 12), Lechner etÂ al. (2011, Equation 3.2), Henderson and
Sperlich (2022, Assumption 1), Ban and Kedagni (2022, Section 2.1), and Park
and Tchetgen (2023, Section 2.2) in the T=2ğ‘‡2T=2italic_T = 2 setting.) Under
(CCTS) and (LINS), (3.4) quantifies the time-invariant difference in
conditionally expected potential outcomes between units in each cohort and
units in the never-treated cohort that appears on each side of (3.7). The
inclusion of the terms in (3.4) provides robustness against time-invariant
confounding (see Proposition A.1(a) in the appendix).

On the other hand, under unconfoundedness of the untreated potential outcomes
(which we define formally and discuss in more detail in (A.1) in the
appendix), (3.4) (and each side of Equation 3.7) is identically 0. Although
including these covariates in a regression does not harm unbiasedness under
unconfoundedness, it reduces efficiency. Fortunately, we will see later that
under the assumptions of Theorem 6.3, if the estimated model contains any
coefficients that equal 0 exactly, FETWFE successfully screens out these
covariates and achieves the same asymptotic efficiency as a model that omitted
them. In this way FETWFE provides robustness without compromising asymptotic
efficiency under unconfoundedness, avoiding the kind of trade-off between
robustness and asymptotic efficiency that Zimmert (2020) discusses.

Many previous works have also noted that difference-in-differences estimation
allows for selection bias and can effectively control for some kinds of
unobserved time-invariant confounding. Imai and Kim (2019) explore this idea
in depth, and also raise interesting issues surrounding the plausibility of an
assumption that time-varying covariates do not affect the observed response
and the implications when this assumption is violated. Imai etÂ al. (2023)
propose a matching estimator in a setting with time-varying covariates. For
more in-depth investigations into the parallel trends assumption, see Ghanem
etÂ al. (2024), Roth and Santâ€™Anna (2023), and Marx etÂ al. (2024). See also
our further discussion in Appendix A.

Under Assumption (CIUN) and (LINS), the covariates
ğƒtâˆ—superscriptsubscriptğƒğ‘¡\boldsymbol{\xi}_{t}^{*}bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT all equal ğŸ0\boldsymbol{0}bold_0. So a test of this null
hypothesis (for example, a Wald test) serves as a test for the null hypothesis
that both (CIUN) and (LINS) hold.

##  4 Causal Estimands

Next we will discuss several classes of causal estimands we hope to estimate
using FETWFE. The building block of our estimands will be the conditional
average treatment effects on the treated units
Ï„CATTâ¢(r,t,ğ’™)subscriptğœCATTğ‘Ÿğ‘¡ğ’™\tau_{\text{CATT}}(r,t,\boldsymbol{x})italic_Ï„
start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t ,
bold_italic_x ) from (1.6), which matches definition (6.23) in Wooldridge
(2021). Estimating
Ï„CATTâ¢(r,t,ğ’™)subscriptğœCATTğ‘Ÿğ‘¡ğ’™\tau_{\text{CATT}}(r,t,\boldsymbol{x})italic_Ï„
start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t ,
bold_italic_x ) is useful if we are interested in identifying which units are
most affected by the treatment at a specific time. Besides economics (Florens
etÂ al., 2008; Djebbari and Smith, 2008), domains where conditional average
treatment effect estimation have been found useful include personalized
medicine (Feinstein etÂ al., 1972; Lesko, 2007; Frankovich etÂ al., 2011;
Foster etÂ al., 2011), education (Morgan, 2001; Brand and Xie, 2010; Murphy
etÂ al., 2016), targeted marketing (Bottou etÂ al., 2013; Athey etÂ al., 2018;
Hitsch and Misra, 2018; Ascarza, 2018; Yang etÂ al., 2020; Ellickson etÂ al.,
2022), psychology (Bolger etÂ al., 2019; Winkelbeiner etÂ al., 2019),
sociology (Xie etÂ al., 2012; Breen etÂ al., 2015), and political science
(Imai and Strauss, 2011; Grimmer etÂ al., 2017).

Many methods for estimating conditional average (or heterogeneous333Within the
differences-in-differences literature, the descriptor â€œheterogeneousâ€ has
often been used in reference to treatment effects that vary across cohorts or
across time; e.g., DeÂ Chaisemartin and dâ€™Haultfoeuille (2020); Sun and
Abraham (2021); Wooldridge (2021). Here we refer to heterogeneity in treatment
effects across the distribution of
ğ—isubscriptğ—ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT, though our model also accommodates heterogeneity in
treatment effects across cohorts and time. To avoid ambiguity, we will
generally use the term â€œconditional average treatment effects.â€) treatment
effects have been developed within econometrics over the last decade; see
Abrevaya etÂ al. (2015); Athey and Imbens (2016); Wager and Athey (2018); Nie
and Wager (2021); Semenova and Chernozhukov (2021), and Fan etÂ al. (2022) for
a few examples.

###  4.1 Conditional Average Treatment Effect Estimands

We can use (1.6) to construct a variety of causal estimands. For any set of
finite constants
{Ïˆrâ¢t}râˆˆâ„›,tâˆˆ{r,â€¦,T}subscriptsubscriptğœ“ğ‘Ÿğ‘¡formulae-
sequenceğ‘Ÿâ„›ğ‘¡ğ‘Ÿâ€¦ğ‘‡\\{\psi_{rt}\\}_{r\in\mathcal{R},t\in\\{r,\ldots,T\\}}{
italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT }
start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R , italic_t âˆˆ { italic_r , â€¦
, italic_T } end_POSTSUBSCRIPT, consider the estimand

| âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢Ï„CATTâ¢(r,t,ğ’™),subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğœCATTğ‘Ÿğ‘¡ğ’™\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\tau_{\text{CATT}}(r,t,% \boldsymbol{x}),âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) , |  | (4.1)  
---|---|---|---  
  
a weighted average of the cohort- and time-specific conditional average
treatment effects. This is similar to the framework of estimation targets of
Borusyak etÂ al. (2024) and Callaway and Santâ€™Anna (2021, Equation 3.1),
though they study average treatment effects (like our estimand (4.8), to come)
rather than conditional average treatment effects. Refer to these papers for
many examples of choices of {Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{
italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT }. Similar
aggregations are also discussed by Brown and Butts (2022, Remark 3.2) and
Wooldridge (2021, Section 6.5).

To give one example among many possible estimands of interest using specific
{Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ start_POSTSUBSCRIPT
italic_r italic_t end_POSTSUBSCRIPT }, we could choose for some
râ€²âˆˆâ„›superscriptğ‘Ÿâ€²â„›r^{\prime}\in\mathcal{R}italic_r
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R

| Ïˆrâ¢t={1Tâˆ’râ€²+1,r=râ€²,0,otherwisesubscriptğœ“ğ‘Ÿğ‘¡cases1ğ‘‡superscriptğ‘Ÿâ€²1ğ‘Ÿsuperscriptğ‘Ÿâ€²0otherwise\psi_{rt}=\begin{cases}\frac{1}{T-r^{\prime}+1},&r=r^{\prime},\\\ 0,&\text{otherwise}\end{cases}italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT = { start_ROW start_CELL divide start_ARG 1 end_ARG start_ARG italic_T - italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT + 1 end_ARG , end_CELL start_CELL italic_r = italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , end_CELL end_ROW start_ROW start_CELL 0 , end_CELL start_CELL otherwise end_CELL end_ROW |  | (4.2)  
---|---|---|---  
  
to define the conditional average treatment effect across time for a unit in
cohort râ€²superscriptğ‘Ÿâ€²r^{\prime}italic_r start_POSTSUPERSCRIPT â€²
end_POSTSUPERSCRIPT with covariates ğ’™ğ’™\boldsymbol{x}bold_italic_x:

| Ï„CATTâ¢(râ€²,ğ’™):=assignsubscriptğœCATTsuperscriptğ‘Ÿâ€²ğ’™absent\displaystyle\tau_{\text{CATT}}(r^{\prime},\boldsymbol{x}):=\leavevmode\nobreak\ italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , bold_italic_x ) := | 1Tâˆ’râ€²+1â¢âˆ‘t=râ€²TÏ„CATTâ¢(râ€²,ğ’™,t)1ğ‘‡superscriptğ‘Ÿâ€²1superscriptsubscriptğ‘¡superscriptğ‘Ÿâ€²ğ‘‡subscriptğœCATTsuperscriptğ‘Ÿâ€²ğ’™ğ‘¡\displaystyle\frac{1}{T-r^{\prime}+1}\sum_{t=r^{\prime}}^{T}\tau_{\text{CATT}}% (r^{\prime},\boldsymbol{x},t)divide start_ARG 1 end_ARG start_ARG italic_T - italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT + 1 end_ARG âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , bold_italic_x , italic_t ) |  | (4.3)  
---|---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | 1Tâˆ’râ€²+1â¢âˆ‘t=râ€²Tğ”¼â¢[y~(iâ¢t)â¢(râ€²)âˆ’y~(iâ¢t)â¢(0)âˆ£Wi=râ€²,ğ‘¿i=ğ’™].1ğ‘‡superscriptğ‘Ÿâ€²1superscriptsubscriptğ‘¡superscriptğ‘Ÿâ€²ğ‘‡ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡superscriptğ‘Ÿâ€²conditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–superscriptğ‘Ÿâ€²subscriptğ‘¿ğ‘–ğ’™\displaystyle\frac{1}{T-r^{\prime}+1}\sum_{t=r^{\prime}}^{T}\mathbb{E}[\tilde{% y}_{(it)}(r^{\prime})-\tilde{y}_{(it)}(0)\mid W_{i}=r^{\prime},\boldsymbol{X}_% {i}=\boldsymbol{x}].divide start_ARG 1 end_ARG start_ARG italic_T - italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT + 1 end_ARG âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] . |   
  
A version of (4.3) for average (rather than conditional average) treatment
effects was considered by Wooldridge (2021, Equation 6.41), and a slightly
more general form (also accommodated by our framework) was considered by
Goodman-Bacon (2021, Equation 12).

####  4.1.1 Propensity-Weighted Conditional Average Treatment Effects

A second class of causal estimands can be generated by weighting each
Ï„CATTâ¢(r,t,ğ’™)subscriptğœCATTğ‘Ÿğ‘¡ğ’™\tau_{\text{CATT}}(r,t,\boldsymbol{x})italic_Ï„
start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t ,
bold_italic_x ) by the probability a unit is in cohort rğ‘Ÿritalic_r given
that they are treated conditional on ğ’™ğ’™\boldsymbol{x}bold_italic_x,

| Ï€~r(ğ’™):=â„™(Wi=râˆ£Wiâ‰ 0,ğ‘¿i=ğ’™)=(âˆ‘râ€²âˆˆâ„›Ï€râ€²(ğ’™))âˆ’1Ï€r(ğ’™)âˆ€râˆˆâ„›.\tilde{\pi}_{r}(\boldsymbol{x}):=\mathbb{P}(W_{i}=r\mid W_{i}\neq 0,% \boldsymbol{X}_{i}=\boldsymbol{x})=\left(\sum_{r^{\prime}\in\mathcal{R}}\pi_{r% ^{\prime}}(\boldsymbol{x})\right)^{-1}\pi_{r}(\boldsymbol{x})\qquad\forall r% \in\mathcal{R}.over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) := blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT â‰ 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ) = ( âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) âˆ€ italic_r âˆˆ caligraphic_R . |  | (4.4)  
---|---|---|---  
  
In particular, for any set of finite constants
{Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ start_POSTSUBSCRIPT
italic_r italic_t end_POSTSUBSCRIPT }, consider the estimands

| âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢Ï€~râ¢(ğ’™)â¢Ï„CATTâ¢(r,t,ğ’™).subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript~ğœ‹ğ‘Ÿğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\tilde{\pi}_{r}(\boldsymbol{x})% \tau_{\text{CATT}}(r,t,\boldsymbol{x}).âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) . |  | (4.5)  
---|---|---|---  
  
One example of an estimand we can form in this class arises from choosing

| Ïˆrâ¢t:={0,r=0,1Tâˆ’r+1,otherwise,assignsubscriptğœ“ğ‘Ÿğ‘¡cases0ğ‘Ÿ01ğ‘‡ğ‘Ÿ1otherwise,\psi_{rt}:=\begin{cases}0,&r=0,\\\ \frac{1}{T-r+1},&\text{otherwise,}\end{cases}italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT := { start_ROW start_CELL 0 , end_CELL start_CELL italic_r = 0 , end_CELL end_ROW start_ROW start_CELL divide start_ARG 1 end_ARG start_ARG italic_T - italic_r + 1 end_ARG , end_CELL start_CELL otherwise, end_CELL end_ROW |  | (4.6)  
---|---|---|---  
  
which yields a conditional average treatment effect by marginalizing (4.3)
across treatment status:

| Ï„CATTâ¢(ğ’™):=assignsubscriptğœCATTğ’™absent\displaystyle\tau_{\text{CATT}}(\boldsymbol{x}):=\leavevmode\nobreak\ italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( bold_italic_x ) := | âˆ‘râˆˆâ„›âˆ‘t=rT1Tâˆ’r+1â¢Ï€~râ¢(ğ’™)â¢Ï„CATTâ¢(r,t,ğ’™)subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡1ğ‘‡ğ‘Ÿ1subscript~ğœ‹ğ‘Ÿğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\frac{1}{T-r+1}\tilde{\pi}_{r% }(\boldsymbol{x})\tau_{\text{CATT}}(r,t,\boldsymbol{x})âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG italic_T - italic_r + 1 end_ARG over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) |  | (4.7)  
---|---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | âˆ‘râˆˆâ„›Ï€~râ¢(ğ’™)â¢Ï„CATTâ¢(r,ğ’™)subscriptğ‘Ÿâ„›subscript~ğœ‹ğ‘Ÿğ’™subscriptğœCATTğ‘Ÿğ’™\displaystyle\sum_{r\in\mathcal{R}}\tilde{\pi}_{r}(\boldsymbol{x})\tau_{\text{% CATT}}(r,\boldsymbol{x})âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , bold_italic_x ) |   
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼â¢[Ï„CATTâ¢(Wi,ğ‘¿i)âˆ£Wiâ‰ 0,ğ‘¿i=ğ’™].ğ”¼delimited-[]formulae-sequenceconditionalsubscriptğœCATTsubscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tau_{\text{CATT}}(W_{i},\boldsymbol{X}_{i})\mid W% _{i}\neq 0,\boldsymbol{X}_{i}=\boldsymbol{x}\right].blackboard_E [ italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT â‰ 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] . |   
  
This estimand is closely related to many previously considered heterogenous
treatment effects; one of many works that considers a similar estimand
(outside of the specific context of difference-in-differences) is Wager and
Athey (2018, Equation 1).

###  4.2 Marginal Average Treatment Effects

Outside of conditional average treatment effects, we can also marginalize
these conditional treatment effects over the distribution of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT to get average treatment effects. Since these
estimands are "coarser," it may be possible to get more precise estimates of
these estimands given a fixed sample size.

For
Ï„ATTâ¢(r,t)=ğ”¼â¢[Ï„CATTâ¢(r,t,ğ‘¿i)]subscriptğœATTğ‘Ÿğ‘¡ğ”¼delimited-[]subscriptğœCATTğ‘Ÿğ‘¡subscriptğ‘¿ğ‘–\tau_{\text{ATT}}(r,t)=\mathbb{E}\left[\tau_{\text{CATT}}(r,t,\boldsymbol{X}_{%
i})\right]italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r ,
italic_t ) = blackboard_E [ italic_Ï„ start_POSTSUBSCRIPT CATT
end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT ) ] from (1.1), consider the classes of estimands

| âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tÏ„ATT(r,t))\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\tau_{\text{ATT}}(r,t))âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) |  | (4.8)  
---|---|---|---  
  
and

| âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢Ï€~râ¢Ï„ATTâ¢(r,t),subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript~ğœ‹ğ‘ŸsubscriptğœATTğ‘Ÿğ‘¡\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\tilde{\pi}_{r}\tau_{\text{ATT}}(% r,t),âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) , |  | (4.9)  
---|---|---|---  
  
where Ï€~r:=â„™â¢(Wi=râˆ£Wiâ‰
0)=ğ”¼â¢[Ï€~râ¢(ğ‘¿i)]assignsubscript~ğœ‹ğ‘Ÿâ„™subscriptğ‘Šğ‘–conditionalğ‘Ÿsubscriptğ‘Šğ‘–0ğ”¼delimited-[]subscript~ğœ‹ğ‘Ÿsubscriptğ‘¿ğ‘–\tilde{\pi}_{r}:=\mathbb{P}(W_{i}=r\mid
W_{i}\neq 0)=\mathbb{E}[\tilde{\pi}_{r% }(\boldsymbol{X}_{i})]over~ start_ARG
italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT :=
blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT =
italic_r âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT â‰ 0 ) =
blackboard_E [ over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r
end_POSTSUBSCRIPT ( bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT ) ] is the marginal probability of a unit being in cohort
rğ‘Ÿritalic_r given that it is treated.

Estimand (1.1) was used by Callaway and Santâ€™Anna (2021) and Hatamyar etÂ
al. (2023, Equation 1), and it matches the estimand from Wooldridge (2021,
Equation 6.2) and Brown and Butts (2022, Equation 3). It is also closely
related to the cohort-specific average treatment effect on the treated (3)
from Sun and Abraham (2021) (though we use the acronym CATT to refer to
conditional, not cohort, effects) and estimands from Goodman-Bacon (2021).

As we mentioned earlier, the class of estimands (4.8) is the same framework of
estimation targets considered by Borusyak etÂ al. (2024) and is similar to
aggregations considered by Callaway and Santâ€™Anna (2021, Equation 3.1),
Wooldridge (2021, Section 6.5), Brown and Butts (2022, Remark 3.2), and
Hatamyar etÂ al. (2023, Equation 18).

The probability-weighted class of estimands (4.9) bears a resemblance to the
probability-weighted estimands proposed by Callaway and Santâ€™Anna (2021).
Theorem D.1 in the appendix extends our consistency result to accommodate
classes of estimands with much broader forms of estimated probability weights
than (4.5) and (4.9), like estimand (26) of Sun and Abraham (2021) or the
broad class of estimands used by Callaway and Santâ€™Anna (2021). Theorems D.2
and D.3 extend our asymptotic normality results to these more general
estimators as well.

As a particular choice of {Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT }, we will again
highlight (4.2) for any
râ€²âˆˆâ„›superscriptğ‘Ÿâ€²â„›r^{\prime}\in\mathcal{R}italic_r
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R, which for
estimand (4.8) marginalizes
Ï„CATTâ¢(râ€²,ğ‘¿i)subscriptğœCATTsuperscriptğ‘Ÿâ€²subscriptğ‘¿ğ‘–\tau_{\text{CATT}}(r^{\prime},\boldsymbol{X}_{i})italic_Ï„
start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT
â€² end_POSTSUPERSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT ) over the distribution of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT:

| Ï„ATTâ¢(râ€²):=assignsubscriptğœATTsuperscriptğ‘Ÿâ€²absent\displaystyle\tau_{\text{ATT}}(r^{\prime}):=\leavevmode\nobreak\ italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ) := | 1Tâˆ’râ€²+1â¢âˆ‘t=râ€²TÏ„ATTâ¢(râ€²,t)1ğ‘‡superscriptğ‘Ÿâ€²1superscriptsubscriptğ‘¡superscriptğ‘Ÿâ€²ğ‘‡subscriptğœATTsuperscriptğ‘Ÿâ€²ğ‘¡\displaystyle\frac{1}{T-r^{\prime}+1}\sum_{t=r^{\prime}}^{T}\tau_{\text{ATT}}(% r^{\prime},t)divide start_ARG 1 end_ARG start_ARG italic_T - italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT + 1 end_ARG âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , italic_t ) |  | (4.10)  
---|---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | 1Tâˆ’râ€²+1â¢âˆ‘t=râ€²Tğ”¼â¢[y~(iâ¢t)â¢(râ€²)âˆ’y~(iâ¢t)â¢(0)âˆ£Wi=râ€²]1ğ‘‡superscriptğ‘Ÿâ€²1superscriptsubscriptğ‘¡superscriptğ‘Ÿâ€²ğ‘‡ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡superscriptğ‘Ÿâ€²conditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–superscriptğ‘Ÿâ€²\displaystyle\frac{1}{T-r^{\prime}+1}\sum_{t=r^{\prime}}^{T}\mathbb{E}\left[% \tilde{y}_{(it)}(r^{\prime})-\tilde{y}_{(it)}(0)\mid W_{i}=r^{\prime}\right]divide start_ARG 1 end_ARG start_ARG italic_T - italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT + 1 end_ARG âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ] |   
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼â¢[Ï„CATTâ¢(râ€²,ğ‘¿i)].ğ”¼delimited-[]subscriptğœCATTsuperscriptğ‘Ÿâ€²subscriptğ‘¿ğ‘–\displaystyle\mathbb{E}\left[\tau_{\text{CATT}}(r^{\prime},\boldsymbol{X}_{i})% \right].blackboard_E [ italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] . |   
  
Estimand (4.10) is identical to estimand (3.7) in Callaway and Santâ€™Anna
(2021), and is also the estimand of estimator (6.41) in Wooldridge (2021).

####  4.2.1 The Average Effect of the Treatment on Treated Units

Lastly, one of the most basic causal parameters of interest is the average
effect of treatment on the treated group (ATT). By using the
Ïˆrâ¢tsubscriptğœ“ğ‘Ÿğ‘¡\psi_{rt}italic_Ïˆ start_POSTSUBSCRIPT italic_r
italic_t end_POSTSUBSCRIPT from (4.6) with (4.9), we can express this estimand
as

| Ï„ATT:=assignsubscriptğœATTabsent\displaystyle\tau_{\text{ATT}}:=\leavevmode\nobreak\ italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT := | ğ”¼â¢[Ï„CATTâ¢(ğ‘¿i)âˆ£Wiâ‰ 0]=ğ”¼â¢[âˆ‘râˆˆâ„›Ï€~râ¢(ğ‘¿i)â¢Ï„CATTâ¢(r,ğ‘¿i)].ğ”¼delimited-[]conditionalsubscriptğœCATTsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–0ğ”¼delimited-[]subscriptğ‘Ÿâ„›subscript~ğœ‹ğ‘Ÿsubscriptğ‘¿ğ‘–subscriptğœCATTğ‘Ÿsubscriptğ‘¿ğ‘–\displaystyle\mathbb{E}\left[\tau_{\text{CATT}}(\boldsymbol{X}_{i})\mid W_{i}% \neq 0\right]=\mathbb{E}\left[\sum_{r\in\mathcal{R}}\tilde{\pi}_{r}(% \boldsymbol{X}_{i})\tau_{\text{CATT}}(r,\boldsymbol{X}_{i})\right].blackboard_E [ italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT â‰ 0 ] = blackboard_E [ âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] . |  | (4.11)  
---|---|---|---|---  
  
Estimand (4.11) is similar to estimand (6.40) proposed by Wooldridge (2021) (a
similar estimand is also mentioned by Borusyak etÂ al. 2024), though we weight
the cohort average treatment effects
Ï„CATTâ¢(r,ğ‘¿i)subscriptğœCATTğ‘Ÿsubscriptğ‘¿ğ‘–\tau_{\text{CATT}}(r,\boldsymbol{X}_{i})italic_Ï„
start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) by the probabilities
Ï€~râ¢(ğ‘¿i)subscript~ğœ‹ğ‘Ÿsubscriptğ‘¿ğ‘–\tilde{\pi}_{r}(\boldsymbol{X}_{i})over~
start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT (
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) rather than
taking an average where each average treatment effect in each time period is
weighted equally (we could also take an equal average with our estimand from
Equation 4.8). This probability-weighted average is closely related to
estimand (26) from Sun and Abraham (2021).

The virtues of estimand Ï„ATTsubscriptğœATT\tau_{\text{ATT}}italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT include summarizing the effect of
the treatment in a single number and potentially being a less noisy quantity
to estimate. Estimating Ï„ATTsubscriptğœATT\tau_{\text{ATT}}italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT will involve taking a weighted
average over many estimated coefficients rather than relying on a single, less
precise, estimated coefficient. In contrast, more specific estimands like
Ï„CATTâ¢(r,t,ğ’™)subscriptğœCATTğ‘Ÿğ‘¡ğ’™\tau_{\text{CATT}}(r,t,\boldsymbol{x})italic_Ï„
start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t ,
bold_italic_x ) will typically be difficult to estimate with precision because
their estimators will depend heavily on a small subset of the observed data
(though this problem will be mitigated by our fusion penalty, discussed in the
next section, which allows us to borrow information from nearby estimators).

Notice that Ï„ATTsubscriptğœATT\tau_{\text{ATT}}italic_Ï„ start_POSTSUBSCRIPT
ATT end_POSTSUBSCRIPT can be obtained not just by marginalizing
Ï„CATTâ¢(ğ‘¿i)subscriptğœCATTsubscriptğ‘¿ğ‘–\tau_{\text{CATT}}(\boldsymbol{X}_{i})italic_Ï„
start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT ) over the distribution of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT, but also by marginalizing
Ï„ATTâ¢(Wi)subscriptğœATTsubscriptğ‘Šğ‘–\tau_{\text{ATT}}(W_{i})italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_W start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT ) over the distribution of cohort assignments:

| Ï„ATT=subscriptğœATTabsent\displaystyle\tau_{\text{ATT}}=\leavevmode\nobreak\ italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT = | ğ”¼â¢[Ï„CATTâ¢(Wi,ğ‘¿i)âˆ£Wiâ‰ 0]=ğ”¼â¢[ğ”¼â¢[Ï„CATTâ¢(Wi,ğ‘¿i)âˆ£Wi]âˆ£Wiâ‰ 0]ğ”¼delimited-[]conditionalsubscriptğœCATTsubscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–0ğ”¼delimited-[]conditionalğ”¼delimited-[]conditionalsubscriptğœCATTsubscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–subscriptğ‘Šğ‘–0\displaystyle\mathbb{E}\left[\tau_{\text{CATT}}(W_{i},\boldsymbol{X}_{i})\mid W% _{i}\neq 0\right]=\mathbb{E}\left[\mathbb{E}\left[\tau_{\text{CATT}}(W_{i},% \boldsymbol{X}_{i})\mid W_{i}\right]\mid W_{i}\neq 0\right]blackboard_E [ italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT â‰ 0 ] = blackboard_E [ blackboard_E [ italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT â‰ 0 ] |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | âˆ‘râˆˆâ„›Ï€~râ‹…ğ”¼â¢[Ï„CATTâ¢(Wi,ğ‘¿i)âˆ£Wi=r]=âˆ‘râˆˆâ„›Ï€~râ¢Ï„ATTâ¢(r)subscriptğ‘Ÿâ„›â‹…subscript~ğœ‹ğ‘Ÿğ”¼delimited-[]conditionalsubscriptğœCATTsubscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘Ÿâ„›subscript~ğœ‹ğ‘ŸsubscriptğœATTğ‘Ÿ\displaystyle\sum_{r\in\mathcal{R}}\tilde{\pi}_{r}\cdot\mathbb{E}[\tau_{\text{% CATT}}(W_{i},\boldsymbol{X}_{i})\mid W_{i}=r]=\sum_{r\in\mathcal{R}}\tilde{\pi% }_{r}\tau_{\text{ATT}}(r)âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT â‹… blackboard_E [ italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] = âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r ) |   
| =\displaystyle=\leavevmode\nobreak\ = | âˆ‘râˆˆâ„›Ï€~râ¢1Tâˆ’r+1â¢âˆ‘t=rTÏ„ATTâ¢(r,t),subscriptğ‘Ÿâ„›subscript~ğœ‹ğ‘Ÿ1ğ‘‡ğ‘Ÿ1superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœATTğ‘Ÿğ‘¡\displaystyle\sum_{r\in\mathcal{R}}\tilde{\pi}_{r}\frac{1}{T-r+1}\sum_{t=r}^{T% }\tau_{\text{ATT}}(r,t),âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_T - italic_r + 1 end_ARG âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) , |   
  
which shows that estimand (4.11) is in the class defined by (4.9) and matches
estimand (3.11) from Callaway and Santâ€™Anna (2021). This formulation will
also be useful for estimation.

##  5 Fused Extended Two-Way Fixed Effects

We will carry out regression on the same design matrix
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG
proposed by Wooldridge (2021) to estimate regression (1.5) by OLS, but we will
add fusion penalties to leverage our belief that some of the parameters are
equal to each other. This design matrix contains Rğ‘…Ritalic_R columns of
cohort dummies, Tâˆ’1ğ‘‡1T-1italic_T - 1 columns of time dummies for times
{2,â€¦,T}2â€¦ğ‘‡\\{2,\ldots,T\\}{ 2 , â€¦ , italic_T },
dNsubscriptğ‘‘ğ‘d_{N}italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
covariates,
ğ”š:=âˆ‘râˆˆâ„›(Tâˆ’r+1)assignğ”šsubscriptğ‘Ÿâ„›ğ‘‡ğ‘Ÿ1\mathfrak{W}:=\sum_{r\in\mathcal{R}}(T-r+1)fraktur_W
:= âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT (
italic_T - italic_r + 1 ) treatment dummies for each possible base treatment
effect Ï„râ¢tsubscriptğœğ‘Ÿğ‘¡\tau_{rt}italic_Ï„ start_POSTSUBSCRIPT italic_r
italic_t end_POSTSUBSCRIPT, and
dNâ¢(R+Tâˆ’1+ğ”š)subscriptğ‘‘ğ‘ğ‘…ğ‘‡1ğ”šd_{N}(R+T-1+\mathfrak{W})italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( italic_R + italic_T - 1 +
fraktur_W ) interactions between covariates and the cohort dummies, time
dummies, and treatment dummies. As is typical in penalized regression, we will
center ğ’š~bold-~ğ’š\boldsymbol{\tilde{y}}overbold_~ start_ARG bold_italic_y
end_ARG and the columns of ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~
start_ARG bold_italic_Z end_ARG before estimating our regression. It is not
necessary to estimate the intercept term Î·âˆ—superscriptğœ‚\eta^{*}italic_Î·
start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT in order to estimate the
treatment effects.

###  5.1 Restrictions in the ETWFE Estimator

Let pNsubscriptğ‘ğ‘p_{N}italic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT be the number of columns of
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG;
that is,
ğ’~âˆˆâ„Nâ¢TÃ—pNbold-~ğ’superscriptâ„ğ‘ğ‘‡subscriptğ‘ğ‘\boldsymbol{\tilde{Z}}\in\mathbb{R}^{NT\times
p_{N}}overbold_~ start_ARG bold_italic_Z end_ARG âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_N italic_T Ã— italic_p start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT. We will assume
pNâ‰¤Nâ¢Tsubscriptğ‘ğ‘ğ‘ğ‘‡p_{N}\leq NTitalic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT â‰¤ italic_N italic_T (see Assumption R2 later), but as we
discussed in the introduction, it is clear that
pN=R+Tâˆ’1+ğ”š+dNâ¢(1+R+Tâˆ’1+ğ”š)subscriptğ‘ğ‘ğ‘…ğ‘‡1ğ”šsubscriptğ‘‘ğ‘1ğ‘…ğ‘‡1ğ”šp_{N}=R+T-1+\mathfrak{W}+d_{N}(1+R+T-1+\mathfrak{W})italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = italic_R + italic_T - 1 +
fraktur_W + italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( 1 +
italic_R + italic_T - 1 + fraktur_W ) may be fairly large compared to
Nâ¢Tğ‘ğ‘‡NTitalic_N italic_T, particularly if dNsubscriptğ‘‘ğ‘d_{N}italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT is not very small. This could
lead to imprecise treatment effect estimates if (1.5) is estimated by OLS.
Wooldridge (2021, Section 6.5) suggests alleviating this problem by assuming
restrictions in the modelâ€”assuming some of these parameters equal each
other. Some of the possibilities Wooldridge suggests include assuming that the
treatment-covariate interactions
ğ†râ¢tsubscriptğ†ğ‘Ÿğ‘¡\boldsymbol{\rho}_{rt}bold_italic_Ï start_POSTSUBSCRIPT
italic_r italic_t end_POSTSUBSCRIPT are fixed across time or assuming the
within-cohort treatment effects Ï„râ¢tsubscriptğœğ‘Ÿğ‘¡\tau_{rt}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT are fixed across time.
Goodman-Bacon (2021) also considers the possibility of treatment effects that
are fixed across time. Another weaker assumption Wooldridge (2021) proposes is
assuming that different treatment effects do not need to be estimated for
every individual time period since treatment starts; instead, these times
could be condensed into â€œearly treated" and â€œlate treated" effects, for
example.

These suggestions seem sensible, but making these simplifying assumptions
without strong justification risks re-introducing the bias that was removed by
adding these parameters to begin with. In settings where a practitioner
believes some of these restrictions hold but has no clear way to choose which
particular parameters may be equal, we instead propose a data-driven approach
to estimate which, if any, of these parameters may be equal.

###  5.2 Fusion Penalization in FETWFE

As described in the introduction, we will assign â„“qsubscriptâ„“ğ‘\ell_{q}roman_â„“ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT fusion (Tibshirani etÂ al., 2005) penalties to the differences between estimated parameters which may be equal, and then carry out a penalized linear regression. For example, for the treatment effects, we propose penalizing the absolute differences between treatment effects within the same cohort at adjacent times, |Ï„rk,tâˆ’Ï„rk,tâˆ’1|subscriptğœsubscriptğ‘Ÿğ‘˜ğ‘¡subscriptğœsubscriptğ‘Ÿğ‘˜ğ‘¡1|\tau_{r_{k},t}-\tau_{r_{k},t-1}|| italic_Ï„ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_t end_POSTSUBSCRIPT - italic_Ï„ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_t - 1 end_POSTSUBSCRIPT |, and we propose the same penalty structure for interaction effects, |Ïrk,t,jâˆ’Ïrk,tâˆ’1,j|subscriptğœŒsubscriptğ‘Ÿğ‘˜ğ‘¡ğ‘—subscriptğœŒsubscriptğ‘Ÿğ‘˜ğ‘¡1ğ‘—|\rho_{r_{k},t,j}-\rho_{r_{k},t-1,j}|| italic_Ï start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_t , italic_j end_POSTSUBSCRIPT - italic_Ï start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_t - 1 , italic_j end_POSTSUBSCRIPT | separately for each jâˆˆ[dN]ğ‘—delimited-[]subscriptğ‘‘ğ‘j\in[d_{N}]italic_j âˆˆ [ italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ]. This leverages our belief that some of these effects may be fixed across time while allowing the optimization problem to learn from the data which restrictions to choose.

We also propose penalizing the absolute differences between initial treatment effects for each cohort, |Ï„rk,rkâˆ’Ï„rkâˆ’1,rkâˆ’1|subscriptğœsubscriptğ‘Ÿğ‘˜subscriptğ‘Ÿğ‘˜subscriptğœsubscriptğ‘Ÿğ‘˜1subscriptğ‘Ÿğ‘˜1|\tau_{r_{k},r_{k}}-\tau_{r_{k-1},r_{k-1}}|| italic_Ï„ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT - italic_Ï„ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT |, and likewise we penalize the absolute differences between adjacent initial interaction effects |Ïrk,rk,jâˆ’Ïrkâˆ’1,rkâˆ’1,j|subscriptğœŒsubscriptğ‘Ÿğ‘˜subscriptğ‘Ÿğ‘˜ğ‘—subscriptğœŒsubscriptğ‘Ÿğ‘˜1subscriptğ‘Ÿğ‘˜1ğ‘—|\rho_{r_{k},r_{k},j}-\rho_{r_{k-1},r_{k-1},j}|| italic_Ï start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_j end_POSTSUBSCRIPT - italic_Ï start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT , italic_j end_POSTSUBSCRIPT | for each jğ‘—jitalic_j. This is motivated by the idea that perhaps time since beginning treatment could be the only dimension in which treatment effect changes. It is also natural to penalize the adjacent cohort fixed effects absolute differences |Î½rkâˆ’Î½rkâˆ’1|subscriptğœˆsubscriptğ‘Ÿğ‘˜subscriptğœˆsubscriptğ‘Ÿğ‘˜1|\nu_{r_{k}}-\nu_{r_{k-1}}|| italic_Î½ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT - italic_Î½ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT | and time fixed effects absolute differences |Î³tâˆ’Î³tâˆ’1|subscriptğ›¾ğ‘¡subscriptğ›¾ğ‘¡1|\gamma_{t}-\gamma_{t-1}|| italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_Î³ start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | towards each other, with analogous penalties for the interaction terms |Î¶rkâ¢jâˆ’Î¶rkâˆ’1,j|subscriptğœsubscriptğ‘Ÿğ‘˜ğ‘—subscriptğœsubscriptğ‘Ÿğ‘˜1ğ‘—|\zeta_{r_{k}j}-\zeta_{r_{k-1},j}|| italic_Î¶ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_Î¶ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT , italic_j end_POSTSUBSCRIPT | and |Î¾tâ¢jâˆ’Î¾tâˆ’1,j|subscriptğœ‰ğ‘¡ğ‘—subscriptğœ‰ğ‘¡1ğ‘—|\xi_{tj}-\xi_{t-1,j}|| italic_Î¾ start_POSTSUBSCRIPT italic_t italic_j end_POSTSUBSCRIPT - italic_Î¾ start_POSTSUBSCRIPT italic_t - 1 , italic_j end_POSTSUBSCRIPT |.

Finally, we may also want to regularize the coefficients directly, as is
common in regressions with large numbers of parameters to estimate relative to
the number of observations. Because of the fusion penalties we employ,
regularizing only a handful of base terms allows for this regularization. We
can also penalize all of the base covariate coefficients directly, allowing us
to screen out irrelevant covariates as dNsubscriptğ‘‘ğ‘d_{N}italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT grows.

In summary, we propose estimating a model like (1.5) but with a penalty term

| pâ¢(ğœ·;q):=assignğ‘ğœ·ğ‘absent\displaystyle p(\boldsymbol{\beta};q):=\leavevmode\nobreak\ italic_p ( bold_italic_Î² ; italic_q ) := | âˆ‘k=2R|Î½rkâˆ’Î½rkâˆ’1|q+|Î½rR|q+âˆ‘t=3T|Î³tâˆ’Î³tâˆ’1|q+|Î³T|qsuperscriptsubscriptğ‘˜2ğ‘…superscriptsubscriptğœˆsubscriptğ‘Ÿğ‘˜subscriptğœˆsubscriptğ‘Ÿğ‘˜1ğ‘superscriptsubscriptğœˆsubscriptğ‘Ÿğ‘…ğ‘superscriptsubscriptğ‘¡3ğ‘‡superscriptsubscriptğ›¾ğ‘¡subscriptğ›¾ğ‘¡1ğ‘superscriptsubscriptğ›¾ğ‘‡ğ‘\displaystyle\sum_{k=2}^{R}|\nu_{r_{k}}-\nu_{r_{k-1}}|^{q}+|\nu_{r_{R}}|^{q}+% \sum_{t=3}^{T}|\gamma_{t}-\gamma_{t-1}|^{q}+|\gamma_{T}|^{q}âˆ‘ start_POSTSUBSCRIPT italic_k = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT | italic_Î½ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT - italic_Î½ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + | italic_Î½ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + âˆ‘ start_POSTSUBSCRIPT italic_t = 3 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT | italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_Î³ start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + | italic_Î³ start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT |   
---|---|---|---  
|  | +âˆ‘j=1dN(|Îºj|q+âˆ‘k=2R|Î¶rk,jâˆ’Î¶rkâˆ’1,j|q+|Î¶rR,j|q+âˆ‘t=3T|Î¾tâ¢jâˆ’Î¾tâˆ’1,j|q+|Î¾Tâ¢j|q)superscriptsubscriptğ‘—1subscriptğ‘‘ğ‘superscriptsubscriptğœ…ğ‘—ğ‘superscriptsubscriptğ‘˜2ğ‘…superscriptsubscriptğœsubscriptğ‘Ÿğ‘˜ğ‘—subscriptğœsubscriptğ‘Ÿğ‘˜1ğ‘—ğ‘superscriptsubscriptğœsubscriptğ‘Ÿğ‘…ğ‘—ğ‘superscriptsubscriptğ‘¡3ğ‘‡superscriptsubscriptğœ‰ğ‘¡ğ‘—subscriptğœ‰ğ‘¡1ğ‘—ğ‘superscriptsubscriptğœ‰ğ‘‡ğ‘—ğ‘\displaystyle+\sum_{j=1}^{d_{N}}\left(|\kappa_{j}|^{q}+\sum_{k=2}^{R}|\zeta_{r% _{k},j}-\zeta_{r_{k-1},j}|^{q}+|\zeta_{r_{R},j}|^{q}+\sum_{t=3}^{T}|\xi_{tj}-% \xi_{t-1,j}|^{q}+|\xi_{Tj}|^{q}\right)\+ âˆ‘ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( | italic_Îº start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + âˆ‘ start_POSTSUBSCRIPT italic_k = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT | italic_Î¶ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_j end_POSTSUBSCRIPT - italic_Î¶ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT , italic_j end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + | italic_Î¶ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT , italic_j end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + âˆ‘ start_POSTSUBSCRIPT italic_t = 3 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT | italic_Î¾ start_POSTSUBSCRIPT italic_t italic_j end_POSTSUBSCRIPT - italic_Î¾ start_POSTSUBSCRIPT italic_t - 1 , italic_j end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + | italic_Î¾ start_POSTSUBSCRIPT italic_T italic_j end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ) |   
|  | +|Ï„r1,r1|q+âˆ‘k=2R(|Ï„rk,rkâˆ’Ï„rkâˆ’1,rkâˆ’1|q+âˆ‘tâ‰¥rk+1|Ï„rk,tâˆ’Ï„rk,tâˆ’1|q)superscriptsubscriptğœsubscriptğ‘Ÿ1subscriptğ‘Ÿ1ğ‘superscriptsubscriptğ‘˜2ğ‘…superscriptsubscriptğœsubscriptğ‘Ÿğ‘˜subscriptğ‘Ÿğ‘˜subscriptğœsubscriptğ‘Ÿğ‘˜1subscriptğ‘Ÿğ‘˜1ğ‘subscriptğ‘¡subscriptğ‘Ÿğ‘˜1superscriptsubscriptğœsubscriptğ‘Ÿğ‘˜ğ‘¡subscriptğœsubscriptğ‘Ÿğ‘˜ğ‘¡1ğ‘\displaystyle+|\tau_{r_{1},r_{1}}|^{q}+\sum_{k=2}^{R}\left(|\tau_{r_{k},r_{k}}% -\tau_{r_{k-1},r_{k-1}}|^{q}+\sum_{t\geq r_{k}+1}|\tau_{r_{k},t}-\tau_{r_{k},t% -1}|^{q}\right)\+ | italic_Ï„ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + âˆ‘ start_POSTSUBSCRIPT italic_k = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT ( | italic_Ï„ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT - italic_Ï„ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + âˆ‘ start_POSTSUBSCRIPT italic_t â‰¥ italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT | italic_Ï„ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_t end_POSTSUBSCRIPT - italic_Ï„ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_t - 1 end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ) |   
|  | +âˆ‘j=1dN[|Ïr1,r1,j|q+âˆ‘k=2R(|Ïrk,rk,jâˆ’Ïrkâˆ’1,rkâˆ’1,j|q+âˆ‘tâ‰¥rk+1|Ïrk,t,jâˆ’Ïrk,tâˆ’1,j|q)],superscriptsubscriptğ‘—1subscriptğ‘‘ğ‘delimited-[]superscriptsubscriptğœŒsubscriptğ‘Ÿ1subscriptğ‘Ÿ1ğ‘—ğ‘superscriptsubscriptğ‘˜2ğ‘…superscriptsubscriptğœŒsubscriptğ‘Ÿğ‘˜subscriptğ‘Ÿğ‘˜ğ‘—subscriptğœŒsubscriptğ‘Ÿğ‘˜1subscriptğ‘Ÿğ‘˜1ğ‘—ğ‘subscriptğ‘¡subscriptğ‘Ÿğ‘˜1superscriptsubscriptğœŒsubscriptğ‘Ÿğ‘˜ğ‘¡ğ‘—subscriptğœŒsubscriptğ‘Ÿğ‘˜ğ‘¡1ğ‘—ğ‘\displaystyle+\sum_{j=1}^{d_{N}}\left[|\rho_{r_{1},r_{1},j}|^{q}+\sum_{k=2}^{R% }\left(|\rho_{r_{k},r_{k},j}-\rho_{r_{k-1},r_{k-1},j}|^{q}+\sum_{t\geq r_{k}+1% }|\rho_{r_{k},t,j}-\rho_{r_{k},t-1,j}|^{q}\right)\right],\+ âˆ‘ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT [ | italic_Ï start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_j end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + âˆ‘ start_POSTSUBSCRIPT italic_k = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT ( | italic_Ï start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_j end_POSTSUBSCRIPT - italic_Ï start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT , italic_j end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + âˆ‘ start_POSTSUBSCRIPT italic_t â‰¥ italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT | italic_Ï start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_t , italic_j end_POSTSUBSCRIPT - italic_Ï start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_t - 1 , italic_j end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ) ] , |  | (5.1)  
  
where
ğœ·âˆˆâ„pNğœ·superscriptâ„subscriptğ‘ğ‘\boldsymbol{\beta}\in\mathbb{R}^{p_{N}}bold_italic_Î²
âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT end_POSTSUPERSCRIPT collects all of the coefficients. (Refer
again to Figure 1 for a graphical depiction of the penalty terms on the
estimated treatment effects Ï„râ¢tsubscriptğœğ‘Ÿğ‘¡\tau_{rt}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT.) We can more
compactly express this as

| pâ¢(ğœ·;q)=âˆ¥ğ‘«Nâ¢ğœ·âˆ¥qq,ğ‘ğœ·ğ‘superscriptsubscriptdelimited-âˆ¥âˆ¥subscriptğ‘«ğ‘ğœ·ğ‘ğ‘p(\boldsymbol{\beta};q)=\lVert\boldsymbol{D}_{N}\boldsymbol{\beta}\rVert_{q}^{% q},italic_p ( bold_italic_Î² ; italic_q ) = âˆ¥ bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î² âˆ¥ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , |  | (5.2)  
---|---|---|---  
  
where
ğ‘«Nâˆˆâ„pNÃ—pNsubscriptğ‘«ğ‘superscriptâ„subscriptğ‘ğ‘subscriptğ‘ğ‘\boldsymbol{D}_{N}\in\mathbb{R}^{p_{N}\times
p_{N}}bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆˆ
blackboard_R start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT Ã— italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
end_POSTSUPERSCRIPT is a suitably defined differences matrix which we later
define explicitly in (E.1).

######  Remark 5.1.

Our theory could easily be extended to allow a much broader class of penalties
than the one penalty we specify in (5.1). Any choice of
ğƒNsubscriptğƒğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT that has all finite entries, is invertible, and is block
diagonal with blocks of sizes not increasing in Nğ‘Nitalic_N would work for
our theoretical results. Such modifications would lead to a change only in
constant factors in our theory. For example, one could choose to only use
fusion penalties for the treatment parameters
Ï„râ¢tsubscriptğœğ‘Ÿğ‘¡\tau_{rt}italic_Ï„ start_POSTSUBSCRIPT italic_r
italic_t end_POSTSUBSCRIPT and Ïrâ¢tsubscriptğœŒğ‘Ÿğ‘¡\rho_{rt}italic_Ï
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT and directly penalize
all of the remaining parameters. For another example, if it is believed that
treatment effects are more likely to be equal in time since treatment rather
than within cohorts, one could replace our structure of treatment effect
penalties with fusion penalties across treatment effects at the same time
since treatment; see Figure 2 for a graphical depiction of such a structure.
It is important that the chosen
ğƒNsubscriptğƒğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT makes Assumption Sâ¢(sN)ğ‘†subscriptğ‘ ğ‘S(s_{N})italic_S (
italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ), which we describe
later in Section 6.1, plausible.

rğ‘Ÿritalic_rtğ‘¡titalic_t1234562345Ï„^22subscript^ğœ22\hat{\tau}_{22}over^
start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT 22
end_POSTSUBSCRIPTÏ„^23subscript^ğœ23\hat{\tau}_{23}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 23
end_POSTSUBSCRIPTÏ„^24subscript^ğœ24\hat{\tau}_{24}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 24
end_POSTSUBSCRIPTÏ„^25subscript^ğœ25\hat{\tau}_{25}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 25
end_POSTSUBSCRIPTÏ„^26subscript^ğœ26\hat{\tau}_{26}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 26
end_POSTSUBSCRIPTÏ„^33subscript^ğœ33\hat{\tau}_{33}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 33
end_POSTSUBSCRIPTÏ„^34subscript^ğœ34\hat{\tau}_{34}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 34
end_POSTSUBSCRIPTÏ„^35subscript^ğœ35\hat{\tau}_{35}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 35
end_POSTSUBSCRIPTÏ„^36subscript^ğœ36\hat{\tau}_{36}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 36
end_POSTSUBSCRIPTÏ„^44subscript^ğœ44\hat{\tau}_{44}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 44
end_POSTSUBSCRIPTÏ„^45subscript^ğœ45\hat{\tau}_{45}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 45
end_POSTSUBSCRIPTÏ„^46subscript^ğœ46\hat{\tau}_{46}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 46
end_POSTSUBSCRIPTÏ„^55subscript^ğœ55\hat{\tau}_{55}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 55
end_POSTSUBSCRIPTÏ„^56subscript^ğœ56\hat{\tau}_{56}over^ start_ARG italic_Ï„
end_ARG start_POSTSUBSCRIPT 56 end_POSTSUBSCRIPT Figure 2: Another example of
a possible valid penalty structure that mainly penalizes treatment effects
across cohorts towards each other based on time since the start of treatment,
as mentioned in Remark 5.1. Compare to Figure 1. All of our theoretical
results for FETWFE would work with such a penalty structure up to a change in
constants in the results.

It is much easier to see that these candidate restrictions are plausible due
to the time-structured nature of the parameters than it is to know exactly
which restrictions to choose. FETWFE allows practitioners to leverage this
structure to improve estimation efficiency without requiring them to choose
restrictions by hand, which could introduce bias if too many restrictions are
chosen or compromise efficiency if too few restrictions are chosen.

###  5.3 Constructing the FETWFE Optimization Problem

Finally, we take care of some details. First we account for the random effects
discussed in Section 2. As suggested by (2.1), in practice we will arrange the
rows of ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z
end_ARG to contain consecutive blocks of Tğ‘‡Titalic_T rows for each
observation and carry out a regression on
ğ’š~bold-~ğ’š\boldsymbol{\tilde{y}}overbold_~ start_ARG bold_italic_y end_ARG
and ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z
end_ARG transformed by

| ğ‘®N:=Ïƒâ¢ğ‘°NâŠ—ğ›€âˆ’1/2âˆˆâ„Nâ¢TÃ—Nâ¢T,assignsubscriptğ‘®ğ‘tensor-productğœsubscriptğ‘°ğ‘superscriptğ›€12superscriptâ„ğ‘ğ‘‡ğ‘ğ‘‡\boldsymbol{G}_{N}:=\sigma\boldsymbol{I}_{N}\otimes\boldsymbol{\Omega}^{-1/2}% \in\mathbb{R}^{NT\times NT},bold_italic_G start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT := italic_Ïƒ bold_italic_I start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âŠ— bold_Î© start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_N italic_T Ã— italic_N italic_T end_POSTSUPERSCRIPT , |  | (5.3)  
---|---|---|---  
  
where âŠ—tensor-product\otimesâŠ— denotes the Kronecker product (recall that
ğ›€ğ›€\boldsymbol{\Omega}bold_Î© was defined in Section 2). We will also
center both the response
ğ‘®Nâ¢ğ’š~subscriptğ‘®ğ‘bold-~ğ’š\boldsymbol{G}_{N}\boldsymbol{\tilde{y}}bold_italic_G
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT overbold_~ start_ARG
bold_italic_y end_ARG and each column of the covariates
ğ‘®Nâ¢ğ’~subscriptğ‘®ğ‘bold-~ğ’\boldsymbol{G}_{N}\boldsymbol{\tilde{Z}}bold_italic_G
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT overbold_~ start_ARG
bold_italic_Z end_ARG, as is common in penalized regression. Denote these
centered objects by ğ’šğ’š\boldsymbol{y}bold_italic_y and
ğ’ğ’\boldsymbol{Z}bold_italic_Z. Then our optimization problem is

| ğœ·^N(q)â¢(Î»N):=argâ¡minğœ·âˆˆâ„pNâ¢{âˆ¥ğ’šâˆ’ğ’â¢ğœ·âˆ¥22+Î»Nâ¢âˆ¥ğ‘«Nâ¢ğœ·âˆ¥qq},assignsuperscriptsubscriptbold-^ğœ·ğ‘ğ‘subscriptğœ†ğ‘ğœ·superscriptâ„subscriptğ‘ğ‘superscriptsubscriptdelimited-âˆ¥âˆ¥ğ’šğ’ğœ·22subscriptğœ†ğ‘superscriptsubscriptdelimited-âˆ¥âˆ¥subscriptğ‘«ğ‘ğœ·ğ‘ğ‘\boldsymbol{\hat{\beta}}_{N}^{(q)}(\lambda_{N}):=\underset{\boldsymbol{\beta}% \in\mathbb{R}^{p_{N}}}{\arg\min}\left\\{\lVert\boldsymbol{y}-\boldsymbol{Z}% \boldsymbol{\beta}\rVert_{2}^{2}+\lambda_{N}\lVert\boldsymbol{D}_{N}% \boldsymbol{\beta}\rVert_{q}^{q}\right\\},overbold_^ start_ARG bold_italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT ( italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) := start_UNDERACCENT bold_italic_Î² âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_UNDERACCENT start_ARG roman_arg roman_min end_ARG { âˆ¥ bold_italic_y - bold_italic_Z bold_italic_Î² âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î² âˆ¥ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT } , |  | (5.4)  
---|---|---|---  
  
where Î»Nsubscriptğœ†ğ‘\lambda_{N}italic_Î» start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT is a tuning parameter. For brevity, we will hereafter write
ğœ·^N(q)â¢(Î»N)=ğœ·^(q)superscriptsubscriptbold-^ğœ·ğ‘ğ‘subscriptğœ†ğ‘superscriptbold-^ğœ·ğ‘\boldsymbol{\hat{\beta}}_{N}^{(q)}(\lambda_{N})=\boldsymbol{\hat{\beta}}^{(q)}overbold_^
start_ARG bold_italic_Î² end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT (
italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) = overbold_^
start_ARG bold_italic_Î² end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT.

######  Remark 5.2.

Optimization problem (5.4) is convex if and only if qâ‰¥1ğ‘1q\geq 1italic_q
â‰¥ 1, but we will be interested in solving this problem with
qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 ) as well. In this case, finding
the global optimum can in principle be difficult, but many heuristics exist to
solve this optimization problem that seem to work well in practice; see, for
example Huang etÂ al. (2008, Section 4.1) and Breheny and Huang (2015). In
Sections 7 and 8 we implement FETWFE by solving (5.4) with the grpreg R
package (Breheny and Huang, 2009). Our simulation results seem to align with
our theory, including the asymptotic normality of our estimators, suggesting
that these heuristics seem to work well for FETWFE.

###  5.4 Causal Estimators

As shown in Theorem A.5(a), under (CNAS), (LINS), and (CCTS)

| Ï„CATTâ¢(r,t,ğ’™)=Ï„râ¢tâˆ—+(ğ’™âˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r])âŠ¤â¢ğ†râ¢tâˆ—subscriptğœCATTğ‘Ÿğ‘¡ğ’™superscriptsubscriptğœğ‘Ÿğ‘¡superscriptğ’™ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡\tau_{\text{CATT}}(r,t,\boldsymbol{x})=\tau_{rt}^{*}+(\boldsymbol{x}-\mathbb{E% }\left[\boldsymbol{X}_{i}\mid W_{i}=r\right])^{\top}\boldsymbol{\rho}_{rt}^{*}italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) = italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + ( bold_italic_x - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
---|---|---  
  
for any fixed ğ’™ğ’™\boldsymbol{x}bold_italic_x. Since under these assumptions
(and other regularity conditions) FETWFE consistently estimates
Ï„râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡\tau_{rt}^{*}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT and
ğ†râ¢tâˆ—superscriptsubscriptğ†ğ‘Ÿğ‘¡\boldsymbol{\rho}_{rt}^{*}bold_italic_Ï
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT, we can estimate this quantity by

| Ï„^CATTâ¢(r,t,ğ’™):=Ï„^râ¢t(q)+(ğ’™âˆ’ğ‘¿Â¯r)âŠ¤â¢Ï^râ¢t(q),râˆˆâ„›,tâ‰¥r,formulae-sequenceassignsubscript^ğœCATTğ‘Ÿğ‘¡ğ’™superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘superscriptğ’™subscriptbold-Â¯ğ‘¿ğ‘Ÿtopsuperscriptsubscript^ğœŒğ‘Ÿğ‘¡ğ‘formulae-sequenceğ‘Ÿâ„›ğ‘¡ğ‘Ÿ\hat{\tau}_{\text{CATT}}(r,t,\boldsymbol{x}):=\hat{\tau}_{rt}^{(q)}+\left(% \boldsymbol{x}-\boldsymbol{\overline{X}}_{r}\right)^{\top}\hat{\rho}_{rt}^{(q)% },\qquad r\in\mathcal{R},t\geq r,over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) := over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT + ( bold_italic_x - overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT , italic_r âˆˆ caligraphic_R , italic_t â‰¥ italic_r , |  | (5.5)  
---|---|---|---  
  
where Ï„^râ¢t(q)superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘\hat{\tau}_{rt}^{(q)}over^
start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT and
Ï^râ¢t(q)superscriptsubscript^ğœŒğ‘Ÿğ‘¡ğ‘\hat{\rho}_{rt}^{(q)}over^ start_ARG
italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT are the estimators of
Ï„râ¢tsubscriptğœğ‘Ÿğ‘¡\tau_{rt}italic_Ï„ start_POSTSUBSCRIPT italic_r
italic_t end_POSTSUBSCRIPT and Ïrâ¢tsubscriptğœŒğ‘Ÿğ‘¡\rho_{rt}italic_Ï
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT from
ğœ·^(q)superscriptbold-^ğœ·ğ‘\boldsymbol{\hat{\beta}}^{(q)}overbold_^
start_ARG bold_italic_Î² end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT as defined in (5.4) and

| ğ‘¿Â¯r=1Nrâ¢âˆ‘{i:Wi=r}ğ‘¿isubscriptbold-Â¯ğ‘¿ğ‘Ÿ1subscriptğ‘ğ‘Ÿsubscriptconditional-setğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–\boldsymbol{\overline{X}}_{r}=\frac{1}{N_{r}}\sum_{\\{i:W_{i}=r\\}}\boldsymbol{X% }_{i}overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG âˆ‘ start_POSTSUBSCRIPT { italic_i : italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } end_POSTSUBSCRIPT bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT |   
---|---|---  
  
is the sample mean of the covariates for units observed in cohort
rğ‘Ÿritalic_r, with
Nr:=âˆ‘i=1NğŸ™â¢{Wi=r}assignsubscriptğ‘ğ‘Ÿsuperscriptsubscriptğ‘–1ğ‘1subscriptğ‘Šğ‘–ğ‘ŸN_{r}:=\sum_{i=1}^{N}\mathbbm{1}\\{W_{i}=r\\}italic_N
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT := âˆ‘ start_POSTSUBSCRIPT
italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N
end_POSTSUPERSCRIPT blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT = italic_r } the total number of units in cohort
rğ‘Ÿritalic_r. The forms of (4.1) and (4.5) then naturally suggest the
estimators

| âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tÏ„^CATT(r,t,ğ’™))\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\hat{\tau}_{\text{CATT}}(r,t,% \boldsymbol{x}))âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) |  | (5.6)  
---|---|---|---  
  
and

| âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï€^râ¢(ğ’™)âˆ‘râ€²âˆˆâ„›Ï€^râ€²â¢(ğ’™))â¢Ï„^CATTâ¢(r,t,ğ’™),subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœ‹ğ‘Ÿğ’™subscriptsuperscriptğ‘Ÿâ€²â„›subscript^ğœ‹superscriptğ‘Ÿâ€²ğ’™subscript^ğœCATTğ‘Ÿğ‘¡ğ’™\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\frac{\hat{\pi}_{r}(% \boldsymbol{x})}{\sum_{r^{\prime}\in\mathcal{R}}\hat{\pi}_{r^{\prime}}(% \boldsymbol{x})}\right)\hat{\tau}_{\text{CATT}}(r,t,\boldsymbol{x}),âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG ) over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) , |  | (5.7)  
---|---|---|---  
  
where Ï€^râ¢(ğ’™)subscript^ğœ‹ğ‘Ÿğ’™\hat{\pi}_{r}(\boldsymbol{x})over^
start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT (
bold_italic_x ) is an estimator of the propensity scores
Ï€râ¢(ğ’™)subscriptğœ‹ğ‘Ÿğ’™\pi_{r}(\boldsymbol{x})italic_Ï€
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ). We will
discuss what properties this estimator
Ï€^râ¢(ğ’™)subscript^ğœ‹ğ‘Ÿğ’™\hat{\pi}_{r}(\boldsymbol{x})over^ start_ARG
italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT (
bold_italic_x ) should have in more detail in Section 6.1.

Finally we discuss estimating the average treatment effects marginalized over
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT. As we showed in Theorem A.5(a) and (b), because
the treatment effects are interacted with the covariates centered with respect
to their cohort means, under either (CCTS) or (CTS) and (CIUN) we can estimate
the average treatment effects using

| Ï„^ATTâ¢(r,t):=Ï„^râ¢t(q)assignsubscript^ğœATTğ‘Ÿğ‘¡superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘\hat{\tau}_{\text{ATT}}(r,t):=\hat{\tau}_{rt}^{(q)}over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) := over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT |  | (5.8)  
---|---|---|---  
  
as proposed by Wooldridge (2021, Sections 5.3 and 6.3). In particular, we
propose the estimators

| âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢Ï„^ATTâ¢(r,t)subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœATTğ‘Ÿğ‘¡\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\hat{\tau}_{\text{ATT}}(r,t)âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) |  | (5.9)  
---|---|---|---  
  
and

| âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢NrNÏ„â¢Ï„^ATTâ¢(r,t)subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘ğ‘Ÿsubscriptğ‘ğœsubscript^ğœATTğ‘Ÿğ‘¡\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\frac{N_{r}}{N_{\tau}}\hat{\tau}_% {\text{ATT}}(r,t)âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT divide start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_Ï„ end_POSTSUBSCRIPT end_ARG over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) |  | (5.10)  
---|---|---|---  
  
for estimands (4.8) and (4.9), respectively. Notice that estimator (5.10)
avoids requiring the specification of an estimator
ğ…^â¢(ğ’™)bold-^ğ…ğ’™\boldsymbol{\hat{\pi}}(\boldsymbol{x})overbold_^
start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) of the generalized
propensity scores by instead using the observed cohort counts to estimate the
marginal cohort assignment probabilities, as we alluded to at the end of
Section 4.2.1.

##  6 Theoretical Results and Discussion

Before we present theoretical guarantees for FETWFE, we will state a sparsity
assumption that we will require along with some additional regularity
conditions. We will require fewer assumptions to prove consistency alone than
we will to prove restriction selection consistency and asymptotic normality.
We emphasize that the conceptually most important assumptions are (CCTSB),
(CCTSA), and (CTSA), which validate the difference-in-differences approach;
(LINS), which justifies a model that is linear in the covariates
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT; and Assumption S(sNsubscriptğ‘ ğ‘s_{N}italic_s
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT), defined below, which assumes
sparsity in a sense that matches our penalty (5.2). (See Remark 5.1 for some
comments on how this can be made more flexible.)

###  6.1 Consistency

Assumption S(sNsubscriptğ‘ ğ‘s_{N}italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT): Assume the vector ğ‘«Nâ¢ğœ·Nâˆ—subscriptğ‘«ğ‘superscriptsubscriptğœ·ğ‘\boldsymbol{D}_{N}\boldsymbol{\beta}_{N}^{*}bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT (where the differences matrix ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT associated with our penalty (5.2) is defined in Equation E.1) is sparse, with indices ğ’®âŠ†[pN]ğ’®delimited-[]subscriptğ‘ğ‘\mathcal{S}\subseteq[p_{N}]caligraphic_S âŠ† [ italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] nonzero and the remaining indices in [pN]âˆ–ğ’®delimited-[]subscriptğ‘ğ‘ğ’®[p_{N}]\setminus\mathcal{S}[ italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] âˆ– caligraphic_S equal to 0, where |ğ’®|=sNğ’®subscriptğ‘ ğ‘|\mathcal{S}|=s_{N}| caligraphic_S | = italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT.

Assumption S(sNsubscriptğ‘ ğ‘s_{N}italic_s start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT) allows us to have sparsity in the appropriate sense: the
differences between parameters that we penalized in (5.2) are sparse, and
irrelevant covariates have true coefficient equal to 0. That is, all but
sNsubscriptğ‘ ğ‘s_{N}italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
of the restrictions that we expect to hold will in fact hold. Crucially,
Assumption S(sNsubscriptğ‘ ğ‘s_{N}italic_s start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT) does not require us to know which restrictions to select,
or even how many restrictions to selectâ€”the value of sNsubscriptğ‘
ğ‘s_{N}italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT does not need
to be known. Our consistency and selection consistency theorems will allow
sNsubscriptğ‘ ğ‘s_{N}italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
to grow with Nğ‘Nitalic_N subject to certain constraints in later assumptions.

The remaining regularity conditions for Theorem 6.1 are more routine. Before
we describe them in detail, we briefly characterize them informally.

  * â€¢

Assumption (R1) requires the tails of the covariates to not be too heavy, but
accommodates a wide variety of covariate distributions.

  * â€¢

Assumption (R2) requires the eigenvalues of the empirical Gram matrix to be
reasonably well-behaved. In particular, it requires
ğ’ğ’\boldsymbol{Z}bold_italic_Z to have full column rank, so
pNâ‰¤Nâ¢Tsubscriptğ‘ğ‘ğ‘ğ‘‡p_{N}\leq NTitalic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT â‰¤ italic_N italic_T. Otherwise this is a mild assumption
as long as (1) none of the covariates are very highly correlated and (2) none
of the cohort propensity scores tend too closely to 0. For example, an overlap
assumption that
Ï€râ¢(ğ’™)â‰¥Ï€lowsubscriptğœ‹ğ‘Ÿğ’™subscriptğœ‹low\pi_{r}(\boldsymbol{x})\geq\pi_{\text{low}}italic_Ï€
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) â‰¥ italic_Ï€
start_POSTSUBSCRIPT low end_POSTSUBSCRIPT for some
Ï€low>0subscriptğœ‹low0\pi_{\text{low}}>0italic_Ï€ start_POSTSUBSCRIPT low
end_POSTSUBSCRIPT > 0 for all Nâˆˆâ„•ğ‘â„•N\in\mathbb{N}italic_N âˆˆ
blackboard_N, râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 }
âˆª caligraphic_R, and ğ’™ğ’™\boldsymbol{x}bold_italic_x in the support of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT would help the plausibility of this assumption.

  * â€¢

In Assumption (R2), the assumptions on the penalty parameter
Î»Nsubscriptğœ†ğ‘\lambda_{N}italic_Î» start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT are not of practical importance because in practice
Î»Nsubscriptğœ†ğ‘\lambda_{N}italic_Î» start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT can be selected from a set of candidate values by a
criterion like BIC. (We show in simulation studies in Section 7 that the
theoretical guarantees from this section seem to hold in practice when
Î»Nsubscriptğœ†ğ‘\lambda_{N}italic_Î» start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT is selected in this way.)

  * â€¢

Assumption (R3) is essentially a technical assumption. It does suggest that
FETWFE may not work well if
ğ‘«Nâ¢ğœ·Nâˆ—subscriptğ‘«ğ‘superscriptsubscriptğœ·ğ‘\boldsymbol{D}_{N}\boldsymbol{\beta}_{N}^{*}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î²
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT has many very small entries, or a small number of very
large entries.

In particular, these assumptions allow the number of covariates
dNsubscriptğ‘‘ğ‘d_{N}italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
and the number of relevant coefficients sNsubscriptğ‘ ğ‘s_{N}italic_s
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT to grow to infinity with
Nğ‘Nitalic_N and allow for unbounded distributions of the covariates.

We now state and describe the assumptions.

Assumption (R1): For each iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [
italic_N ],
ğ”¼â¢[Xiâ¢j4]<âˆğ”¼delimited-[]superscriptsubscriptğ‘‹ğ‘–ğ‘—4\mathbb{E}[X_{ij}^{4}]<\inftyblackboard_E
[ italic_X start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ] < âˆ for all
jâˆˆ[dN]ğ‘—delimited-[]subscriptğ‘‘ğ‘j\in[d_{N}]italic_j âˆˆ [ italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] and
ğ”¼â¢[u(iâ¢t)4]<âˆğ”¼delimited-[]superscriptsubscriptğ‘¢ğ‘–ğ‘¡4\mathbb{E}[u_{(it)}^{4}]<\inftyblackboard_E
[ italic_u start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ] < âˆ for all
tâˆˆ[T]ğ‘¡delimited-[]ğ‘‡t\in[T]italic_t âˆˆ [ italic_T ]. Further,
ğ”¼â¢[ğ‘¿iâ¢ğ‘¿iâŠ¤âˆ£Wi=r]ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–superscriptsubscriptğ‘¿ğ‘–topsubscriptğ‘Šğ‘–ğ‘Ÿ\mathbb{E}[\boldsymbol{X}_{i}\boldsymbol{X}_{i}^{\top}\mid
W_{i}=r]blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT = italic_r ]. Finally, for some
K<âˆğ¾K<\inftyitalic_K < âˆ,

| sup1â‰¤Nâ‰¤âˆ{1pNâ¢âˆ‘t=1Tâˆ‘j=1pNğ”¼â¢[(ğ’â¢ğ‘«Nâˆ’1)(1â¢t)â¢j2]}â‰¤K.subscriptsupremum1ğ‘1subscriptğ‘ğ‘superscriptsubscriptğ‘¡1ğ‘‡superscriptsubscriptğ‘—1subscriptğ‘ğ‘ğ”¼delimited-[]superscriptsubscriptğ’superscriptsubscriptğ‘«ğ‘11ğ‘¡ğ‘—2ğ¾\sup_{1\leq N\leq\infty}\left\\{\frac{1}{p_{N}}\sum_{t=1}^{T}\sum_{j=1}^{p_{N}}% \mathbb{E}\left[(\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(1t)j}^{2}\right]% \right\\}\leq K.roman_sup start_POSTSUBSCRIPT 1 â‰¤ italic_N â‰¤ âˆ end_POSTSUBSCRIPT { divide start_ARG 1 end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG âˆ‘ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT blackboard_E [ ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( 1 italic_t ) italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] } â‰¤ italic_K . |   
---|---|---  
  
We show later (Lemma E.1) that
ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT is invertible. The matrix
ğ’â¢ğ‘«Nâˆ’1ğ’superscriptsubscriptğ‘«ğ‘1\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}bold_italic_Z
bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT is of interest because it turns
out this is the design matrix we will actually use for estimation; see the
proof of Theorem C.1 for details. Because the singular values of
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT are bounded away from 0 and from above for all
Nğ‘Nitalic_N even if dNâ†’âˆâ†’subscriptğ‘‘ğ‘d_{N}\to\inftyitalic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT â†’ âˆ (see Lemma F.1), this is
qualitatively similar to making the same statement about
ğ’ğ’\boldsymbol{Z}bold_italic_Z itself. We discuss a closely related point in
more detail below.

Before we state Assumption (R2), we will define some needed notation. For any
matrix
ğ‘¨âˆˆâ„NÃ—pNğ‘¨superscriptâ„ğ‘subscriptğ‘ğ‘\boldsymbol{A}\in\mathbb{R}^{N\times
p_{N}}bold_italic_A âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_N Ã—
italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT,
denote the empirical Gram matrix by
ğšº^â¢(ğ‘¨)bold-^ğšºğ‘¨\boldsymbol{\hat{\Sigma}}(\boldsymbol{A})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_A ):

| ğšº^â¢(ğ‘¨):=1Nâ¢ğ‘¨âŠ¤â¢ğ‘¨âˆˆâ„pNÃ—pN.assignbold-^ğšºğ‘¨1ğ‘superscriptğ‘¨topğ‘¨superscriptâ„subscriptğ‘ğ‘subscriptğ‘ğ‘\boldsymbol{\hat{\Sigma}}(\boldsymbol{A}):=\frac{1}{N}\boldsymbol{A}^{\top}% \boldsymbol{A}\in\mathbb{R}^{p_{N}\times p_{N}}.overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_A ) := divide start_ARG 1 end_ARG start_ARG italic_N end_ARG bold_italic_A start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_A âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT Ã— italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT . |  | (6.1)  
---|---|---|---  
  
Notice that if ğ‘¨ğ‘¨\boldsymbol{A}bold_italic_A has centered columns then
ğšº^â¢(ğ‘¨)bold-^ğšºğ‘¨\boldsymbol{\hat{\Sigma}}(\boldsymbol{A})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_A ) is the estimated covariance
matrix. Let e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT and e2â¢Nsubscriptğ‘’2ğ‘e_{2N}italic_e start_POSTSUBSCRIPT 2
italic_N end_POSTSUBSCRIPT be the smallest and largest eigenvalues of
ğšº^â¢(ğ’)bold-^ğšºğ’\boldsymbol{\hat{\Sigma}}(\boldsymbol{Z})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_Z ).(Since
ğšº^â¢(ğ’)bold-^ğšºğ’\boldsymbol{\hat{\Sigma}}(\boldsymbol{Z})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_Z ) is random,
e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT and e2â¢Nsubscriptğ‘’2ğ‘e_{2N}italic_e start_POSTSUBSCRIPT 2
italic_N end_POSTSUBSCRIPT are as well.)

Assumption (R2): Assume e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e start_POSTSUBSCRIPT
1 italic_N end_POSTSUBSCRIPT is almost surely upper-bounded by a constant for
all Nğ‘Nitalic_N and hNâ€²â†’a.s.0h_{N}^{\prime}\xrightarrow{a.s.}0italic_h
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€²
end_POSTSUPERSCRIPT start_ARROW start_OVERACCENT italic_a . italic_s .
end_OVERACCENT â†’ end_ARROW 0, where

| hNâ€²:=pN+Î»Nâ¢sNNâ¢e1â¢Nassignsuperscriptsubscriptâ„ğ‘â€²subscriptğ‘ğ‘subscriptğœ†ğ‘subscriptğ‘ ğ‘ğ‘subscriptğ‘’1ğ‘h_{N}^{\prime}:=\sqrt{\frac{p_{N}+\lambda_{N}s_{N}}{Ne_{1N}}}italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT := square-root start_ARG divide start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT + italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_N italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT end_ARG end_ARG |  | (6.2)  
---|---|---|---  
  
and â†’a.s.\xrightarrow{a.s.}start_ARROW start_OVERACCENT italic_a . italic_s
. end_OVERACCENT â†’ end_ARROW denotes almost sure convergence. Also, assume
limNâ†’âˆÎ»Nâ¢sNN=0subscriptâ†’ğ‘subscriptğœ†ğ‘subscriptğ‘
ğ‘ğ‘0\lim_{N\to\infty}\lambda_{N}\sqrt{\frac{s_{N}}{N}}=0roman_lim
start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT italic_Î»
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT square-root start_ARG divide
start_ARG italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG
start_ARG italic_N end_ARG end_ARG = 0.

Kock (2013) points out that (6.2) requires the design matrix to be full rank,
so this assumption requires that pNsubscriptğ‘ğ‘p_{N}italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT grows slower than Nğ‘Nitalic_N,
Î»Nsubscriptğœ†ğ‘\lambda_{N}italic_Î» start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT does not grow too quickly, and
e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT does not vanish too quickly. (In practice, in finite samples
Î»Nsubscriptğœ†ğ‘\lambda_{N}italic_Î» start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT can be selected by cross-validation or a criterion like BIC,
similarly to the lasso.) Under the qualitative assumption that the eigenvalues
of ğšº^â¢(ğ’)bold-^ğšºğ’\boldsymbol{\hat{\Sigma}}(\boldsymbol{Z})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_Z ) and
ğšº^â¢(ğ‘®Nâ¢ğ’~)bold-^ğšºsubscriptğ‘®ğ‘bold-~ğ’\boldsymbol{\hat{\Sigma}}(\boldsymbol{G}_{N}\boldsymbol{\tilde{Z}})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_G start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT overbold_~ start_ARG bold_italic_Z end_ARG ) are
â€œclose,"444This can be made formal by noting that centering the columns of
ğ‘®Nâ¢ğ’~subscriptğ‘®ğ‘bold-~ğ’\boldsymbol{G}_{N}\boldsymbol{\tilde{Z}}bold_italic_G
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT overbold_~ start_ARG
bold_italic_Z end_ARG can be characterized as multiplication on the left by a
centering matrix ğ‘ªğ‘ª\boldsymbol{C}bold_italic_C, then bounding the singular
values of ğ‘ªğ‘ª\boldsymbol{C}bold_italic_C. See, for example, Section 8.1 of
Ding (2024) for further details. (R2) roughly requires that
ğ‘®Nâ¢ğ’~subscriptğ‘®ğ‘bold-~ğ’\boldsymbol{G}_{N}\boldsymbol{\tilde{Z}}bold_italic_G
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT overbold_~ start_ARG
bold_italic_Z end_ARG is full rank, and we can provide sufficient conditions
for this to hold. First, the singular values of
ğ‘®Nsubscriptğ‘®ğ‘\boldsymbol{G}_{N}bold_italic_G start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT are bounded from above and below by positive constants for
all Nğ‘Nitalic_N (see Lemma I.1 in the appendix), so
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG
being full rank is enough for
ğ‘®Nâ¢ğ’~subscriptğ‘®ğ‘bold-~ğ’\boldsymbol{G}_{N}\boldsymbol{\tilde{Z}}bold_italic_G
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT overbold_~ start_ARG
bold_italic_Z end_ARG to be full rank. For
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG to
be full rank, we require at least dN+1subscriptğ‘‘ğ‘1d_{N}+1italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT + 1 observed units in each
cohort (see Lemma I.2 in the appendix), all of the marginal cohort
probabilities must be large enough relative to the growth rate of
dNsubscriptğ‘‘ğ‘d_{N}italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
as Nâ†’âˆâ†’ğ‘N\to\inftyitalic_N â†’ âˆ, and the distribution of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT must be well-behaved as
Nâ†’âˆâ†’ğ‘N\to\inftyitalic_N â†’ âˆ.

Assumption (R3): There exist constants 0<b0<b1<âˆ0subscriptğ‘0subscriptğ‘10<b_{0}<b_{1}<\infty0 < italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT < italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT < âˆ such that b0â‰¤minjâˆˆğ’®â¡{|(ğ‘«Nâ¢ğœ·Nâˆ—)j|}â‰¤maxjâˆˆğ’®â¡{|(ğ‘«Nâ¢ğœ·Nâˆ—)j|}â‰¤b1subscriptğ‘0subscriptğ‘—ğ’®subscriptsubscriptğ‘«ğ‘superscriptsubscriptğœ·ğ‘ğ‘—subscriptğ‘—ğ’®subscriptsubscriptğ‘«ğ‘superscriptsubscriptğœ·ğ‘ğ‘—subscriptğ‘1b_{0}\leq\min_{j\in\mathcal{S}}\left\\{\left|(\boldsymbol{D}_{N}\boldsymbol{% \beta}_{N}^{*})_{j}\right|\right\\}\leq\max_{j\in\mathcal{S}}\left\\{\left|(% \boldsymbol{D}_{N}\boldsymbol{\beta}_{N}^{*})_{j}\right|\right\\}\leq b_{1}italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT â‰¤ roman_min start_POSTSUBSCRIPT italic_j âˆˆ caligraphic_S end_POSTSUBSCRIPT { | ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | } â‰¤ roman_max start_POSTSUBSCRIPT italic_j âˆˆ caligraphic_S end_POSTSUBSCRIPT { | ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | } â‰¤ italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT.

The lower bound in Assumption (R3) is essentially a signal strength
assumption.

Note that we allow sNâ†’âˆâ†’subscriptğ‘ ğ‘s_{N}\to\inftyitalic_s
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT â†’ âˆ and
pNâ†’âˆâ†’subscriptğ‘ğ‘p_{N}\to\inftyitalic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT â†’ âˆ as long as the above assumptions are satisfied.

We are now prepared to state our consistency theorem.

######  Theorem 6.1 (Consistency of FETWFE).

Assume that Assumptions (CNAS), (CCTSB), and (LINS) hold, as well as
Assumptions (F1), (F2), S(sNsubscriptğ‘ ğ‘s_{N}italic_s start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT), and (R1) - (R3). Let q>0ğ‘0q>0italic_q > 0.

  1. (a)

Suppose that either Assumptions (CTSA) and (CIUN) hold or Assumption (CCTSA)
holds. Then for any set of finite constants
{Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ start_POSTSUBSCRIPT
italic_r italic_t end_POSTSUBSCRIPT },

| |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï„^ATTâ¢(r,t)âˆ’Ï„ATTâ¢(r,t))|=ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœATTğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\hat{\tau}_{\text{ATT% }}(r,t)-\tau_{\text{ATT}}(r,t)\right)\right|=\mathcal{O}_{\mathbb{P}}\left(% \min\\{h_{N},h_{N}^{\prime}\\}\right)| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) | = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) |   
---|---|---  
  
and

| |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(NrNÏ„â¢Ï„^ATTâ¢(r,t)âˆ’Ï€~râ¢Ï„ATTâ¢(r,t))|=ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}),subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘ğ‘Ÿsubscriptğ‘ğœsubscript^ğœATTğ‘Ÿğ‘¡subscript~ğœ‹ğ‘ŸsubscriptğœATTğ‘Ÿğ‘¡subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\frac{N_{r}}{N_{\tau}% }\hat{\tau}_{\text{ATT}}(r,t)-\tilde{\pi}_{r}\tau_{\text{ATT}}(r,t)\right)% \right|=\mathcal{O}_{\mathbb{P}}\left(\min\\{h_{N},h_{N}^{\prime}\\}\right),| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( divide start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_Ï„ end_POSTSUBSCRIPT end_ARG over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) | = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) , |   
---|---|---  
  
where

| hN:=1e1â¢Nâ¢pNNassignsubscriptâ„ğ‘1subscriptğ‘’1ğ‘subscriptğ‘ğ‘ğ‘h_{N}:=\frac{1}{e_{1N}}\sqrt{\frac{p_{N}}{N}}italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT := divide start_ARG 1 end_ARG start_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT end_ARG square-root start_ARG divide start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG end_ARG |  | (6.3)  
---|---|---|---  
  
and hNâ€²superscriptsubscriptâ„ğ‘â€²h_{N}^{\prime}italic_h start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT is as
defined in (6.2).

  2. (b)

Suppose Assumption (CCTSA) holds and dN=dsubscriptğ‘‘ğ‘ğ‘‘d_{N}=ditalic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = italic_d is fixed. For all
Nğ‘Nitalic_N and all râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r
âˆˆ { 0 } âˆª caligraphic_R, assume all of the eigenvalues of
Covâ¢(ğ‘¿iâˆ£Wi=r)Covconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\mathrm{Cov}(\boldsymbol{X}_{i}\mid
W_{i}=r)roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
= italic_r ) are bounded between
Î»min>0subscriptğœ†min0\lambda_{\text{min}}>0italic_Î» start_POSTSUBSCRIPT min
end_POSTSUBSCRIPT > 0 and
Î»max<âˆsubscriptğœ†max\lambda_{\text{max}}<\inftyitalic_Î»
start_POSTSUBSCRIPT max end_POSTSUBSCRIPT < âˆ. Then for any set of finite
constants {Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT } and any fixed
ğ’™ğ’™\boldsymbol{x}bold_italic_x in the support of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT,

| |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï„^CATTâ¢(r,t,ğ’™)âˆ’Ï„CATTâ¢(r,t,ğ’™))|=ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}).subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœCATTğ‘Ÿğ‘¡ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\displaystyle\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\hat{% \tau}_{\text{CATT}}(r,t,\boldsymbol{x})-\tau_{\text{CATT}}(r,t,\boldsymbol{x})% \right)\right|=\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\}).| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) - italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) | = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) . |   
---|---|---  
  
Further, if Ï€^râ¢(ğ’™)subscript^ğœ‹ğ‘Ÿğ’™\hat{\pi}_{r}(\boldsymbol{x})over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) is an estimator of Ï€râ¢(ğ’™)subscriptğœ‹ğ‘Ÿğ’™\pi_{r}(\boldsymbol{x})italic_Ï€ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) that satisfies |Ï€^râ¢(ğ’™)âˆ’Ï€râ¢(ğ’™)|=ğ’ªâ„™â¢(aN)subscript^ğœ‹ğ‘Ÿğ’™subscriptğœ‹ğ‘Ÿğ’™subscriptğ’ªâ„™subscriptğ‘ğ‘|\hat{\pi}_{r}(\boldsymbol{x})-\pi_{r}(\boldsymbol{x})|=\mathcal{O}_{\mathbb{P% }}(a_{N})| over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) - italic_Ï€ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) | = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) for a decreasing sequence aNsubscriptğ‘ğ‘a_{N}italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT for each râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 } âˆª caligraphic_R and all ğ’™ğ’™\boldsymbol{x}bold_italic_x in the support of ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT, then 

|  | |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï€^râ¢(ğ’™)âˆ‘râ€²âˆˆâ„›Ï€^râ€²â¢(ğ’™)â¢Ï„^CATTâ¢(r,t,ğ’™)âˆ’Ï€~râ¢(ğ’™)â¢Ï„CATTâ¢(r,t,ğ’™))|subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœ‹ğ‘Ÿğ’™subscriptsuperscriptğ‘Ÿâ€²â„›subscript^ğœ‹superscriptğ‘Ÿâ€²ğ’™subscript^ğœCATTğ‘Ÿğ‘¡ğ’™subscript~ğœ‹ğ‘Ÿğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\frac{% \hat{\pi}_{r}(\boldsymbol{x})}{\sum_{r^{\prime}\in\mathcal{R}}\hat{\pi}_{r^{% \prime}}(\boldsymbol{x})}\hat{\tau}_{\text{CATT}}(r,t,\boldsymbol{x})-\tilde{% \pi}_{r}(\boldsymbol{x})\tau_{\text{CATT}}(r,t,\boldsymbol{x})\right)\right|| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) - over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) | |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}âˆ¨aN).subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²subscriptğ‘ğ‘\displaystyle\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\}\vee a_{N}).caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } âˆ¨ italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) . |   
  

###### Proof.

Provided in Section E of the appendix. âˆ

Theorem 6.1 shows that all of our causal estimators are consistent and
characterizes their rates of consistency. In particular, it also shows that
the classes of marginal parallel trends estimators (5.9) and (5.10) are
consistent under either (CCTSA) or (CIUN) and (CTSA) for the marginal average
treatment effects (4.8) and (4.9). Although we require (CCTSB) to hold
regardless of whether (CIUN) holds, (CCTSB) also depends only on the observed
outcomes and is testable. In the next section, we show that under mild
assumptions FETWFE automatically provides a valid estimate of whether (CIUN)
holds (by estimating whether the
ğƒtâˆ—superscriptsubscriptğƒğ‘¡\boldsymbol{\xi}_{t}^{*}bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT coefficients all equal ğŸ0\boldsymbol{0}bold_0).

To interpret the rate of convergence
minâ¡{hN,hNâ€²}subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\min\\{h_{N},h_{N}^{\prime}\\}roman_min
{ italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€²
end_POSTSUPERSCRIPT }, consider the upper bound hNsubscriptâ„ğ‘h_{N}italic_h
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT from (6.3). Suppose the minimum
eigenvalue e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT is bounded away from 0 with high probability, which happens
under relatively mild assumptions in our pNâ‰¤Nâ¢Tsubscriptğ‘ğ‘ğ‘ğ‘‡p_{N}\leq
NTitalic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT â‰¤ italic_N
italic_T setting (see our more detailed discussion later in Section 6.3 about
Assumption R6). Then
ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})=ğ’ªâ„™â¢(pN/N)subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²subscriptğ’ªâ„™subscriptğ‘ğ‘ğ‘\mathcal{O}_{\mathbb{P}}\left(\min\\{h_{N},h_{N}^{\prime}\\}\right)=\mathcal{O}_%
{\mathbb{P}}\left(\sqrt{p_{N}/N}\right)caligraphic_O start_POSTSUBSCRIPT
blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) =
caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( square-root
start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N
end_ARG ); see Lemma I.3 in the appendix.

In general we will focus more on qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 )
as required by Theorems 6.2, 6.3, and 6.4, but we note that Theorem 6.1 holds
for any q>0ğ‘0q>0italic_q > 0. This is useful because the convex lasso
(q=1ğ‘1q=1italic_q = 1) and ridge (q=2ğ‘2q=2italic_q = 2) optimization
problems, for example, may be more tractable on very large data sets than the
nonconvex bridge estimator with q<1ğ‘1q<1italic_q < 1.

To give a concrete example of an estimator
ğ…^â¢(ğ’™)bold-^ğ…ğ’™\boldsymbol{\hat{\pi}}(\boldsymbol{x})overbold_^
start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ), in the setting of Theorem
6.1(b) where dN=dsubscriptğ‘‘ğ‘ğ‘‘d_{N}=ditalic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT = italic_d is fixed, the multinomial logit model is
1/N1ğ‘1/\sqrt{N}1 / square-root start_ARG italic_N end_ARG-consistent for the
generalized propensity scores by standard maximum likelihood theory under
correct specification. If this model is overly simplistic or dğ‘‘ditalic_d is
large relative to Nğ‘Nitalic_N, regularized machine learning methods with
theoretical convergence guaranteesâ€”like deep neural networks (Farrell etÂ
al., 2021, see Lemma 9c), random forests (Gao etÂ al., 2022), the
â„“1subscriptâ„“1\ell_{1}roman_â„“ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT-
penalized classifiers of Levy and Abramovich (2023), or the group lasso
multinomial logit model of Farrell (2015)â€”would also work. On the other
hand, since the cohorts have a natural ordering, we could add more structure
by using an ordinal response estimator like the proportional odds model
(McCullagh, 1980).

It may be possible to relax Assumption (LINS) so that linearity only has to
hold approximately, along the lines of e.g. Condition ASTE in Belloni etÂ al.
(2014). (At a high level, we might expect that if approximate linearity holds
so that the error due to misspecification is on the same order as the
estimation error of the population least squares model, we can achieve
convergence at the same rate as when the linearity assumption holds exactly.)

It may also be possible to relax the fixed dğ‘‘ditalic_d assumption in part
(b)ğ‘(b)( italic_b ) by using high-dimensional central limit theorems like
those in Lopes (2022) and Chernozhukov etÂ al. (2023), to name two recent
examples among many papers containing such results.

Lastly, we point out that under Theorem 6.1 the generalized propensity scores
and treatment effects can be estimated on the same data sets; that is, the
full data set can be used for both. Intuitively, this is because these
estimators are used for the distinct tasks of estimating the effects
Ï„CATTâ¢(r,t,ğ’™)subscriptğœCATTğ‘Ÿğ‘¡ğ’™\tau_{\text{CATT}}(r,t,\boldsymbol{x})italic_Ï„
start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t ,
bold_italic_x ) and estimating the weights used to combine them in a weighted
average. For technical details, see the proof of Theorem 6.1 in Appendix E.

In the appendix, we present an extension of Theorem 6.1, Theorem D.1, which
proves consistency for a set of estimators that allows for much broader
functions of the estimated cohort membership probabilities than the classes
(5.10) and (5.7). This result includes, for example, all of the estimands from
Callaway and Santâ€™Anna (2021) as special cases.

###  6.2 Restriction Selection Consistency

Again, we first state some additional needed regularity conditions and then
present our selection consistency result, Theorem 6.2. Theorem 6.2 shows that
with probability tending towards one FETWFE identifies the correct
restrictions, resulting in fusing together parameters that equal each other,
screening out irrelevant covariates, and improving estimation efficiency. At a
high level, Assumptions (R4) and (R5) add the following requirements:

  * â€¢

Assumption (R4) is most plausible if the covariates have bounded support and
if dNsubscriptğ‘‘ğ‘d_{N}italic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT is not increasing in Nğ‘Nitalic_N. Intuitively, this means
that in finite samples results relying on Assumption (R4) will be most likely
to hold when Nâ¢Tğ‘ğ‘‡NTitalic_N italic_T is reasonably large compared to
pNsubscriptğ‘ğ‘p_{N}italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT,
though we show in the simulation studies in Section 7 that in practice the
conclusion of Theorem 6.2 seems to hold even when Nğ‘Nitalic_N is not all that
large and pNsubscriptğ‘ğ‘p_{N}italic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT is fairly close to Nâ¢Tğ‘ğ‘‡NTitalic_N italic_T.

  * â€¢

Assumption (R5) is a technical assumption that does not require much more than
(R2). (R5) is easier to satisfy if dNsubscriptğ‘‘ğ‘d_{N}italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT is increasing only slowly in
Nğ‘Nitalic_N and if the sparsity sNsubscriptğ‘ ğ‘s_{N}italic_s
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT is fixed. (In finite samples,
we would expect better results if pNsubscriptğ‘ğ‘p_{N}italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT and the sparsity sNsubscriptğ‘
ğ‘s_{N}italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT are small
relative to Nâ¢Tğ‘ğ‘‡NTitalic_N italic_T.)

Assumption (R4): There exists a positive constant
emax<âˆsubscriptğ‘’maxe_{\text{max}}<\inftyitalic_e start_POSTSUBSCRIPT max
end_POSTSUBSCRIPT < âˆ such that
e2â¢Nâ‰¤emaxsubscriptğ‘’2ğ‘subscriptğ‘’maxe_{2N}\leq e_{\text{max}}italic_e
start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT â‰¤ italic_e
start_POSTSUBSCRIPT max end_POSTSUBSCRIPT almost surely (recall from Section
6.1 that e2â¢Nsubscriptğ‘’2ğ‘e_{2N}italic_e start_POSTSUBSCRIPT 2 italic_N
end_POSTSUBSCRIPT is the largest eigenvalue of
ğšº^â¢(ğ’)bold-^ğšºğ’\boldsymbol{\hat{\Sigma}}(\boldsymbol{Z})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_Z )).

A sufficient condition for Assumption (R4) is that the distribution of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT has bounded support in the sense that
âˆ¥ğ‘¿iâˆ¥2â‰¤Bsubscriptdelimited-
âˆ¥âˆ¥subscriptğ‘¿ğ‘–2ğµ\lVert\boldsymbol{X}_{i}\rVert_{2}\leq Bâˆ¥
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ¥
start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT â‰¤ italic_B almost surely for some
B<âˆğµB<\inftyitalic_B < âˆ.

Assumption (R5):

| Î»Nâ¢e1â¢N2âˆ’qNqâ¢pN2âˆ’qâ†’a.s.âˆ.\lambda_{N}\frac{e_{1N}^{2-q}}{\sqrt{N^{q}p_{N}^{2-q}}}\xrightarrow{a.s.}\infty.italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT divide start_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 - italic_q end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_N start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 - italic_q end_POSTSUPERSCRIPT end_ARG end_ARG start_ARROW start_OVERACCENT italic_a . italic_s . end_OVERACCENT â†’ end_ARROW âˆ . |   
---|---|---  
  
We will briefly examine how Assumption (R5) interacts with Assumption (R2).
For simplicity, assume the minimum eigenvalue Â
e1â¢Nâ‰¥csubscriptğ‘’1ğ‘ğ‘e_{1N}\geq citalic_e start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT â‰¥ italic_c for some c>0ğ‘0c>0italic_c > 0 with probability
tending towards 1, so that we can ignore e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e
start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT asymptotically (using a
similar argument to the one in the proof of Lemma I.3 in the appendix). Then
Assumption (R5) is equivalent to the deterministic condition

| Î»Nâ¢1Nq/2â¢pN1âˆ’q/2â†’âˆ.â†’subscriptğœ†ğ‘1superscriptğ‘ğ‘2superscriptsubscriptğ‘ğ‘1ğ‘2\lambda_{N}\frac{1}{N^{q/2}p_{N}^{1-q/2}}\to\infty.italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUPERSCRIPT italic_q / 2 end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 - italic_q / 2 end_POSTSUPERSCRIPT end_ARG â†’ âˆ . |   
---|---|---  
  
If we also assume sN=ssubscriptğ‘ ğ‘ğ‘ s_{N}=sitalic_s start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT = italic_s is fixed, we have from Assumption (R2)
that

| Î»NNâ†’0andlimNâ†’âˆÎ»NN1/2=0.formulae-sequenceâ†’subscriptğœ†ğ‘ğ‘0andsubscriptâ†’ğ‘subscriptğœ†ğ‘superscriptğ‘120\displaystyle\frac{\lambda_{N}}{N}\to 0\qquad\text{and}\qquad\lim_{N\to\infty}% \frac{\lambda_{N}}{N^{1/2}}=0.divide start_ARG italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG â†’ 0 and roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT divide start_ARG italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_N start_POSTSUPERSCRIPT 1 / 2 end_POSTSUPERSCRIPT end_ARG = 0 . |   
---|---|---  
  
We will require qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 ), and we see that
under these assumptions for (R5) and (R2) to hold simultaneously we require
Nq/2â¢pN1âˆ’q/2superscriptğ‘ğ‘2superscriptsubscriptğ‘ğ‘1ğ‘2N^{q/2}p_{N}^{1-q/2}italic_N
start_POSTSUPERSCRIPT italic_q / 2 end_POSTSUPERSCRIPT italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 -
italic_q / 2 end_POSTSUPERSCRIPT to grow slower than
N1/2superscriptğ‘12N^{1/2}italic_N start_POSTSUPERSCRIPT 1 / 2
end_POSTSUPERSCRIPT; that is, pNsubscriptğ‘ğ‘p_{N}italic_p start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT must grow slower than

| (N1/2Nq/2)2/(2âˆ’q)=N(1âˆ’q)/(2âˆ’q).superscriptsuperscriptğ‘12superscriptğ‘ğ‘222ğ‘superscriptğ‘1ğ‘2ğ‘\left(\frac{N^{1/2}}{N^{q/2}}\right)^{2/(2-q)}=N^{(1-q)/(2-q)}.( divide start_ARG italic_N start_POSTSUPERSCRIPT 1 / 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_N start_POSTSUPERSCRIPT italic_q / 2 end_POSTSUPERSCRIPT end_ARG ) start_POSTSUPERSCRIPT 2 / ( 2 - italic_q ) end_POSTSUPERSCRIPT = italic_N start_POSTSUPERSCRIPT ( 1 - italic_q ) / ( 2 - italic_q ) end_POSTSUPERSCRIPT . |   
---|---|---  
  
Even if e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT is not bounded away from 0 with high probability, Assumption
(R5) requires that e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e start_POSTSUBSCRIPT 1
italic_N end_POSTSUBSCRIPT does not vanish too quickly. As we discussed in
reference to Assumption (R2), this requires that the probability of being in
any one cohort does not vanish too quickly as Nâ†’âˆâ†’ğ‘N\to\inftyitalic_N
â†’ âˆ. It also requires that Î»Nsubscriptğœ†ğ‘\lambda_{N}italic_Î»
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT not decrease too quickly.

Notice that other than these relatively mild regularity conditions on the
eigenvalues of
ğšº^â¢(ğ’)bold-^ğšºğ’\boldsymbol{\hat{\Sigma}}(\boldsymbol{Z})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_Z ), we do not require a condition
like the irrepresentable condition (Zhao and Yu, 2006) or neighborhood
stability condition (Meinshausen and BÃ¼hlmann, 2006) that are required for
selection consistency of the lasso. However, our restriction selection
consistency result will only work for q<1ğ‘1q<1italic_q < 1; we do not prove
selection consistency of FETWFE with a lasso (q=1ğ‘1q=1italic_q = 1) penalty.

######  Theorem 6.2 (Selection consistency).

For the FETWFE estimator
ğ›ƒ^(q)superscriptbold-^ğ›ƒğ‘\boldsymbol{\hat{\beta}}^{(q)}overbold_^
start_ARG bold_italic_Î² end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT defined in (5.4), define

| ğ’®^:={jâˆˆ[pN]:(ğ‘«Nâ¢ğœ·^(q))jâ‰ 0}assign^ğ’®conditional-setğ‘—delimited-[]subscriptğ‘ğ‘subscriptsubscriptğ‘«ğ‘superscriptbold-^ğœ·ğ‘ğ‘—0\hat{\mathcal{S}}:=\left\\{j\in[p_{N}]:(\boldsymbol{D}_{N}\boldsymbol{\hat{% \beta}}^{(q)})_{j}\neq 0\right\\}over^ start_ARG caligraphic_S end_ARG := { italic_j âˆˆ [ italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] : ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT overbold_^ start_ARG bold_italic_Î² end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT â‰ 0 } |   
---|---|---  
  
to be the set of nonzero values in
ğƒNâ¢ğ›ƒ^(q)subscriptğƒğ‘superscriptbold-^ğ›ƒğ‘\boldsymbol{D}_{N}\boldsymbol{\hat{\beta}}^{(q)}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT overbold_^ start_ARG
bold_italic_Î² end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT.
Recall from Assumption S(sNsubscriptğ‘ ğ‘s_{N}italic_s start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT) that

| ğ’®={jâˆˆ[pN]:(ğ‘«Nâ¢ğœ·Nâˆ—)jâ‰ 0}.ğ’®conditional-setğ‘—delimited-[]subscriptğ‘ğ‘subscriptsubscriptğ‘«ğ‘superscriptsubscriptğœ·ğ‘ğ‘—0\mathcal{S}=\left\\{j\in[p_{N}]:(\boldsymbol{D}_{N}\boldsymbol{\beta}_{N}^{*})_% {j}\neq 0\right\\}.caligraphic_S = { italic_j âˆˆ [ italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] : ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT â‰ 0 } . |   
---|---|---  
  
Assume that Assumptions (CNAS), (CCTSB), and (LINS) hold, as well as
Assumptions (F1), (F2), S(sNsubscriptğ‘ ğ‘s_{N}italic_s start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT), and (R1) - (R5). Assume
qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 ). Then
limNâ†’âˆâ„™â¢(ğ’®^=ğ’®)=1subscriptâ†’ğ‘â„™^ğ’®ğ’®1\lim_{N\to\infty}\mathbb{P}\left(\hat{\mathcal{S}}=\mathcal{S}\right)=1roman_lim
start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( over^
start_ARG caligraphic_S end_ARG = caligraphic_S ) = 1.

###### Proof.

This is immediate from Theorem C.1(c) in the appendix. âˆ

Theorem 6.2 shows that FETWFE fulfills its promise to identify the correct
restrictions in accordance with our â„“qsubscriptâ„“ğ‘\ell_{q}roman_â„“
start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT penalty structure, as discussed
in Section 5. This serves our goal of improving estimation by avoiding
unnecessarily estimating parameters that are in fact equal.

FETWFE also screens out irrelevant covariates and interactions. As mentioned
in Section 3.2, if Assumptions (LINS) and (CIUN) both hold than the
ğƒtâˆ—superscriptsubscriptğƒğ‘¡\boldsymbol{\xi}_{t}^{*}bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT coefficients must all equal 0. If this is true, in large
enough samples FETWFE will estimate
ğƒtâˆ—superscriptsubscriptğƒğ‘¡\boldsymbol{\xi}_{t}^{*}bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT to equal exactly ğŸ0\boldsymbol{0}bold_0 with high
probability.

The proof of Theorem 6.2 relies on an extension of Theorem 2 of Kock (2013)
(Theorem F.4 in the appendix) to show that not only does the bridge estimator
exclude false selections, it also selects all of the relevant components of
ğ‘«Nâ¢ğœ·Nâˆ—subscriptğ‘«ğ‘superscriptsubscriptğœ·ğ‘\boldsymbol{D}_{N}\boldsymbol{\beta}_{N}^{*}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î²
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT with probability tending to 1. Theorem F.4 requires no
added assumptions from Theorem 2 of Kock (2013).

One consequence of Theorem 6.2 is that if
Ï„ATTâ¢(r,t)=0subscriptğœATTğ‘Ÿğ‘¡0\tau_{\text{ATT}}(r,t)=0italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) = 0 for any
rğ‘Ÿritalic_r, then

| limNâ†’âˆâ„™â¢(Ï„^ATTâ¢(r,t)=0)=1.subscriptâ†’ğ‘â„™subscript^ğœATTğ‘Ÿğ‘¡01\lim_{N\to\infty}\mathbb{P}\left(\hat{\tau}_{\text{ATT}}(r,t)=0\right)=1.roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) = 0 ) = 1 . |   
---|---|---  
  
The same is true of all of the other causal estimators. This is stronger than
convergence in probability to 0, and this stronger notion of convergence turns
out to be a key ingredient in the proof of Theorems 6.3 and 6.4, to come.

###  6.3 Asymptotic Normality and Oracle Property

Our asymptotic convergence results (Theorems 6.3 and 6.4 below) require one
additional regularity condition, an eigenvalue condition which does not
require much more than Assumptions (R2) and (R5).

Assumption (R6): The minimum eigenvalue of

| ğ”¼â¢[ğšº^â¢(ğ’â¢ğ‘«Nâˆ’1)]ğ”¼delimited-[]bold-^ğšºğ’superscriptsubscriptğ‘«ğ‘1\mathbb{E}\left[\boldsymbol{\hat{\Sigma}}\left(\boldsymbol{Z}\boldsymbol{D}_{N% }^{-1}\right)\right]blackboard_E [ overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ] |  | (6.4)  
---|---|---|---  
  
is greater than or equal to a fixed Î´>0ğ›¿0\delta>0italic_Î´ > 0 for all
Nğ‘Nitalic_N sufficiently large, and

| Î»Ne1â¢Nâ¢Nâˆˆoâ„™â¢(1).subscriptğœ†ğ‘subscriptğ‘’1ğ‘ğ‘subscriptğ‘œâ„™1\frac{\lambda_{N}}{e_{1N}\sqrt{N}}\in o_{\mathbb{P}}\left(1\right).divide start_ARG italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT square-root start_ARG italic_N end_ARG end_ARG âˆˆ italic_o start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( 1 ) . |  | (6.5)  
---|---|---|---  
  
Further, for all Nğ‘Nitalic_N and all
râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 } âˆª
caligraphic_R, all of the eigenvalues of
Covâ¢(ğ‘¿iâˆ£Wi=r)Covconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\mathrm{Cov}(\boldsymbol{X}_{i}\mid
W_{i}=r)roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
= italic_r ) are bounded between
Î»min>0subscriptğœ†min0\lambda_{\text{min}}>0italic_Î» start_POSTSUBSCRIPT min
end_POSTSUBSCRIPT > 0 and
Î»max<âˆsubscriptğœ†max\lambda_{\text{max}}<\inftyitalic_Î»
start_POSTSUBSCRIPT max end_POSTSUBSCRIPT < âˆ.

The assumption that the minimum eigenvalue of (6.4) is bounded away from 0 is
fairly mild since we already require
ğšº^â¢(ğ’)bold-^ğšºğ’\boldsymbol{\hat{\Sigma}}(\boldsymbol{Z})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_Z ) to be full rank and for its
minimum eigenvalue to not vanish too quickly, and the minimum singular value
of ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT is bounded from below by a positive constant; see
Lemma F.1 in the appendix. Further, this assumption is stronger than necessary
for the sake of interpretability; we only require a bound on the minimum
eigenvalue of a different matrix (F.6) for all Nğ‘Nitalic_N. This condition
holding for (6.5) is sufficient but not necessary.

Condition (6.5) is another assumption that requires
e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT to not vanish too quickly, which is qualitatively similar to
Assumptions (R2) and (R5). Holding s=sNğ‘ subscriptğ‘ ğ‘s=s_{N}italic_s =
italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT fixed (as is required
in Theorems 6.3 and 6.4) and ignoring the distinction between almost sure
convergence and convergence in probability, (6.5) is more restrictive on the
growth rate of Î»Nsubscriptğœ†ğ‘\lambda_{N}italic_Î» start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT than (R2) since (R2) requires

| Î»NNâ¢e1â¢Nâ†’0â†’subscriptğœ†ğ‘ğ‘subscriptğ‘’1ğ‘0\frac{\lambda_{N}}{Ne_{1N}}\to 0divide start_ARG italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_N italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT end_ARG â†’ 0 |   
---|---|---  
  
while (6.5) requires

| Î»NNâ¢e1â¢Nâ†’0.â†’subscriptğœ†ğ‘ğ‘subscriptğ‘’1ğ‘0\frac{\lambda_{N}}{\sqrt{N}e_{1N}}\to 0.divide start_ARG italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_N end_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT end_ARG â†’ 0 . |   
---|---|---  
  
However, if e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT is bounded away from 0 with high probability, using a
similar argument to the one in the proof of Lemma I.3 in the appendix, (6.5)
is essentially equivalent to the other requirement in (R2) that
limNâ†’âˆÎ»Nâ¢sN/N=0subscriptâ†’ğ‘subscriptğœ†ğ‘subscriptğ‘
ğ‘ğ‘0\lim_{N\to\infty}\lambda_{N}\sqrt{s_{N}/N}=0roman_lim start_POSTSUBSCRIPT
italic_N â†’ âˆ end_POSTSUBSCRIPT italic_Î» start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT square-root start_ARG italic_s start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT / italic_N end_ARG = 0 (in the setting of Theorem 6.4 where
sN=ssubscriptğ‘ ğ‘ğ‘ s_{N}=sitalic_s start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT = italic_s is fixed). If the smallest eigenvalue of
ğ”¼â¢[ğšº^â¢(ğ’)]ğ”¼delimited-[]bold-^ğšºğ’\mathbb{E}\left[\boldsymbol{\hat{\Sigma}}(\boldsymbol{Z})\right]blackboard_E
[ overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_Z ) ] is bounded away
from 0, one can show that the asymptotic distribution for the minimum
eigenvalue of
ğšº^â¢(ğ’)bold-^ğšºğ’\boldsymbol{\hat{\Sigma}}(\boldsymbol{Z})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_Z ) has support bounded away from 0 in
our setting where ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT has finite fourth moments and
pNâ‰¤Nâ¢Tsubscriptğ‘ğ‘ğ‘ğ‘‡p_{N}\leq NTitalic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT â‰¤ italic_N italic_T (Marchenko and Pastur, 1967). If we
also assume that ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT is subgaussian (a weaker
assumption than requiring ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT to have bounded support), under
Theorem 5.39 from Vershynin (2012) e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e
start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT is bounded away from 0 with
high probability for finite Nğ‘Nitalic_N large enough relative to
pNsubscriptğ‘ğ‘p_{N}italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT.

####  6.3.1 Oracle Property

Next we show that under Assumptions (R1) - (R6) the estimators (5.9) and
(5.10) are both oracle estimators (Fan and Li, 2001; Fan and Peng, 2004),
converge at a 1/N1ğ‘1/\sqrt{N}1 / square-root start_ARG italic_N end_ARG rate
(faster than the guarantee from Theorem 6.1), and are asymptotically Gaussian.

######  Theorem 6.3 (Oracle Property of FETWFE).

Assume that Assumptions (CNAS), (CCTSB), and (LINS) hold, as well as
Assumptions (F1), (F2), S(sğ‘ sitalic_s) for a fixed sğ‘ sitalic_s, and (R1) -
(R6). Assume qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 ). Suppose that either
Assumptions (CTSA) and (CIUN) hold or Assumption (CCTSA) holds.

For an arbitrary set of finite constants
{Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ start_POSTSUBSCRIPT
italic_r italic_t end_POSTSUBSCRIPT }, if at least one of the
Ï„ATTâ¢(r,t)subscriptğœATTğ‘Ÿğ‘¡\tau_{\text{ATT}}(r,t)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) with a
nonzero Ïˆrâ¢tsubscriptğœ“ğ‘Ÿğ‘¡\psi_{rt}italic_Ïˆ start_POSTSUBSCRIPT
italic_r italic_t end_POSTSUBSCRIPT is nonzero, then the sequence of random
variables

| Nâ¢Tâ¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï„^ATTâ¢(r,t)âˆ’Ï„ATTâ¢(r,t))ğ‘ğ‘‡subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœATTğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡\displaystyle\sqrt{NT}\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}(\hat{\tau}% _{\text{ATT}}(r,t)-\tau_{\text{ATT}}(r,t))square-root start_ARG italic_N italic_T end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) |   
---|---|---  
  
converges in distribution to a mean zero Gaussian random variables with
variance that depends only on the sğ‘ sitalic_s parameters of the model with
all restrictions correctly identified.

Further, if
Ï„^ATTâ¢(r,t)subscript^ğœATTğ‘Ÿğ‘¡\hat{\tau}_{\text{ATT}}(r,t)over^ start_ARG
italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r ,
italic_t ) and the probability ratios
Nr/NÏ„subscriptğ‘ğ‘Ÿsubscriptğ‘ğœN_{r}/N_{\tau}italic_N start_POSTSUBSCRIPT
italic_r end_POSTSUBSCRIPT / italic_N start_POSTSUBSCRIPT italic_Ï„
end_POSTSUBSCRIPT are estimated on two independent data sets of size
Nğ‘Nitalic_N, then the sequence of random variables

| Nâ¢Tâ¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(NrNÏ„â¢Ï„^ATTâ¢(r,t)âˆ’Ï€~râ¢Ï„ATTâ¢(r,t))ğ‘ğ‘‡subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘ğ‘Ÿsubscriptğ‘ğœsubscript^ğœATTğ‘Ÿğ‘¡subscript~ğœ‹ğ‘ŸsubscriptğœATTğ‘Ÿğ‘¡\displaystyle\sqrt{NT}\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\frac% {N_{r}}{N_{\tau}}\hat{\tau}_{\text{ATT}}(r,t)-\tilde{\pi}_{r}\tau_{\text{ATT}}% (r,t)\right)square-root start_ARG italic_N italic_T end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( divide start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_Ï„ end_POSTSUBSCRIPT end_ARG over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) |   
---|---|---  
  
also converges in distribution to a mean zero Gaussian random variable with
variance that depends only on the sğ‘ sitalic_s parameters of the model with
all restrictions correctly identified.

(If all of the Ï„ATTâ¢(r,t)subscriptğœATTğ‘Ÿğ‘¡\tau_{\text{ATT}}(r,t)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) with nonzero
Ïˆrâ¢tsubscriptğœ“ğ‘Ÿğ‘¡\psi_{rt}italic_Ïˆ start_POSTSUBSCRIPT italic_r
italic_t end_POSTSUBSCRIPT terms equal 0, both sequences of random variables
converge in probability to 0.)

###### Proof.

Provided in Section E of the appendix. âˆ

Theorems 6.3 and 6.4 leverage novel (to the best of our knowledge) extensions
of Theorem 2 from Kock (2013) that establish finite-sample variance
estimators, including when the weights in a linear combination of the
estimated coefficients are themselves estimated; see Theorem F.5 in the
appendix.

Theorem 6.3 (and, more directly, Theorem C.1(d) and (f) in the appendix) show
that even if pNâ†’âˆâ†’subscriptğ‘ğ‘p_{N}\to\inftyitalic_p start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT â†’ âˆ FETWFE converges at a 1/N1ğ‘1/\sqrt{N}1 /
square-root start_ARG italic_N end_ARG rate and its asymptotic covariance
matrix depends only on the sğ‘ sitalic_s parameters of the correct model. That
is, FETWFE estimates the model with the same asymptotic efficiency as an OLS-
estimated ETWFE estimator that knows the pNâˆ’ssubscriptğ‘ğ‘ğ‘ p_{N}-sitalic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_s correct
restrictions. FETWFE leverages the possible restrictions in the ETWFE
estimator to improve efficiency without requiring the practitioner to make
assumptions on which restrictions to choose, which could induce asymptotic
bias if the wrong restrictions are chosen or compromise asymptotic efficiency
if not enough restrictions are chosen. This addresses the need to consider
both bias and variance when estimating treatment effects (Gelman and VÃ¡kÃ¡r,
2021).

In Remark 3.1 we mentioned that the inclusion of the parameters (3.4) in our
regression allows for unbiased estimation of treatment effects under both
(CCTS) and unconfoundedness of the untreated potential outcomes, but under
unconfoundedness the parameters equal exactly 0 and are inefficient to
include. However, Theorem 6.3 shows that when coefficients that equal 0 are
included, FETWFE sets these coefficients equal to exactly 0 with high
probability and estimates the nonzero coefficients with the same asymptotic
efficiency as if those coefficients were omitted from the model. FETWFE is
therefore a good model to choose if one wants to maximize robustness without
compromising asymptotic efficiency. The same is true if (CIUN) holds and the
regression estimands
ğƒtâˆ—superscriptsubscriptğƒğ‘¡\boldsymbol{\xi}_{t}^{*}bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT all equal ğŸ0\boldsymbol{0}bold_0, or if any irrelevant
covariates are included in the regression. So practitioners do not need to
hesitate to include a possibly relevant covariate that could be helpful for
the plausibility of Assumption (CCTSB) or (CCTS) as long as
ğ’ğ’\boldsymbol{Z}bold_italic_Z has full column rank.

####  6.3.2 Asymptotically Valid Confidence Intervals

Theorem 6.3 is conceptual and yields insight on the kind of behavior we can
expect from FETWFE in large samples. The following result, which has the same
assumptions as Theorem 6.3, is more practical and provides explicit formulas
for variance estimators for asymptotically valid confidence intervals of
treatment effect estimates.

######  Theorem 6.4 (Asymptotic Confidence Intervals for FETWFE).

Assume that Assumptions (CNAS), (CCTSB), and (LINS) hold, as well as
Assumptions (F1), (F2), S(sğ‘ sitalic_s) for a fixed sğ‘ sitalic_s, and (R1) -
(R6). Assume qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 ). Suppose that either
Assumptions (CTSA) and (CIUN) hold or Assumption (CCTSA) holds. Let
{Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ start_POSTSUBSCRIPT
italic_r italic_t end_POSTSUBSCRIPT } be an arbitrary set of finite constants,
and for all of the below results, assume at least one of the
Ï„ATTâ¢(r,t)subscriptğœATTğ‘Ÿğ‘¡\tau_{\text{ATT}}(r,t)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t )
corresponding to a nonzero Ïˆrâ¢tsubscriptğœ“ğ‘Ÿğ‘¡\psi_{rt}italic_Ïˆ
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT is nonzero (otherwise,
all of the below sequences of random variables converge in probability to 0).

  1. (a)

For the estimator (5.9) it holds that

| Nâ¢Tv^N(C)â¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï„^ATTâ¢(r,t)âˆ’Ï„ATTâ¢(r,t))â†’ğ‘‘ğ‘‘â†’ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘Csubscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœATTğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡absent\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{C})}}}\sum_{r\in\mathcal{R}}% \sum_{t=r}^{T}\psi_{rt}(\hat{\tau}_{\text{ATT}}(r,t)-\tau_{\text{ATT}}(r,t))% \xrightarrow{d}\leavevmode\nobreak\ square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C ) end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,1),ğ’©01\displaystyle\mathcal{N}(0,1),caligraphic_N ( 0 , 1 ) , |   
---|---|---|---  
  
where v^N(C)superscriptsubscript^ğ‘£ğ‘C\hat{v}_{N}^{(\text{C})}over^ start_ARG
italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( C ) end_POSTSUPERSCRIPT is a finite-sample variance
estimator defined in (E.7). (All variance estimators depend only on the known
Ïƒ2superscriptğœ2\sigma^{2}italic_Ïƒ start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT and the observed data.)

  2. (b)

Suppose one set of data of size Nğ‘Nitalic_N is used to estimate the cohort
probabilities Nr/NÏ„subscriptğ‘ğ‘Ÿsubscriptğ‘ğœN_{r}/N_{\tau}italic_N
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT / italic_N start_POSTSUBSCRIPT
italic_Ï„ end_POSTSUBSCRIPT and another independent data set of size
Nğ‘Nitalic_N is used to estimate each
Ï„^ATTâ¢(r,t)subscript^ğœATTğ‘Ÿğ‘¡\hat{\tau}_{\text{ATT}}(r,t)over^ start_ARG
italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r ,
italic_t ). Then for the estimator (5.10) it holds that

| Nâ¢Tv^NC;Ï€^â¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(NrNÏ„â¢Ï„^ATTâ¢(r,t)âˆ’Ï€~râ¢Ï„ATTâ¢(r,t))â†’ğ‘‘ğ‘‘â†’ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘C^ğœ‹subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘ğ‘Ÿsubscriptğ‘ğœsubscript^ğœATTğ‘Ÿğ‘¡subscript~ğœ‹ğ‘ŸsubscriptğœATTğ‘Ÿğ‘¡absent\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{\text{C};\hat{\pi}}}}\sum_{r\in% \mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\frac{N_{r}}{N_{\tau}}\hat{\tau}_{% \text{ATT}}(r,t)-\tilde{\pi}_{r}\tau_{\text{ATT}}(r,t)\right)\xrightarrow{d}% \leavevmode\nobreak\ square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT C ; over^ start_ARG italic_Ï€ end_ARG end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( divide start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_Ï„ end_POSTSUBSCRIPT end_ARG over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,1),ğ’©01\displaystyle\mathcal{N}(0,1),caligraphic_N ( 0 , 1 ) , |   
---|---|---|---  
  
where
v^NC;Ï€^superscriptsubscript^ğ‘£ğ‘C^ğœ‹\hat{v}_{N}^{\text{C};\hat{\pi}}over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT C ; over^ start_ARG italic_Ï€ end_ARG
end_POSTSUPERSCRIPT is a finite-sample variance estimator defined in (E.11).

  3. (c)

Suppose a single set of data of size Nğ‘Nitalic_N is used to estimate both the
cohort probabilities Nr/NÏ„subscriptğ‘ğ‘Ÿsubscriptğ‘ğœN_{r}/N_{\tau}italic_N
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT / italic_N start_POSTSUBSCRIPT
italic_Ï„ end_POSTSUBSCRIPT and each
Ï„^ATTâ¢(r,t)subscript^ğœATTğ‘Ÿğ‘¡\hat{\tau}_{\text{ATT}}(r,t)over^ start_ARG
italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r ,
italic_t ). Then the estimator (5.10) is asymptotically subgaussian: the
sequence of random variables

| Nâ¢Tv^NC, (cons);Ï€^â¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(NrNÏ„â¢Ï„^ATTâ¢(r,t)âˆ’Ï€~râ¢Ï„ATTâ¢(r,t))ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘C, (cons)^ğœ‹subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘ğ‘Ÿsubscriptğ‘ğœsubscript^ğœATTğ‘Ÿğ‘¡subscript~ğœ‹ğ‘ŸsubscriptğœATTğ‘Ÿğ‘¡\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{\text{C, (cons)};\hat{\pi}}}}\sum_{r% \in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\frac{N_{r}}{N_{\tau}}\hat{\tau}_{% \text{ATT}}(r,t)-\tilde{\pi}_{r}\tau_{\text{ATT}}(r,t)\right)square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT C, (cons) ; over^ start_ARG italic_Ï€ end_ARG end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( divide start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_Ï„ end_POSTSUBSCRIPT end_ARG over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - over~ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) |   
---|---|---  
  
converges in distribution to a mean-zero subgaussian random variable with
variance at most 1, where v^NC, (cons);Ï€^superscriptsubscript^ğ‘£ğ‘C,
(cons)^ğœ‹\hat{v}_{N}^{\text{C, (cons)};\hat{\pi}}over^ start_ARG italic_v
end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
C, (cons) ; over^ start_ARG italic_Ï€ end_ARG end_POSTSUPERSCRIPT is a finite-
sample conservative variance estimator defined in (E.12).

###### Proof.

Provided in Section E of the appendix. âˆ

Theorem 6.4 shows that we can form asymptotically valid 1âˆ’Î±1ğ›¼1-\alpha1 -
italic_Î± confidence intervals with estimator
T^Nsubscript^ğ‘‡ğ‘\hat{T}_{N}over^ start_ARG italic_T end_ARG
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT and variance estimator
v^Nsubscript^ğ‘£ğ‘\hat{v}_{N}over^ start_ARG italic_v end_ARG
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT with

| CINâ¢(v^N;Î±):=[T^Nâˆ’Î¦âˆ’1â¢(1âˆ’Î±2)â¢v^NNâ¢T,T^N+Î¦âˆ’1â¢(1âˆ’Î±2)â¢v^NNâ¢T],assignsubscriptCIğ‘subscript^ğ‘£ğ‘ğ›¼subscript^ğ‘‡ğ‘superscriptÎ¦11ğ›¼2subscript^ğ‘£ğ‘ğ‘ğ‘‡subscript^ğ‘‡ğ‘superscriptÎ¦11ğ›¼2subscript^ğ‘£ğ‘ğ‘ğ‘‡\text{CI}_{N}(\hat{v}_{N};\alpha):=\left[\hat{T}_{N}-\Phi^{-1}\left(1-\frac{% \alpha}{2}\right)\sqrt{\frac{\hat{v}_{N}}{NT}},\hat{T}_{N}+\Phi^{-1}\left(1-% \frac{\alpha}{2}\right)\sqrt{\frac{\hat{v}_{N}}{NT}}\right],CI start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ; italic_Î± ) := [ over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - roman_Î¦ start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( 1 - divide start_ARG italic_Î± end_ARG start_ARG 2 end_ARG ) square-root start_ARG divide start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_N italic_T end_ARG end_ARG , over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT + roman_Î¦ start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( 1 - divide start_ARG italic_Î± end_ARG start_ARG 2 end_ARG ) square-root start_ARG divide start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_N italic_T end_ARG end_ARG ] , |  | (6.6)  
---|---|---|---  
  
where Î¦â¢(â‹…)Î¦â‹…\Phi(\cdot)roman_Î¦ ( â‹… ) is the distribution function
of the standard normal distribution.

Theorem 6.4(b) requires data splitting for asymptotic normality of the
estimator (5.10). However, the data used for estimating the marginal cohort
probabilities do not need to include observed responses. In some domains like
public health and medicine where difference-in-differences has many potential
uses (Rothbard etÂ al., 2023; Wing etÂ al., 2018), such unlabeled data may be
more widely available than labeled data (CandÃ¨s etÂ al., 2018, Section
1.3.2). In a setting like this, asymptotic normality can be achieved without
reducing the amount of data used to estimate the model. (It is straightforward
to adjust the variance estimator appropriately if the sample sizes of the two
data sets are not equal.)

Theorem 6.4(c) does not require sample splitting, at the price of sacrificing asymptotic normality for mere asymptotic subgaussianity and necessitating a conservative variance estimator. Because a subgaussian random variable can be defined as a variable Xğ‘‹Xitalic_X satisfying â„™â¢(|X|â‰¥x)â‰¤2â¢expâ¡{âˆ’x2/K2}â„™ğ‘‹ğ‘¥2superscriptğ‘¥2superscriptğ¾2\mathbb{P}(|X|\geq x)\leq 2\exp\\{-x^{2}/K^{2}\\}blackboard_P ( | italic_X | â‰¥ italic_x ) â‰¤ 2 roman_exp { - italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT } for some K>0ğ¾0K>0italic_K > 0 for all xâ‰¥0ğ‘¥0x\geq 0italic_x â‰¥ 0 (Vershynin, 2018, Proposition 2.5.2(a)), the tails of such a variable decay at least as quickly as a Gaussian random variable, so we might expect 95%percent9595\%95 % confidence intervals to have similar asymptotic validity to the confidence intervals from part (b). In practice, we show in the simulation studies in Section 7 that these confidence intervals do seem to retain validity.

We cannot test the null hypothesis of treatment effects equalling 0 under
Theorem 6.4, since these test statistics are not asymptotically normal if the
estimated coefficients all equal 0; instead they converge in probability to 0
(even after scaling by Nâ¢Tğ‘ğ‘‡\sqrt{NT}square-root start_ARG italic_N
italic_T end_ARG).

Theorem D.3 in the appendix is a generalization of both Theorems 6.3 and 6.4
for the classes of conditional average treatment effects estimators (5.6) and
(5.7) in the fixed dN=dsubscriptğ‘‘ğ‘ğ‘‘d_{N}=ditalic_d start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT = italic_d setting under the assumption that an
asymptotically Gaussian estimator of the generalized propensity scores (like
the multinomial logit or proportional odds models) is available and an extra
split of the data is available to estimate the cohort covariate means.

##  7 Simulation Studies

To test the efficacy of FETWFE under our assumptions, we conduct simulation
studies in R using the simulator package (Bien, 2016). We choose parameters
that bear resemblance to the empirical application from Section III of
Goodman-Bacon (2021) (N=51,T=33,R=12,dN=3formulae-sequenceğ‘51formulae-
sequenceğ‘‡33formulae-
sequenceğ‘…12subscriptğ‘‘ğ‘3N=51,T=33,R=12,d_{N}=3italic_N = 51 , italic_T =
33 , italic_R = 12 , italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT =
3), which we explore in Section 8. We use fewer cohorts for simplicity of
presentation, more covariates to increase pNsubscriptğ‘ğ‘p_{N}italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT in compensation for the smaller
Rğ‘…Ritalic_R, and more units to avoid realizations where no units are
assigned to a cohort by random chance. We generate data with
N=120ğ‘120N=120italic_N = 120 units, T=30ğ‘‡30T=30italic_T = 30 time periods,
R=5ğ‘…5R=5italic_R = 5 cohorts entering at times
{2,â€¦,6}2â€¦6\\{2,\ldots,6\\}{ 2 , â€¦ , 6 }, and
dN=12subscriptğ‘‘ğ‘12d_{N}=12italic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT = 12 features, which results in a total of
pN=2209subscriptğ‘ğ‘2209p_{N}=2209italic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT = 2209 covariates and Nâ¢T=3600ğ‘ğ‘‡3600NT=3600italic_N
italic_T = 3600 observations. To generate a
ğœ·Nâˆ—superscriptsubscriptğœ·ğ‘\boldsymbol{\beta}_{N}^{*}bold_italic_Î²
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT such that
ğ‘«Nâ¢ğœ·Nâˆ—subscriptğ‘«ğ‘superscriptsubscriptğœ·ğ‘\boldsymbol{D}_{N}\boldsymbol{\beta}_{N}^{*}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î²
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT is sparse, we generate a single random sparse
ğœ½Nâˆ—âˆˆâ„pNsuperscriptsubscriptğœ½ğ‘superscriptâ„subscriptğ‘ğ‘\boldsymbol{\theta}_{N}^{*}\in\mathbb{R}^{p_{N}}bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT, then
transform this into a coefficient vector
ğœ·Nâˆ—=ğ‘«Nâˆ’1â¢ğœ½Nâˆ—superscriptsubscriptğœ·ğ‘superscriptsubscriptğ‘«ğ‘1superscriptsubscriptğœ½ğ‘\boldsymbol{\beta}_{N}^{*}=\boldsymbol{D}_{N}^{-1}\boldsymbol{\theta}_{N}^{*}bold_italic_Î²
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT = bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT to use across all simulations. We generate
ğœ½Nâˆ—superscriptsubscriptğœ½ğ‘\boldsymbol{\theta}_{N}^{*}bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT by taking a pNsubscriptğ‘ğ‘p_{N}italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT-vector of all 0 entries and
setting each entry equal to 2 randomly with probability 0.1. We set the sign
of each term randomly, but since each entry of
ğœ·Nâˆ—superscriptsubscriptğœ·ğ‘\boldsymbol{\beta}_{N}^{*}bold_italic_Î²
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT is a sum of terms in
ğœ½Nâˆ—superscriptsubscriptğœ½ğ‘\boldsymbol{\theta}_{N}^{*}bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT, we bias the signs to avoid treatment effects that are too
close to 0: individual nonzero terms in
ğœ½Nâˆ—superscriptsubscriptğœ½ğ‘\boldsymbol{\theta}_{N}^{*}bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT are positive with probability 0.6 and negative otherwise.

On each of 700 simulations, we randomly generate Nğ‘Nitalic_N independent
realizations of ğ‘¿(i)âˆ¼ğ’©â¢(ğŸ,ğ‘°dN)similar-
tosubscriptğ‘¿ğ‘–ğ’©0subscriptğ‘°subscriptğ‘‘ğ‘\boldsymbol{X}_{(i)}\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I}_{d_{N}})bold_italic_X
start_POSTSUBSCRIPT ( italic_i ) end_POSTSUBSCRIPT âˆ¼ caligraphic_N ( bold_0
, bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) for the time-invariant covariates. We
randomly assign treatments with probabilities
(Ï€0,Ï€1,â€¦,Ï€R)=(1/(R+1),â€¦,1/(R+1))subscriptğœ‹0subscriptğœ‹1â€¦subscriptğœ‹ğ‘…1ğ‘…1â€¦1ğ‘…1(\pi_{0},\pi_{1},\ldots,\pi_{R})=(1/(R+1),\ldots,1/(R+1))(
italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€
start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT
italic_R end_POSTSUBSCRIPT ) = ( 1 / ( italic_R + 1 ) , â€¦ , 1 / ( italic_R +
1 ) ), where

| Ï€r:={â„™â¢(Wi=0),r=0,â„™â¢(Wi=r),râˆˆâ„›,assignsubscriptğœ‹ğ‘Ÿcasesâ„™subscriptğ‘Šğ‘–0ğ‘Ÿ0â„™subscriptğ‘Šğ‘–ğ‘Ÿğ‘Ÿâ„›\pi_{r}:=\begin{cases}\mathbb{P}(W_{i}=0),&r=0,\\\ \mathbb{P}(W_{i}=r),&r\in\mathcal{R},\end{cases}italic_Ï€ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT := { start_ROW start_CELL blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ) , end_CELL start_CELL italic_r = 0 , end_CELL end_ROW start_ROW start_CELL blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) , end_CELL start_CELL italic_r âˆˆ caligraphic_R , end_CELL end_ROW |  | (7.1)  
---|---|---|---  
  
are the marginal probabilities of treatment assignments. To ensure the model
is estimable, in the rare instances where there are no untreated units or one
cohort has no observed units, we draw another set of random assignments.

After drawing covariates and treatment assignments, we construct
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG.
Then we draw Nğ‘Nitalic_N independent random effects ciâˆ¼ğ’©â¢(0,5)similar-
tosubscriptğ‘ğ‘–ğ’©05c_{i}\sim\mathcal{N}(0,5)italic_c start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT âˆ¼ caligraphic_N ( 0 , 5 ) as well as
Nâ¢Tğ‘ğ‘‡NTitalic_N italic_T independent noise terms
u(iâ¢t)âˆ¼ğ’©â¢(0,5)similar-
tosubscriptğ‘¢ğ‘–ğ‘¡ğ’©05u_{(it)}\sim\mathcal{N}(0,5)italic_u
start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT âˆ¼ caligraphic_N
( 0 , 5 ) to generate
Ïµ(iâ‹…)=ciâ¢ğŸT+ğ’–(iâ‹…)\boldsymbol{\epsilon}_{(i\cdot)}=c_{i}\boldsymbol{1}_{T}+\boldsymbol{u}_{(i%
\cdot)}bold_italic_Ïµ start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT =
italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_1
start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT + bold_italic_u
start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT and finally generate
ğ’š~=ğ’~â¢ğœ·Nâˆ—+Ïµ(â‹…â‹…)bold-~ğ’šbold-~ğ’superscriptsubscriptğœ·ğ‘subscriptbold-
italic-
Ïµâ‹…absentâ‹…\boldsymbol{\tilde{y}}=\boldsymbol{\tilde{Z}}\boldsymbol{\beta}_{N}^{*}+%
\boldsymbol{\epsilon}_{(\cdot\cdot)}overbold_~ start_ARG bold_italic_y end_ARG
= overbold_~ start_ARG bold_italic_Z end_ARG bold_italic_Î²
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT + bold_italic_Ïµ start_POSTSUBSCRIPT ( â‹… â‹… )
end_POSTSUBSCRIPT.

Besides FETWFE, we also consider three competitor methods. The first is ETWFE,
estimated by OLS on ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG
bold_italic_Z end_ARG. We also consider bridge regression on
ğ’ğ’\boldsymbol{Z}bold_italic_Z directly penalizing
ğœ·ğœ·\boldsymbol{\beta}bold_italic_Î² rather than penalizing
ğ‘«Nâ¢ğœ·subscriptğ‘«ğ‘ğœ·\boldsymbol{D}_{N}\boldsymbol{\beta}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î² (BETWFE). For
both FETWFE and BETWFE, we follow the experiments of Kock (2013) and use
q=0.5ğ‘0.5q=0.5italic_q = 0.5, selecting the penalty
Î»Nsubscriptğœ†ğ‘\lambda_{N}italic_Î» start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT over a grid of 100 values (equally spaced on a logarithmic
scale) using BIC. We implement bridge regression for both BETWFE and FETWFE
using the R grpreg package (Breheny and Huang, 2009). Finally, we also
consider a slightly more flexible version of (1.3), where we estimate the
model

| y~iâ¢t=Î½r+Î³t+ğ‘¿â¢ğœ¿+âˆ‘râˆˆâ„›Ï„râ‹…ğŸ™â¢{Wi=r}â¢ğŸ™â¢{tâ‰¥r}+Ïµiâ¢tsubscript~ğ‘¦ğ‘–ğ‘¡subscriptğœˆğ‘Ÿsubscriptğ›¾ğ‘¡ğ‘¿ğœ¿subscriptğ‘Ÿâ„›â‹…subscriptğœğ‘Ÿ1subscriptğ‘Šğ‘–ğ‘Ÿ1ğ‘¡ğ‘Ÿsubscriptitalic-Ïµğ‘–ğ‘¡\tilde{y}_{it}=\nu_{r}+\gamma_{t}+\boldsymbol{X}\boldsymbol{\kappa}+\sum_{r\in% \mathcal{R}}\tau_{r}\cdot\mathbbm{1}\\{W_{i}=r\\}\mathbbm{1}\\{t\geq r\\}+\epsilon% _{it}over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT = italic_Î½ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT + italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + bold_italic_X bold_italic_Îº + âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT â‹… blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } blackboard_1 { italic_t â‰¥ italic_r } + italic_Ïµ start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT |   
---|---|---  
  
by OLS (TWFE_COVS). (Notice that adding unit-specific covariates to Model
(1.3) induces collinearity. Fitting the model instead on cohort fixed effects,
like ETWFE, also matches, e.g., Equation 3.2 in Callaway and Santâ€™Anna
(2021). See also the discussion around Equation 2.5 in Santâ€™Anna and Zhao
2020.) The inclusion of covariates might make it seem more plausible that
Assumptions (CNAS) and (CCTS) could hold in this model, though Wooldridge
(2021, Section 6) points out that adding time-invariant covariates does not
change the estimates of the treatment effects. Separate treatment effects for
each cohort, while insufficient to avoid bias and capture the variation in
treatment effects, should improve estimation relative to (1.3) and allows for
the estimation of cohort-specific treatment effects to compare to the other
methods.

###  7.1 Estimation Error

We start by evaluating the error of each method in estimating the average
treatment effect (4.11). The assumptions of Theorem 6.1 are satisfied, so we
expect FETWFE to estimate the treatment effects more accurately than ETWFE,
which will suffer from high variance; BETWFE, which does not assume the
correct form of sparsity; and TWFE_COVS, which is asymptotically biased. We
estimate the average treatment effect using the FETWFE estimator (5.10) with
Ïˆrâ¢tsubscriptğœ“ğ‘Ÿğ‘¡\psi_{rt}italic_Ïˆ start_POSTSUBSCRIPT italic_r
italic_t end_POSTSUBSCRIPT from (4.6), as well as analogous estimators using
the competitor estimated regression coefficients and observed cohort counts.

We calculate the squared error of each average treatment effect estimate for
each method on each iteration. Boxplots of the results are displayed in Figure
3. We also provide the means and standard errors for the squared errors of
each method in Table 1. Table 2 contains pğ‘pitalic_p-values for paired one-
tailed tğ‘¡titalic_t-tests of the alternative hypothesis that the squared
error for FETWFE is less than the squared error for each competitor method;
all results show significantly better performance for FETWFE at the 0.05
significance level.

These results show that even if most of the restrictions we would naturally
consider hold and we are only interested in overall average treatment effect
(4.11), a simple model like TWFE_COVS is an unsuitable estimator. This aligns
with the conclusions of previous works, as we discussed in the introduction.
We see that ETWFE has better estimation error, though in practice it still
does not perform as well as FETWFE because it estimates about ten times as
many parameters as are needed, leading to imprecise estimates.

![Refer to caption]() Figure 3: Boxplots of squared errors for each treatment effect estimate across all 700 simulations. Vertical axis is on a log scale. Table 1: Means and standard errors for the squared error of the estimator of the ATT (4.11) for each method across all 700 simulations in the first simulation study from Section 7. FETWFE | ETWFE | BETWFE | TWFE_COVS  
---|---|---|---  
0.0399 (0.00263) | 1.19 (0.633) | 0.339 (0.00336) | 0.938 (0.0395)  
Table 2: pğ‘pitalic_p-values from paired one-tailed tğ‘¡titalic_t-tests of the alternative hypothesis that the FETWFE ATT estimator (5.10) has a lower squared estimation error for the ATT (4.11) than each competitor method calculated across all 700 simulations in the first simulation study from Section 7. (Low pğ‘pitalic_p-values indicate better predictive performance for FETWFE.) ETWFE | BETWFE | TWFE_COVS  
---|---|---  
0.0343 | 1.24e-320 | 1.68e-86  
  
In Appendix B, we also present estimation error results for the cohort-
specific average treatment effects
Ï„ATTâ¢(r)subscriptğœATTğ‘Ÿ\tau_{\text{ATT}}(r)italic_Ï„ start_POSTSUBSCRIPT
ATT end_POSTSUBSCRIPT ( italic_r ) as defined in (4.10) for each of the five
cohorts, and estimation error for the coefficients of
ğœ·Nâˆ—superscriptsubscriptğœ·ğ‘\boldsymbol{\beta}_{N}^{*}bold_italic_Î²
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT corresponding to the interaction effects,
ğ†âˆ—superscriptğ†\boldsymbol{\rho}^{*}bold_italic_Ï start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT. These results show that FETWFE outperforms the competitor
methods for these estimands as well.

###  7.2 Restriction Selection Consistency

Next, we examine the extent to which we can trust FETWFE to select the correct
restrictions, as we know it does with asymptotically high probability under
Theorem 6.2. In the same experiment as before, on each simulation we calculate
the percentage of restrictions FETWFE successfully identifies among the
treatment parameters. In particular, we calculate the percentage of entries of
ğ‘«â¢ğœ·Nâˆ—ğ‘«superscriptsubscriptğœ·ğ‘\boldsymbol{D}\boldsymbol{\beta}_{N}^{*}bold_italic_D
bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT that FETWFE successfully
estimates as either zero or nonzero.

On average across the 700 simulations, FETWFE successfully decides whether to
use a restriction or not in 95.0%percent95.095.0\%95.0 % of the
pNsubscriptğ‘ğ‘p_{N}italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
possible cases, with a standard error of 0.025%percent0.0250.025\%0.025 %. Of
the true restrictions (that is, the entries of
ğ‘«â¢ğœ·Nâˆ—ğ‘«superscriptsubscriptğœ·ğ‘\boldsymbol{D}\boldsymbol{\beta}_{N}^{*}bold_italic_D
bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT that equal 0), on average
97.5%percent97.597.5\%97.5 % (0.021%percent0.0210.021\%0.021 %) are correctly
identified. This suggests that FETWFE is effective at identifying restrictions
in practice, which contributes to FETWFEâ€™s success in estimating treatment
effects that we saw in the previous section. (Figure 4 in Appendix B shows a
boxplot of the proportion of restrictions successfully identified across all
700 simulations.)

To get a better sense of the asymptotics, we conduct an additional simulation
study in the same way as the first one, but with T=5ğ‘‡5T=5italic_T =
5,555Notice that increasing Tğ‘‡Titalic_T increases the number of observations
while also increasing the number of treatment effects and interactions to
estimate. So we might expect larger Tğ‘‡Titalic_T to have a roughly neutral
effect on the convergence properties, while greatly increasing the
computational cost of simulations with large Nğ‘Nitalic_N. R=3,dN=2formulae-
sequenceğ‘…3subscriptğ‘‘ğ‘2R=3,d_{N}=2italic_R = 3 , italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = 2 (resulting in
pN=50subscriptğ‘ğ‘50p_{N}=50italic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT = 50), and N=1200ğ‘1200N=1200italic_N = 1200 observations
(resulting in 300 observations per cohort in expectation). The sparse
ğœ½Nâˆ—superscriptsubscriptğœ½ğ‘\boldsymbol{\theta}_{N}^{*}bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT is generated as before, but with entries each equalling 0
with probability 0.5. Again, we conduct 700 simulations. In this second
simulation study, FETWFE successfully decides whether to use a restriction or
not in 99.3%percent99.399.3\%99.3 % (0.042%percent0.0420.042\%0.042 %) of the
pNsubscriptğ‘ğ‘p_{N}italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
possible cases across the 700 simulations, and on average FETWFE identifies
98.5%percent98.598.5\%98.5 % (0.096%percent0.0960.096\%0.096 %) of the true
restrictions.

###  7.3 Asymptotic Distribution

Finally we investigate the asymptotic distribution of the FETWFE estimators.
On each simulation, we estimate nominal asymptotic 95%percent9595\%95 %
confidence intervals for the cohort average treatment effects using (6.6) and
the variance estimator from Theorem 6.4(a). In the first simulation study, we
find coverage rates of 0.791 for the r=2ğ‘Ÿ2r=2italic_r = 2 cohort (standard
error 0.015), 0.884 for the r=3ğ‘Ÿ3r=3italic_r = 3 cohort (standard error
0.012), 0.8540.8540.8540.854 (0.013) for the r=4ğ‘Ÿ4r=4italic_r = 4 cohort,
0.8030.8030.8030.803 (0.015) for the r=5ğ‘Ÿ5r=5italic_r = 5 cohort, and
0.8500.8500.8500.850 (0.014) for the r=6ğ‘Ÿ6r=6italic_r = 6 cohort. We see
that the coverage is unsatisfactory for FETWFE in this relatively small sample
size, where in expectation 20 units are observed in each cohort.

We also estimate conservative confidence intervals for the average treatment
effect with the conservative variance estimator from Theorem 6.4(c), yielding
a coverage rate of 0.993 (0.001). That is, the conservative confidence
intervals seem to achieve the desired coverage level in practice, even though
the asymptotic distribution of the test statistic is not known to be Gaussian
(merely subgaussian).

Lastly, we examine the non-conservative estimator from Theorem 6.4(b): on each
simulation study, we generate Nğ‘Nitalic_N independent unlabeled samples where
only cohort assignments (drawn from the same distribution as the Nğ‘Nitalic_N
labeled units) are observed, and we use these to estimate asymptotically exact
confidence intervals for the average treatment effect. The resulting coverage
is 0.986 (0.001). The coverage may be better for the average treatment effect
than the cohort average treatment effects because the number of observations
that are relevant for estimating the overall average treatment effect is much
larger than that for each of the cohort average treatment effects.

In the second simulation study, described previously in Section 7.2, we find
coverage rates of 0.944 (0.009) for the r=2ğ‘Ÿ2r=2italic_r = 2 cohort, 0.941
(0.009) for the r=3ğ‘Ÿ3r=3italic_r = 3 cohort, and 0.930 (0.010) for the third
cohort. The conservative confidence intervals for the average treatment
effects have coverage 0.997 (0.001), and the asymptotically exact confidence
intervals have coverage 0.973 (0.002). Overall, the coverage rates are close
to the nominal 95%percent9595\%95 % level in this finite Nğ‘Nitalic_N setting.
This is especially promising because we are using heuristics to solve the
FETWFE optimization problem, as discussed in Remark 5.2.

##  8 Empirical Application

We analyze the data from Stevenson and Wolfers (2006), as collected in the
divorce data set from Flack and Jee (2020). Stevenson and Wolfers estimate the
causal effect of unilateral or â€œno-fault" divorce laws on suicide rates
among women. The data set consists of observations from N=51ğ‘51N=51italic_N =
51 states (including the District of Columbia) for T=33ğ‘‡33T=33italic_T = 33
years, along with demographic covariates. The response variable is the
aggregate state suicide rate among women by year (as in the first column of
Table 1 of Stevenson and Wolfers 2006). See Stevenson and Wolfers (2006) and
Goodman-Bacon (2021, Section III) for more details on the data.

We remove states treated at time T=1ğ‘‡1T=1italic_T = 1 from the data, leaving
N=42ğ‘42N=42italic_N = 42 observations. 5 states are never treated, and
R=12ğ‘…12R=12italic_R = 12 cohorts are treated at various times. Similarly to
the analysis in Goodman-Bacon (2021, Section IV(B)), we consider the time-
varying covariates murderrate (state female homicide rate), lnpersinc (natural
log of state personal income per capita), and afdcrolls (state welfare
participation rate), including the values from time t=1ğ‘¡1t=1italic_t = 1 as
time-invariant controls. However, murderrate is missing for some observations
at t=1ğ‘¡1t=1italic_t = 1 so is omitted, leaving
dN=2subscriptğ‘‘ğ‘2d_{N}=2italic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT = 2 covariates. In total, we have
Nâ¢T=1386ğ‘ğ‘‡1386NT=1386italic_N italic_T = 1386 observations and
pN=908subscriptğ‘ğ‘908p_{N}=908italic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT = 908 coefficients to estimate.

We estimate the variances Ïƒc2superscriptsubscriptğœğ‘2\sigma_{c}^{2}italic_Ïƒ
start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT (the variance of the unit random effects) and
Ïƒ2superscriptğœ2\sigma^{2}italic_Ïƒ start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT (the variance of the added noise) using the estimators
from Pesaran (2015, Section 26.5.1) with ridge regression. We use FETWFE with
q=0.5ğ‘0.5q=0.5italic_q = 0.5 to estimate the marginal average treatment
effects, again leveraging the R grpreg package as in the simulation studies
and selecting Î»Nsubscriptğœ†ğ‘\lambda_{N}italic_Î» start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT by BIC. We estimate that the overall average
percent change to the suicide rate for women is âˆ’3.76%percent3.76-3.76\%\-
3.76 %, which is similar to the estimate of âˆ’2.52%percent2.52-2.52\%\- 2.52
% (standard error 1.09%percent1.091.09\%1.09 %) that Goodman-Bacon (2021)
calculates when using similar controls. Applying Theorem 6.4(c), we estimate a
conservative standard error of 4.70%percent4.704.70\%4.70 %, yielding a
conservative 95%percent9595\%95 % confidence interval of
(âˆ’12.97%,5.45%)percent12.97percent5.45(-12.97\%,5.45\%)( - 12.97 % , 5.45 %
) for the average treatment effect.

In Table 3 we present point estimates for the estimated average treatment
effects for each of the cohorts. (We omit standard errors since the individual
cohorts have very small sample sizes.) We estimate that four cohorts have non-
zero treatment effects, with the 1970 cohort (consisting of California and
Iowa) having by far the largest treatment effect estimate. We emphasize that
these individual estimates are likely less reliable than the average treatment
effect estimate since most cohorts have a small number of units.

Table 3: Cohort average treatment effect estimates from the empirical application in Section 8, targeting estimand Ï„ATTâ¢(r)subscriptğœATTğ‘Ÿ\tau_{\text{ATT}}(r)italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r ) as defined in (4.10). Cohort | Ï„^ATTâ¢(r)subscript^ğœATTğ‘Ÿ\hat{\tau}_{\text{ATT}}(r)over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r )  
---|---  
1969 | 0%percent00\%0 %  
1970 | -40.142%percent40.14240.142\%40.142 %  
1971 | 0%percent00\%0 %  
1972 | 0%percent00\%0 %  
1973 | -3.466%percent3.4663.466\%3.466 %  
1974 | 0%percent00\%0 %  
1975 | 0%percent00\%0 %  
1976 | -4.703%percent4.7034.703\%4.703 %  
1977 | -5.338%percent5.3385.338\%5.338 %  
1980 | 0%percent00\%0 %  
1984 | 0%percent00\%0 %  
1985 | 0%percent00\%0 %  
  
##  9 Conclusion

In this work, we have proposed the fused extended two-way fixed effects
estimator for difference-in-differences with staggered adoptions. Our
estimator leverages the fact that the extended two-way fixed effects estimator
includes coefficients that are likely to be similar (for example, because of
their proximity in time), but it selects appropriate restrictions
automatically rather than relying on hand-selected restrictions, which could
be biased. FETWFE retains the asymptotic unbiasedness (and normality) of ETWFE
but leverages sparsity for large efficiency gains. In particular, we showed
that our estimator is consistent, selection consistent, asymptotically
Gaussian, and has an oracle property for several classes of heterogeneous
marginal and conditional average treatment effects. Finally, we demonstrated
the usefulness of FETWFE in practice in both simulation studies and an
empirical application.

###  9.1 Future Work

Throughout the paper we have mentioned places where our work might be
relatively straightforward to extend. Here we specify some other possible
extensions. It would be useful to develop theory allowing for FETWFE to be
estimated when the design matrix ğ’ğ’\boldsymbol{Z}bold_italic_Z is deficient
in column rank; for example, when pN>Nâ¢Tsubscriptğ‘ğ‘ğ‘ğ‘‡p_{N}>NTitalic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT > italic_N italic_T. One could
extend our method to this setting by suitably adapting the marginal bridge
estimator of Kock (2013), which involves a screening step to remove irrelevant
covariates before estimating a regression on the reduced design matrix in a
second step. This allows for consistency and asymptotic normality of the
second-step estimator under similar assumptions to those that we have used in
this work. Alternatively, consistency (but not asymptotic normality) could be
established under weaker assumptions in the q=1ğ‘1q=1italic_q = 1 case by
suitably adapting theory for lasso estimators like Corollary 2 from Negahban
etÂ al. (2012).

Another potentially useful extension would be relaxing the parallel trends
assumption to allow for heterogeneous trends as described in Wooldridge (2021,
Section 7.2). This requires adding extra parameters to the ETWFE estimator,
but FETWFE is well-poised to adapt to this setting because it can
automatically restrict to 0 any parameters that are added unnecessarily.

## Acknowledgement

I thank Jacob Bien for very helpful discussions that shaped the direction of
this work and edits to an early draft.

## Funding

This work was supported by the University of Southern California.

## References

  * Abadie [2005] A.Â Abadie.  Semiparametric difference-in-differences estimators.  _The review of economic studies_ , 72(1):1â€“19, 2005. 
  * Abadie and Imbens [2006] A.Â Abadie and G.Â W. Imbens.  Large sample properties of matching estimators for average treatment effects.  _econometrica_ , 74(1):235â€“267, 2006. 
  * Abrevaya etÂ al. [2015] J.Â Abrevaya, Y.-C. Hsu, and R.Â P. Lieli.  Estimating conditional average treatment effects.  _Journal of Business & Economic Statistics_, 33(4):485â€“505, 2015. 
  * Arkhangelsky and Imbens [2023] D.Â Arkhangelsky and G.Â Imbens.  Causal models for longitudinal and panel data: A survey.  Technical report, National Bureau of Economic Research, 2023. 
  * Ascarza [2018] E.Â Ascarza.  Retention futility: Targeting high-risk customers might be ineffective.  _Journal of Marketing Research_ , 55(1):80â€“98, 2018. 
  * Athey and Imbens [2016] S.Â Athey and G.Â Imbens.  Recursive partitioning for heterogeneous causal effects: Table 1.  _Proceedings of the National Academy of Sciences_ , 113(27):7353â€“7360, May 2016.  doi: 10.1073/pnas.1510489113. 
  * Athey and Imbens [2006] S.Â Athey and G.Â W. Imbens.  Identification and inference in nonlinear difference-in-differences models.  _Econometrica_ , 74(2):431â€“497, 2006. 
  * Athey and Imbens [2022] S.Â Athey and G.Â W. Imbens.  Design-based analysis in difference-in-differences settings with staggered adoption.  _Journal of Econometrics_ , 226(1):62â€“79, 2022\. 
  * Athey etÂ al. [2018] S.Â Athey, D.Â Blei, R.Â Donnelly, F.Â Ruiz, and T.Â Schmidt.  Estimating Heterogeneous Consumer Preferences for Restaurants and Travel Time Using Mobile Location Data.  _ArXiv e-prints_ , Jan. 2018. 
  * Ban and Kedagni [2022] K.Â Ban and D.Â Kedagni.  Generalized difference-in-differences models: Robust bounds.  _arXiv preprint arXiv:2211.06710_ , 2022. 
  * Belloni etÂ al. [2014] A.Â Belloni, V.Â Chernozhukov, and C.Â Hansen.  Inference on treatment effects after selection among high-dimensional controls.  _The Review of Economic Studies_ , 81(2):608â€“650, 2014. 
  * Bien [2016] J.Â Bien.  The simulator: an engine to streamline simulations.  _arXiv preprint arXiv:1607.00021_ , 2016. 
  * Bilinski and Hatfield [2018] A.Â Bilinski and L.Â A. Hatfield.  Seeking evidence of absence: Reconsidering tests of model assumptions.  _arXiv preprint arXiv:1805.03273_ , 2018. 
  * Blackwell etÂ al. [2024] M.Â Blackwell, A.Â Glynn, H.Â Hilbig, and C.Â H. Phillips.  Estimating controlled direct effects with panel data: An application to reducing support for discriminatory policies.  2024\. 
  * Bolger etÂ al. [2019] N.Â Bolger, K.Â S. Zee, M.Â Rossignac-Milon, and R.Â R. Hassin.  Causal processes in psychology are heterogeneous.  _Journal of Experimental Psychology: General_ , 148(4):601, 2019. 
  * Borusyak and Jaravel [2018] K.Â Borusyak and X.Â Jaravel.  _Revisiting event study designs_.  SSRN, 2018. 
  * Borusyak etÂ al. [2024] K.Â Borusyak, X.Â Jaravel, and J.Â Spiess.  Revisiting event study designs: Robust and efficient estimation.  _Review of Economic Studies_ , page rdae007, 2024. 
  * Bottou etÂ al. [2013] L.Â Bottou, J.Â Peters, J.Â QuiÃ±onero-Candela, D.Â X. Charles, D.Â M. Chickering, E.Â Portugaly, D.Â Ray, P.Â Simard, and E.Â Snelson.  Counterfactual reasoning and learning systems: The example of computational advertising.  _Journal of Machine Learning Research_ , 14(11), 2013. 
  * Brand and Xie [2010] J.Â E. Brand and Y.Â Xie.  Who benefits most from college? evidence for negative selection in heterogeneous economic returns to higher education.  _American sociological review_ , 75(2):273â€“302, 2010. 
  * Breen etÂ al. [2015] R.Â Breen, S.Â Choi, and A.Â Holm.  Heterogeneous causal effects and sample selection bias.  _Sociological Science_ , 2:351â€“369, 2015. 
  * Breheny and Huang [2009] P.Â Breheny and J.Â Huang.  Penalized methods for bi-level variable selection.  _Statistics and its interface_ , 2(3):369, 2009\. 
  * Breheny and Huang [2015] P.Â Breheny and J.Â Huang.  Group descent algorithms for nonconvex penalized linear and logistic regression models with grouped predictors.  _Statistics and Computing_ , 25:173â€“187, 2015. 
  * Brown and Butts [2022] N.Â Brown and K.Â Butts.  A Unified Framework for Dynamic Treatment Effect Estimation in Interactive Fixed Effect Models.  Working Paper 1495, Economics Department, Queenâ€™s University, Nov. 2022\.  URL https://ideas.repec.org/p/qed/wpaper/1495.html. 
  * Caetano etÂ al. [2022] C.Â Caetano, B.Â Callaway, S.Â Payne, and H.Â S. Rodrigues.  Difference in differences with time-varying covariates.  _arXiv preprint arXiv:2202.02903_ , 2022. 
  * Callaway [2023] B.Â Callaway.  _Handbook of Labor, Human Resources and Population Economics_ , chapter Difference-in-Differences for Policy Evaluation, pages 1â€“61.  Springer International Publishing, 2023. 
  * Callaway and Karami [2023] B.Â Callaway and S.Â Karami.  Treatment effects in interactive fixed effects models with a small number of time periods.  _Journal of Econometrics_ , 233(1):184â€“208, 2023\. 
  * Callaway and Li [2023] B.Â Callaway and T.Â Li.  Policy evaluation during a pandemic.  _Journal of Econometrics_ , 236(1):105454, 2023\. 
  * Callaway and Santâ€™Anna [2022] B.Â Callaway and P.Â Santâ€™Anna.  Preâ€“testing in a did setup using the did package.  _Vignette URL https://bcallaway11. github. io/did/articles/pre-testing. html_ , 2022. 
  * Callaway and Santâ€™Anna [2021] B.Â Callaway and P.Â H. Santâ€™Anna.  Difference-in-differences with multiple time periods.  _Journal of Econometrics_ , 225(2):200â€“230, 2021\. 
  * CandÃ¨s etÂ al. [2018] E.Â CandÃ¨s, Y.Â Fan, L.Â Janson, and J.Â Lv.  Panning for gold: â€˜model-Xâ€™ knockoffs for high dimensional controlled variable selection.  _Journal of the Royal Statistical Society. Series B: Statistical Methodology_ , 80(3):551â€“577, 2018.  ISSN 14679868.  doi: 10.1111/rssb.12265.  URL https://rss-onlinelibrary-wiley-com.libproxy1.usc.edu/doi/pdf/10.1111/rssb.12265. 
  * Chang [2020] N.-C. Chang.  Double/debiased machine learning for difference-in-differences models.  _The Econometrics Journal_ , 23(2):177â€“191, 2020\. 
  * Chernozhukov etÂ al. [2023] V.Â Chernozhukov, D.Â Chetverikov, and Y.Â Koike.  Nearly optimal central limit theorem and bootstrap approximations in high dimensions.  _The Annals of Applied Probability_ , 33(3):2374â€“2425, 2023. 
  * Chiu etÂ al. [2023] A.Â Chiu, X.Â Lan, Z.Â Liu, and Y.Â Xu.  What to do (and not to do) with causal panel analysis under parallel trends: Lessons from a large reanalysis study.  _Available at SSRN 4490035_ , 2023. 
  * Cinelli etÂ al. [2022] C.Â Cinelli, A.Â Forney, and J.Â Pearl.  A crash course in good and bad controls.  _Sociological Methods & Research_, page 00491241221099552, 2022\. 
  * DasGupta [2008] A.Â DasGupta.  _Asymptotic theory of statistics and probability_ , volume 180.  Springer, 2008. 
  * DeÂ Chaisemartin and dâ€™Haultfoeuille [2020] C.Â DeÂ Chaisemartin and X.Â dâ€™Haultfoeuille.  Two-way fixed effects estimators with heterogeneous treatment effects.  _American Economic Review_ , 110(9):2964â€“2996, 2020. 
  * deÂ Chaisemartin and Dâ€™HaultfÅ“uille [2023] C.Â deÂ Chaisemartin and X.Â Dâ€™HaultfÅ“uille.  Difference-in-differences for simple and complex natural experiments.  _Available at SSRN_ , November 2023.  URL https://ssrn.com/abstract=4487202. 
  * DeÂ Chaisemartin and dâ€™Haultfoeuille [2023] C.Â DeÂ Chaisemartin and X.Â dâ€™Haultfoeuille.  Two-way fixed effects and differences-in-differences with heterogeneous treatment effects: A survey.  _The Econometrics Journal_ , 26(3):C1â€“C30, 2023\. 
  * Dette [2020] H.Â Dette.  Difference-in-differences estimation under non-parallel trends.  2020\. 
  * Ding [2024] P.Â Ding.  Linear model and extensions.  _arXiv preprint arXiv:2401.00649_ , 2024. 
  * Ding and Li [2019] P.Â Ding and F.Â Li.  A bracketing relationship between difference-in-differences and lagged-dependent-variable adjustment.  _Political Analysis_ , 27(4):605â€“615, 2019. 
  * Djebbari and Smith [2008] H.Â Djebbari and J.Â Smith.  Heterogeneous impacts in progresa.  _Journal of Econometrics_ , 145(1-2):64â€“80, 2008\. 
  * Ellickson etÂ al. [2022] P.Â B. Ellickson, W.Â Kar, and J.Â C. ReederÂ III.  Estimating marketing component effects: Double machine learning from targeted digital promotions.  _Marketing Science_ , 2022. 
  * Fan and Li [2001] J.Â Fan and R.Â Li.  Variable selection via nonconcave penalized likelihood and its oracle properties.  _Journal of the American statistical Association_ , 96(456):1348â€“1360, 2001. 
  * Fan and Peng [2004] J.Â Fan and H.Â Peng.  Nonconcave penalized likelihood with a diverging number of parameters.  2004\. 
  * Fan etÂ al. [2022] Q.Â Fan, Y.-C. Hsu, R.Â P. Lieli, and Y.Â Zhang.  Estimation of conditional average treatment effects with high-dimensional data.  _Journal of Business & Economic Statistics_, 40(1):313â€“327, 2022. 
  * Farrell [2015] M.Â H. Farrell.  Robust inference on average treatment effects with possibly more covariates than observations.  _Journal of Econometrics_ , 189(1):1â€“23, 2015\. 
  * Farrell etÂ al. [2021] M.Â H. Farrell, T.Â Liang, and S.Â Misra.  Deep neural networks for estimation and inference.  _Econometrica_ , 89(1):181â€“213, 2021. 
  * Feinstein etÂ al. [1972] A.Â R. Feinstein, J.Â F. Rubinstein, and W.Â A. Ramshaw.  Estimating prognosis with the aid of a conversational-mode computer program.  _Annals of Internal Medicine_ , 76(6):911â€“921, 1972. 
  * Flack and Jee [2020] E.Â Flack and E.Â Jee.  _bacondecomp: Goodman-Bacon Decomposition_ , 2020.  URL https://CRAN.R-project.org/package=bacondecomp.  R package version 0.1.1. 
  * Florens etÂ al. [2008] J.-P. Florens, J.Â J. Heckman, C.Â Meghir, and E.Â Vytlacil.  Identification of treatment effects using control functions in models with continuous, endogenous treatment and heterogeneous effects.  _Econometrica_ , 76(5):1191â€“1206, 2008. 
  * Foster etÂ al. [2011] J.Â C. Foster, J.Â M. Taylor, and S.Â J. Ruberg.  Subgroup identification from randomized clinical trial data.  _Statistics in medicine_ , 30(24):2867â€“2880, 2011\. 
  * Frankovich etÂ al. [2011] J.Â Frankovich, C.Â A. Longhurst, and S.Â M. Sutherland.  Evidence-based medicine in the emr era.  _N Engl J Med_ , 365(19):1758â€“1759, 2011. 
  * Gao etÂ al. [2022] W.Â Gao, F.Â Xu, and Z.-H. Zhou.  Towards convergence rate analysis of random forests for classification.  _Artificial Intelligence_ , 313:103788, 2022. 
  * GarcÃ­a-PortuguÃ©s [2023] E.Â GarcÃ­a-PortuguÃ©s.  _Notes for Nonparametric Statistics_.  2023\.  URL https://bookdown.org/egarpor/NP-UC3M/.  Version 6.9.0. ISBN 978-84-09-29537-1. 
  * Gavrilova etÂ al. [2023] E.Â Gavrilova, A.Â LangÃ¸rgen, and F.Â Zoutman.  Dynamic causal forests, with an application to payroll tax incidence in norway, 2023. 
  * Gelman and VÃ¡kÃ¡r [2021] A.Â Gelman and M.Â VÃ¡kÃ¡r.  Slamming the sham: A bayesian model for adaptive adjustment with noisy control data.  _Statistics in medicine_ , 40(15):3403â€“3424, 2021\. 
  * Ghanem etÂ al. [2024] D.Â Ghanem, P.Â H.Â C. Santâ€™Anna, and K.Â WÃ¼thrich.  Selection and parallel trends, 2024.  URL https://arxiv.org/abs/2203.09001. 
  * Goodman-Bacon [2021] A.Â Goodman-Bacon.  Difference-in-differences with variation in treatment timing.  _Journal of Econometrics_ , 225(2):254â€“277, 2021\. 
  * Grimmer etÂ al. [2017] J.Â Grimmer, S.Â Messing, and S.Â J. Westwood.  Estimating heterogeneous treatment effects and the effects of heterogeneous treatments with ensemble methods.  _Political Analysis_ , 25(4):413â€“434, 2017. 
  * GÃ¼ngÃ¶r [2007] A.Â D. GÃ¼ngÃ¶r.  Some bounds for the product of singular values.  _Int. J. Contemp. Math. Sciences_ , 2(26):1285â€“1292, 2007. 
  * Ham and Miratrix [2022] D.Â W. Ham and L.Â Miratrix.  Benefits and costs of matching prior to a difference in differences analysis when parallel trends does not hold.  _arXiv preprint arXiv:2205.08644_ , 2022. 
  * Hastie etÂ al. [2015] T.Â Hastie, R.Â Tibshirani, and M.Â Wainwright.  Statistical learning with sparsity.  _Monographs on statistics and applied probability_ , 143:143, 2015. 
  * Hatamyar etÂ al. [2023] J.Â Hatamyar, N.Â Kreif, R.Â Rocha, and M.Â Huber.  Machine learning for staggered difference-in-differences and dynamic treatment effect heterogeneity, 2023.  URL https://arxiv.org/abs/2310.11962. 
  * Heckman etÂ al. [1997] J.Â J. Heckman, H.Â Ichimura, and P.Â E. Todd.  Matching as an econometric evaluation estimator: Evidence from evaluating a job training programme.  _The review of economic studies_ , 64(4):605â€“654, 1997. 
  * Heckman etÂ al. [1998] J.Â J. Heckman, H.Â Ichimura, J.Â A. Smith, and P.Â E. Todd.  Characterizing selection bias using experimental data, 1998. 
  * Heiler and Mareckova [2021] P.Â Heiler and J.Â Mareckova.  Shrinkage for categorical regressors.  _Journal of Econometrics_ , 223(1):161â€“189, 2021\. 
  * Henderson and Sperlich [2022] D.Â J. Henderson and S.Â Sperlich.  A complete framework for model-free difference-in-differences estimation.  _Available at SSRN: https://ssrn.com/abstract=4300808_ , (No. 15799), 2022.  URL http://dx.doi.org/10.2139/ssrn.4300808. 
  * Hitsch and Misra [2018] G.Â J. Hitsch and S.Â Misra.  Heterogeneous treatment effects and optimal targeting policy evaluation.  _Available at SSRN 3111957_ , 2018. 
  * HÃ¶fling etÂ al. [2010] H.Â HÃ¶fling, H.Â Binder, and M.Â Schumacher.  A coordinate-wise optimization algorithm for the fused lasso.  _arXiv preprint arXiv:1011.6409_ , 2010. 
  * Horn and Johnson [1991] R.Â A. Horn and C.Â R. Johnson.  _Topics in Matrix Analysis_.  Cambridge University Press, 1991.  doi: 10.1017/CBO9780511840371. 
  * Huang etÂ al. [2008] J.Â Huang, J.Â L. Horowitz, and S.Â Ma.  Asymptotic properties of bridge estimators in sparse high-dimensional regression models.  _Annals of Statistics_ , 36(2):587â€“613, 2008\.  ISSN 00905364.  doi: 10.1214/009053607000000875. 
  * Imai and Kim [2019] K.Â Imai and I.Â S. Kim.  When should we use unit fixed effects regression models for causal inference with longitudinal data?  _American Journal of Political Science_ , 63(2):467â€“490, 2019. 
  * Imai and Strauss [2011] K.Â Imai and A.Â Strauss.  Estimation of heterogeneous treatment effects from randomized experiments, with application to the optimal planning of the get-out-the-vote campaign.  _Political Analysis_ , 19(1):1â€“19, 2011. 
  * Imai etÂ al. [2023] K.Â Imai, I.Â S. Kim, and E.Â H. Wang.  Matching methods for causal inference with time-series cross-sectional data.  _American Journal of Political Science_ , 67(3):587â€“605, 2023. 
  * Imbens and Rubin [2015] G.Â Imbens and D.Â B. Rubin.  _Causal inference for statistics, social, and biomedical sciences: an introduction_.  Cambridge University Press, 2015. 
  * Imbens and Wooldridge [2009] G.Â W. Imbens and J.Â M. Wooldridge.  Recent developments in the econometrics of program evaluation.  _Journal of economic literature_ , 47(1):5â€“86, 2009. 
  * Kaddoura and Westerlund [2022] Y.Â Kaddoura and J.Â Westerlund.  Estimation of panel data models with random interactive effects and multiple structural breaks when t is fixed.  _Journal of Business & Economic Statistics_, pages 1â€“13, 2022. 
  * Kahn-Lang and Lang [2020] A.Â Kahn-Lang and K.Â Lang.  The promise and pitfalls of differences-in-differences: Reflections on 16 and pregnant and other applications.  _Journal of Business & Economic Statistics_, 38(3):613â€“620, 2020. 
  * Kock [2013] A.Â B. Kock.  Oracle efficient variable selection in random and fixed effects panel data models.  _Econometric Theory_ , 29(1):115â€“152, 2013. 
  * Kwon [2021] S.Â Kwon.  Optimal shrinkage estimation of fixed effects in linear panel data models.  _EliScholarâ€“A Digital Platform for Scholarly Publishing at Yal e_ , pageÂ 1, 2021. 
  * Lechner etÂ al. [2011] M.Â Lechner etÂ al.  The estimation of causal effects by difference-in-difference methods.  _Foundations and TrendsÂ® in Econometrics_ , 4(3):165â€“224, 2011. 
  * Lehmann [1999] E.Â L. Lehmann.  _Elements of large-sample theory_.  Springer, 1999. 
  * Lesko [2007] L.Â Lesko.  Personalized medicine: elusive dream or imminent reality?  _Clinical Pharmacology & Therapeutics_, 81(6):807â€“816, 2007. 
  * Levy and Abramovich [2023] T.Â Levy and F.Â Abramovich.  Generalization error bounds for multiclass sparse linear classifiers.  _Journal of Machine Learning Research_ , 24(151):1â€“35, 2023. 
  * Lindner and McConnell [2019] S.Â Lindner and K.Â J. McConnell.  Difference-in-differences and matching on outcomes: a tale of two unobservables.  _Health Services and Outcomes Research Methodology_ , 19:127â€“144, 2019. 
  * Lopes [2022] M.Â E. Lopes.  Central limit theorem and bootstrap approximation in high dimensions: Near 1/n rates via implicit smoothing.  _The Annals of Statistics_ , 50(5):2492â€“2513, 2022. 
  * Manski and Pepper [2018] C.Â F. Manski and J.Â V. Pepper.  How do right-to-carry laws affect crime rates? coping with ambiguity using bounded-variation assumptions.  _Review of Economics and Statistics_ , 100(2):232â€“244, 2018. 
  * Marchenko and Pastur [1967] V.Â A. Marchenko and L.Â A. Pastur.  Distribution of eigenvalues for some sets of random matrices.  _Matematicheskii Sbornik_ , 114(4):507â€“536, 1967\. 
  * Marx etÂ al. [2024] P.Â Marx, E.Â Tamer, and X.Â Tang.  Parallel trends and dynamic choices.  _Journal of Political Economy Microeconomics_ , 2(1):129â€“171, 2024. 
  * McCullagh [1980] P.Â McCullagh.  Regression models for ordinal data.  _Journal of the Royal Statistical Society: Series B (Methodological)_ , 42(2):109â€“127, 1980. 
  * Meinshausen and BÃ¼hlmann [2006] N.Â Meinshausen and P.Â BÃ¼hlmann.  High-dimensional graphs and variable selection with the lasso.  2006\. 
  * Meyer [1995] B.Â D. Meyer.  Natural and quasi-experiments in economics.  _Journal of business & economic statistics_, 13(2):151â€“161, 1995. 
  * Morgan [2001] S.Â L. Morgan.  Counterfactuals, causal effect heterogeneity, and the catholic school effect on learning.  _Sociology of education_ , pages 341â€“374, 2001. 
  * Murphy etÂ al. [2016] M.Â Murphy, S.Â Redding, and J.Â Twyman.  _Handbook on personalized learning for states, districts, and schools_.  IAP, 2016. 
  * Negahban etÂ al. [2012] S.Â N. Negahban, P.Â Ravikumar, M.Â J. Wainwright, and B.Â Yu.  A unified framework for high-dimensional analysis of m-estimators with decomposable regularizers.  2012\. 
  * Nie and Wager [2021] X.Â Nie and S.Â Wager.  Quasi-oracle estimation of heterogeneous treatment effects.  _Biometrika_ , 108(2):299â€“319, 2021. 
  * Nie etÂ al. [2021] X.Â Nie, C.Â Lu, and S.Â Wager.  Nonparametric heterogeneous treatment effect estimation in repeated cross sectional designs, 2021.  URL https://arxiv.org/abs/1905.11622. 
  * Park and Tchetgen [2023] C.Â Park and E.Â T. Tchetgen.  A universal difference-in-differences approach for causal inference.  2023\.  URL https://arxiv.org/abs/2212.13641. 
  * Park and Yamauchi [2023] J.Â H. Park and S.Â Yamauchi.  Change-point detection and regularization in time series cross-sectional data analysis.  _Political Analysis_ , 31(2):257â€“277, 2023. 
  * Pesaran [2015] M.Â H. Pesaran.  _Time Series and Panel Data Econometrics_.  Number 9780198759980 in OUP Catalogue. Oxford University Press, 2015.  URL https://ideas.repec.org/b/oxp/obooks/9780198759980.html. 
  * Rambachan and Roth [2023] A.Â Rambachan and J.Â Roth.  A more credible approach to parallel trends.  _Review of Economic Studies_ , page rdad018, 2023. 
  * Roth [2022] J.Â Roth.  Pretest with caution: Event-study estimates after testing for parallel trends.  _American Economic Review: Insights_ , 4(3):305â€“322, 2022. 
  * Roth and Santâ€™Anna [2023] J.Â Roth and P.Â H. Santâ€™Anna.  When is parallel trends sensitive to functional form?  _Econometrica_ , 91(2):737â€“747, 2023. 
  * Roth etÂ al. [2023] J.Â Roth, P.Â H. Santâ€™Anna, A.Â Bilinski, and J.Â Poe.  Whatâ€™s trending in difference-in-differences? a synthesis of the recent econometrics literature.  _Journal of Econometrics_ , 2023. 
  * Rothbard etÂ al. [2023] S.Â Rothbard, J.Â C. Etheridge, and E.Â J. Murray.  A tutorial on applying the difference-in-differences method to health data.  _Current Epidemiology Reports_ , pages 1â€“11, 2023. 
  * Santâ€™Anna and Zhao [2020] P.Â H. Santâ€™Anna and J.Â Zhao.  Doubly robust difference-in-differences estimators.  _Journal of Econometrics_ , 219(1):101â€“122, 2020\. 
  * Semenova and Chernozhukov [2021] V.Â Semenova and V.Â Chernozhukov.  Debiased machine learning of conditional average treatment effects and other causal functions.  _The Econometrics Journal_ , 24(2):264â€“289, 2021\. 
  * Shaikh and Toulis [2021] A.Â M. Shaikh and P.Â Toulis.  Randomization tests in observational studies with staggered adoption of treatment.  _Journal of the American Statistical Association_ , 116(536):1835â€“1848, 2021. 
  * Stevenson and Wolfers [2006] B.Â Stevenson and J.Â Wolfers.  Bargaining in the shadow of the law: Divorce laws and family distress.  _The Quarterly Journal of Economics_ , 121(1):267â€“288, 2006. 
  * Sun and Abraham [2021] L.Â Sun and S.Â Abraham.  Estimating dynamic treatment effects in event studies with heterogeneous treatment effects.  _Journal of Econometrics_ , 225(2):175â€“199, 2021\. 
  * Sun and Shapiro [2022] L.Â Sun and J.Â M. Shapiro.  A linear panel model with heterogeneous coefficients and variation in exposure.  _Journal of Economic Perspectives_ , 36(4):193â€“204, 2022. 
  * Tibshirani [1996] R.Â Tibshirani.  Regression Shrinkage and Selection via the Lasso.  _Journal of the Royal Statistical Society. Series B: Statistical Methodology_ , 58(1):267â€“288, 1996. 
  * Tibshirani etÂ al. [2005] R.Â Tibshirani, M.Â Saunders, S.Â Rosset, J.Â Zhu, and K.Â Knight.  Sparsity and smoothness via the fused lasso.  _Journal of the Royal Statistical Society: Series B (Statistical Methodology)_ , 67(1):91â€“108, 2005. 
  * Tibshirani and Taylor [2011] R.Â J. Tibshirani and J.Â Taylor.  The solution path of the generalized lasso.  _The annals of statistics_ , 39(3):1335â€“1371, 2011. 
  * vanÂ der Vaart [2000] A.Â vanÂ der Vaart.  _Asymptotic Statistics_.  Asymptotic Statistics. Cambridge University Press, 2000.  ISBN 9780521784504.  URL https://books.google.com/books?id=UEuQEM5RjWgC. 
  * Vershynin [2012] R.Â Vershynin.  _Introduction to the non-asymptotic analysis of random matrices_ , pages 210â€“268.  Cambridge University Press, 2012.  doi: 10.1017/CBO9780511794308.006. 
  * Vershynin [2018] R.Â Vershynin.  _High-Dimensional Probability: An Introduction with Applications in Data Science_.  Cambridge Series in Statistical and Probabilistic Mathematics. Cambridge University Press, 2018.  ISBN 9781108415194.  URL https://books.google.com/books?id=J-VjswEACAAJ. 
  * Viallon etÂ al. [2013] V.Â Viallon, S.Â Lambert-Lacroix, H.Â HÃ¶fling, and F.Â Picard.  Adaptive generalized fused-lasso: Asymptotic properties and applications.  2013\. 
  * Viallon etÂ al. [2016] V.Â Viallon, S.Â Lambert-Lacroix, H.Â Hoefling, and F.Â Picard.  On the robustness of the generalized fused lasso to prior specifications.  _Statistics and Computing_ , 26(1-2):285â€“301, 2016. 
  * Wager and Athey [2018] S.Â Wager and S.Â Athey.  Estimation and Inference of Heterogeneous Treatment Effects using Random Forests.  _Journal of the American Statistical Association_ , 113(523):1228â€“1242, jul 2018.  ISSN 0162-1459.  doi: 10.1080/01621459.2017.1319839.  URL https://www.tandfonline.com/doi/full/10.1080/01621459.2017.1319839. 
  * Wasserman [2004] L.Â Wasserman.  _All of statistics: a concise course in statistical inference_ , volumeÂ 26.  Springer, 2004. 
  * Wing etÂ al. [2018] C.Â Wing, K.Â Simon, and R.Â A. Bello-Gomez.  Designing difference in difference studies: Best practices for public health policy research.  _Annual Review of Public Health_ , 39(1):453â€“469, 2018.  doi: 10.1146/annurev-publhealth-040617-013507.  URL https://doi.org/10.1146/annurev-publhealth-040617-013507.  PMID: 29328877. 
  * Winkelbeiner etÂ al. [2019] S.Â Winkelbeiner, S.Â Leucht, J.Â M. Kane, and P.Â Homan.  Evaluation of differences in individual treatment response in schizophrenia spectrum disorders: a meta-analysis.  _JAMA psychiatry_ , 76(10):1063â€“1073, 2019. 
  * Wooldridge [2021] J.Â M. Wooldridge.  Two-way fixed effects, the two-way mundlak regression, and difference-in-differences estimators.  _Available at SSRN 3906345_ , 2021. 
  * Xie etÂ al. [2012] Y.Â Xie, J.Â E. Brand, and B.Â Jann.  Estimating heterogeneous treatment effects with observational data.  _Sociological methodology_ , 42(1):314â€“347, 2012\. 
  * Xin etÂ al. [2014] B.Â Xin, Y.Â Kawahara, Y.Â Wang, and W.Â Gao.  Efficient generalized fused lasso and its application to the diagnosis of alzheimerâ€™s disease.  In _Proceedings of the AAAI Conference on Artificial Intelligence_ , volumeÂ 28, 2014. 
  * Yang etÂ al. [2020] J.Â Yang, D.Â Eckles, P.Â Dhillon, and S.Â Aral.  Targeting for long-term outcomes.  _arXiv preprint arXiv:2010.15835_ , 2020. 
  * Zhao and Yu [2006] P.Â Zhao and B.Â Yu.  On Model Selection Consistency of Lasso.  _Journal of Machine Learning Research_ , 7:2541â€“2563, 2006\. 
  * Zimmert [2020] M.Â Zimmert.  Efficient difference-in-differences estimation with high-dimensional common trend confounding, 2020.  URL https://arxiv.org/abs/1809.01643. 
  * Zou [2006] H.Â Zou.  The adaptive lasso and its oracle properties.  _J. Amer. Statist. Assoc._ , 101(476):1418â€“1429, 2006.  ISSN 0162-1459.  URL https://doi.org/10.1198/016214506000000735. 

In Appendix A we investigate in more detail the relatively plausibility of
conditional and marginal parallel trends, how Assumption (CIUN) interacts with
these assumptions, and how we can achieve consistency of FETWFE for marginal
average treatment effects under either form of parallel trends if (CIUN)
holds. We present additional results from the simulation studies from Section
7 in Appendix B. We state Theorem C.1, which Theorems 6.1, 6.2, 6.3, and 6.4
all depend on, in Appendix C, and we prove it in Appendix F. In Appendix D we
state Theorem D.1, which shows the consistency of FETWFE for broader classes
of estimators than those considered in Theorem 6.1. Theorem D.2 similarly
extends Theorem 6.4, and Theorem D.3 shows that two classes of conditional
treatment effect estimators are asymptotically Gaussian and provides
consistent variance estimators for constructing asymptotically valid
confidence intervals, analogously to Theorem D.2 for marginal treatment effect
estimators. We prove the results from Appendix D, along with Theorems 6.1,
6.3, and 6.4, in Appendix E. In Appendix G we provide proofs for results that
were stated but not proven in Appendix A and supporting results used in
Appendix E. We prove supporting results for Theorem C.1 in Appendix H.
Finally, in Appendix I we state and prove some technical lemmas.

##  Appendix A More on Parallel Trends and Assumption (CIUN)

In Section A.1 we discuss the plausibility of marginal and conditional
parallel trends in relation to an assumption of marginal or conditional
(respectively) independence of the treatment and the potential outcomes. The
latter assumptions imply the former, which motivates difference-in-differences
estimators like FETWFE as more plausible than identification strategies that
rely on stronger untestable assumptions.

We point out that no such strict hierarchy exists to relate marginal and
conditional parallel trends in Section A.2â€”there exist settings where either
assumption can hold without the other holding. Investigating this sheds light
on when conditional or marginal parallel trends may be more plausible. We
later show (Theorem A.5) that conditional parallel trends is necessary to
estimate conditional average treatment effects via FETWFE, but there are
estimators that are consistent for marginal average treatment effects under
either conditional or marginal parallel trends. So it is natural to wonder
what conditions allow an estimator to be consistent for marginal average
treatment effects under either assumption, and whether this might be possible
for FETWFE. In Section A.3 we explore when this might hold, ultimately
investigating Assumption (CIUN) in more detail and showing how it affects the
consistency of regression (1.5). These ideas underlie the proof of Theorem
6.1.

###  A.1 Relationships Between Unconfounded Treatment Assignment, Marginally
Randomized Treatment Assignment, and Parallel Trends Assumptions

In this section we present Proposition A.1, which relates the plausibility of
several assumptions on the potential outcomes. Ultimately, this motivates
difference-in-differences estimators like FETWFE as having more plausible
untestable assumptions than methods that rely on unconfoundedness (like
matching) or randomized assignment.

We consider an assumption of unconfoundedness of the untreated potential
outcomes, which we define in this setting as

| y~iâ¢tâ¢(0)âŸ‚âŸ‚Wiâˆ£ğ‘¿iiâˆˆ[N],tâˆˆ{1,â€¦,T}.formulae-sequenceperpendicular-toabsentperpendicular-tosubscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–ğ‘–delimited-[]ğ‘ğ‘¡1â€¦ğ‘‡\tilde{y}_{it}(0)\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}% \mkern 2.0mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$% \hss}\mkern 2.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp% $\hss}\mkern 2.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$% \scriptscriptstyle\perp$\hss}\mkern 2.0mu{\scriptscriptstyle\perp}}}W_{i}\ % \mid\ \boldsymbol{X}_{i}\qquad i\in[N],t\in\\{1,\ldots,T\\}.over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT ( 0 ) start_RELOP âŸ‚ âŸ‚ end_RELOP italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_i âˆˆ [ italic_N ] , italic_t âˆˆ { 1 , â€¦ , italic_T } . |  | (A.1)  
---|---|---|---  
  
This requires that treatment assignment is independent of the untreated
potential outcomes conditional on the time-invariant (pre-treatment)
covariates ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT. Abadie [2005, Section 3.2.2]
considered a similar assumption in the T=2ğ‘‡2T=2italic_T = 2 case. As we
discuss in more detail later in this section, it has previously been noted
that the assumption of unconfoundedness [Imbens and Rubin, 2015, Def. 3.6]
that is common in causal inference is a stronger assumption than (CCTS).

Sometimes unconfoundedness is taken to be a stronger assumption that all of
the potential outcomes are independent of treatment status conditional on
covariates; such a condition would imply (A.1). Shaikh and Toulis [2021,
Assumption 2.1] is one example of a work that uses such a stronger assumption
in a setting with continuous treatment status.

We note that different notions of unconfoundedness have been considered in the
difference-in-differences setting. For example, Imbens and Wooldridge [2009,
Section 6.5.4] consider unconfoundedness in a two-period difference-in-
differences setting with no covariates, where the lagged outcome is
conditioned on rather than covariates. Similarly, Callaway and Li [2023]
consider unconfoundedness conditional on several lagged time-varying
variables. Ding and Li [2019] and Lindner and McConnell [2019] consider an
ignorability condition where the untreated potential outcome is independent of
treatment assignment status conditional on covariates and the lagged outcome.

We also refer to an assumption of marginal independence of the untreated
potential outcomes and treatment status,

| y~iâ¢tâ¢(0)âŸ‚âŸ‚Wiiâˆˆ[N],tâˆˆ{1,â€¦,T}.formulae-sequenceperpendicular-toabsentperpendicular-tosubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–formulae-sequenceğ‘–delimited-[]ğ‘ğ‘¡1â€¦ğ‘‡\tilde{y}_{it}(0)\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}% \mkern 2.0mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$% \hss}\mkern 2.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp% $\hss}\mkern 2.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$% \scriptscriptstyle\perp$\hss}\mkern 2.0mu{\scriptscriptstyle\perp}}}W_{i}% \qquad i\in[N],t\in\\{1,\ldots,T\\}.over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT ( 0 ) start_RELOP âŸ‚ âŸ‚ end_RELOP italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_i âˆˆ [ italic_N ] , italic_t âˆˆ { 1 , â€¦ , italic_T } . |  | (A.2)  
---|---|---|---  
  
Completely randomized assignment, an assumption considered by, for example,
Athey and Imbens [2022, Assumption 1] and Roth and Santâ€™Anna [2023, Case 1],
is sufficient for (A.2).

Lastly, we say that (CCTS) or (CTS) holds in a transformation-invariant sense
if (3.1) or (3.2) (respectively) hold under any transformation
hâ¢(y~iâ¢tâ¢(r))â„subscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿh(\tilde{y}_{it}(r))italic_h ( over~
start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_t
end_POSTSUBSCRIPT ( italic_r ) ) of the potential outcomes such that the
expectations exist. Some works have expressed concern that parallel trends
assumptions are fragile because they may hold only if the response is not
transformed, or only under a specific transformation [Meyer, 1995, Athey and
Imbens, 2006, Kahn-Lang and Lang, 2020]. Roth and Santâ€™Anna [2023]
investigate in detail when marginal parallel trends assumptions are
transformation-invariant in the T=2ğ‘‡2T=2italic_T = 2 setting, and they point
out that their arguments extend straightforwardly to the arbitrary
Tğ‘‡Titalic_T setting as well as to conditional parallel trends assumptions.
Proposition A.1 explicitly draws attention to an implication of their
Propositions 3.1 and 3.2 when extended to these more general settings.

######  Proposition A.1.

Assume that the conditional expectations in (3.1) and (3.2) exist and are
finite.

  1. (a)

Unconfoundedness of the untreated potential outcomes is a strictly stronger
assumption than conditional parallel trends: (A.1) is sufficient for
Assumption CCTS to hold in a transformation-invariant sense, but (CCTS) does
not imply unconfoundedness of the untreated potential outcomes.

  2. (b)

Marginal independence of treatment status and the untreated potential outcomes
is a strictly stronger assumption than marginal parallel trends: (A.2) is
sufficient for Assumption CTS to hold in a transformation-invariant sense, but
(CTS) does not imply (A.2).

###### Proof.

  1. (a)

Under unconfoundedness (A.1), for any iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i
âˆˆ [ italic_N ], tâˆˆ{1,â€¦,T},râˆˆâ„›formulae-
sequenceğ‘¡1â€¦ğ‘‡ğ‘Ÿâ„›t\in\\{1,\ldots,T\\},r\in\mathcal{R}italic_t âˆˆ { 1 ,
â€¦ , italic_T } , italic_r âˆˆ caligraphic_R almost surely it holds that

| ğ”¼â¢[hâ¢(y~(iâ¢t)â¢(0))âˆ£Wi,ğ‘¿i]=ğ”¼â¢[hâ¢(y~(iâ¢t)â¢(0))âˆ£ğ‘¿i]ğ”¼delimited-[]conditionalâ„subscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalâ„subscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘¿ğ‘–\mathbb{E}[h(\tilde{y}_{(it)}(0))\mid W_{i},\boldsymbol{X}_{i}]=\mathbb{E}[h(% \tilde{y}_{(it)}(0))\mid\boldsymbol{X}_{i}]blackboard_E [ italic_h ( over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = blackboard_E [ italic_h ( over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) ) âˆ£ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] |  | (A.3)  
---|---|---|---  
  
for any arbitrary hâ¢(â‹…)â„â‹…h(\cdot)italic_h ( â‹… ) such that the above
expectation exists. For (CCTS) to hold with transformational invariance, we
need that for any hâ¢(â‹…)â„â‹…h(\cdot)italic_h ( â‹… ) such that the
expectations exist and any iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [
italic_N ], tâˆˆ{2,â€¦,T},râˆˆâ„›formulae-
sequenceğ‘¡2â€¦ğ‘‡ğ‘Ÿâ„›t\in\\{2,\ldots,T\\},r\in\mathcal{R}italic_t âˆˆ { 2 ,
â€¦ , italic_T } , italic_r âˆˆ caligraphic_R, almost surely

| ğ”¼â¢[hâ¢(y~(iâ¢t)â¢(0))âˆ’hâ¢(y~(iâ¢1)â¢(0))âˆ£Wi,ğ‘¿i]=ğ”¼â¢[hâ¢(y~(iâ¢t)â¢(0))âˆ’hâ¢(y~(iâ¢1)â¢(0))âˆ£ğ‘¿i].ğ”¼delimited-[]â„subscript~ğ‘¦ğ‘–ğ‘¡0conditionalâ„subscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–ğ”¼delimited-[]â„subscript~ğ‘¦ğ‘–ğ‘¡0conditionalâ„subscript~ğ‘¦ğ‘–10subscriptğ‘¿ğ‘–\mathbb{E}[h(\tilde{y}_{(it)}(0))-h(\tilde{y}_{(i1)}(0))\mid W_{i},\boldsymbol% {X}_{i}]=\mathbb{E}[h(\tilde{y}_{(it)}(0))-h(\tilde{y}_{(i1)}(0))\mid% \boldsymbol{X}_{i}].blackboard_E [ italic_h ( over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) ) - italic_h ( over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = blackboard_E [ italic_h ( over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) ) - italic_h ( over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) ) âˆ£ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] . |   
---|---|---  
  
But this is immediate from (A.3). We show that the reverse implication does
not hold by constructing a counterexample. (CCTS) can be rearranged as

| ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ£Wi,ğ‘¿i]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ£ğ‘¿i]=ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi,ğ‘¿i]âˆ’ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£ğ‘¿i]â¢âˆ€tâˆˆ[T].ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘¿ğ‘–for-allğ‘¡delimited-[]ğ‘‡\mathbb{E}[\tilde{y}_{(it)}(0)\mid W_{i},\boldsymbol{X}_{i}]-\mathbb{E}[\tilde% {y}_{(it)}(0)\mid\boldsymbol{X}_{i}]=\mathbb{E}[\tilde{y}_{(i1)}(0)\mid W_{i},% \boldsymbol{X}_{i}]-\mathbb{E}[\tilde{y}_{(i1)}(0)\mid\boldsymbol{X}_{i}]% \leavevmode\nobreak\ \forall t\in[T].blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] âˆ€ italic_t âˆˆ [ italic_T ] . |  | (A.4)  
---|---|---|---  
  
Suppose that for all tâˆˆ{1,2,â€¦,T}ğ‘¡12â€¦ğ‘‡t\in\\{1,2,\ldots,T\\}italic_t
âˆˆ { 1 , 2 , â€¦ , italic_T }, it holds that
ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ£Wi,ğ‘¿i]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ£ğ‘¿i]=fâ¢(Wi,ğ‘¿i)ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘¿ğ‘–ğ‘“subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–\mathbb{E}[\tilde{y}_{(it)}(0)\mid
W_{i},\boldsymbol{X}_{i}]-\mathbb{E}[\tilde%
{y}_{(it)}(0)\mid\boldsymbol{X}_{i}]=f(W_{i},\boldsymbol{X}_{i})blackboard_E [
over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t )
end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT ] - blackboard_E [ over~ start_ARG italic_y end_ARG
start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = italic_f (
italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) almost surely for an
arbitrary fâ¢(â‹…,â‹…)ğ‘“â‹…â‹…f(\cdot,\cdot)italic_f ( â‹… , â‹… ) that is
not identically 0. Then from (A.4) we see that (CCTS) will hold. However,
unconfoundedness does not hold since (A.3) with hâ¢(â‹…)â„â‹…h(\cdot)italic_h
( â‹… ) as the identity function is violated.

  2. (b)

This proof is similar. Under marginal independence of treatment status and the
untreated potential outcomes (A.2), for any
iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ],
tâˆˆ{1,â€¦,T},râˆˆâ„›formulae-
sequenceğ‘¡1â€¦ğ‘‡ğ‘Ÿâ„›t\in\\{1,\ldots,T\\},r\in\mathcal{R}italic_t âˆˆ { 1 ,
â€¦ , italic_T } , italic_r âˆˆ caligraphic_R almost surely it holds that

| ğ”¼â¢[hâ¢(y~(iâ¢t)â¢(0))âˆ£Wi]=ğ”¼â¢[hâ¢(y~(iâ¢t)â¢(0))]ğ”¼delimited-[]conditionalâ„subscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–ğ”¼delimited-[]â„subscript~ğ‘¦ğ‘–ğ‘¡0\mathbb{E}[h(\tilde{y}_{(it)}(0))\mid W_{i}]=\mathbb{E}[h(\tilde{y}_{(it)}(0))]blackboard_E [ italic_h ( over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = blackboard_E [ italic_h ( over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) ) ] |  | (A.5)  
---|---|---|---  
  
for any hâ¢(â‹…)â„â‹…h(\cdot)italic_h ( â‹… ) such that the expectation holds.
It is immediate that for any such hâ¢(â‹…)â„â‹…h(\cdot)italic_h ( â‹… ) and
any iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ],
tâˆˆ{2,â€¦,T},râˆˆâ„›formulae-
sequenceğ‘¡2â€¦ğ‘‡ğ‘Ÿâ„›t\in\\{2,\ldots,T\\},r\in\mathcal{R}italic_t âˆˆ { 2 ,
â€¦ , italic_T } , italic_r âˆˆ caligraphic_R, almost surely
ğ”¼â¢[hâ¢(y~(iâ¢t)â¢(0))âˆ’hâ¢(y~(iâ¢1)â¢(0))âˆ£Wi]=ğ”¼â¢[hâ¢(y~(iâ¢t)â¢(0))âˆ’hâ¢(y~(iâ¢1)â¢(0))]ğ”¼delimited-[]â„subscript~ğ‘¦ğ‘–ğ‘¡0conditionalâ„subscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ”¼delimited-[]â„subscript~ğ‘¦ğ‘–ğ‘¡0â„subscript~ğ‘¦ğ‘–10\mathbb{E}[h(\tilde{y}_{(it)}(0))-h(\tilde{y}_{(i1)}(0))\mid
W_{i}]=\mathbb{E}% [h(\tilde{y}_{(it)}(0))-h(\tilde{y}_{(i1)}(0))]blackboard_E
[ italic_h ( over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i
italic_t ) end_POSTSUBSCRIPT ( 0 ) ) - italic_h ( over~ start_ARG italic_y
end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) ) âˆ£
italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = blackboard_E [
italic_h ( over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i
italic_t ) end_POSTSUBSCRIPT ( 0 ) ) - italic_h ( over~ start_ARG italic_y
end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) ) ], so
(CTS) holds with transformational invariance. On the other hand, (CTS) can be
rearranged as

| ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ£Wi]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)]=ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi]âˆ’ğ”¼â¢[y~(iâ¢1)â¢(0)]âˆ€tâˆˆ[T].formulae-sequenceğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ”¼delimited-[]subscript~ğ‘¦ğ‘–10for-allğ‘¡delimited-[]ğ‘‡\mathbb{E}[\tilde{y}_{(it)}(0)\mid W_{i}]-\mathbb{E}[\tilde{y}_{(it)}(0)]=% \mathbb{E}[\tilde{y}_{(i1)}(0)\mid W_{i}]-\mathbb{E}[\tilde{y}_{(i1)}(0)]% \qquad\forall t\in[T].blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) ] = blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) ] âˆ€ italic_t âˆˆ [ italic_T ] . |  | (A.6)  
---|---|---|---  
  
If for all tâˆˆ{1,2,â€¦,T}ğ‘¡12â€¦ğ‘‡t\in\\{1,2,\ldots,T\\}italic_t âˆˆ { 1 ,
2 , â€¦ , italic_T } we have
ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ£Wi]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)]=gâ¢(Wi)ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0ğ‘”subscriptğ‘Šğ‘–\mathbb{E}[\tilde{y}_{(it)}(0)\mid
W_{i}]-\mathbb{E}[\tilde{y}_{(it)}(0)]=g(W_% {i})blackboard_E [ over~
start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t )
end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT ] - blackboard_E [ over~ start_ARG italic_y end_ARG
start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) ] = italic_g
( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) almost surely for
an arbitrary gâ¢(â‹…)ğ‘”â‹…g(\cdot)italic_g ( â‹… ) that is not identically 0,
then (A.6) holds but (A.5) with hâ¢(â‹…)â„â‹…h(\cdot)italic_h ( â‹… ) as the
identity function is violated. So (CTS) holds but marginal independence of
treatment status and the untreated potential outcomes does not.

âˆ

Since unconfoundedness often seems more plausible than marginal independence
of the potential outcomes and treatment status, Proposition A.1(a) and (b)
considered together suggest an intuition that conditional parallel trends may
often be more plausible than marginal parallel trends. Proposition A.1 also
points out that difference-in-differences estimators are strictly more robust
than identification strategies that rely on assumptions of completely
randomized assignment or unconfoundedness.

Proposition A.1(a) verifies that (CCTS) is a strictly weaker assumption than
unconfoundedness. As we mentioned earlier, this is a fairly straightforward
observation that has been noted before; for example, Abadie [2005], Heckman
etÂ al. [1997], and Heckman etÂ al. [1998] mention that this fact holds in the
T=2ğ‘‡2T=2italic_T = 2 case. Besides the previously mentioned intuition that
Proposition A.1(a) and (b) provide that conditional parallel trends may be
more plausible in many applications than marginal parallel trends, we also
draw attention to the facts in Proposition A.1(a) to point out explicitly that
difference-in-differences identification strategies like FETWFE that rely on
(CCTS) are more robust than methods like matching on time-invariant covariates
that rely on an unconfoundedness assumption [Abadie and Imbens, 2006, Imbens
and Rubin, 2015].

The implications of Proposition A.1(b) are analogous, and previous works have
also shown that random or â€œas good as random" treatment assignment is
sufficient for (CTS) [Athey and Imbens, 2022, Roth and Santâ€™Anna, 2023,
Ghanem etÂ al., 2024].

###  A.2 Neither Conditional Nor Marginal Parallel Trends is Strictly More
Plausible

Proposition A.1 showed that (CTS) and (CCTS) are strictly more plausible than
(respectively) marginal independence of the potential outcomes and treatment
and unconfoundedness. Theorem A.2 shows that (CTS) and (CCTS) cannot be
related in this wayâ€”neither is strictly more plausible than the other.

######  Theorem A.2.

Assume that the conditional expectations in (3.1) and (3.2) exist and are
finite. Neither of conditional parallel trends or marginal parallel trends is
a relaxation of the other: Assumption CCTS (3.1) (conditional parallel trends)
does not imply Assumption CTS (3.2) (marginal parallel trends), nor does (CTS)
imply (CCTS).

###### Proof.

Provided in Appendix G.1.

âˆ

We prove Theorem A.2 by providing counterexamples where one of the parallel
trends assumptions holds but the other does not. We briefly provide some
intuition behind the counterexamples here in order to highlight some of the
relative strengths and weaknesses of each assumption.

(CCTS) may hold when the time-invariant covariates have a time-varying effect
on the potential outcomes, while (CTS) will not hold. This seems plausible if
external conditions change that change the relevance of some features for the
response. Ham and Miratrix [2022] and Callaway and Karami [2023] touch on
closely related issues, investigating settings where parallel trends does not
hold because time-invariant confounders have time-varying effects on the
potential outcomes. We also expand on related ideas in Section A.3.

On the other hand, (CCTS) requires parallel trends to hold on every subgroup
of ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT. But (CTS) can hold if this is violated and
parallel trends holds merely on average across the distribution of the
covariates. That is, for any
râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 } âˆª
caligraphic_R, the quantity

| ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£ğ‘¿i]ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘¿ğ‘–\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=r,\boldsymbol{X}_% {i}]-\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid\boldsymbol{X}_{i}]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] |  | (A.7)  
---|---|---|---  
  
may be positive on some subgroups of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT if this is canceled out by (A.7) being negative on
other subgroups such that (3.2) holds after marginalizing the left side of
(3.1) across the distribution of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT conditional on
Wi=rsubscriptğ‘Šğ‘–ğ‘ŸW_{i}=ritalic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT = italic_r and the right side across the distribution of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT conditional on Wi=0subscriptğ‘Šğ‘–0W_{i}=0italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0. In this particular sense,
(CTS) allows for more variation in the time trends across the distribution of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT than (CCTS). We also emphasize that both (CCTS) and
(CTS) allow for heterogeneity in the sense that the values of
ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi,ğ‘¿i]ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid
W_{i},\boldsymbol{X}_{i}]blackboard_E [ over~ start_ARG italic_y end_ARG
start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~
start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 )
end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT ] and
ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£ğ‘¿i]ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘¿ğ‘–\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid\boldsymbol{X}_{i}]blackboard_E
[ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t )
end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT
( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT ] may vary with
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT.

However, if (3.1) does not hold, (3.2) holding exactly after marginalizing
(3.1) appropriately may seem somewhat implausible. Nonetheless, it could be
the case that (3.1) is not close to holding, but (3.2) approximately holds.
Relaxing (CTS) by allowing small violations has been considered in recent
works on sensitivity analyses for difference-in-differences estimation [Manski
and Pepper, 2018, Ban and Kedagni, 2022, Rambachan and Roth, 2023, Ghanem etÂ
al., 2024]. That said, Ghanem etÂ al. [2024, Section 7.2] point out that
adjusting for covariates (that is, performing a sensitivity analysis under an
assumption of conditional parallel trends that may not hold exactly) can
result in smaller plausible ranges of marginal average treatment effects.

Overall, this suggests an intuition that (CCTS) may be somewhat more plausible
in practice than (CTS), but since neither assumption nests the other, an ideal
estimator would be asymptotically unbiased under either assumption. We discuss
this in more detail in the next section.

###  A.3 Parallel Trends, Assumption (CIUN), and Regression (1.5)

Theorem A.2 motivates interest in estimators of marginal average treatment
effects that are consistent under either conditional or marginal parallel
trends. We have seen that Assumption (CIUN) is helpful for thisâ€”under the
conditions of Theorem 6.1, FETWFE consistently estimates heterogeneous
marginal average treatment effects under either conditional or marginal
parallel trends if (CIUN) holds. In this section we fill in more detail about
(CIUN), build some intuition for its role in the consistency of difference-in-
differences estimators, and establish the consistency of regression (1.5)
under (CIUN).

We first introduce a related assumption that, unlike (CIUN), is not directly
testable.

Assumption (CIU) (â€œconditional independence of trends of the untreated
potential outcomes"): Almost surely for all
râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 } âˆª
caligraphic_R, iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ], and
any tâˆˆ{2,â€¦,T}ğ‘¡2â€¦ğ‘‡t\in\\{2,\ldots,T\\}italic_t âˆˆ { 2 , â€¦ ,
italic_T },

| ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r]=ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿabsent\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}% =r\right]=\leavevmode\nobreak\ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] = | ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i].ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}% =r,\boldsymbol{X}_{i}\right].blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] . |   
---|---|---|---  
  
(CIU) is similar to (CIUN), but it requires the trends in the untreated
potential outcomes to be mean-independent of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT for units in all cohorts, so it cannot be tested.

It is immediate that (CCTS) and (CTS) are equivalent under (CIU).

######  Proposition A.3.

Under (CIU), conditional parallel trends (CCTS) and marginal parallel trends
(CTS) are equivalent.

###### Proof.

We can apply (CIU) on each side of (CTS) to immediately yield that for any
iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ],
râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R, and any tâ‰¥2ğ‘¡2t\geq
2italic_t â‰¥ 2,

| ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r]=ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿabsent\displaystyle\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=r]=% \leavevmode\nobreak\ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] = | ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0]ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0\displaystyle\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] |   
---|---|---|---  
| â‡”ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i]=iffğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–absent\displaystyle\iff\qquad\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W% _{i}=r,\boldsymbol{X}_{i}]=\leavevmode\nobreak\ â‡” blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = | ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i].ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–\displaystyle\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,% \boldsymbol{X}_{i}].blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] . |   
  
âˆ

One implication of Proposition A.3 is that any method that consistently
estimates the marginal average treatment effects under either (CCTS) or (CTS)
is consistent under both assumptions if (CIU) holds.

Although (CIUN) does not guarantee the equivalence of (CTS) and (CCTS), under
(CIUN) conditional and marginal parallel trends are still connected.

######  Proposition A.4.

Suppose (CIUN) holds. Then conditional parallel trends (CCTS) implies marginal
parallel trends (CTS).

###### Proof.

Applying (CIUN) to one side of (CCTS), we have that for any
iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ],
râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R, and any tâ‰¥2ğ‘¡2t\geq
2italic_t â‰¥ 2,

| ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i]=ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–absent\displaystyle\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=r,% \boldsymbol{X}_{i}]=\leavevmode\nobreak\ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = | ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i]ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–\displaystyle\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,% \boldsymbol{X}_{i}]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] |   
---|---|---|---  
| â‡”ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i]=iffğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–absent\displaystyle\iff\qquad\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W% _{i}=r,\boldsymbol{X}_{i}]=\leavevmode\nobreak\ â‡” blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = | ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0]ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0\displaystyle\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] |   
| âŸ¹ğ”¼â¢[ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i]âˆ£Wi=r]=absentğ”¼delimited-[]conditionalğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿabsent\displaystyle\implies\leavevmode\nobreak\ \mathbb{E}\left[\mathbb{E}[\tilde{y}% _{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=r,\boldsymbol{X}_{i}]\mid W_{i}=r% \right]=\leavevmode\nobreak\ âŸ¹ blackboard_E [ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] = | ğ”¼â¢[ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0]âˆ£Wi=r]ğ”¼delimited-[]conditionalğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘Šğ‘–ğ‘Ÿ\displaystyle\mathbb{E}\left[\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0% )\mid W_{i}=0]\mid W_{i}=r\right]blackboard_E [ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |   
| â‡”ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r]=iffğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿabsent\displaystyle\iff\qquad\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)% \mid W_{i}=r\right]=\leavevmode\nobreak\ â‡” blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] = | ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0].ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0\displaystyle\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0].blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] . |   
  
âˆ

Proposition A.4 shows that any method that consistently estimates the marginal
average treatment effects is also consistent under (CIUN) and (CCTS).

Notice that Assumptions (CIU) and (CIUN) are closely related to the time-
varying effects of the covariates on the potential outcomes that we mentioned
in our discussion of Theorem A.2 in Section A.2, which can cause marginal
parallel trends to fail to hold even if conditional parallel trends holds.
Proposition A.4 shows that (CIUN) rules out such settings.

Next we present a key result that underlies Theorem C.1, and in turn Theorems
6.1, 6.3, and 6.4.

######  Theorem A.5 (Assumption (CIUN) and the Consistency of Regression 1.5).

Assume that (CNAS) and (3.6) from (LINS) hold.

  1. (a)

(Consistency under conditional parallel trends.) The following are equivalent:
(i) conditional parallel trends after treatment (CCTSA) holds, and (ii) for
all râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R and all
tâ‰¥rğ‘¡ğ‘Ÿt\geq ritalic_t â‰¥ italic_r, for the regression estimands
Ï„râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡\tau_{rt}^{*}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT and
ğ†râ¢tâˆ—superscriptsubscriptğ†ğ‘Ÿğ‘¡\boldsymbol{\rho}_{rt}^{*}bold_italic_Ï
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT defined in (3.6) it holds almost surely that the
conditional average treatment effects
Ï„CATTâ¢(r,t,ğ‘¿i)subscriptğœCATTğ‘Ÿğ‘¡subscriptğ‘¿ğ‘–\tau_{\text{CATT}}(r,t,\boldsymbol{X}_{i})italic_Ï„
start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t ,
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) defined in
(1.6) equal
Ï„râ¢tâˆ—+(ğ‘¿iâˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r])âŠ¤â¢ğ†râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡superscriptsubscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡\tau_{rt}^{*}+\left(\boldsymbol{X}_{i}-\mathbb{E}\left[\boldsymbol{X}_{i}\mid
W% _{i}=r\right]\right)^{\top}\boldsymbol{\rho}_{rt}^{*}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT + ( bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
= italic_r ] ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT.

  2. (b)

(Consistency under marginal parallel trends and CIUN.) If (CIUN) and marginal
parallel trends after treatment (CTSA) hold, then for all
râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R and all
tâ‰¥rğ‘¡ğ‘Ÿt\geq ritalic_t â‰¥ italic_r the regression estimand
Ï„râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡\tau_{rt}^{*}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT is equal to the marginal average treatment effect
Ï„ATTâ¢(r,t)subscriptğœATTğ‘Ÿğ‘¡\tau_{\text{ATT}}(r,t)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) from (1.1)..

  3. (c)

(Identifying the bias-inducing covariates under CTSA if CIUN does not hold.)
Suppose (CTSA) and (3.5) from (LINS) hold. Then for any
râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R and
tâˆˆ{r,â€¦,T}ğ‘¡ğ‘Ÿâ€¦ğ‘‡t\in\\{r,\ldots,T\\}italic_t âˆˆ { italic_r , â€¦ ,
italic_T },

| Ï„râ¢tâˆ—=Ï„ATTâ¢(r,t)âˆ’(ğ”¼â¢[ğ‘¿iâˆ£Wi=r]âˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=0])âŠ¤â¢ğƒtâˆ—.superscriptsubscriptğœğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡superscriptğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–0topsuperscriptsubscriptğƒğ‘¡\tau_{rt}^{*}=\tau_{\text{ATT}}(r,t)-\left(\mathbb{E}[\boldsymbol{X}_{i}\mid W% _{i}=r]-\mathbb{E}\left[\boldsymbol{X}_{i}\mid W_{i}=0\right]\right)^{\top}% \boldsymbol{\xi}_{t}^{*}.italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT = italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - ( blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT . |   
---|---|---  
  

###### Proof.

The proofs of parts (b) and (c) are provided in Appendix G.1. Part (a) follows
from Wooldridge [2021, Sections 6.3 and 6.4], but for illustrative purposes we
provide a proof in our notation here. For all râˆˆâ„›,tâ‰¥rformulae-
sequenceğ‘Ÿâ„›ğ‘¡ğ‘Ÿr\in\mathcal{R},t\geq ritalic_r âˆˆ caligraphic_R ,
italic_t â‰¥ italic_r and any ğ’™ğ’™\boldsymbol{x}bold_italic_x in the support
of ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT,

|  | Ï„râ¢tâˆ—+ğ’™Ë™râŠ¤â¢ğ†râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡superscriptsubscriptbold-Ë™ğ’™ğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡\displaystyle\tau_{rt}^{*}+\boldsymbol{\dot{x}}_{r}^{\top}\boldsymbol{\rho}_{% rt}^{*}italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + overbold_Ë™ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
---|---|---|---  
| =(a)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(a)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_a ) end_ARG end_RELOP | ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ’y~(iâ¢1)â¢(r)âˆ£Wi=r,ğ‘¿i=ğ’™]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿconditionalsubscript~ğ‘¦ğ‘–1ğ‘Ÿsubscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}(r)-\tilde{y}_{(i1)}(r)\mid W_{i}% =r,\boldsymbol{X}_{i}=\boldsymbol{x}\right]-\mathbb{E}\left[\tilde{y}_{(it)}(0% )-\tilde{y}_{(i1)}(0)\mid W_{i}=0,\boldsymbol{X}_{i}=\boldsymbol{x}\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
| =(b)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(b)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_b ) end_ARG end_RELOP | ğ”¼[y~(iâ¢t)(r)âˆ£Wi=r,ğ‘¿i=ğ’™]âˆ’(ğ”¼[y~(iâ¢1)(0)âˆ£Wi=r,ğ‘¿i=ğ’™]\displaystyle\mathbb{E}[\tilde{y}_{(it)}(r)\mid W_{i}=r,\boldsymbol{X}_{i}=% \boldsymbol{x}]-\bigg{(}\mathbb{E}[\tilde{y}_{(i1)}(0)\mid W_{i}=r,\boldsymbol% {X}_{i}=\boldsymbol{x}]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] - ( blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
|  | +ğ”¼[y~(iâ¢t)(0)âˆ’y~(iâ¢1)(0)âˆ£Wi=0,ğ‘¿i=ğ’™])\displaystyle+\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,% \boldsymbol{X}_{i}=\boldsymbol{x}]\bigg{)}\+ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] ) |   
| =(c)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(c)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_c ) end_ARG end_RELOP | ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ£Wi=r,ğ‘¿i=ğ’™]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ£Wi=r,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿsubscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}[\tilde{y}_{(it)}(r)\mid W_{i}=r,\boldsymbol{X}_{i}=% \boldsymbol{x}]-\mathbb{E}[\tilde{y}_{(it)}(0)\mid W_{i}=r,\boldsymbol{X}_{i}=% \boldsymbol{x}]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
| =\displaystyle=\leavevmode\nobreak\ = | Ï„CATTâ¢(r,t,ğ’™),subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle\tau_{\text{CATT}}(r,t,\boldsymbol{x}),italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) , |  | (A.8)  
  
where in (a)ğ‘(a)( italic_a ) we used (3.6) from (LINS), in (b)ğ‘(b)( italic_b
) we used (CNAS), and (c)ğ‘(c)( italic_c ) follows from rearranging (CCTSA).

âˆ

####  A.3.1 Discussion of Theorem A.5

Theorem A.5(a) and (b) show the consistency of regression (1.5): if (LINS),
(CNAS), and (CIUN) hold, any estimator that is consistent for the regression
estimands in (3.6) is also consistent for the marginal average treatment
effects under either conditional parallel trends after treatment or marginal
parallel trends after treatment. Theorem A.5(a) and (b) applies to ETWFE
immediately under the conditions of Theorem 6.1(ii) in Wooldridge [2021],
which shows that the ETWFE estimator of
Ï„râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡\tau_{rt}^{*}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT is consistent. It also applies to FETWFE in light of
Theorem C.1(b), which is used to prove Theorem 6.1.

Theorem A.5(c) shows that it is specifically the covariates
ğ‘¿iâ¢ğŸ™â¢{t=tâ€²}subscriptğ‘¿ğ‘–1ğ‘¡superscriptğ‘¡â€²\boldsymbol{X}_{i}\mathbbm{1}\\{t=t^{\prime}\\}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT blackboard_1 { italic_t =
italic_t start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } for
tâ€²âˆˆ{2,â€¦,T}superscriptğ‘¡â€²2â€¦ğ‘‡t^{\prime}\in\\{2,\ldots,T\\}italic_t
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ { 2 , â€¦ , italic_T }
(which correspond to regression estimands
ğƒtâˆ—superscriptsubscriptğƒğ‘¡\boldsymbol{\xi}_{t}^{*}bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT) included in regression (1.5) that induce an asymptotic
bias in the estimated marginal average treatment effects
Ï„ATTâ¢(r,tâ€²)subscriptğœATTğ‘Ÿsuperscriptğ‘¡â€²\tau_{\text{ATT}}(r,t^{\prime})italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ) if (CIUN) does not hold.
Suppose we assume that (3.5) from (LINS) holds and
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT and Wisubscriptğ‘Šğ‘–W_{i}italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT are not mean-independent; in
particular, for all râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R we
have ğ”¼â¢[ğ‘¿iâˆ£Wi=r]â‰
ğ”¼â¢[ğ‘¿iâˆ£Wi=0]ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–0\mathbb{E}[\boldsymbol{X}_{i}\mid
W_{i}=r]\neq\mathbb{E}[\boldsymbol{X}_{i}% \mid W_{i}=0]blackboard_E [
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] â‰ blackboard_E [
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ]666Notice from Theorem
A.5(c) that
Ï„râ¢tâˆ—=Ï„ATTâ¢(r,t)superscriptsubscriptğœğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡\tau_{rt}^{*}=\tau_{\text{ATT}}(r,t)italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT = italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT
( italic_r , italic_t ) if and only if either
ğ”¼â¢[ğ‘¿iâˆ£Wi=r]=ğ”¼â¢[ğ‘¿iâˆ£Wi=0]ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–0\mathbb{E}[\boldsymbol{X}_{i}\mid
W_{i}=r]=\mathbb{E}[\boldsymbol{X}_{i}\mid W% _{i}=0]blackboard_E [
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] = blackboard_E [
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] or
ğƒtâˆ—=ğŸsuperscriptsubscriptğƒğ‘¡0\boldsymbol{\xi}_{t}^{*}=\boldsymbol{0}bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT = bold_0. There is an interesting connection here: it is
also true that (CCTS) implies (CTS) under either independence of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT and Wisubscriptğ‘Šğ‘–W_{i}italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT or (CIUN), which under (LINS)
is equivalent to
ğƒtâˆ—=ğŸsuperscriptsubscriptğƒğ‘¡0\boldsymbol{\xi}_{t}^{*}=\boldsymbol{0}bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT = bold_0. The latter fact is from Proposition A.4. Under
independence of ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT and
Wisubscriptğ‘Šğ‘–W_{i}italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT,
the distribution of ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT conditional on
Wi=rsubscriptğ‘Šğ‘–ğ‘ŸW_{i}=ritalic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT = italic_r is identical to the marginal distribution of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT for all
râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 } âˆª
caligraphic_R, so we can marginalize each side of (3.1) across the marginal
distribution of ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT to yield (3.2).. Then if
(CCTSA) and (CIUN) both do not hold, not only does Theorem A.5(a) show that
there is no hope of estimating conditional average treatment effects, Theorem
A.5(c) shows that in general including the covariates
ğ‘¿iâ¢ğŸ™â¢{t=tâ€²}subscriptğ‘¿ğ‘–1ğ‘¡superscriptğ‘¡â€²\boldsymbol{X}_{i}\mathbbm{1}\\{t=t^{\prime}\\}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT blackboard_1 { italic_t =
italic_t start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } in a regression
induces bias in the estimated average treatment effects (since if (CIUN) does
not hold and (3.5) from (LINS) does then ğƒtâˆ—â‰
ğŸsuperscriptsubscriptğƒğ‘¡0\boldsymbol{\xi}_{t}^{*}\neq\boldsymbol{0}bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT â‰ bold_0 for at least some tğ‘¡titalic_t). This is true
even if (CTS) holds and the marginal average treatment effects are estimable
(by, for example, model (6.15) in Wooldridge 2021, which omits these
covariates). That is, the covariates
ğ‘¿iâ¢ğŸ™â¢{t=tâ€²}subscriptğ‘¿ğ‘–1ğ‘¡superscriptğ‘¡â€²\boldsymbol{X}_{i}\mathbbm{1}\\{t=t^{\prime}\\}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT blackboard_1 { italic_t =
italic_t start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } for
tâ€²âˆˆ{2,â€¦,T}superscriptğ‘¡â€²2â€¦ğ‘‡t^{\prime}\in\\{2,\ldots,T\\}italic_t
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ { 2 , â€¦ , italic_T } are
â€œbad controls," in the language of Cinelli etÂ al. [2022]. This observation
aligns with the observation that Wooldridge [2021, Section 6.3] makes that
including time-invariant covariates and their interactions with cohort dummies
has no effect on the estimated marginal average treatment effectsâ€”it is
specifically the inclusion of the covariate/time dummy interactions that
changes the estimand for each
Ï„râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡\tau_{rt}^{*}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT.

Notice that these covariates correspond exactly to the kind of effect of the
covariates on the untreated trends that is ruled out by Assumptions (CIU) and
(CIUN), as well as the time-varying effects of the covariates on the potential
outcomes that we mentioned in our discussion of Theorem A.2 in Section A.2.

However, if (3.5) holds, we see that under (CIUN) the coefficients
ğƒtâˆ—superscriptsubscriptğƒğ‘¡\boldsymbol{\xi}_{t}^{*}bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT must all equal ğŸ0\boldsymbol{0}bold_0. In this case,
Theorem A.5(c) shows that no harm is done to asymptotic unbiasedness by
including those coefficients in the regression, and any estimator that is
consistent for Ï„râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡\tau_{rt}^{*}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT from (3.6) is consistent for
Ï„ATTâ¢(r,t)subscriptğœATTğ‘Ÿğ‘¡\tau_{\text{ATT}}(r,t)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ). (This
aligns with part (b), which shows that if (CIUN) holds then we can
consistently estimate the marginal average treatment effects under (CTSA) with
regression 1.5.)

As we showed in Theorem 6.3, under the required assumptions no harm is done to
the asymptotic efficiency of FETWFE by including irrelevant covariates (as we
mentioned earlier in Remark 3.1), like when (CIUN) holds and all of the
ğƒtâˆ—superscriptsubscriptğƒğ‘¡\boldsymbol{\xi}_{t}^{*}bold_italic_Î¾
start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT equal ğŸ0\boldsymbol{0}bold_0.

Theorem A.5(c) has similarities to Theorems 4.1 and 5.1 from Ham and Miratrix
[2022], which analyze the T=2ğ‘‡2T=2italic_T = 2,
â„›={2}â„›2\mathcal{R}=\\{2\\}caligraphic_R = { 2 } and arbitrary
Tğ‘‡Titalic_T, â„›={T}â„›ğ‘‡\mathcal{R}=\\{T\\}caligraphic_R = { italic_T }
cases, respectively. In particular, their estimand
ğ”¼â¢[Ï„^DiDX]ğ”¼delimited-[]superscriptsubscript^ğœDiDğ‘‹\mathbb{E}[\hat{\tau}_{\text{DiD}}^{X}]blackboard_E
[ over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT DiD end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT italic_X end_POSTSUPERSCRIPT ] matches our estimand
Ï„râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡\tau_{rt}^{*}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT under our assumptions, and they also identify the bias
of this estimand in order to investigate when conditional parallel trends
might be more plausible than marginal parallel trends. Besides the fact that
we consider a more general staggered adoptions (arbitrary
â„›â„›\mathcal{R}caligraphic_R) setting, they also consider different
structural equations for the potential outcomes (for example, they omit
interactions between the covariates and treatment status or cohort membership,
though they do allow for time-varying coefficients on the covariates) and they
consider a setting with a latent confounder.

##  Appendix B Additional Results For Simulation Studies

Table 4 contains results for the cohort-specific squared estimation errors for
the cohort-specific average treatment effects
Ï„ATTâ¢(r)subscriptğœATTğ‘Ÿ\tau_{\text{ATT}}(r)italic_Ï„ start_POSTSUBSCRIPT
ATT end_POSTSUBSCRIPT ( italic_r ) as defined in (4.10). We see that on
average FETWFE outperforms every method for most cohorts, except that BETWFE
outperforms FETWFE on average for cohort 2. This is because the true treatment
effect for Cohort 2 is close to 0 (0.069), so BETWFEâ€™s direct penalization
of the treatment coefficients directly towards 0 happens to be useful. In
addition, this difference in the mean outcomes seems to be driven by
outliersâ€”we see from the boxplots in Figure 5 that in the median case FETWFE
still outperforms BETWFE.

Table 5 contains pğ‘pitalic_p-values for paired one-tailed tğ‘¡titalic_t-tests
of the alternative hypothesis that FETWFE has lower squared estimation error
than the competitor methods, showing that the differences are statistically
significant at the 0.010.010.010.01 level in all settings except for the
Cohort 2 BETWFE estimate and the last two ETWFE estimates, which are not
significant because the ETWFE estimator has very high variance (see Table 4).

Table 6 contains results for the sum of squared errors of all methodsâ€™
estimates of the treatment interaction coefficients
Ïâˆ—superscriptğœŒ\rho^{*}italic_Ï start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT. We see that FETWFE outperforms every method. Table 7
contains pğ‘pitalic_p-values for paired one-tailed tğ‘¡titalic_t-tests of the
alternative hypothesis that FETWFE has lower squared estimation error than the
competitor methods, showing that the differences are statistically significant
at the 0.050.050.050.05 level.

Figure 4 depicts a boxplot of the proportion of the
pNsubscriptğ‘ğ‘p_{N}italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
possible restrictions that FETWFE selects correctly in the first simulation
study. Figures 5, 6, 7, 8, and 9 display boxplots of these squared errors,
similar to Figure 3 for the average treatment effect. These plots also
indicate that FETWFE typically outperforms the other methods.

Table 4: Means and standard errors for the squared errors of estimates of Ï„ATTâ¢(r)subscriptğœATTğ‘Ÿ\tau_{\text{ATT}}(r)italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r ) by each method for each cohort in the simulation study from Section 7. | FETWFE | ETWFE | BETWFE | TWFE_COVS  
---|---|---|---|---  
Cohort 2 | 0.035 (0.006) | 1.502 (0.312) | 0.008 (0) | 7.265 (0.163)  
Cohort 3 | 0.037 (0.004) | 0.943 (0.19) | 0.425 (0.011) | 1.881 (0.091)  
Cohort 4 | 0.129 (0.009) | 0.856 (0.179) | 3.492 (0.016) | 1.269 (0.062)  
Cohort 5 | 0.093 (0.007) | 4.12 (3.079) | 4.794 (0.011) | 1.685 (0.082)  
Cohort 6 | 0.068 (0.005) | 3.212 (2.016) | 3.759 (0.016) | 0.949 (0.049)  
Table 5: pğ‘pitalic_p-values for paired one-tailed tğ‘¡titalic_t-tests of the alternative hypothesis that the FETWFE estimate of Ï„ATTâ¢(r)subscriptğœATTğ‘Ÿ\tau_{\text{ATT}}(r)italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r ) has lower squared error than the competitor methods for each cohort in the simulation study from Section 7. | ETWFE | BETWFE | TWFE_COVS  
---|---|---|---  
Cohort 2 | 1.14e-05 | 1 | 8.2e-206  
Cohort 3 | 8.06e-06 | 2.35e-145 | 1.85e-72  
Cohort 4 | 0.000119 | 0 | 3.89e-63  
Cohort 5 | 0.118 | 0 | 1.12e-68  
Cohort 6 | 0.0795 | 0 | 8.71e-60  
Table 6: Means and standard errors for the summed squared errors of estimates of the treatment interaction coefficients ğ†âˆ—superscriptğ†\boldsymbol{\rho}^{*}bold_italic_Ï start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT by each method for each cohort in the simulation study from Section 7. FETWFE | ETWFE | BETWFE  
---|---|---  
0.529 (0.00827) | 38.1 (18.3) | 4.82 (0.0119)  
Table 7: pğ‘pitalic_p-values for paired one-tailed tğ‘¡titalic_t-tests of the alternative hypothesis that the FETWFE estimates of the treatment interaction coefficients ğ†âˆ—superscriptğ†\boldsymbol{\rho}^{*}bold_italic_Ï start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT have lower summed squared error than the competitor methods for each cohort in the simulation study from Section 7. ETWFE | BETWFE  
---|---  
0.02 | 0  
![Refer to caption]() Figure 4: Boxplot displaying proportions of correct
treatment effect restriction decisions correctly made by FETWFE across each of
the 700 simulations from the first simulation study in Section 7. ![Refer to
caption]() Figure 5: Boxplots of squared errors for each methodâ€™s estimate
of Ï„ATTâ¢(2)subscriptğœATT2\tau_{\text{ATT}}(2)italic_Ï„ start_POSTSUBSCRIPT
ATT end_POSTSUBSCRIPT ( 2 ) across all 700 simulations. Vertical axis is on a
log scale. ![Refer to caption]() Figure 6: Boxplots of squared errors for each
methodâ€™s estimate of Ï„ATTâ¢(3)subscriptğœATT3\tau_{\text{ATT}}(3)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( 3 ) across all 700 simulations.
Vertical axis is on a log scale. ![Refer to caption]() Figure 7: Boxplots of
squared errors for each methodâ€™s estimate of
Ï„ATTâ¢(4)subscriptğœATT4\tau_{\text{ATT}}(4)italic_Ï„ start_POSTSUBSCRIPT ATT
end_POSTSUBSCRIPT ( 4 ) across all 700 simulations. Vertical axis is on a log
scale. ![Refer to caption]() Figure 8: Boxplots of squared errors for each
methodâ€™s estimate of Ï„ATTâ¢(5)subscriptğœATT5\tau_{\text{ATT}}(5)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( 5 ) across all 700 simulations.
Vertical axis is on a log scale. ![Refer to caption]() Figure 9: Boxplots of
squared errors for each methodâ€™s estimate of
Ï„ATTâ¢(6)subscriptğœATT6\tau_{\text{ATT}}(6)italic_Ï„ start_POSTSUBSCRIPT ATT
end_POSTSUBSCRIPT ( 6 ) across all 700 simulations. Vertical axis is on a log
scale.

##  Appendix C Theorem C.1

Theorem C.1 connects the bridge regression theory of Kock [2013] to the
difference-in-differences theory of Wooldridge [2021]. It also makes use of
some extensions of the theory of Kock [2013] (Theorem F.4, Theorem F.5).
Equipped with Theorem C.1, Theorems 6.1, 6.2, 6.3, and 6.4 are relatively
straightforward to prove.

######  Theorem C.1.

  1. (a)

(Correct specification.) Suppose Assumptions (CNAS), (CCTSB), and (LINS) hold.
Then for all iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ],
tâˆˆ[T]ğ‘¡delimited-[]ğ‘‡t\in[T]italic_t âˆˆ [ italic_T ],
râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R,

| ğ”¼â¢[y~(iâ¢t)âˆ£Wi=0,ğ‘¿i]=ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–absent\displaystyle\mathbb{E}[\tilde{y}_{(it)}\mid W_{i}=0,\boldsymbol{X}_{i}]=% \leavevmode\nobreak\ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = | Î·âˆ—+Î³tâˆ—+ğ‘¿iâŠ¤â¢(ğœ¿âˆ—+ğƒtâˆ—)andsuperscriptğœ‚superscriptsubscriptğ›¾ğ‘¡superscriptsubscriptğ‘¿ğ‘–topsuperscriptğœ¿superscriptsubscriptğƒğ‘¡and\displaystyle\eta^{*}+\gamma_{t}^{*}+\boldsymbol{X}_{i}^{\top}(\boldsymbol{% \kappa}^{*}+\boldsymbol{\xi}_{t}^{*})\qquad\text{and}italic_Î· start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_Îº start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) and |   
---|---|---|---  
| ğ”¼â¢[y~(iâ¢t)âˆ£Wi=r,ğ‘¿i]=ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–absent\displaystyle\mathbb{E}[\tilde{y}_{(it)}\mid W_{i}=r,\boldsymbol{X}_{i}]=% \leavevmode\nobreak\ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = | Î·âˆ—+Î³tâˆ—+Î½râˆ—+ğ‘¿iâŠ¤â¢(ğœ¿âˆ—+ğƒtâˆ—+ğœ»râˆ—)+ğŸ™â¢{tâ‰¥r}â¢(Ï„râ¢tâˆ—+ğ‘¿Ë™(iâ¢r)âŠ¤â¢ğ†râ¢tâˆ—),superscriptğœ‚superscriptsubscriptğ›¾ğ‘¡superscriptsubscriptğœˆğ‘Ÿsuperscriptsubscriptğ‘¿ğ‘–topsuperscriptğœ¿superscriptsubscriptğƒğ‘¡superscriptsubscriptğœ»ğ‘Ÿ1ğ‘¡ğ‘Ÿsuperscriptsubscriptğœğ‘Ÿğ‘¡superscriptsubscriptbold-Ë™ğ‘¿ğ‘–ğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡\displaystyle\eta^{*}+\gamma_{t}^{*}+\nu_{r}^{*}+\boldsymbol{X}_{i}^{\top}(% \boldsymbol{\kappa}^{*}+\boldsymbol{\xi}_{t}^{*}+\boldsymbol{\zeta}_{r}^{*})+% \mathbbm{1}\\{t\geq r\\}(\tau_{rt}^{*}+\boldsymbol{\dot{X}}_{(ir)}^{\top}% \boldsymbol{\rho}_{rt}^{*}),italic_Î· start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Î½ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_Îº start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_Î¶ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) + blackboard_1 { italic_t â‰¥ italic_r } ( italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + overbold_Ë™ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT ( italic_i italic_r ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) , |   
  
where
ğ‘¿Ë™(iâ¢r)=ğ‘¿iâˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r]subscriptbold-Ë™ğ‘¿ğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\boldsymbol{\dot{X}}_{(ir)}=\boldsymbol{X}_{i}-\mathbb{E}[\boldsymbol{X}_{i}%
\mid W_{i}=r]overbold_Ë™ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT (
italic_i italic_r ) end_POSTSUBSCRIPT = bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT = italic_r ], for identifiability we define the time-
dependent parameters to equal 0 at t=1ğ‘¡1t=1italic_t = 1, and recall that
Î·âˆ—,Î³tâˆ—superscriptğœ‚superscriptsubscriptğ›¾ğ‘¡\eta^{*},\gamma_{t}^{*}italic_Î·
start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , italic_Î³ start_POSTSUBSCRIPT
italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT, etc.
are the regression estimands defined in (LINS).

  2. (b)

(Estimation consistency.) In addition to the assumptions from part (a)ğ‘(a)(
italic_a ), suppose Assumptions (F1), (F2), S(sNsubscriptğ‘ ğ‘s_{N}italic_s
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT), and (R1) - (R3) hold. Then
for any q>0ğ‘0q>0italic_q > 0,
âˆ¥ğœ·^(q)âˆ’ğœ·Nâˆ—âˆ¥2=ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})subscriptdelimited-
âˆ¥âˆ¥superscriptbold-^ğœ·ğ‘superscriptsubscriptğœ·ğ‘2subscriptğ’ªâ„™subscriptâ„ğ‘subscriptsuperscriptâ„â€²ğ‘\lVert\boldsymbol{\hat{\beta}}^{(q)}-\boldsymbol{\beta}_{N}^{*}\rVert_{2}=%
\mathcal{O}_{\mathbb{P}}\left(\min\\{h_{N},h^{\prime}_{N}\\}\right)âˆ¥
overbold_^ start_ARG bold_italic_Î² end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT - bold_italic_Î² start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥
start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = caligraphic_O start_POSTSUBSCRIPT
blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT â€²
end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT } ), where
hNsubscriptâ„ğ‘h_{N}italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT is
defined in (6.3) and hNâ€²superscriptsubscriptâ„ğ‘â€²h_{N}^{\prime}italic_h
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€²
end_POSTSUPERSCRIPT is defined in (6.2).

  3. (c)

(Selection consistency.) Define

| ğœ½Nâˆ—:=ğ‘«Nâ¢ğœ·Nâˆ—assignsuperscriptsubscriptğœ½ğ‘subscriptğ‘«ğ‘superscriptsubscriptğœ·ğ‘\boldsymbol{\theta}_{N}^{*}:=\boldsymbol{D}_{N}\boldsymbol{\beta}_{N}^{*}bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT := bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |  | (C.1)  
---|---|---|---  
  
and
ğœ½^(q):=ğ‘«Nâ¢ğœ·^(q)assignsuperscriptbold-^ğœ½ğ‘subscriptğ‘«ğ‘superscriptbold-^ğœ·ğ‘\boldsymbol{\hat{\theta}}^{(q)}:=\boldsymbol{D}_{N}\boldsymbol{\hat{\beta}}^{(%
q)}overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT (
italic_q ) end_POSTSUPERSCRIPT := bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT overbold_^ start_ARG bold_italic_Î² end_ARG
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT. In addition to the
previous assumptions, assume that qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 )
and Assumptions (R4) - (R5) hold. Then
limNâ†’âˆâ„™â¢(ğœ½^ğ’®c(q)=ğŸ)=1subscriptâ†’ğ‘â„™subscriptsuperscriptbold-^ğœ½ğ‘superscriptğ’®ğ‘01\lim_{N\to\infty}\mathbb{P}\left(\boldsymbol{\hat{\theta}}^{(q)}_{\mathcal{S}^%
{c}}=\boldsymbol{0}\right)=1roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ
end_POSTSUBSCRIPT blackboard_P ( overbold_^ start_ARG bold_italic_Î¸ end_ARG
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT
caligraphic_S start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT
end_POSTSUBSCRIPT = bold_0 ) = 1. (This also implies that
ğœ½^ğ’®c(q)â†’ğ‘ğŸğ‘â†’subscriptsuperscriptbold-^ğœ½ğ‘superscriptğ’®ğ‘0\boldsymbol{\hat{\theta}}^{(q)}_{\mathcal{S}^{c}}\xrightarrow{p}\boldsymbol{0}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT start_POSTSUBSCRIPT caligraphic_S start_POSTSUPERSCRIPT
italic_c end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_ARROW overitalic_p â†’
end_ARROW bold_0,
limNâ†’âˆâ„™â¢(Nâ¢Tâ¢ğœ½^ğ’®c(q)=ğŸ)=1subscriptâ†’ğ‘â„™ğ‘ğ‘‡subscriptsuperscriptbold-^ğœ½ğ‘superscriptğ’®ğ‘01\lim_{N\to\infty}\mathbb{P}\left(\sqrt{NT}\boldsymbol{\hat{\theta}}^{(q)}_{%
\mathcal{S}^{c}}=\boldsymbol{0}\right)=1roman_lim start_POSTSUBSCRIPT italic_N
â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( square-root start_ARG italic_N
italic_T end_ARG overbold_^ start_ARG bold_italic_Î¸ end_ARG
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT
caligraphic_S start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT
end_POSTSUBSCRIPT = bold_0 ) = 1, and
limNâ†’âˆâ„™â¢(Nâ¢Tâ¢ğ’—NâŠ¤â¢ğœ½^ğ’®c(q)=0)=1subscriptâ†’ğ‘â„™ğ‘ğ‘‡superscriptsubscriptğ’—ğ‘topsubscriptsuperscriptbold-^ğœ½ğ‘superscriptğ’®ğ‘01\lim_{N\to\infty}\mathbb{P}\left(\sqrt{NT}\boldsymbol{v}_{N}^{\top}\boldsymbol%
{\hat{\theta}}^{(q)}_{\mathcal{S}^{c}}=0\right)=1roman_lim start_POSTSUBSCRIPT
italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( square-root start_ARG
italic_N italic_T end_ARG bold_italic_v start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT start_POSTSUBSCRIPT caligraphic_S start_POSTSUPERSCRIPT
italic_c end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = 0 ) = 1 for any sequence of
finite vectors
ğ’—Nâˆˆâ„pNsubscriptğ’—ğ‘superscriptâ„subscriptğ‘ğ‘\boldsymbol{v}_{N}\
\in\mathbb{R}^{p_{N}}bold_italic_v start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT.)

Further, let ğ’®^N:={j:Î¸^j(q)â‰ 0}assignsubscript^ğ’®ğ‘conditional-
setğ‘—subscriptsuperscript^ğœƒğ‘ğ‘—0\hat{\mathcal{S}}_{N}:=\\{j:\hat{\theta}^{(q)}_{j}\neq
0\\}over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT := { italic_j : over^ start_ARG italic_Î¸ end_ARG
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT
italic_j end_POSTSUBSCRIPT â‰ 0 }, and similarly let
ğ’®NâŠ†[pN]subscriptğ’®ğ‘delimited-[]subscriptğ‘ğ‘\mathcal{S}_{N}\subseteq[p_{N}]caligraphic_S
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âŠ† [ italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] be the set of components of
ğœ½Nâˆ—superscriptsubscriptğœ½ğ‘\boldsymbol{\theta}_{N}^{*}bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT that are nonzero. Then

| limNâ†’âˆâ„™â¢(ğ’®^N=ğ’®N)=1.subscriptâ†’ğ‘â„™subscript^ğ’®ğ‘subscriptğ’®ğ‘1\lim_{N\to\infty}\mathbb{P}\left(\hat{\mathcal{S}}_{N}=\mathcal{S}_{N}\right)=1.roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = caligraphic_S start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) = 1 . |   
---|---|---  
  
  4. (d)

(Asymptotic normality and oracle property.) In addition to the previous
assumptions, assume Assumption (R6) holds and Assumption S(sğ‘ sitalic_s)
holds for a fixed sN=ssubscriptğ‘ ğ‘ğ‘ s_{N}=sitalic_s start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT = italic_s, so
ğ’®N=ğ’®subscriptğ’®ğ‘ğ’®\mathcal{S}_{N}=\mathcal{S}caligraphic_S
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = caligraphic_S is fixed as
well. Let
{ğN}N=1âˆsuperscriptsubscriptsubscriptğğ‘ğ‘1\\{\boldsymbol{\psi}_{N}\\}_{N=1}^{\infty}{
bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT }
start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ
end_POSTSUPERSCRIPT be a sequence of real-valued vectors where for each
ğNâˆˆâ„pNsubscriptğğ‘superscriptâ„subscriptğ‘ğ‘\boldsymbol{\psi}_{N}\in\mathbb{R}^{p_{N}}bold_italic_Ïˆ
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
end_POSTSUPERSCRIPT,
(ğN)ğ’®=ğœ¶âˆˆâ„ssubscriptsubscriptğğ‘ğ’®ğœ¶superscriptâ„ğ‘
(\boldsymbol{\psi}_{N})_{\mathcal{S}}=\boldsymbol{\alpha}\in\mathbb{R}^{s}(
bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT )
start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT = bold_italic_Î± âˆˆ
blackboard_R start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT is fixed and
finite and
(ğN)[pN]âˆ–ğ’®=ğ’ƒNsubscriptsubscriptğğ‘delimited-[]subscriptğ‘ğ‘ğ’®subscriptğ’ƒğ‘(\boldsymbol{\psi}_{N})_{[p_{N}]\setminus\mathcal{S}}=\boldsymbol{b}_{N}(
bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT )
start_POSTSUBSCRIPT [ italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
] âˆ– caligraphic_S end_POSTSUBSCRIPT = bold_italic_b start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT, where
{ğ’ƒN}N=1âˆsuperscriptsubscriptsubscriptğ’ƒğ‘ğ‘1\\{\boldsymbol{b}_{N}\\}_{N=1}^{\infty}{
bold_italic_b start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT }
start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ
end_POSTSUPERSCRIPT is any sequence of constants where each
ğ’ƒNâˆˆâ„pNâˆ’ssubscriptğ’ƒğ‘superscriptâ„subscriptğ‘ğ‘ğ‘
\boldsymbol{b}_{N}\in\mathbb{R}^{p_{N}-s}bold_italic_b start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_s end_POSTSUPERSCRIPT
contains all finite entries. Then if ğœ¶â‰
ğŸğœ¶0\boldsymbol{\alpha}\neq\boldsymbol{0}bold_italic_Î± â‰ bold_0,

| Nâ¢Tâ¢ğNâŠ¤â¢(ğœ½^(q)âˆ’ğœ½Nâˆ—)â†’ğ‘‘ğ’©â¢(0,Ïƒ2â¢ğœ¶âŠ¤â¢(Covâ¢(ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®)âˆ’1â¢ğœ¶),ğ‘‘â†’ğ‘ğ‘‡superscriptsubscriptğğ‘topsuperscriptbold-^ğœ½ğ‘superscriptsubscriptğœ½ğ‘ğ’©0superscriptğœ2superscriptğœ¶topsuperscriptCovsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…ğ’®1ğœ¶\sqrt{NT}\boldsymbol{\psi}_{N}^{\top}(\boldsymbol{\hat{\theta}}^{(q)}-% \boldsymbol{\theta}_{N}^{*})\xrightarrow{d}\mathcal{N}\left(0,\sigma^{2}% \boldsymbol{\alpha}^{\top}\left(\mathrm{Cov}\left(\boldsymbol{Z}\boldsymbol{D}% _{N}^{-1}\right)_{(\cdot\cdot)\mathcal{S}}\right)^{-1}\boldsymbol{\alpha}% \right),square-root start_ARG italic_N italic_T end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_Cov ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± ) , |   
---|---|---  
  
where
Covâ¢(ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…ğ’®\mathrm{Cov}\left(\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}\right)_{(\cdot\cdot)%
\mathcal{S}}roman_Cov ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT )
start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT is the columns
and rows of the covariance matrix corresponding to the nonzero components of
ğœ½Nâˆ—superscriptsubscriptğœ½ğ‘\boldsymbol{\theta}_{N}^{*}bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT.

  5. (e)

(Asymptotic normality with feasible variance estimator.) Maintain the
assumptions from part (d)ğ‘‘(d)( italic_d ). For a random matrix
ğ‘¨âˆˆâ„Nâ¢TÃ—pNğ‘¨superscriptâ„ğ‘ğ‘‡subscriptğ‘ğ‘\boldsymbol{A}\in\mathbb{R}^{NT\times
p_{N}}bold_italic_A âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_N italic_T
Ã— italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT
with centered columns, define

| Cov^â¢(ğ‘¨):=1Nâ¢Tâ¢ğ‘¨âŠ¤â¢ğ‘¨assign^Covğ‘¨1ğ‘ğ‘‡superscriptğ‘¨topğ‘¨\widehat{\mathrm{Cov}}(\boldsymbol{A}):=\frac{1}{NT}\boldsymbol{A}^{\top}% \boldsymbol{A}over^ start_ARG roman_Cov end_ARG ( bold_italic_A ) := divide start_ARG 1 end_ARG start_ARG italic_N italic_T end_ARG bold_italic_A start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_A |  | (C.2)  
---|---|---|---  
  
to be the sample covariance matrix of ğ‘¨ğ‘¨\boldsymbol{A}bold_italic_A. For any ğ’œNâŠ†[pN]subscriptğ’œğ‘delimited-[]subscriptğ‘ğ‘\mathcal{A}_{N}\subseteq[p_{N}]caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âŠ† [ italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] such that ğ’œNâ‰ âˆ…subscriptğ’œğ‘\mathcal{A}_{N}\neq\emptysetcaligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT â‰ âˆ…, consider Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’œN)^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…subscriptğ’œğ‘\widehat{\mathrm{Cov}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot% \cdot)\mathcal{A}_{N}}\right)over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT ), the estimated covariance matrix of the columns of ğ’â¢ğ‘«Nâˆ’1ğ’superscriptsubscriptğ‘«ğ‘1\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT corresponding to ğ’œNsubscriptğ’œğ‘\mathcal{A}_{N}caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT. For sets (ğ’œN)N=1âˆsuperscriptsubscriptsubscriptğ’œğ‘ğ‘1(\mathcal{A}_{N})_{N=1}^{\infty}( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ end_POSTSUPERSCRIPT, define ğœ¶â¢(ğ’œN)âˆˆâ„|ğ’œN|ğœ¶subscriptğ’œğ‘superscriptâ„subscriptğ’œğ‘\boldsymbol{\alpha}(\mathcal{A}_{N})\in\mathbb{R}^{|\mathcal{A}_{N}|}bold_italic_Î± ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) âˆˆ blackboard_R start_POSTSUPERSCRIPT | caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT to be a fixed, finite vector for each unique ğ’œNsubscriptğ’œğ‘\mathcal{A}_{N}caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT, and define the sequence of pNsubscriptğ‘ğ‘p_{N}italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT-vectors {ğNâ¢(ğ’œN)}N=1âˆsuperscriptsubscriptsubscriptğğ‘subscriptğ’œğ‘ğ‘1\\{\boldsymbol{\psi}_{N}(\mathcal{A}_{N})\\}_{N=1}^{\infty}{ bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ end_POSTSUPERSCRIPT to have components in the entries corresponding to ğ’œNsubscriptğ’œğ‘\mathcal{A}_{N}caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT equal to ğœ¶â¢(ğ’œN)ğœ¶subscriptğ’œğ‘\boldsymbol{\alpha}(\mathcal{A}_{N})bold_italic_Î± ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) and remaining entries ğ’ƒnâ¢(ğ’œN)subscriptğ’ƒğ‘›subscriptğ’œğ‘\boldsymbol{b}_{n}(\mathcal{A}_{N})bold_italic_b start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) all finite (but otherwise arbitrary). Define the sequence of random variables U1â¢(ğ’œN)subscriptğ‘ˆ1subscriptğ’œğ‘U_{1}(\mathcal{A}_{N})italic_U start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) to equal

| 1Ïƒâ¢Nâ¢Tğœ¶â¢(ğ’œN)âŠ¤â¢(Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’œN))âˆ’1â¢ğœ¶â¢(ğ’œN)â‹…(ğNâ¢(ğ’œN)âŠ¤â¢ğœ½^(q)âˆ’ğNâ¢(ğ’®)âŠ¤â¢ğœ½Nâˆ—)â‹…1ğœğ‘ğ‘‡ğœ¶superscriptsubscriptğ’œğ‘topsuperscript^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…subscriptğ’œğ‘1ğœ¶subscriptğ’œğ‘subscriptğğ‘superscriptsubscriptğ’œğ‘topsuperscriptbold-^ğœ½ğ‘subscriptğğ‘superscriptğ’®topsuperscriptsubscriptğœ½ğ‘\frac{1}{\sigma}\sqrt{\frac{NT}{\boldsymbol{\alpha}(\mathcal{A}_{N})^{\top}% \left(\widehat{\mathrm{Cov}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(% \cdot\cdot)\mathcal{A}_{N}}\right)\right)^{-1}\boldsymbol{\alpha}(\mathcal{A}_% {N})}}\cdot\left(\boldsymbol{\psi}_{N}(\mathcal{A}_{N})^{\top}\boldsymbol{\hat% {\theta}}^{(q)}-\boldsymbol{\psi}_{N}(\mathcal{S})^{\top}\boldsymbol{\theta}_{% N}^{*}\right)divide start_ARG 1 end_ARG start_ARG italic_Ïƒ end_ARG square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG bold_italic_Î± ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) end_ARG end_ARG â‹… ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
---|---|---  
  
if ğ’œNâ‰ âˆ…subscriptğ’œğ‘\mathcal{A}_{N}\neq\emptysetcaligraphic_A
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT â‰ âˆ… and
Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’œN)^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…subscriptğ’œğ‘\widehat{\mathrm{Cov}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot%
\cdot)\mathcal{A}_{N}}\right)over^ start_ARG roman_Cov end_ARG ( (
bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹…
) caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
end_POSTSUBSCRIPT ) is invertible and 0 otherwise. Then if ğœ¶â¢(ğ’®)â‰
ğŸğœ¶ğ’®0\boldsymbol{\alpha}(\mathcal{S})\neq\boldsymbol{0}bold_italic_Î± (
caligraphic_S ) â‰ bold_0,

| U1â¢(ğ’®^N)â†’ğ‘‘ğ’©â¢(0,1).ğ‘‘â†’subscriptğ‘ˆ1subscript^ğ’®ğ‘ğ’©01U_{1}(\hat{\mathcal{S}}_{N})\xrightarrow{d}\mathcal{N}(0,1).italic_U start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , 1 ) . |   
---|---|---  
  
  6. (f)

(Asymptotic normality when ğœ¶ğœ¶\boldsymbol{\alpha}bold_italic_Î± is estimated independently from ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT.) Maintain the assumptions from part (e)ğ‘’(e)( italic_e ). For sets (ğ’œN)N=1âˆsuperscriptsubscriptsubscriptğ’œğ‘ğ‘1(\mathcal{A}_{N})_{N=1}^{\infty}( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ end_POSTSUPERSCRIPT, let ğœ¶^Nâ¢(ğ’œN)âˆˆâ„|ğ’œN|subscriptbold-^ğœ¶ğ‘subscriptğ’œğ‘superscriptâ„subscriptğ’œğ‘\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A}_{N})\in\mathbb{R}^{|\mathcal{A}_{N}|}overbold_^ start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) âˆˆ blackboard_R start_POSTSUPERSCRIPT | caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT be a sequence of random variables for each ğ’œNsubscriptğ’œğ‘\mathcal{A}_{N}caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT with the properties that for a given data set, ğ’œ=ğ’œâ€²ğ’œsuperscriptğ’œâ€²\mathcal{A}=\mathcal{A}^{\prime}caligraphic_A = caligraphic_A start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT implies ğœ¶^Nâ¢(ğ’œ)=ğœ¶^Nâ¢(ğ’œâ€²)subscriptbold-^ğœ¶ğ‘ğ’œsubscriptbold-^ğœ¶ğ‘superscriptğ’œâ€²\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A})=\boldsymbol{\hat{\alpha}}_{N}(% \mathcal{A^{\prime}})overbold_^ start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) = overbold_^ start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ) and

| Nâ¢Tâ¢(ğœ½Nâˆ—)âŠ¤â¢(ğœ¶^Nâ¢(ğ’®)âˆ’ğœ¶)â†’ğ‘‘ğ’©â¢(ğŸs,vÏˆâ¢(ğœ¶))ğ‘‘â†’ğ‘ğ‘‡superscriptsuperscriptsubscriptğœ½ğ‘topsubscriptbold-^ğœ¶ğ‘ğ’®ğœ¶ğ’©subscript0ğ‘ subscriptğ‘£ğœ“ğœ¶\sqrt{NT}(\boldsymbol{\theta}_{N}^{*})^{\top}\left(\boldsymbol{\hat{\alpha}}_{% N}(\mathcal{S})-\boldsymbol{\alpha}\right)\xrightarrow{d}\mathcal{N}(% \boldsymbol{0}_{s},v_{\psi}(\boldsymbol{\alpha}))square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) - bold_italic_Î± ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( bold_0 start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( bold_italic_Î± ) ) |   
---|---|---  
  
for some
vÏˆâ¢(ğœ¶)>0subscriptğ‘£ğœ“ğœ¶0v_{\psi}(\boldsymbol{\alpha})>0italic_v
start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( bold_italic_Î± ) > 0. Define
the sequence of random vectors
{ğ^Nâ¢(ğ’œN)}N=1âˆsuperscriptsubscriptsubscriptbold-^ğğ‘subscriptğ’œğ‘ğ‘1\\{\boldsymbol{\hat{\psi}}_{N}(\mathcal{A}_{N})\\}_{N=1}^{\infty}{
overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT âˆ end_POSTSUPERSCRIPT to have components in
ğ’œNsubscriptğ’œğ‘\mathcal{A}_{N}caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT equal to
ğœ¶^â¢(ğ’œN)bold-^ğœ¶subscriptğ’œğ‘\boldsymbol{\hat{\alpha}}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_Î± end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) and components
ğ’ƒ^Nâ¢(ğ’œN)subscriptbold-^ğ’ƒğ‘subscriptğ’œğ‘\boldsymbol{\hat{b}}_{N}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_b end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) in the
components corresponding to
[pN]âˆ–ğ’œNdelimited-[]subscriptğ‘ğ‘subscriptğ’œğ‘[p_{N}]\setminus\mathcal{A}_{N}[
italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] âˆ– caligraphic_A
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT that are all almost surely
finite for all Nğ‘Nitalic_N. Define the sequence of random variables

| U2â¢(ğ’œN):=Nâ¢Tâ‹…(ğ^Nâ¢(ğ’œN)âŠ¤â¢ğœ½^(q)âˆ’ğNâ¢(ğ’®)âŠ¤â¢ğœ½Nâˆ—).assignsubscriptğ‘ˆ2subscriptğ’œğ‘â‹…ğ‘ğ‘‡subscriptbold-^ğğ‘superscriptsubscriptğ’œğ‘topsuperscriptbold-^ğœ½ğ‘subscriptğğ‘superscriptğ’®topsuperscriptsubscriptğœ½ğ‘U_{2}(\mathcal{A}_{N}):=\sqrt{NT}\cdot\left(\boldsymbol{\hat{\psi}}_{N}(% \mathcal{A}_{N})^{\top}\boldsymbol{\hat{\theta}}^{(q)}-\boldsymbol{\psi}_{N}(% \mathcal{S})^{\top}\boldsymbol{\theta}_{N}^{*}\right).italic_U start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) := square-root start_ARG italic_N italic_T end_ARG â‹… ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) . |   
---|---|---  
  
Assume
ğœ¶^Nâ¢(ğ’œN)subscriptbold-^ğœ¶ğ‘subscriptğ’œğ‘\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) and
ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT are estimated on independent data sets of size
Nğ‘Nitalic_N. Then if ğœ¶â‰
ğŸğœ¶0\boldsymbol{\alpha}\neq\boldsymbol{0}bold_italic_Î± â‰ bold_0,

| U2â¢(ğ’®^N)â†’ğ‘‘ğ’©â¢(0,Ïƒ2â¢ğœ¶âŠ¤â¢(Covâ¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®))âˆ’1â¢ğœ¶+vÏˆâ¢(ğœ¶)).ğ‘‘â†’subscriptğ‘ˆ2subscript^ğ’®ğ‘ğ’©0superscriptğœ2superscriptğœ¶topsuperscriptCovsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…ğ’®1ğœ¶subscriptğ‘£ğœ“ğœ¶U_{2}(\hat{\mathcal{S}}_{N})\xrightarrow{d}\mathcal{N}\left(0,\sigma^{2}% \boldsymbol{\alpha}^{\top}\left(\mathrm{Cov}\left((\boldsymbol{Z}\boldsymbol{D% }_{N}^{-1})_{(\cdot\cdot)\mathcal{S}}\right)\right)^{-1}\boldsymbol{\alpha}+v_% {\psi}(\boldsymbol{\alpha})\right).italic_U start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_Cov ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± + italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( bold_italic_Î± ) ) . |   
---|---|---  
  
  7. (g)

(Asymptotic normality when ğœ¶ğœ¶\boldsymbol{\alpha}bold_italic_Î± is
estimated independently from
ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT with feasible variance estimator.) Maintain the
assumptions from part (f)ğ‘“(f)( italic_f ). Define the sequence of random
variables U3â¢(ğ’œN)subscriptğ‘ˆ3subscriptğ’œğ‘U_{3}(\mathcal{A}_{N})italic_U
start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT ) to equal

| Nâ¢Tv^Nâ¢(ğ’œN)â‹…(ğ^Nâ¢(ğ’œN)âŠ¤â¢ğœ½^(q)âˆ’ğNâ¢(ğ’®)âŠ¤â¢ğœ½Nâˆ—)â‹…ğ‘ğ‘‡subscript^ğ‘£ğ‘subscriptğ’œğ‘subscriptbold-^ğğ‘superscriptsubscriptğ’œğ‘topsuperscriptbold-^ğœ½ğ‘subscriptğğ‘superscriptğ’®topsuperscriptsubscriptğœ½ğ‘\sqrt{\frac{NT}{\hat{v}_{N}(\mathcal{A}_{N})}}\cdot\left(\boldsymbol{\hat{\psi% }}_{N}(\mathcal{A}_{N})^{\top}\boldsymbol{\hat{\theta}}^{(q)}-\boldsymbol{\psi% }_{N}(\mathcal{S})^{\top}\boldsymbol{\theta}_{N}^{*}\right)square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) end_ARG end_ARG â‹… ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
---|---|---  
  
if ğ’œNâ‰ âˆ…subscriptğ’œğ‘\mathcal{A}_{N}\neq\emptysetcaligraphic_A
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT â‰ âˆ…, ğœ¶^â¢(ğ’œN)â‰
ğŸbold-^ğœ¶subscriptğ’œğ‘0\boldsymbol{\hat{\alpha}}(\mathcal{A}_{N})\neq\boldsymbol{0}overbold_^
start_ARG bold_italic_Î± end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) â‰ bold_0, and
Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’œN)^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…subscriptğ’œğ‘\widehat{\mathrm{Cov}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot%
\cdot)\mathcal{A}_{N}}\right)over^ start_ARG roman_Cov end_ARG ( (
bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹…
) caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
end_POSTSUBSCRIPT ) is invertible and 0 otherwise, where

| v^Nâ¢(ğ’œN):=Ïƒ2â¢ğœ¶^â¢(ğ’œN)âŠ¤â¢(Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’œN))âˆ’1â¢ğœ¶^â¢(ğ’œN)+v^Ïˆâ¢(ğœ¶)assignsubscript^ğ‘£ğ‘subscriptğ’œğ‘superscriptğœ2bold-^ğœ¶superscriptsubscriptğ’œğ‘topsuperscript^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…subscriptğ’œğ‘1bold-^ğœ¶subscriptğ’œğ‘subscript^ğ‘£ğœ“ğœ¶\hat{v}_{N}(\mathcal{A}_{N}):=\sigma^{2}\boldsymbol{\hat{\alpha}}(\mathcal{A}_% {N})^{\top}\left(\widehat{\mathrm{Cov}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}% ^{-1})_{(\cdot\cdot)\mathcal{A}_{N}}\right)\right)^{-1}\boldsymbol{\hat{\alpha% }}(\mathcal{A}_{N})+\hat{v}_{\psi}(\boldsymbol{\alpha})over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) := italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) + over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( bold_italic_Î± ) |  | (C.3)  
---|---|---|---  
  
and v^Ïˆâ¢(ğœ¶)subscript^ğ‘£ğœ“ğœ¶\hat{v}_{\psi}(\boldsymbol{\alpha})over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT (
bold_italic_Î± ) is an estimator of
vÏˆâ¢(ğœ¶)subscriptğ‘£ğœ“ğœ¶v_{\psi}(\boldsymbol{\alpha})italic_v
start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( bold_italic_Î± ) that
satisfies
v^Ïˆâ¢(ğœ¶)â†’ğ‘vÏˆâ¢(ğœ¶)ğ‘â†’subscript^ğ‘£ğœ“ğœ¶subscriptğ‘£ğœ“ğœ¶\hat{v}_{\psi}(\boldsymbol{\alpha})\xrightarrow{p}v_{\psi}(\boldsymbol{\alpha})over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT (
bold_italic_Î± ) start_ARROW overitalic_p â†’ end_ARROW italic_v
start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( bold_italic_Î± ). Assume
ğœ¶^Nâ¢(ğ’œN)subscriptbold-^ğœ¶ğ‘subscriptğ’œğ‘\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) and
ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT are estimated on independent data sets of size
Nğ‘Nitalic_N. Then if ğœ¶â‰
ğŸğœ¶0\boldsymbol{\alpha}\neq\boldsymbol{0}bold_italic_Î± â‰ bold_0,

| U3â¢(ğ’®^N)â†’ğ‘‘ğ’©â¢(0,1).ğ‘‘â†’subscriptğ‘ˆ3subscript^ğ’®ğ‘ğ’©01U_{3}(\hat{\mathcal{S}}_{N})\xrightarrow{d}\mathcal{N}(0,1).italic_U start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , 1 ) . |   
---|---|---  
  
  8. (h)

(Asymptotic subgaussianity when ğœ¶ğœ¶\boldsymbol{\alpha}bold_italic_Î± is
estimated on the same data set as
ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT with feasible variance estimator.) Maintain the
assumptions from part (g)ğ‘”(g)( italic_g ). Define the sequence of random
variables U4â¢(ğ’œN)subscriptğ‘ˆ4subscriptğ’œğ‘U_{4}(\mathcal{A}_{N})italic_U
start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT ) to equal

| Nâ¢Tv^N(cons)â¢(ğ’œN)â‹…(ğ^Nâ¢(ğ’œN)âŠ¤â¢ğœ½^(q)âˆ’ğNâ¢(ğ’®)âŠ¤â¢ğœ½Nâˆ—)â‹…ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘conssubscriptğ’œğ‘subscriptbold-^ğğ‘superscriptsubscriptğ’œğ‘topsuperscriptbold-^ğœ½ğ‘subscriptğğ‘superscriptğ’®topsuperscriptsubscriptğœ½ğ‘\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{cons})}(\mathcal{A}_{N})}}\cdot\left(% \boldsymbol{\hat{\psi}}_{N}(\mathcal{A}_{N})^{\top}\boldsymbol{\hat{\theta}}^{% (q)}-\boldsymbol{\psi}_{N}(\mathcal{S})^{\top}\boldsymbol{\theta}_{N}^{*}\right)square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( cons ) end_POSTSUPERSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) end_ARG end_ARG â‹… ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
---|---|---  
  
if ğ’œNâ‰ âˆ…subscriptğ’œğ‘\mathcal{A}_{N}\neq\emptysetcaligraphic_A
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT â‰ âˆ…, ğœ¶^â¢(ğ’œN)â‰
ğŸbold-^ğœ¶subscriptğ’œğ‘0\boldsymbol{\hat{\alpha}}(\mathcal{A}_{N})\neq\boldsymbol{0}overbold_^
start_ARG bold_italic_Î± end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) â‰ bold_0, and
Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’œN)^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…subscriptğ’œğ‘\widehat{\mathrm{Cov}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot%
\cdot)\mathcal{A}_{N}}\right)over^ start_ARG roman_Cov end_ARG ( (
bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹…
) caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
end_POSTSUBSCRIPT ) is invertible and 0 otherwise, where
v^N(cons)â¢(ğ’œN)superscriptsubscript^ğ‘£ğ‘conssubscriptğ’œğ‘\hat{v}_{N}^{(\text{cons})}(\mathcal{A}_{N})over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( cons ) end_POSTSUPERSCRIPT ( caligraphic_A
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) is defined as

|  | Ïƒ2â¢ğœ¶^â¢(ğ’œN)âŠ¤â¢(Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’œN))âˆ’1â¢ğœ¶^â¢(ğ’œN)superscriptğœ2bold-^ğœ¶superscriptsubscriptğ’œğ‘topsuperscript^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…subscriptğ’œğ‘1bold-^ğœ¶subscriptğ’œğ‘\displaystyle\sigma^{2}\boldsymbol{\hat{\alpha}}(\mathcal{A}_{N})^{\top}\left(% \widehat{\mathrm{Cov}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot% \cdot)\mathcal{A}_{N}}\right)\right)^{-1}\boldsymbol{\hat{\alpha}}(\mathcal{A}% _{N})italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) |   
---|---|---|---  
|  | +2â¢Ïƒ2â¢ğœ¶^â¢(ğ’œN)âŠ¤â¢(Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’œN))âˆ’1â¢ğœ¶^â¢(ğ’œN)â¢v^Ïˆâ¢(ğœ¶)+v^Ïˆâ¢(ğœ¶).2superscriptğœ2bold-^ğœ¶superscriptsubscriptğ’œğ‘topsuperscript^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…subscriptğ’œğ‘1bold-^ğœ¶subscriptğ’œğ‘subscript^ğ‘£ğœ“ğœ¶subscript^ğ‘£ğœ“ğœ¶\displaystyle+2\sqrt{\sigma^{2}\boldsymbol{\hat{\alpha}}(\mathcal{A}_{N})^{% \top}\left(\widehat{\mathrm{Cov}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})% _{(\cdot\cdot)\mathcal{A}_{N}}\right)\right)^{-1}\boldsymbol{\hat{\alpha}}(% \mathcal{A}_{N})\hat{v}_{\psi}(\boldsymbol{\alpha})}+\hat{v}_{\psi}(% \boldsymbol{\alpha}).\+ 2 square-root start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( bold_italic_Î± ) end_ARG + over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( bold_italic_Î± ) . |  | (C.4)  
  
Assume
ğœ¶^Nâ¢(ğ’œN)subscriptbold-^ğœ¶ğ‘subscriptğ’œğ‘\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) and
ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT are estimated on the same data set of size Nğ‘Nitalic_N.
Then if ğœ¶â‰ ğŸğœ¶0\boldsymbol{\alpha}\neq\boldsymbol{0}bold_italic_Î± â‰
bold_0,
U4â¢(ğ’®^N)subscriptğ‘ˆ4subscript^ğ’®ğ‘U_{4}(\hat{\mathcal{S}}_{N})italic_U
start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S
end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) converges in
distribution to a mean-zero subgaussian random variable with variance at most
1.

###### Proof.

Provided in Section F. âˆ

##  Appendix D Extensions of Main Results

Theorem 6.1 is an immediate consequence of the following more general result
that allows for estimands that include broader classes of functions of the
marginal cohort membership probabilities or propensity scores.

######  Theorem D.1 (Consistency of FETWFE; extension of Theorem 6.1).

Assume that Assumptions (CNAS), (CCTSB), and (LINS) hold, as well as
Assumptions (F1), (F2), S(sNsubscriptğ‘ ğ‘s_{N}italic_s start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT), and (R1) - (R3). Let q>0ğ‘0q>0italic_q > 0.

  1. (a)

Suppose that either Assumptions (CTSA) and (CIUN) hold or Assumption (CCTSA)
holds. Then for any set of finite constants
{Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ start_POSTSUBSCRIPT
italic_r italic_t end_POSTSUBSCRIPT },

| |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï„^ATTâ¢(r,t)âˆ’Ï„ATTâ¢(r,t))|=ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœATTğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\hat{\tau}_{\text{ATT% }}(r,t)-\tau_{\text{ATT}}(r,t)\right)\right|=\mathcal{O}_{\mathbb{P}}\left(% \min\\{h_{N},h_{N}^{\prime}\\}\right)| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) | = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) |   
---|---|---  
  
and for any differentiable function
ğ’‡:[0,1]R+1â†’â„R:ğ’‡â†’superscript01ğ‘…1superscriptâ„ğ‘…\boldsymbol{f}:[0,1]^{R+1}\to\mathbb{R}^{R}bold_italic_f
: [ 0 , 1 ] start_POSTSUPERSCRIPT italic_R + 1 end_POSTSUPERSCRIPT â†’
blackboard_R start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT that is
pointwise finite and has a Jacobian
âˆ‡ğ’‡âˆˆâ„(R+1)Ã—Râˆ‡ğ’‡superscriptâ„ğ‘…1ğ‘…\nabla\boldsymbol{f}\in\mathbb{R}^{(R+1)\times
R}âˆ‡ bold_italic_f âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_R + 1 ) Ã—
italic_R end_POSTSUPERSCRIPT at
(Ï€0,Ï€r1,â€¦,Ï€rR)subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})(
italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r
start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) that exists
and is nonzero and finite,

| |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(frâ¢(Ï€^0,Ï€^r1,â€¦,Ï€^rR)â¢Ï„^ATTâ¢(r,t)âˆ’frâ¢(Ï€0,Ï€r1,â€¦,Ï€rR)â¢Ï„ATTâ¢(r,t))|=ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}),subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscript^ğœ‹0subscript^ğœ‹subscriptğ‘Ÿ1â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscript^ğœATTğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…subscriptğœATTğ‘Ÿğ‘¡subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(f_{r}(\hat{\pi}_{0},% \hat{\pi}_{r_{1}},\ldots,\hat{\pi}_{r_{R}})\hat{\tau}_{\text{ATT}}(r,t)-f_{r}(% \pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})\tau_{\text{ATT}}(r,t)\right)\right|=% \mathcal{O}_{\mathbb{P}}\left(\min\\{h_{N},h_{N}^{\prime}\\}\right),| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) | = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) , |   
---|---|---  
  
where
Ï€^r:=Nr/Nassignsubscript^ğœ‹ğ‘Ÿsubscriptğ‘ğ‘Ÿğ‘\hat{\pi}_{r}:=N_{r}/Nover^
start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT :=
italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT / italic_N for all
râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R,
hNâ€²superscriptsubscriptâ„ğ‘â€²h_{N}^{\prime}italic_h start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT is
defined in (6.2), and hNsubscriptâ„ğ‘h_{N}italic_h start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT is defined in (6.3).

  2. (b)

Suppose Assumption (CCTSA) holds and dN=dsubscriptğ‘‘ğ‘ğ‘‘d_{N}=ditalic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = italic_d is fixed. For all
Nğ‘Nitalic_N and all râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r
âˆˆ { 0 } âˆª caligraphic_R, assume all of the eigenvalues of
Covâ¢(ğ‘¿iâˆ£Wi=r)Covconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\mathrm{Cov}(\boldsymbol{X}_{i}\mid
W_{i}=r)roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
= italic_r ) are bounded between
Î»min>0subscriptğœ†min0\lambda_{\text{min}}>0italic_Î» start_POSTSUBSCRIPT min
end_POSTSUBSCRIPT > 0 and
Î»max<âˆsubscriptğœ†max\lambda_{\text{max}}<\inftyitalic_Î»
start_POSTSUBSCRIPT max end_POSTSUBSCRIPT < âˆ. Then for any set of finite
constants {Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT } and any fixed
ğ’™ğ’™\boldsymbol{x}bold_italic_x in the support of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT,

| |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï„^CATTâ¢(r,t,ğ’™)âˆ’Ï„CATTâ¢(r,t,ğ’™))|=ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}).subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœCATTğ‘Ÿğ‘¡ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\displaystyle\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\hat{% \tau}_{\text{CATT}}(r,t,\boldsymbol{x})-\tau_{\text{CATT}}(r,t,\boldsymbol{x})% \right)\right|=\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\}).| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) - italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) | = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) . |   
---|---|---  
  
Further, for any ğ’™ğ’™\boldsymbol{x}bold_italic_x in the support of ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT, let ğ…^â¢(ğ’™)bold-^ğ…ğ’™\boldsymbol{\hat{\pi}}(\boldsymbol{x})overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) be an estimator for Ï€râ¢(ğ’™)subscriptğœ‹ğ‘Ÿğ’™\pi_{r}(\boldsymbol{x})italic_Ï€ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) satisfying |Ï€^râ¢(ğ’™)âˆ’Ï€râ¢(ğ’™)|=ğ’ªâ„™â¢(aN)subscript^ğœ‹ğ‘Ÿğ’™subscriptğœ‹ğ‘Ÿğ’™subscriptğ’ªâ„™subscriptğ‘ğ‘|\hat{\pi}_{r}(\boldsymbol{x})-\pi_{r}(\boldsymbol{x})|=\mathcal{O}_{\mathbb{P% }}(a_{N})| over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) - italic_Ï€ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) | = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) for a decreasing sequence aNsubscriptğ‘ğ‘a_{N}italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT for all râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 } âˆª caligraphic_R, and let ğ’‚rsubscriptğ’‚ğ‘Ÿ\boldsymbol{a}_{r}bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT and ğ’ƒrâˆˆâ„R+1subscriptğ’ƒğ‘Ÿsuperscriptâ„ğ‘…1\boldsymbol{b}_{r}\in\mathbb{R}^{R+1}bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_R + 1 end_POSTSUPERSCRIPT be finite vectors satisfying ğ’‚râŠ¤â¢ğ…â¢(ğ’™)>0superscriptsubscriptğ’‚ğ‘Ÿtopğ…ğ’™0\boldsymbol{a}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})>0bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) > 0 and ğ’ƒrâŠ¤â¢ğ…â¢(ğ’™)>0superscriptsubscriptğ’ƒğ‘Ÿtopğ…ğ’™0\boldsymbol{b}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})>0bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) > 0 for any ğ’™ğ’™\boldsymbol{x}bold_italic_x in the support of ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT. Then

|  | |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(ğ’‚râŠ¤â¢ğ…^â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…^â¢(ğ’™)â¢Ï„^CATTâ¢(r,t,ğ’™)âˆ’ğ’‚râŠ¤â¢ğ…â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…â¢(ğ’™)â¢Ï„CATTâ¢(r,t,ğ’™))|subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptğ’‚ğ‘Ÿtopbold-^ğ…ğ’™superscriptsubscriptğ’ƒğ‘Ÿtopbold-^ğ…ğ’™subscript^ğœCATTğ‘Ÿğ‘¡ğ’™superscriptsubscriptğ’‚ğ‘Ÿtopğ…ğ’™superscriptsubscriptğ’ƒğ‘Ÿtopğ…ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\frac{% \boldsymbol{a}_{r}^{\top}\boldsymbol{{\hat{\pi}}}(\boldsymbol{x})}{\boldsymbol% {b}_{r}^{\top}\boldsymbol{{\hat{\pi}}}(\boldsymbol{x})}\hat{\tau}_{\text{CATT}% }(r,t,\boldsymbol{x})-\frac{\boldsymbol{a}_{r}^{\top}\boldsymbol{{\pi}}(% \boldsymbol{x})}{\boldsymbol{b}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}% \tau_{\text{CATT}}(r,t,\boldsymbol{x})\right)\right|| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) - divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) | |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}âˆ¨aN).subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²subscriptğ‘ğ‘\displaystyle\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\}\vee a_{N}).caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } âˆ¨ italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) . |   
  

###### Proof.

Provided in Section E. âˆ

Theorem D.2 is a similar generalization of Theorem 6.4.

######  Theorem D.2 (Asymptotic Confidence Intervals for FETWFE; extension of
Theorem 6.4).

Assume that Assumptions (CNAS), (CCTSB), and (LINS) hold, as well as
Assumptions (F1), (F2), S(sğ‘ sitalic_s) for a fixed sğ‘ sitalic_s, and (R1) -
(R6). Assume qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 ). Suppose that either
Assumptions (CTSA) and (CIUN) hold or Assumption (CCTSA) holds. Let
{Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ start_POSTSUBSCRIPT
italic_r italic_t end_POSTSUBSCRIPT } be an arbitrary set of finite constants,
and for all of the below results, assume at least one of the
Ï„ATTâ¢(r,t)subscriptğœATTğ‘Ÿğ‘¡\tau_{\text{ATT}}(r,t)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t )
corresponding to a nonzero Ïˆrâ¢tsubscriptğœ“ğ‘Ÿğ‘¡\psi_{rt}italic_Ïˆ
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT is nonzero (otherwise,
all of the below sequences of random variables converge in probability to 0).

  1. (a)

For the estimator (5.9) it holds that

| Nâ¢Tv^N(C)â¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï„^ATTâ¢(r,t)âˆ’Ï„ATTâ¢(r,t))â†’ğ‘‘ğ‘‘â†’ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘Csubscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœATTğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡absent\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{C})}}}\sum_{r\in\mathcal{R}}% \sum_{t=r}^{T}\psi_{rt}(\hat{\tau}_{\text{ATT}}(r,t)-\tau_{\text{ATT}}(r,t))% \xrightarrow{d}\leavevmode\nobreak\ square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C ) end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,1),ğ’©01\displaystyle\mathcal{N}(0,1),caligraphic_N ( 0 , 1 ) , |   
---|---|---|---  
  
where v^N(C)superscriptsubscript^ğ‘£ğ‘C\hat{v}_{N}^{(\text{C})}over^ start_ARG
italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( C ) end_POSTSUPERSCRIPT is a finite-sample variance
estimator defined in (E.7). (All variance estimators depend only on the known
Ïƒ2superscriptğœ2\sigma^{2}italic_Ïƒ start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT and the observed data.)

  2. (b)

Suppose one set of data of size Nğ‘Nitalic_N is used to estimate the cohort
probabilities Nr/NÏ„subscriptğ‘ğ‘Ÿsubscriptğ‘ğœN_{r}/N_{\tau}italic_N
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT / italic_N start_POSTSUBSCRIPT
italic_Ï„ end_POSTSUBSCRIPT and another independent data set of size
Nğ‘Nitalic_N is used to estimate each
Ï„^ATTâ¢(r,t)subscript^ğœATTğ‘Ÿğ‘¡\hat{\tau}_{\text{ATT}}(r,t)over^ start_ARG
italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r ,
italic_t ). Then for any differentiable function
ğ’‡:[0,1]R+1â†’â„R:ğ’‡â†’superscript01ğ‘…1superscriptâ„ğ‘…\boldsymbol{f}:[0,1]^{R+1}\to\mathbb{R}^{R}bold_italic_f
: [ 0 , 1 ] start_POSTSUPERSCRIPT italic_R + 1 end_POSTSUPERSCRIPT â†’
blackboard_R start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT that is
pointwise finite and has a Jacobian
âˆ‡ğ’‡âˆˆâ„(R+1)Ã—Râˆ‡ğ’‡superscriptâ„ğ‘…1ğ‘…\nabla\boldsymbol{f}\in\mathbb{R}^{(R+1)\times
R}âˆ‡ bold_italic_f âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_R + 1 ) Ã—
italic_R end_POSTSUPERSCRIPT at
(Ï€0,Ï€r1,â€¦,Ï€rR)subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})(
italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r
start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) that exists
and is nonzero and finite, it holds that

| Nâ¢Tv^NC;Ï€^â¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(frâ¢(Ï€^r1,Ï€^r2,â€¦,Ï€^rR)â¢Ï„^ATTâ¢(r,t)âˆ’frâ¢(Ï€r1,Ï€r2,â€¦,Ï€rR)â¢Ï„ATTâ¢(r,t))â†’ğ‘‘ğ‘‘â†’ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘C^ğœ‹subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1subscript^ğœ‹subscriptğ‘Ÿ2â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscript^ğœATTğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1subscriptğœ‹subscriptğ‘Ÿ2â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…subscriptğœATTğ‘Ÿğ‘¡absent\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{\text{C};\hat{\pi}}}}\sum_{r\in% \mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(f_{r}\left(\hat{\pi}_{r_{1}},\hat{\pi% }_{r_{2}},\ldots,\hat{\pi}_{r_{R}}\right)\hat{\tau}_{\text{ATT}}(r,t)-f_{r}% \left(\pi_{r_{1}},\pi_{r_{2}},\ldots,\pi_{r_{R}}\right)\tau_{\text{ATT}}(r,t)% \right)\xrightarrow{d}\leavevmode\nobreak\ square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT C ; over^ start_ARG italic_Ï€ end_ARG end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,1),ğ’©01\displaystyle\mathcal{N}(0,1),caligraphic_N ( 0 , 1 ) , |   
---|---|---|---  
  
where
v^NC;Ï€^superscriptsubscript^ğ‘£ğ‘C^ğœ‹\hat{v}_{N}^{\text{C};\hat{\pi}}over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT C ; over^ start_ARG italic_Ï€ end_ARG
end_POSTSUPERSCRIPT is a finite-sample variance estimator defined in (E.11).

  3. (c)

Suppose a single set of data of size Nğ‘Nitalic_N is used to estimate both the
cohort probabilities Nr/NÏ„subscriptğ‘ğ‘Ÿsubscriptğ‘ğœN_{r}/N_{\tau}italic_N
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT / italic_N start_POSTSUBSCRIPT
italic_Ï„ end_POSTSUBSCRIPT and each
Ï„^ATTâ¢(r,t)subscript^ğœATTğ‘Ÿğ‘¡\hat{\tau}_{\text{ATT}}(r,t)over^ start_ARG
italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r ,
italic_t ). Then for any differentiable function
ğ’‡:[0,1]R+1â†’â„R:ğ’‡â†’superscript01ğ‘…1superscriptâ„ğ‘…\boldsymbol{f}:[0,1]^{R+1}\to\mathbb{R}^{R}bold_italic_f
: [ 0 , 1 ] start_POSTSUPERSCRIPT italic_R + 1 end_POSTSUPERSCRIPT â†’
blackboard_R start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT that is
pointwise finite and has a Jacobian
âˆ‡ğ’‡âˆˆâ„(R+1)Ã—Râˆ‡ğ’‡superscriptâ„ğ‘…1ğ‘…\nabla\boldsymbol{f}\in\mathbb{R}^{(R+1)\times
R}âˆ‡ bold_italic_f âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_R + 1 ) Ã—
italic_R end_POSTSUPERSCRIPT at
(Ï€0,Ï€r1,â€¦,Ï€rR)subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})(
italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r
start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) that exists
and is nonzero and finite, the estimator (5.10) is asymptotically subgaussian:
the sequence of random variables

| Nâ¢Tv^NC, (cons);Ï€^â¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(frâ¢(Ï€^r1,Ï€^r2,â€¦,Ï€^rR)â¢Ï„^ATTâ¢(r,t)âˆ’frâ¢(Ï€r1,Ï€r2,â€¦,Ï€rR)â¢Ï„ATTâ¢(r,t))ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘C, (cons)^ğœ‹subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1subscript^ğœ‹subscriptğ‘Ÿ2â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscript^ğœATTğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1subscriptğœ‹subscriptğ‘Ÿ2â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…subscriptğœATTğ‘Ÿğ‘¡\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{\text{C, (cons)};\hat{\pi}}}}\sum_{r% \in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(f_{r}\left(\hat{\pi}_{r_{1}},\hat{% \pi}_{r_{2}},\ldots,\hat{\pi}_{r_{R}}\right)\hat{\tau}_{\text{ATT}}(r,t)-f_{r}% \left(\pi_{r_{1}},\pi_{r_{2}},\ldots,\pi_{r_{R}}\right)\tau_{\text{ATT}}(r,t)\right)square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT C, (cons) ; over^ start_ARG italic_Ï€ end_ARG end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) |   
---|---|---  
  
converges in distribution to a mean-zero subgaussian random variable with
variance at most 1, where v^NC, (cons);Ï€^superscriptsubscript^ğ‘£ğ‘C,
(cons)^ğœ‹\hat{v}_{N}^{\text{C, (cons)};\hat{\pi}}over^ start_ARG italic_v
end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
C, (cons) ; over^ start_ARG italic_Ï€ end_ARG end_POSTSUPERSCRIPT is a finite-
sample conservative variance estimator defined in (E.12).

###### Proof.

Provided in Section E. âˆ

Theorem D.3 shows the asymptotic normality of two classes of conditional
treatment effect estimators, analogously to Theorem D.2, and provides
consistent variance estimators for constructing asymptotically valid
confidence intervals. It also provides sufficient assumptions for the FETWFE
estimators of conditional average treatment effects to converge at
1/N1ğ‘1/\sqrt{N}1 / square-root start_ARG italic_N end_ARG rates.

######  Theorem D.3 (Asymptotic Confidence Intervals for conditional average
treatment effects in FETWFE).

Assume that Assumptions (CNAS), (CCTS), and (LINS) hold, as well as
Assumptions (F1), (F2), S(sğ‘ sitalic_s) for a fixed sğ‘ sitalic_s, and (R1) -
(R6). Assume qâˆˆ(0,1)ğ‘01q\in(0,1)italic_q âˆˆ ( 0 , 1 ), and assume
dN=dsubscriptğ‘‘ğ‘ğ‘‘d_{N}=ditalic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT = italic_d is fixed. Let
{Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ start_POSTSUBSCRIPT
italic_r italic_t end_POSTSUBSCRIPT } be an arbitrary set of finite constants,
and for both of the below results, assume at least one of the
Ï„CATTâ¢(r,t,ğ±)subscriptğœCATTğ‘Ÿğ‘¡ğ±\tau_{\text{CATT}}(r,t,\boldsymbol{x})italic_Ï„
start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t ,
bold_italic_x ) corresponding to a nonzero
Ïˆrâ¢tsubscriptğœ“ğ‘Ÿğ‘¡\psi_{rt}italic_Ïˆ start_POSTSUBSCRIPT italic_r
italic_t end_POSTSUBSCRIPT is nonzero (otherwise, all of the below sequences
of random variables converge in probability to 0).

  1. (a)

For
Ï„^CATTâ¢(r,t,ğ’™)subscript^ğœCATTğ‘Ÿğ‘¡ğ’™\hat{\tau}_{\text{CATT}}(r,t,\boldsymbol{x})over^
start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT (
italic_r , italic_t , bold_italic_x ) as defined in (5.5), suppose one set of
data of size Nğ‘Nitalic_N is used to estimate each cohort conditional
covariate mean
ğ‘¿Â¯rsubscriptbold-Â¯ğ‘¿ğ‘Ÿ\boldsymbol{\overline{X}}_{r}overbold_Â¯ start_ARG
bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT and
another independent data set of size Nğ‘Nitalic_N is used to estimate each
Ï„^râ¢t(q)superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘\hat{\tau}_{rt}^{(q)}over^ start_ARG
italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT and
Ï^râ¢t(q)superscriptsubscript^ğœŒğ‘Ÿğ‘¡ğ‘\hat{\rho}_{rt}^{(q)}over^ start_ARG
italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT via the FETWFE
regression. Then for any set of finite constants
{Ïˆrâ¢t}râˆˆâ„›,tâˆˆ{r,â€¦,T}subscriptsubscriptğœ“ğ‘Ÿğ‘¡formulae-
sequenceğ‘Ÿâ„›ğ‘¡ğ‘Ÿâ€¦ğ‘‡\\{\psi_{rt}\\}_{r\in\mathcal{R},t\in\\{r,\ldots,T\\}}{
italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT }
start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R , italic_t âˆˆ { italic_r , â€¦
, italic_T } end_POSTSUBSCRIPT and any fixed ğ’™ğ’™\boldsymbol{x}bold_italic_x
in the support of ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT, it holds that

| Nâ¢Tv^N(C;CATT)â¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï„^CATTâ¢(r,t,ğ’™)âˆ’Ï„CATTâ¢(r,t,ğ’™))â†’ğ‘‘ğ‘‘â†’ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘C;CATTsubscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœCATTğ‘Ÿğ‘¡ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™absent\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{C;CATT})}}}\sum_{r\in\mathcal% {R}}\sum_{t=r}^{T}\psi_{rt}(\hat{\tau}_{\text{CATT}}(r,t,\boldsymbol{x})-\tau_% {\text{CATT}}(r,t,\boldsymbol{x}))\xrightarrow{d}\leavevmode\nobreak\ square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) - italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,1),ğ’©01\displaystyle\mathcal{N}(0,1),caligraphic_N ( 0 , 1 ) , |   
---|---|---|---  
  
where
v^N(C;CATT)superscriptsubscript^ğ‘£ğ‘C;CATT\hat{v}_{N}^{(\text{C;CATT})}over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT is a finite-sample
variance estimator defined in (E.13).

  2. (b)

Assume we have an estimator
(Ï€^0â¢(ğ’™),Ï€^r1â¢(ğ’™),â€¦,Ï€^rRâ¢(ğ’™))subscript^ğœ‹0ğ’™subscript^ğœ‹subscriptğ‘Ÿ1ğ’™â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’™(\hat{\pi}_{0}(\boldsymbol{x}),\hat{\pi}_{r_{1}}(\boldsymbol{x}),\ldots,\hat{%
\pi}_{r_{R}}(\boldsymbol{x}))( over^ start_ARG italic_Ï€ end_ARG
start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG
italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1
end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG
italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R
end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) of the generalized
propensity scores
(Ï€0â¢(ğ’™),Ï€r1â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))subscriptğœ‹0ğ’™subscriptğœ‹subscriptğ‘Ÿ1ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™(\pi_{0}(\boldsymbol{x}),\pi_{r_{1}}(\boldsymbol{x}),\ldots,\pi_{r_{R}}(%
\boldsymbol{x}))( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT (
bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1
end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT
end_POSTSUBSCRIPT ( bold_italic_x ) ) that satisfies for any fixed
ğ’™ğ’™\boldsymbol{x}bold_italic_x in the support of
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT

| Nâ¢(Ï€^0â¢(ğ’™)âˆ’Ï€0â¢(ğ’™),Ï€^r1â¢(ğ’™)âˆ’Ï€r1â¢(ğ’™),â€¦,Ï€^rRâ¢(ğ’™)âˆ’Ï€rRâ¢(ğ’™))â†’ğ‘‘ğ’©â¢(0,ğšºÏ€)ğ‘‘â†’ğ‘subscript^ğœ‹0ğ’™subscriptğœ‹0ğ’™subscript^ğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ1ğ’™â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’™subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™ğ’©0subscriptğšºğœ‹\sqrt{N}\left(\hat{\pi}_{0}(\boldsymbol{x})-\pi_{0}(\boldsymbol{x}),\hat{\pi}_% {r_{1}}(\boldsymbol{x})-\pi_{r_{1}}(\boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(% \boldsymbol{x})-\pi_{r_{R}}(\boldsymbol{x})\right)\xrightarrow{d}\mathcal{N}(0% ,\boldsymbol{\Sigma}_{\pi})square-root start_ARG italic_N end_ARG ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_x ) - italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , bold_Î£ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT ) |   
---|---|---  
  
for some finite positive definite
ğšºÏ€âˆˆâ„(R+1)Ã—(R+1)subscriptğšºğœ‹superscriptâ„ğ‘…1ğ‘…1\boldsymbol{\Sigma}_{\pi}\in\mathbb{R}^{(R+1)\times(R+1)}bold_Î£
start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT âˆˆ blackboard_R
start_POSTSUPERSCRIPT ( italic_R + 1 ) Ã— ( italic_R + 1 )
end_POSTSUPERSCRIPT. Assume we also have available a consistent estimator
ğšº^Ï€subscriptbold-^ğšºğœ‹\boldsymbol{\hat{\Sigma}}_{\pi}overbold_^ start_ARG
bold_Î£ end_ARG start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT that converges
entrywise in probability to
ğšºÏ€subscriptğšºğœ‹\boldsymbol{\Sigma}_{\pi}bold_Î£ start_POSTSUBSCRIPT
italic_Ï€ end_POSTSUBSCRIPT. Suppose one set of data of size Nğ‘Nitalic_N is
used to estimate each cohort conditional covariate mean
ğ‘¿Â¯rsubscriptbold-Â¯ğ‘¿ğ‘Ÿ\boldsymbol{\overline{X}}_{r}overbold_Â¯ start_ARG
bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT, another
independent data set of size Nğ‘Nitalic_N is used to estimate each
Ï„^râ¢t(q)superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘\hat{\tau}_{rt}^{(q)}over^ start_ARG
italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT and
Ï^râ¢t(q)superscriptsubscript^ğœŒğ‘Ÿğ‘¡ğ‘\hat{\rho}_{rt}^{(q)}over^ start_ARG
italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT via the FETWFE
regression, and a third independent data set is used to estimate the
generalized propensity scores. Then for any differentiable function
f:[0,1]R+1â†’â„R:ğ‘“â†’superscript01ğ‘…1superscriptâ„ğ‘…f:[0,1]^{R+1}\to\mathbb{R}^{R}italic_f
: [ 0 , 1 ] start_POSTSUPERSCRIPT italic_R + 1 end_POSTSUPERSCRIPT â†’
blackboard_R start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT that is
pointwise finite and has a Jacobian
âˆ‡ğ’‡âˆˆâ„(R+1)Ã—Râˆ‡ğ’‡superscriptâ„ğ‘…1ğ‘…\nabla\boldsymbol{f}\in\mathbb{R}^{(R+1)\times
R}âˆ‡ bold_italic_f âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_R + 1 ) Ã—
italic_R end_POSTSUPERSCRIPT at
(Ï€0â¢(ğ’™),Ï€r1â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))subscriptğœ‹0ğ’™subscriptğœ‹subscriptğ‘Ÿ1ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™(\pi_{0}(\boldsymbol{x}),\pi_{r_{1}}(\boldsymbol{x}),\ldots,\pi_{r_{R}}(%
\boldsymbol{x}))( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT (
bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1
end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT
end_POSTSUBSCRIPT ( bold_italic_x ) ) that exists and is nonzero and finite,
it holds that

| Nâ¢Tv^N(C;CATT,â¢Ï€)âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢t(fr(Ï€^r1(ğ’™),Ï€^r2(ğ’™),â€¦,Ï€^rR(ğ’™))Ï„^CATT(r,t,ğ’™)\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{C;CATT,}\pi)}}}\sum_{r\in% \mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\big{(}f_{r}\left(\hat{\pi}_{r_{1}}(% \boldsymbol{x}),\hat{\pi}_{r_{2}}(\boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(% \boldsymbol{x})\right)\hat{\tau}_{\text{CATT}}(r,t,\boldsymbol{x})square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) |   
---|---|---  
| âˆ’fr(Ï€r1(ğ’™),Ï€r2(ğ’™),â€¦,Ï€rR(ğ’™))Ï„CATT(r,t,ğ’™))â†’ğ‘‘ğ’©(0,1),\displaystyle-f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x% }),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\tau_{\text{CATT}}(r,t,\boldsymbol% {x})\big{)}\xrightarrow{d}\mathcal{N}(0,1),\- italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , 1 ) , |   
  
where
v^N(C;CATT,â¢Ï€)superscriptsubscript^ğ‘£ğ‘C;CATT,ğœ‹\hat{v}_{N}^{(\text{C;CATT,}\pi)}over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT is a finite-
sample variance estimator defined in (E.16).

###### Proof.

Provided in Section E. âˆ

It is trivial to extend Theorem D.3 to show that these classes of conditional
average treatment effect estimators enjoy oracle properties analogous to those
of Theorem 6.3. Theorem D.3 applies immediately to the classes of conditional
average treatment effects estimators (5.6) and (5.7) by the same argument we
used to prove Theorem 6.1 since the Jacobian
âˆ‡ğ’‡âˆˆâ„(R+1)Ã—Râˆ‡ğ’‡superscriptâ„ğ‘…1ğ‘…\nabla\boldsymbol{f}\in\mathbb{R}^{(R+1)\times
R}âˆ‡ bold_italic_f âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_R + 1 ) Ã—
italic_R end_POSTSUPERSCRIPT

| âˆ‡ğ’‡:=(00â‹¯0âˆ‘râ€²âˆˆâ„›âˆ–r1Ï€râ€²â¢(ğ’™)(âˆ‘râ€²âˆˆâ„›Ï€râ€²â¢(ğ’™))2âˆ’Ï€r2â¢(ğ’™)(âˆ‘râ€²âˆˆâ„›Ï€râ€²â¢(ğ’™))2â‹¯âˆ’Ï€rRâ¢(ğ’™)(âˆ‘râ€²âˆˆâ„›Ï€râ€²â¢(ğ’™))2âˆ’Ï€r1â¢(ğ’™)(âˆ‘râ€²âˆˆâ„›Ï€râ€²â¢(ğ’™))2âˆ‘râ€²âˆˆâ„›âˆ–r2Ï€râ€²â¢(ğ’™)(âˆ‘râ€²âˆˆâ„›Ï€râ€²â¢(ğ’™))2â‹¯âˆ’Ï€rRâ¢(ğ’™)(âˆ‘râ€²âˆˆâ„›Ï€râ€²â¢(ğ’™))2â‹®â‹®â‹±â‹®âˆ’Ï€r1â¢(ğ’™)(âˆ‘râ€²âˆˆâ„›Ï€râ€²â¢(ğ’™))2âˆ’Ï€r2â¢(ğ’™)(âˆ‘râ€²âˆˆâ„›Ï€râ€²â¢(ğ’™))2â‹¯âˆ‘râ€²âˆˆâ„›âˆ–rRÏ€râ€²â¢(ğ’™)(âˆ‘râ€²âˆˆâ„›Ï€râ€²â¢(ğ’™))2)assignâˆ‡ğ’‡matrix00â‹¯0subscriptsuperscriptğ‘Ÿâ€²â„›subscriptğ‘Ÿ1subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™superscriptsubscriptsuperscriptğ‘Ÿâ€²â„›subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™2subscriptğœ‹subscriptğ‘Ÿ2ğ’™superscriptsubscriptsuperscriptğ‘Ÿâ€²â„›subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™2â‹¯subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsubscriptsuperscriptğ‘Ÿâ€²â„›subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™2subscriptğœ‹subscriptğ‘Ÿ1ğ’™superscriptsubscriptsuperscriptğ‘Ÿâ€²â„›subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™2subscriptsuperscriptğ‘Ÿâ€²â„›subscriptğ‘Ÿ2subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™superscriptsubscriptsuperscriptğ‘Ÿâ€²â„›subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™2â‹¯subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsubscriptsuperscriptğ‘Ÿâ€²â„›subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™2â‹®â‹®â‹±â‹®subscriptğœ‹subscriptğ‘Ÿ1ğ’™superscriptsubscriptsuperscriptğ‘Ÿâ€²â„›subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™2subscriptğœ‹subscriptğ‘Ÿ2ğ’™superscriptsubscriptsuperscriptğ‘Ÿâ€²â„›subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™2â‹¯subscriptsuperscriptğ‘Ÿâ€²â„›subscriptğ‘Ÿğ‘…subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™superscriptsubscriptsuperscriptğ‘Ÿâ€²â„›subscriptğœ‹superscriptğ‘Ÿâ€²ğ’™2\nabla\boldsymbol{f}:=\begin{pmatrix}0&0&\cdots&0\\\ \frac{\sum_{r^{\prime}\in\mathcal{R}\setminus r_{1}}\pi_{r^{\prime}}(% \boldsymbol{x})}{\left(\sum_{r^{\prime}\in\mathcal{R}}\pi_{r^{\prime}}(% \boldsymbol{x})\right)^{2}}&\frac{-\pi_{r_{2}}(\boldsymbol{x})}{\left(\sum_{r^% {\prime}\in\mathcal{R}}\pi_{r^{\prime}}(\boldsymbol{x})\right)^{2}}&\cdots&% \frac{-\pi_{r_{R}}(\boldsymbol{x})}{\left(\sum_{r^{\prime}\in\mathcal{R}}\pi_{% r^{\prime}}(\boldsymbol{x})\right)^{2}}\\\ \frac{-\pi_{r_{1}}(\boldsymbol{x})}{\left(\sum_{r^{\prime}\in\mathcal{R}}\pi_{% r^{\prime}}(\boldsymbol{x})\right)^{2}}&\frac{\sum_{r^{\prime}\in\mathcal{R}% \setminus r_{2}}\pi_{r^{\prime}}(\boldsymbol{x})}{\left(\sum_{r^{\prime}\in% \mathcal{R}}\pi_{r^{\prime}}(\boldsymbol{x})\right)^{2}}&\cdots&\frac{-\pi_{r_% {R}}(\boldsymbol{x})}{\left(\sum_{r^{\prime}\in\mathcal{R}}\pi_{r^{\prime}}(% \boldsymbol{x})\right)^{2}}\\\ \vdots&\vdots&\ddots&\vdots\\\ \frac{-\pi_{r_{1}}(\boldsymbol{x})}{\left(\sum_{r^{\prime}\in\mathcal{R}}\pi_{% r^{\prime}}(\boldsymbol{x})\right)^{2}}&\frac{-\pi_{r_{2}}(\boldsymbol{x})}{% \left(\sum_{r^{\prime}\in\mathcal{R}}\pi_{r^{\prime}}(\boldsymbol{x})\right)^{% 2}}&\cdots&\frac{\sum_{r^{\prime}\in\mathcal{R}\setminus r_{R}}\pi_{r^{\prime}% }(\boldsymbol{x})}{\left(\sum_{r^{\prime}\in\mathcal{R}}\pi_{r^{\prime}}(% \boldsymbol{x})\right)^{2}}\end{pmatrix}âˆ‡ bold_italic_f := ( start_ARG start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL â‹¯ end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL divide start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R âˆ– italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL divide start_ARG - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL â‹¯ end_CELL start_CELL divide start_ARG - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL end_ROW start_ROW start_CELL divide start_ARG - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL divide start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R âˆ– italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL â‹¯ end_CELL start_CELL divide start_ARG - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL end_ROW start_ROW start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹± end_CELL start_CELL â‹® end_CELL end_ROW start_ROW start_CELL divide start_ARG - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL divide start_ARG - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL â‹¯ end_CELL start_CELL divide start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R âˆ– italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL end_ROW end_ARG ) |   
---|---|---  
  
at
(Ï€0â¢(ğ’™),Ï€r1â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))subscriptğœ‹0ğ’™subscriptğœ‹subscriptğ‘Ÿ1ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™(\pi_{0}(\boldsymbol{x}),\pi_{r_{1}}(\boldsymbol{x}),\ldots,\pi_{r_{R}}(%
\boldsymbol{x}))( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT (
bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1
end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT
end_POSTSUBSCRIPT ( bold_italic_x ) ) and exists and is nonzero and finite by
Assumption (F2).

##  Appendix E Proofs of Main Results

We present two lemmas we will use in the following proofs.

######  Lemma E.1.

The number of treatment effects ğ”šğ”š\mathfrak{W}fraktur_W is at most
(Tâˆ’1)2superscriptğ‘‡12(T-1)^{2}( italic_T - 1 ) start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT. Further, after re-ordering the columns of
ğ™~bold-~ğ™\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG,
we can write ğƒNsubscriptğƒğ‘\boldsymbol{D}_{N}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT as

| diagâ¡(ğ‘«(1)â¢(R),ğ‘«(1)â¢(Tâˆ’1),ğ‘°dN,ğ‘°dNâŠ—ğ‘«(1)â¢(R),ğ‘°dNâŠ—ğ‘«(1)â¢(Tâˆ’1),ğ‘«(2)â¢(â„›),ğ‘°dNâŠ—ğ‘«(2)â¢(â„›)),diagsuperscriptğ‘«1ğ‘…superscriptğ‘«1ğ‘‡1subscriptğ‘°subscriptğ‘‘ğ‘tensor-productsubscriptğ‘°subscriptğ‘‘ğ‘superscriptğ‘«1ğ‘…tensor-productsubscriptğ‘°subscriptğ‘‘ğ‘superscriptğ‘«1ğ‘‡1superscriptğ‘«2â„›tensor-productsubscriptğ‘°subscriptğ‘‘ğ‘superscriptğ‘«2â„›\operatorname{diag}\big{(}\boldsymbol{D}^{(1)}(R),\boldsymbol{D}^{(1)}(T-1),% \boldsymbol{I}_{d_{N}},\boldsymbol{I}_{d_{N}}\otimes\boldsymbol{D}^{(1)}(R),% \boldsymbol{I}_{d_{N}}\otimes\boldsymbol{D}^{(1)}(T-1),\boldsymbol{D}^{(2)}(% \mathcal{R}),\boldsymbol{I}_{d_{N}}\otimes\boldsymbol{D}^{(2)}(\mathcal{R})% \big{)},roman_diag ( bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_R ) , bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_T - 1 ) , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT âŠ— bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_R ) , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT âŠ— bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_T - 1 ) , bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT âŠ— bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) ) , |  | (E.1)  
---|---|---|---  
  
where
ğƒ(1)â¢(t)âˆˆâ„tÃ—tsuperscriptğƒ1ğ‘¡superscriptâ„ğ‘¡ğ‘¡\boldsymbol{D}^{(1)}(t)\in\mathbb{R}^{t\times
t}bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_t )
âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_t Ã— italic_t
end_POSTSUPERSCRIPT is defined in (G.4) and
ğƒ(2)â¢(â„›)âˆˆâ„ğ”šÃ—ğ”šsuperscriptğƒ2â„›superscriptâ„ğ”šğ”š\boldsymbol{D}^{(2)}(\mathcal{R})\in\mathbb{R}^{\mathfrak{W}\times\mathfrak{W}}bold_italic_D
start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) âˆˆ
blackboard_R start_POSTSUPERSCRIPT fraktur_W Ã— fraktur_W end_POSTSUPERSCRIPT
is defined in (G.5). Further, ğƒNsubscriptğƒğ‘\boldsymbol{D}_{N}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT is invertible, and
ğƒNâˆ’1superscriptsubscriptğƒğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT can be written as

| diag(\displaystyle\operatorname{diag}\Big{(}roman_diag ( | ğ‘«(1)(R)âˆ’1,((ğ‘«(1)(Tâˆ’1))âˆ’1,ğ‘°dN,ğ‘°dNâŠ—ğ‘«(1)(R)âˆ’1,ğ‘°dNâŠ—((ğ‘«(1)(Tâˆ’1))âˆ’1,\displaystyle\boldsymbol{D}^{(1)}(R)^{-1},((\boldsymbol{D}^{(1)}(T-1))^{-1},% \boldsymbol{I}_{d_{N}},\boldsymbol{I}_{d_{N}}\otimes\boldsymbol{D}^{(1)}(R)^{-% 1},\boldsymbol{I}_{d_{N}}\otimes((\boldsymbol{D}^{(1)}(T-1))^{-1},bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_R ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , ( ( bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_T - 1 ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT âŠ— bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_R ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT âŠ— ( ( bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_T - 1 ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , |   
---|---|---|---  
|  | (ğ‘«(2)(â„›))âˆ’1,ğ‘°dNâŠ—(ğ‘«(2)(â„›))âˆ’1).\displaystyle(\boldsymbol{D}^{(2)}(\mathcal{R}))^{-1},\boldsymbol{I}_{d_{N}}% \otimes(\boldsymbol{D}^{(2)}(\mathcal{R}))^{-1}\Big{)}.( bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT âŠ— ( bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) . |  | (E.2)  
  
Finally, both ğƒNsubscriptğƒğ‘\boldsymbol{D}_{N}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT and
ğƒNâˆ’1superscriptsubscriptğƒğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT consists of blocks of size at most
(Tâˆ’1)2Ã—(Tâˆ’1)2superscriptğ‘‡12superscriptğ‘‡12(T-1)^{2}\times(T-1)^{2}(
italic_T - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT Ã— ( italic_T - 1 )
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT. For
ğƒNsubscriptğƒğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT the entries of these blocks are either âˆ’11-1\- 1, 0, or 1;
and for ğƒNâˆ’1superscriptsubscriptğƒğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT the entries of these blocks are either 0 or 1. Both
matrices equal 0 elsewhere.

######  Lemma E.2.

Under Assumption (R3), maxjâˆˆpNâ¡{|(ğ›ƒNâˆ—)j|}â‰¤(Tâˆ’1)2â¢b1subscriptğ‘—subscriptğ‘ğ‘subscriptsuperscriptsubscriptğ›ƒğ‘ğ‘—superscriptğ‘‡12subscriptğ‘1\max_{j\in p_{N}}\\{|(\boldsymbol{\beta}_{N}^{*})_{j}|\\}\leq(T-1)^{2}b_{1}roman_max start_POSTSUBSCRIPT italic_j âˆˆ italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT { | ( bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | } â‰¤ ( italic_T - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT.

Proofs of both results are provided in Appendix G.2.

###  E.1 Proofs of Theorems D.1 and 6.1

We start by proving Theorem D.1, which leads almost immediately to a proof of
Theorem 6.1.

###### Proof of Theorem D.1.

  1. (a)

Observe that under our assumptions our model is correctly specified due to
Theorem C.1(a). Recall that due to Theorem A.5, under our assumptions the
regression estimands correspond to our causal estimands.

Examining our estimator
Ï„^ATTâ¢(r,t)subscript^ğœATTğ‘Ÿğ‘¡\hat{\tau}_{\text{ATT}}(r,t)over^ start_ARG
italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r ,
italic_t ) for the average treatment effect for a unit in cohort rğ‘Ÿritalic_r
at time tğ‘¡titalic_t from (5.8), we see that we can then apply Theorem C.1(b)
to immediately obtain that for every râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ
caligraphic_R and tâ‰¥rğ‘¡ğ‘Ÿt\geq ritalic_t â‰¥ italic_r,

| |Ï„^ATTâ¢(r,t)âˆ’Ï„ATTâ¢(r,t)|=|Ï„^râ¢t(q)âˆ’Ï„râ¢tâˆ—|â‰¤âˆ¥ğœ·^(q)âˆ’ğœ·Nâˆ—âˆ¥2=ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}).subscript^ğœATTğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘superscriptsubscriptğœğ‘Ÿğ‘¡subscriptdelimited-âˆ¥âˆ¥superscriptbold-^ğœ·ğ‘superscriptsubscriptğœ·ğ‘2subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\left|\hat{\tau}_{\text{ATT}}(r,t)-\tau_{\text{ATT}}(r,t)\right|=\left|\hat{% \tau}_{rt}^{(q)}-\tau_{rt}^{*}\right|\leq\lVert\boldsymbol{\hat{\beta}}^{(q)}-% \boldsymbol{\beta}_{N}^{*}\rVert_{2}=\mathcal{O}_{\mathbb{P}}\left(\min\\{h_{N}% ,h_{N}^{\prime}\\}\right).| over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) | = | over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT | â‰¤ âˆ¥ overbold_^ start_ARG bold_italic_Î² end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) . |  | (E.3)  
---|---|---|---  
  
Similarly, for any deterministic fixed linear combination of average treatment
effects, using (E.3) and Theorem A.5 we have that for our class of estimators
(5.9) and estimands (4.8),

| |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢Ï„^ATTâ¢(r,t)âˆ’âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢Ï„ATTâ¢(r,t)|â‰¤subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœATTğ‘Ÿğ‘¡subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡absent\displaystyle\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\hat{\tau}_{% \text{ATT}}(r,t)-\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\tau_{\text{ATT}% }(r,t)\right|\leq\leavevmode\nobreak\ | âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) | â‰¤ | âˆ‘râˆˆâ„›âˆ‘t=rT|Ïˆrâ¢t|â¢|Ï„^ATTâ¢(r,t)âˆ’Ï„ATTâ¢(r,t)|subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœATTğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}|\psi_{rt}|\left|\hat{\tau}_{% \text{ATT}}(r,t)-\tau_{\text{ATT}}(r,t)\right|âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT | italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT | | over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) | |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}),subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\displaystyle\mathcal{O}_{\mathbb{P}}\left(\min\\{h_{N},h_{N}^{\prime}\\}\right),caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) , |   
  
where we used the fact that Tğ‘‡Titalic_T is fixed (and upper bounds
Rğ‘…Ritalic_R).

Next we characterize the rate of convergence of each
frâ¢(Ï€^0,Ï€^r1,â€¦,Ï€^rR)subscriptğ‘“ğ‘Ÿsubscript^ğœ‹0subscript^ğœ‹subscriptğ‘Ÿ1â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…f_{r}(\hat{\pi}_{0},\hat{\pi}_{r_{1}},\ldots,\hat{\pi}_{r_{R}})italic_f
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€
end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€
end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT
end_POSTSUBSCRIPT ). Because by assumption
ğ’‡â¢(â‹…)ğ’‡â‹…\boldsymbol{f}(\cdot)bold_italic_f ( â‹… ) has a finite
Jacobian
âˆ‡ğ’‡âˆˆâ„(R+1)Ã—Râˆ‡ğ’‡superscriptâ„ğ‘…1ğ‘…\nabla\boldsymbol{f}\in\mathbb{R}^{(R+1)\times
R}âˆ‡ bold_italic_f âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_R + 1 ) Ã—
italic_R end_POSTSUPERSCRIPT at
(Ï€0,Ï€r1,â€¦,Ï€rR)subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})(
italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r
start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) that exists
and is nonzero and finite, we have by the asymptotic normality of the maximum
likelihood estimator
(N0N,Nr1N,Nr2N,â€¦,NrRN)subscriptğ‘0ğ‘subscriptğ‘subscriptğ‘Ÿ1ğ‘subscriptğ‘subscriptğ‘Ÿ2ğ‘â€¦subscriptğ‘subscriptğ‘Ÿğ‘…ğ‘\left(\frac{N_{0}}{N},\frac{N_{r_{1}}}{N},\frac{N_{r_{2}}}{N},\ldots,\frac{N_{%
r_{R}}}{N}\right)( divide start_ARG italic_N start_POSTSUBSCRIPT 0
end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG , divide start_ARG
italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG , divide start_ARG
italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG , â€¦ , divide start_ARG
italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R
end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG )
(Theorem 14.6 in Wasserman 2004) and the delta method (Theorem 3.1 in vanÂ der
Vaart 2000) that

| Nâ¢(fâ¢(Ï€^0,Ï€^r1,â€¦,Ï€^rR)âˆ’fâ¢(Ï€0,Ï€r1,â€¦,Ï€rR))â†’ğ‘‘ğ‘‘â†’ğ‘ğ‘“subscript^ğœ‹0subscript^ğœ‹subscriptğ‘Ÿ1â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ‘“subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…absent\displaystyle\sqrt{N}\left(f(\hat{\pi}_{0},\hat{\pi}_{r_{1}},\ldots,\hat{\pi}_% {r_{R}})-f(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})\right)\xrightarrow{d}% \leavevmode\nobreak\ square-root start_ARG italic_N end_ARG ( italic_f ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - italic_f ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,âˆ‡ğ’‡âŠ¤â¢ğšºMâ¢âˆ‡ğ’‡)ğ’©0âˆ‡superscriptğ’‡topsubscriptğšºğ‘€âˆ‡ğ’‡\displaystyle\mathcal{N}(0,\nabla\boldsymbol{f}^{\top}\boldsymbol{\Sigma}_{M}% \nabla\boldsymbol{f})caligraphic_N ( 0 , âˆ‡ bold_italic_f start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_Î£ start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT âˆ‡ bold_italic_f ) |   
---|---|---|---  
| âŸ¹Nâ¢(frâ€²â¢(Ï€^0,Ï€^r1,â€¦,Ï€^rR)âˆ’frâ€²â¢(Ï€0,Ï€r1,â€¦,Ï€rR))â†’ğ‘‘ğ‘‘â†’ğ‘subscriptğ‘“superscriptğ‘Ÿâ€²subscript^ğœ‹0subscript^ğœ‹subscriptğ‘Ÿ1â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscriptğ‘“superscriptğ‘Ÿâ€²subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…absent\displaystyle\implies\qquad\sqrt{N}\left(f_{r^{\prime}}(\hat{\pi}_{0},\hat{\pi% }_{r_{1}},\ldots,\hat{\pi}_{r_{R}})-f_{r^{\prime}}(\pi_{0},\pi_{r_{1}},\ldots,% \pi_{r_{R}})\right)\xrightarrow{d}\leavevmode\nobreak\ âŸ¹ square-root start_ARG italic_N end_ARG ( italic_f start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - italic_f start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,ğ’†râ€²âŠ¤â¢âˆ‡ğ’‡âŠ¤â¢ğšºMâ¢âˆ‡ğ’‡â¢ğ’†râ€²),ğ’©0superscriptsubscriptğ’†superscriptğ‘Ÿâ€²topâˆ‡superscriptğ’‡topsubscriptğšºğ‘€âˆ‡ğ’‡subscriptğ’†superscriptğ‘Ÿâ€²\displaystyle\mathcal{N}(0,\boldsymbol{e}_{r^{\prime}}^{\top}\nabla\boldsymbol% {f}^{\top}\boldsymbol{\Sigma}_{M}\nabla\boldsymbol{f}\boldsymbol{e}_{r^{\prime% }}),caligraphic_N ( 0 , bold_italic_e start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‡ bold_italic_f start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_Î£ start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT âˆ‡ bold_italic_f bold_italic_e start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) , |   
  
for any râ€²âˆˆ[R]superscriptğ‘Ÿâ€²delimited-[]ğ‘…r^{\prime}\in[R]italic_r
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ [ italic_R ], where

| ğšºM:=(Ï€0â¢(1âˆ’Ï€0)âˆ’Ï€0â¢Ï€r1â‹¯âˆ’Ï€0â¢Ï€rRâˆ’Ï€0â¢Ï€r1Ï€r1â¢(1âˆ’Ï€r1)â‹¯âˆ’Ï€r1â¢Ï€rRâ‹®â‹®â‹±â‹®âˆ’Ï€0â¢Ï€rRâˆ’Ï€r1â¢Ï€rRâ‹¯Ï€rRâ¢(1âˆ’Ï€rR))âˆˆâ„(R+1)Ã—(R+1)assignsubscriptğšºğ‘€matrixsubscriptğœ‹01subscriptğœ‹0subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â‹¯subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿğ‘…subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1subscriptğœ‹subscriptğ‘Ÿ11subscriptğœ‹subscriptğ‘Ÿ1â‹¯subscriptğœ‹subscriptğ‘Ÿ1subscriptğœ‹subscriptğ‘Ÿğ‘…â‹®â‹®â‹±â‹®subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿğ‘…subscriptğœ‹subscriptğ‘Ÿ1subscriptğœ‹subscriptğ‘Ÿğ‘…â‹¯subscriptğœ‹subscriptğ‘Ÿğ‘…1subscriptğœ‹subscriptğ‘Ÿğ‘…superscriptâ„ğ‘…1ğ‘…1\boldsymbol{\Sigma}_{M}:=\begin{pmatrix}\pi_{0}(1-\pi_{0})&-\pi_{0}\pi_{r_{1}}% &\cdots&-\pi_{0}\pi_{r_{R}}\\\ -\pi_{0}\pi_{r_{1}}&\pi_{r_{1}}(1-\pi_{r_{1}})&\cdots&-\pi_{r_{1}}\pi_{r_{R}}% \\\ \vdots&\vdots&\ddots&\vdots\\\ -\pi_{0}\pi_{r_{R}}&-\pi_{r_{1}}\pi_{r_{R}}&\cdots&\pi_{r_{R}}(1-\pi_{r_{R}})% \end{pmatrix}\in\mathbb{R}^{(R+1)\times(R+1)}bold_Î£ start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT := ( start_ARG start_ROW start_CELL italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( 1 - italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_CELL start_CELL - italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL start_CELL â‹¯ end_CELL start_CELL - italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL - italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL start_CELL italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( 1 - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_CELL start_CELL â‹¯ end_CELL start_CELL - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹± end_CELL start_CELL â‹® end_CELL end_ROW start_ROW start_CELL - italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL start_CELL - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL start_CELL â‹¯ end_CELL start_CELL italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( 1 - italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_CELL end_ROW end_ARG ) âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_R + 1 ) Ã— ( italic_R + 1 ) end_POSTSUPERSCRIPT |  | (E.4)  
---|---|---|---  
  
and
ğ’†râˆˆâ„Rsubscriptğ’†ğ‘Ÿsuperscriptâ„ğ‘…\boldsymbol{e}_{r}\in\mathbb{R}^{R}bold_italic_e
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT is the selector vector with
a 1 in the rthsuperscriptğ‘Ÿthr^{\text{th}}italic_r start_POSTSUPERSCRIPT th
end_POSTSUPERSCRIPT entry and zeroes elsewhere. Therefore by Theorem 2.4(i) in
vanÂ der Vaart [2000] and Proposition 1.8(iii) in GarcÃ­a-PortuguÃ©s [2023],
we have that for all râˆˆ[R]ğ‘Ÿdelimited-[]ğ‘…r\in[R]italic_r âˆˆ [ italic_R ]

| Nâ¢|frâ¢(Ï€^0,Ï€^r1,â€¦,Ï€^rR)âˆ’frâ¢(Ï€0,Ï€r1,â€¦,Ï€rR)|=ğ‘subscriptğ‘“ğ‘Ÿsubscript^ğœ‹0subscript^ğœ‹subscriptğ‘Ÿ1â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscriptğ‘“ğ‘Ÿsubscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…absent\displaystyle\sqrt{N}\left|f_{r}(\hat{\pi}_{0},\hat{\pi}_{r_{1}},\ldots,\hat{% \pi}_{r_{R}})-f_{r}(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})\right|=\leavevmode\nobreak\ square-root start_ARG italic_N end_ARG | italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) | = | ğ’ªâ„™â¢(1)subscriptğ’ªâ„™1\displaystyle\mathcal{O}_{\mathbb{P}}\left(1\right)caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( 1 ) |   
---|---|---|---  
| âŸ¹|frâ¢(Ï€^0,Ï€^r1,â€¦,Ï€^rR)âˆ’frâ¢(Ï€0,Ï€r1,â€¦,Ï€rR)|=subscriptğ‘“ğ‘Ÿsubscript^ğœ‹0subscript^ğœ‹subscriptğ‘Ÿ1â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscriptğ‘“ğ‘Ÿsubscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…absent\displaystyle\implies\qquad\left|f_{r}(\hat{\pi}_{0},\hat{\pi}_{r_{1}},\ldots,% \hat{\pi}_{r_{R}})-f_{r}(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})\right|=% \leavevmode\nobreak\ âŸ¹ | italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) | = | ğ’ªâ„™â¢(1N).subscriptğ’ªâ„™1ğ‘\displaystyle\mathcal{O}_{\mathbb{P}}\left(\frac{1}{\sqrt{N}}\right).caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG ) . |  | (E.5)  
  
Finally, for our class of estimators (5.10) and estimands (4.9), we have

|  | |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢frâ¢(Ï€^0,Ï€^r1,â€¦,Ï€^rR)â¢Ï„^ATTâ¢(r,t)âˆ’Ïˆrâ¢tâ¢frâ¢(Ï€0,Ï€r1,â€¦,Ï€rR)â¢Ï„ATTâ¢(r,t)|subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscript^ğœ‹0subscript^ğœ‹subscriptğ‘Ÿ1â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscript^ğœATTğ‘Ÿğ‘¡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…subscriptğœATTğ‘Ÿğ‘¡\displaystyle\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}f_{r}(\hat{\pi% }_{0},\hat{\pi}_{r_{1}},\ldots,\hat{\pi}_{r_{R}})\hat{\tau}_{\text{ATT}}(r,t)-% \psi_{rt}f_{r}(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})\tau_{\text{ATT}}(r,t)\right|| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) | |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢t[fr(Ï€0,Ï€r1,â€¦,Ï€rR)(Ï„^ATT(r,t)âˆ’Ï„ATT(r,t))\displaystyle\Bigg{|}\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\big{[}f_{r}% (\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})\left(\hat{\tau}_{\text{ATT}}(r,t)-% \tau_{\text{ATT}}(r,t)\right)| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT [ italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) |   
|  | +(frâ¢(Ï€^0,Ï€^r1,â€¦,Ï€^rR)âˆ’frâ¢(Ï€0,Ï€r1,â€¦,Ï€rR))â¢Ï„ATTâ¢(r,t)subscriptğ‘“ğ‘Ÿsubscript^ğœ‹0subscript^ğœ‹subscriptğ‘Ÿ1â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscriptğ‘“ğ‘Ÿsubscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…subscriptğœATTğ‘Ÿğ‘¡\displaystyle+\left(f_{r}(\hat{\pi}_{0},\hat{\pi}_{r_{1}},\ldots,\hat{\pi}_{r_% {R}})-f_{r}(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})\right)\tau_{\text{ATT}}(r,t)\+ ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) |   
|  | +(fr(Ï€^0,Ï€^r1,â€¦,Ï€^rR)âˆ’fr(Ï€0,Ï€r1,â€¦,Ï€rR))(Ï„^ATT(r,t)âˆ’Ï„ATT(r,t))]|\displaystyle+(f_{r}(\hat{\pi}_{0},\hat{\pi}_{r_{1}},\ldots,\hat{\pi}_{r_{R}})% -f_{r}(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}}))\left(\hat{\tau}_{\text{ATT}}(r% ,t)-\tau_{\text{ATT}}(r,t)\right)\big{]}\Bigg{|}\+ ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) ] | |   
| â‰¤\displaystyle\leq\leavevmode\nobreak\ â‰¤ | âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢t(fr(Ï€0,Ï€r1,â€¦,Ï€rR)|Ï„^ATT(r,t)âˆ’Ï„ATT(r,t)|+\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\big{(}f_{r}(\pi_{0}% ,\pi_{r_{1}},\ldots,\pi_{r_{R}})\left|\hat{\tau}_{\text{ATT}}(r,t)-\tau_{\text% {ATT}}(r,t)\right|+âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) | over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) | + |   
|  | |frâ¢(Ï€^0,Ï€^r1,â€¦,Ï€^rR)âˆ’frâ¢(Ï€0,Ï€r1,â€¦,Ï€rR)|â¢Ï„ATTâ¢(r,t)subscriptğ‘“ğ‘Ÿsubscript^ğœ‹0subscript^ğœ‹subscriptğ‘Ÿ1â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscriptğ‘“ğ‘Ÿsubscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…subscriptğœATTğ‘Ÿğ‘¡\displaystyle\left|f_{r}(\hat{\pi}_{0},\hat{\pi}_{r_{1}},\ldots,\hat{\pi}_{r_{% R}})-f_{r}(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})\right|\tau_{\text{ATT}}(r,t)| italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) | italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) |   
|  | +|fr(Ï€^0,Ï€^r1,â€¦,Ï€^rR)âˆ’fr(Ï€0,Ï€r1,â€¦,Ï€rR)||Ï„^ATT(r,t)âˆ’Ï„ATT(r,t)|)\displaystyle+|f_{r}(\hat{\pi}_{0},\hat{\pi}_{r_{1}},\ldots,\hat{\pi}_{r_{R}})% -f_{r}(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})|\left|\hat{\tau}_{\text{ATT}}(r% ,t)-\tau_{\text{ATT}}(r,t)\right|\big{)}\+ | italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) | | over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) | ) |   
| =(a)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(a)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_a ) end_ARG end_RELOP | ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})+ğ’ªâ„™â¢(1/N)+ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})â¢ğ’ªâ„™â¢(1/N)subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²subscriptğ’ªâ„™1ğ‘subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²subscriptğ’ªâ„™1ğ‘\displaystyle\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\})+\mathcal{O% }_{\mathbb{P}}(1/\sqrt{N})+\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}% \\})\mathcal{O}_{\mathbb{P}}(1/\sqrt{N})caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) + caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( 1 / square-root start_ARG italic_N end_ARG ) + caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( 1 / square-root start_ARG italic_N end_ARG ) |   
| =(b)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(b)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_b ) end_ARG end_RELOP | ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}),subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\displaystyle\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\}),caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) , |   
  
where in (a)ğ‘(a)( italic_a ) we used that all the
frâ¢(Ï€0,Ï€r1,â€¦,Ï€rR)subscriptğ‘“ğ‘Ÿsubscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…f_{r}(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})italic_f
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT
0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r
start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT
end_POSTSUBSCRIPT ) and
Ï„ATTâ¢(r,t)subscriptğœATTğ‘Ÿğ‘¡\tau_{\text{ATT}}(r,t)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) are finite,
(E.3), and (E.5); and in (b)ğ‘(b)( italic_b ) we used that
1/N=ğ’ªâ¢(hN)1ğ‘ğ’ªsubscriptâ„ğ‘1/\sqrt{N}=\mathcal{O}(h_{N})1 / square-root
start_ARG italic_N end_ARG = caligraphic_O ( italic_h start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT ) since e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e
start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT is upper-bounded by a
constant and pNsubscriptğ‘ğ‘p_{N}italic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT is nondecreasing.

  2. (b)

Again, using Theorem A.5,

| Ï„CATTâ¢(r,t,ğ’™)=Ï„râ¢tâˆ—+(ğ†râ¢tâˆ—)âŠ¤â¢(ğ’™âˆ’ğ”¼â¢[ğ‘¿(1â¢t)â£â‹…âˆ£Wi=r])=Ï„râ¢tâˆ—+(ğ†râ¢tâˆ—)âŠ¤â¢(ğ’™âˆ’ğr),subscriptğœCATTğ‘Ÿğ‘¡ğ’™superscriptsubscriptğœğ‘Ÿğ‘¡superscriptsuperscriptsubscriptğ†ğ‘Ÿğ‘¡topğ’™ğ”¼delimited-[]conditionalsubscriptğ‘¿1ğ‘¡â‹…subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğœğ‘Ÿğ‘¡superscriptsuperscriptsubscriptğ†ğ‘Ÿğ‘¡topğ’™subscriptğğ‘Ÿ\tau_{\text{CATT}}(r,t,\boldsymbol{x})=\tau_{rt}^{*}+(\boldsymbol{\rho}_{rt}^{% *})^{\top}\left(\boldsymbol{x}-\mathbb{E}\left[\boldsymbol{X}_{(1t)\cdot}\mid W% _{i}=r\right]\right)=\tau_{rt}^{*}+(\boldsymbol{\rho}_{rt}^{*})^{\top}\left(% \boldsymbol{x}-\boldsymbol{\mu}_{r}\right),italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) = italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + ( bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_x - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT ( 1 italic_t ) â‹… end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ) = italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + ( bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_x - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) , |   
---|---|---  
  
where
ğr:=ğ”¼â¢[ğ‘¿(iâ¢t)â£â‹…âˆ£Wi=r]assignsubscriptğğ‘Ÿğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–ğ‘¡â‹…subscriptğ‘Šğ‘–ğ‘Ÿ\boldsymbol{\mu}_{r}:=\mathbb{E}\left[\boldsymbol{X}_{(it)\cdot}\mid
W_{i}=r\right]bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT :=
blackboard_E [ bold_italic_X start_POSTSUBSCRIPT ( italic_i italic_t ) â‹…
end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
= italic_r ]. Using this and (5.5) we have

|  | |Ï„^CATTâ¢(r,t,ğ’™)âˆ’Ï„CATTâ¢(r,t,ğ’™)|subscript^ğœCATTğ‘Ÿğ‘¡ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle\left|\hat{\tau}_{\text{CATT}}(r,t,\boldsymbol{x})-\tau_{\text{% CATT}}(r,t,\boldsymbol{x})\right|| over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) - italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) | |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | |Ï„^râ¢t(q)âˆ’Ï„râ¢tâˆ—+(ğ’™âˆ’ğ‘¿Â¯r)âŠ¤â¢ğ†^râ¢tâˆ’(ğ’™âˆ’ğr)âŠ¤â¢ğ†râ¢tâˆ—|superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘superscriptsubscriptğœğ‘Ÿğ‘¡superscriptğ’™subscriptbold-Â¯ğ‘¿ğ‘Ÿtopsubscriptbold-^ğ†ğ‘Ÿğ‘¡superscriptğ’™subscriptğğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡\displaystyle\left|\hat{\tau}_{rt}^{(q)}-\tau_{rt}^{*}+(\boldsymbol{x}-% \boldsymbol{\overline{X}}_{r})^{\top}\boldsymbol{\hat{\rho}}_{rt}-\left(% \boldsymbol{x}-\boldsymbol{\mu}_{r}\right)^{\top}\boldsymbol{\rho}_{rt}^{*}\right|| over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + ( bold_italic_x - overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT - ( bold_italic_x - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT | |   
| =\displaystyle=\leavevmode\nobreak\ = | |Ï„^râ¢t(q)âˆ’Ï„râ¢tâˆ—+(ğ’™âˆ’ğr)âŠ¤â¢(ğ†^râ¢tâˆ’ğ†râ¢tâˆ—)+(ğrâˆ’ğ‘¿Â¯r)âŠ¤â¢(ğ†^râ¢tâˆ’ğ†râ¢tâˆ—)âˆ’(ğ‘¿Â¯râˆ’ğr)âŠ¤â¢ğ†râ¢tâˆ—|superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘superscriptsubscriptğœğ‘Ÿğ‘¡superscriptğ’™subscriptğğ‘Ÿtopsubscriptbold-^ğ†ğ‘Ÿğ‘¡superscriptsubscriptğ†ğ‘Ÿğ‘¡superscriptsubscriptğğ‘Ÿsubscriptbold-Â¯ğ‘¿ğ‘Ÿtopsubscriptbold-^ğ†ğ‘Ÿğ‘¡superscriptsubscriptğ†ğ‘Ÿğ‘¡superscriptsubscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡\displaystyle\left|\hat{\tau}_{rt}^{(q)}-\tau_{rt}^{*}+\left(\boldsymbol{x}-% \boldsymbol{\mu}_{r}\right)^{\top}\left(\boldsymbol{\hat{\rho}}_{rt}-% \boldsymbol{\rho}_{rt}^{*}\right)+\left(\boldsymbol{\mu}_{r}-\boldsymbol{% \overline{X}}_{r}\right)^{\top}\left(\boldsymbol{\hat{\rho}}_{rt}-\boldsymbol{% \rho}_{rt}^{*}\right)-\left(\boldsymbol{\overline{X}}_{r}-\boldsymbol{\mu}_{r}% \right)^{\top}\boldsymbol{\rho}_{rt}^{*}\right|| over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + ( bold_italic_x - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT - bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) + ( bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT - bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) - ( overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT | |   
| â‰¤\displaystyle\leq\leavevmode\nobreak\ â‰¤ | |Ï„^râ¢t(q)âˆ’Ï„râ¢tâˆ—|+|(ğ’™âˆ’ğr)âŠ¤â¢(ğ†^râ¢tâˆ’ğ†râ¢tâˆ—)|+|(ğrâˆ’ğ‘¿Â¯r)âŠ¤â¢(ğ†^râ¢tâˆ’ğ†râ¢tâˆ—)|+|(ğ‘¿Â¯râˆ’ğr)âŠ¤â¢ğ†râ¢tâˆ—|superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘superscriptsubscriptğœğ‘Ÿğ‘¡superscriptğ’™subscriptğğ‘Ÿtopsubscriptbold-^ğ†ğ‘Ÿğ‘¡superscriptsubscriptğ†ğ‘Ÿğ‘¡superscriptsubscriptğğ‘Ÿsubscriptbold-Â¯ğ‘¿ğ‘Ÿtopsubscriptbold-^ğ†ğ‘Ÿğ‘¡superscriptsubscriptğ†ğ‘Ÿğ‘¡superscriptsubscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡\displaystyle\left|\hat{\tau}_{rt}^{(q)}-\tau_{rt}^{*}\right|+\left|\left(% \boldsymbol{x}-\boldsymbol{\mu}_{r}\right)^{\top}\left(\boldsymbol{\hat{\rho}}% _{rt}-\boldsymbol{\rho}_{rt}^{*}\right)\right|+\left|\left(\boldsymbol{\mu}_{r% }-\boldsymbol{\overline{X}}_{r}\right)^{\top}\left(\boldsymbol{\hat{\rho}}_{rt% }-\boldsymbol{\rho}_{rt}^{*}\right)\right|+\left|\left(\boldsymbol{\overline{X% }}_{r}-\boldsymbol{\mu}_{r}\right)^{\top}\boldsymbol{\rho}_{rt}^{*}\right|| over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT | + | ( bold_italic_x - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT - bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) | + | ( bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT - bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) | + | ( overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT | |   
| â‰¤(c)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(c)}}{{\leq}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG â‰¤ end_ARG start_ARG ( italic_c ) end_ARG end_RELOP | |Ï„^râ¢t(q)âˆ’Ï„râ¢tâˆ—|+âˆ¥ğ’™âˆ’ğrâˆ¥2â¢âˆ¥ğ†^râ¢tâˆ’ğ†râ¢tâˆ—âˆ¥2+âˆ¥ğrâˆ’ğ‘¿Â¯râˆ¥2â¢âˆ¥ğ†^râ¢tâˆ’ğ†râ¢tâˆ—âˆ¥2+âˆ¥ğ‘¿Â¯râˆ’ğrâˆ¥2â¢âˆ¥ğ†râ¢tâˆ—âˆ¥2superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘superscriptsubscriptğœğ‘Ÿğ‘¡subscriptdelimited-âˆ¥âˆ¥ğ’™subscriptğğ‘Ÿ2subscriptdelimited-âˆ¥âˆ¥subscriptbold-^ğ†ğ‘Ÿğ‘¡superscriptsubscriptğ†ğ‘Ÿğ‘¡2subscriptdelimited-âˆ¥âˆ¥subscriptğğ‘Ÿsubscriptbold-Â¯ğ‘¿ğ‘Ÿ2subscriptdelimited-âˆ¥âˆ¥subscriptbold-^ğ†ğ‘Ÿğ‘¡superscriptsubscriptğ†ğ‘Ÿğ‘¡2subscriptdelimited-âˆ¥âˆ¥subscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿ2subscriptdelimited-âˆ¥âˆ¥superscriptsubscriptğ†ğ‘Ÿğ‘¡2\displaystyle\left|\hat{\tau}_{rt}^{(q)}-\tau_{rt}^{*}\right|+\left\lVert% \boldsymbol{x}-\boldsymbol{\mu}_{r}\right\rVert_{2}\left\lVert\boldsymbol{\hat% {\rho}}_{rt}-\boldsymbol{\rho}_{rt}^{*}\right\rVert_{2}+\left\lVert\boldsymbol% {\mu}_{r}-\boldsymbol{\overline{X}}_{r}\right\rVert_{2}\left\lVert\boldsymbol{% \hat{\rho}}_{rt}-\boldsymbol{\rho}_{rt}^{*}\right\rVert_{2}+\left\lVert% \boldsymbol{\overline{X}}_{r}-\boldsymbol{\mu}_{r}\right\rVert_{2}\left\lVert% \boldsymbol{\rho}_{rt}^{*}\right\rVert_{2}| over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT | + âˆ¥ bold_italic_x - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT âˆ¥ overbold_^ start_ARG bold_italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT - bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + âˆ¥ bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT âˆ¥ overbold_^ start_ARG bold_italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT - bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + âˆ¥ overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT âˆ¥ bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT |   
| =(d)superscriptğ‘‘\displaystyle\stackrel{{\scriptstyle(d)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_d ) end_ARG end_RELOP | ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})+ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})+ğ’ªâ„™â¢(1/N)â¢ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})+ğ’ªâ„™â¢(1/N)subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²subscriptğ’ªâ„™1ğ‘subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²subscriptğ’ªâ„™1ğ‘\displaystyle\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\})+\mathcal{O% }_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\})+\mathcal{O}_{\mathbb{P}}\left(1/% \sqrt{N}\right)\mathcal{O}_{\mathbb{P}}\left(\min\\{h_{N},h_{N}^{\prime}\\}% \right)+\mathcal{O}_{\mathbb{P}}\left(1/\sqrt{N}\right)caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) + caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) + caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( 1 / square-root start_ARG italic_N end_ARG ) caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) + caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( 1 / square-root start_ARG italic_N end_ARG ) |   
| =\displaystyle=\leavevmode\nobreak\ = | ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}),subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\displaystyle\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\}),caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) , |   
  
where in (c)ğ‘(c)( italic_c ) we applied Cauchy-Schwarz and (d)ğ‘‘(d)(
italic_d ) follows from Theorem C.1, the fact that
âˆ¥ğ†râ¢tâˆ—âˆ¥2subscriptdelimited-
âˆ¥âˆ¥superscriptsubscriptğ†ğ‘Ÿğ‘¡2\left\lVert\boldsymbol{\rho}_{rt}^{*}\right\rVert_{2}âˆ¥
bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2
end_POSTSUBSCRIPT is fixed and bounded since dğ‘‘ditalic_d is fixed and each
coefficient is finite due to Lemma E.2, and Lemma E.3:

######  Lemma E.3.

For each râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 } âˆª
caligraphic_R, let
ğ›™râˆˆâ„dsubscriptğ›™ğ‘Ÿsuperscriptâ„ğ‘‘\boldsymbol{\psi}_{r}\in\mathbb{R}^{d}bold_italic_Ïˆ
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT be constant vectors, with
ğ›™râ‰ ğŸsubscriptğ›™ğ‘Ÿ0\boldsymbol{\psi}_{r}\neq\boldsymbol{0}bold_italic_Ïˆ
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT â‰ bold_0 for at least one
r=râˆ—ğ‘Ÿsuperscriptğ‘Ÿr=r^{*}italic_r = italic_r start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT. For all Nğ‘Nitalic_N and all
râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 } âˆª
caligraphic_R, assume all of the eigenvalues of
Covâ¢(ğ—iâˆ£Wi=r)Covconditionalsubscriptğ—ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\mathrm{Cov}(\boldsymbol{X}_{i}\mid
W_{i}=r)roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
= italic_r ) are bounded between
Î»min>0subscriptğœ†min0\lambda_{\text{min}}>0italic_Î» start_POSTSUBSCRIPT min
end_POSTSUBSCRIPT > 0 and
Î»max<âˆsubscriptğœ†max\lambda_{\text{max}}<\inftyitalic_Î»
start_POSTSUBSCRIPT max end_POSTSUBSCRIPT < âˆ. Then

| Nâ¢âˆ‘râˆˆ{0}âˆªâ„›ğrâŠ¤â¢(ğ‘¿Â¯râˆ’ğr)â†’ğ‘‘ğ’©â¢(0,vR),ğ‘‘â†’ğ‘subscriptğ‘Ÿ0â„›superscriptsubscriptğğ‘Ÿtopsubscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿğ’©0subscriptğ‘£ğ‘…\sqrt{N}\sum_{r\in\\{0\\}\cup\mathcal{R}}\boldsymbol{\psi}_{r}^{\top}\left(% \boldsymbol{\overline{X}}_{r}-\boldsymbol{\mu}_{r}\right)\xrightarrow{d}% \mathcal{N}(0,v_{R}),square-root start_ARG italic_N end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) , |   
---|---|---  
  
where

| vR:=âˆ‘râˆˆ{0}âˆªâ„›ğrâŠ¤â¢Covâ¢(ğ‘¿iâˆ£Wi=r)â¢ğrâ„™â¢(Wi=r).assignsubscriptğ‘£ğ‘…subscriptğ‘Ÿ0â„›superscriptsubscriptğğ‘ŸtopCovconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğğ‘Ÿâ„™subscriptğ‘Šğ‘–ğ‘Ÿv_{R}:=\sum_{r\in\\{0\\}\cup\mathcal{R}}\frac{\boldsymbol{\psi}_{r}^{\top}% \mathrm{Cov}(\boldsymbol{X}_{i}\mid W_{i}=r)\boldsymbol{\psi}_{r}}{\mathbb{P}(% W_{i}=r)}.italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT := âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT divide start_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) end_ARG . |   
---|---|---  
  
Further, for any râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ {
0 } âˆª caligraphic_R,

| âˆ¥ğ‘¿Â¯râˆ’ğrâˆ¥2=ğ’ªâ„™â¢(1N).subscriptdelimited-âˆ¥âˆ¥subscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿ2subscriptğ’ªâ„™1ğ‘\lVert\boldsymbol{\overline{X}}_{r}-\boldsymbol{\mu}_{r}\rVert_{2}=\mathcal{O}% _{\mathbb{P}}\left(\frac{1}{\sqrt{N}}\right).âˆ¥ overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG ) . |   
---|---|---  
  
###### Proof.

Provided in Appendix G.2. âˆ

Next, for any deterministic fixed set of constants
{Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ start_POSTSUBSCRIPT
italic_r italic_t end_POSTSUBSCRIPT }, the above result gives us

|  | |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢Ï„^CATTâ¢(r,t,ğ’™)âˆ’âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢Ï„CATTâ¢(r,t,ğ’™)|subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœCATTğ‘Ÿğ‘¡ğ’™subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\hat{\tau}_{% \text{CATT}}(r,t,\boldsymbol{x})-\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}% \tau_{\text{CATT}}(r,t,\boldsymbol{x})\right|| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) - âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) | |   
---|---|---|---  
| â‰¤\displaystyle\leq\leavevmode\nobreak\ â‰¤ | âˆ‘râˆˆâ„›âˆ‘t=rT|Ïˆrâ¢t|â¢|Ï„^CATTâ¢(r,t,ğ’™)âˆ’Ï„CATTâ¢(r,t,ğ’™)|subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœCATTğ‘Ÿğ‘¡ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}|\psi_{rt}|\left|\hat{\tau}_{% \text{CATT}}(r,t,\boldsymbol{x})-\tau_{\text{CATT}}(r,t,\boldsymbol{x})\right|âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT | italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT | | over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) - italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) | |   
| =\displaystyle=\leavevmode\nobreak\ = | ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}).subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\displaystyle\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\}).caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) . |  | (E.6)  
  
Finally, we have

|  | |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(ğ’‚râŠ¤â¢ğ…^â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…^â¢(ğ’™))â¢Ï„^CATTâ¢(r,t,ğ’™)âˆ’âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢ğ’‚râŠ¤â¢ğ…â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…â¢(ğ’™)â¢Ï„CATTâ¢(r,t,ğ’™)|subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptğ’‚ğ‘Ÿtopbold-^ğ…ğ’™superscriptsubscriptğ’ƒğ‘Ÿtopbold-^ğ…ğ’™subscript^ğœCATTğ‘Ÿğ‘¡ğ’™subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptğ’‚ğ‘Ÿtopğ…ğ’™superscriptsubscriptğ’ƒğ‘Ÿtopğ…ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle\left|\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\frac{% \boldsymbol{a}_{r}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x})}{\boldsymbol{b% }_{r}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x})}\right)\hat{\tau}_{\text{% CATT}}(r,t,\boldsymbol{x})-\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\frac{% \boldsymbol{a}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}{\boldsymbol{b}_{r% }^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}\tau_{\text{CATT}}(r,t,\boldsymbol{% x})\right|| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG ) over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) - âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) | |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | |âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢t[(ğ’‚râŠ¤â¢ğ…â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…â¢(ğ’™))(Ï„^CATT(r,ğ’™,t)âˆ’Ï„CATT(r,t,ğ’™))\displaystyle\Bigg{|}\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\Bigg{[}% \left(\frac{\boldsymbol{a}_{r}^{\top}\boldsymbol{\pi}(\boldsymbol{x})}{% \boldsymbol{b}_{r}^{\top}\boldsymbol{\pi}(\boldsymbol{x})}\right)(\hat{\tau}_{% \text{CATT}}(r,\boldsymbol{x},t)-\tau_{\text{CATT}}(r,t,\boldsymbol{x}))| âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT [ ( divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG ) ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , bold_italic_x , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) |   
|  | +[ğ’‚râŠ¤â¢ğ…^â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…^â¢(ğ’™)âˆ’ğ’‚râŠ¤â¢ğ…â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…â¢(ğ’™)]â¢Ï„CATTâ¢(r,t,ğ’™)delimited-[]superscriptsubscriptğ’‚ğ‘Ÿtopbold-^ğ…ğ’™superscriptsubscriptğ’ƒğ‘Ÿtopbold-^ğ…ğ’™superscriptsubscriptğ’‚ğ‘Ÿtopğ…ğ’™superscriptsubscriptğ’ƒğ‘Ÿtopğ…ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle+\left[\frac{\boldsymbol{a}_{r}^{\top}\boldsymbol{\hat{\pi}}(% \boldsymbol{x})}{\boldsymbol{b}_{r}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x% })}-\frac{\boldsymbol{a}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}{% \boldsymbol{b}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}\right]\tau_{\text% {CATT}}(r,t,\boldsymbol{x})\+ [ divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG - divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG ] italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) |   
|  | +[ğ’‚râŠ¤â¢ğ…^â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…^â¢(ğ’™)âˆ’ğ’‚râŠ¤â¢ğ…â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…â¢(ğ’™)](Ï„^CATT(r,ğ’™,t)âˆ’Ï„CATT(r,t,ğ’™))]|\displaystyle+\left[\frac{\boldsymbol{a}_{r}^{\top}\boldsymbol{\hat{\pi}}(% \boldsymbol{x})}{\boldsymbol{b}_{r}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x% })}-\frac{\boldsymbol{a}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}{% \boldsymbol{b}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}\right](\hat{\tau}% _{\text{CATT}}(r,\boldsymbol{x},t)-\tau_{\text{CATT}}(r,t,\boldsymbol{x}))% \Bigg{]}\Bigg{|}\+ [ divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG - divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG ] ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , bold_italic_x , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) ] | |   
| â‰¤\displaystyle\leq\leavevmode\nobreak\ â‰¤ | âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢t[ğ’‚râŠ¤â¢ğ…â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…â¢(ğ’™)|Ï„^CATT(r,ğ’™,t)âˆ’Ï„CATT(r,t,ğ’™)|\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\Bigg{[}\frac{% \boldsymbol{a}_{r}^{\top}\boldsymbol{\pi}(\boldsymbol{x})}{\boldsymbol{b}_{r}^% {\top}\boldsymbol{\pi}(\boldsymbol{x})}\left|\hat{\tau}_{\text{CATT}}(r,% \boldsymbol{x},t)-\tau_{\text{CATT}}(r,t,\boldsymbol{x})\right|âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT [ divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG | over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , bold_italic_x , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) | |   
|  | +|ğ’‚râŠ¤â¢ğ…^â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…^â¢(ğ’™)âˆ’ğ’‚râŠ¤â¢ğ…â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…â¢(ğ’™)|â¢Ï„CATTâ¢(r,t,ğ’™)superscriptsubscriptğ’‚ğ‘Ÿtopbold-^ğ…ğ’™superscriptsubscriptğ’ƒğ‘Ÿtopbold-^ğ…ğ’™superscriptsubscriptğ’‚ğ‘Ÿtopğ…ğ’™superscriptsubscriptğ’ƒğ‘Ÿtopğ…ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle+\left|\frac{\boldsymbol{a}_{r}^{\top}\boldsymbol{\hat{\pi}}(% \boldsymbol{x})}{\boldsymbol{b}_{r}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x% })}-\frac{\boldsymbol{a}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}{% \boldsymbol{b}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}\right|\tau_{\text% {CATT}}(r,t,\boldsymbol{x})\+ | divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG - divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG | italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) |   
|  | +|ğ’‚râŠ¤â¢ğ…^â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…^â¢(ğ’™)âˆ’ğ’‚râŠ¤â¢ğ…â¢(ğ’™)ğ’ƒrâŠ¤â¢ğ…â¢(ğ’™)||Ï„^CATT(r,ğ’™,t)âˆ’Ï„CATT(r,t,ğ’™)|]\displaystyle+\left|\frac{\boldsymbol{a}_{r}^{\top}\boldsymbol{\hat{\pi}}(% \boldsymbol{x})}{\boldsymbol{b}_{r}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x% })}-\frac{\boldsymbol{a}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}{% \boldsymbol{b}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}\right|\left|\hat{% \tau}_{\text{CATT}}(r,\boldsymbol{x},t)-\tau_{\text{CATT}}(r,t,\boldsymbol{x})% \right|\Bigg{]}\+ | divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG - divide start_ARG bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG | | over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , bold_italic_x , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) | ] |   
| â‰¤(e)superscriptğ‘’\displaystyle\stackrel{{\scriptstyle(e)}}{{\leq}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG â‰¤ end_ARG start_ARG ( italic_e ) end_ARG end_RELOP | ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})+ğ’ªâ„™â¢(aN)+ğ’ªâ„™â¢(aN)â¢ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²subscriptğ’ªâ„™subscriptğ‘ğ‘subscriptğ’ªâ„™subscriptğ‘ğ‘subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²\displaystyle\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\})+\mathcal{O% }_{\mathbb{P}}(a_{N})+\mathcal{O}_{\mathbb{P}}(a_{N})\mathcal{O}_{\mathbb{P}}(% \min\\{h_{N},h_{N}^{\prime}\\})caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) + caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) + caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) |   
| =(f)superscriptğ‘“\displaystyle\stackrel{{\scriptstyle(f)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_f ) end_ARG end_RELOP | ğ’ªâ„™â¢(minâ¡{hN,hNâ€²}âˆ¨aN),subscriptğ’ªâ„™subscriptâ„ğ‘superscriptsubscriptâ„ğ‘â€²subscriptğ‘ğ‘\displaystyle\mathcal{O}_{\mathbb{P}}(\min\\{h_{N},h_{N}^{\prime}\\}\vee a_{N}),caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } âˆ¨ italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) , |   
  
where in (f)ğ‘“(f)( italic_f ) we used Proposition 1.8 from GarcÃ­a-PortuguÃ©s [2023] and in (e)ğ‘’(e)( italic_e ) we used (E.6), the fact that |Ïˆrâ¢t|subscriptğœ“ğ‘Ÿğ‘¡|\psi_{rt}|| italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT | is bounded for any fixed ğ’™ğ’™\boldsymbol{x}bold_italic_x for all râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R due to Lemma E.2, the fact that |Ï„CATTâ¢(r,t,ğ’™)|subscriptğœCATTğ‘Ÿğ‘¡ğ’™\left|\tau_{\text{CATT}}(r,t,\boldsymbol{x})\right|| italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) | and ğ’‚râŠ¤â¢ğ…â¢(ğ’™)/ğ’ƒrâŠ¤â¢ğ…â¢(ğ’™)superscriptsubscriptğ’‚ğ‘Ÿtopğ…ğ’™superscriptsubscriptğ’ƒğ‘Ÿtopğ…ğ’™\boldsymbol{a}_{r}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})/\boldsymbol{b}_{r}% ^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})bold_italic_a start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) / bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) are bounded for any fixed ğ’™ğ’™\boldsymbol{x}bold_italic_x, and Lemma E.4:

######  Lemma E.4.

For any ğ±ğ±\boldsymbol{x}bold_italic_x in the support of ğ—isubscriptğ—ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT, let ğ›‘^â¢(ğ±)bold-^ğ›‘ğ±\boldsymbol{\hat{\pi}}(\boldsymbol{x})overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) be an estimator for Ï€râ¢(ğ±)subscriptğœ‹ğ‘Ÿğ±\pi_{r}(\boldsymbol{x})italic_Ï€ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) satisfying |Ï€^râ¢(ğ±)âˆ’Ï€râ¢(ğ±)|=ğ’ªâ„™â¢(aN)subscript^ğœ‹ğ‘Ÿğ±subscriptğœ‹ğ‘Ÿğ±subscriptğ’ªâ„™subscriptğ‘ğ‘|\hat{\pi}_{r}(\boldsymbol{x})-\pi_{r}(\boldsymbol{x})|=\mathcal{O}_{\mathbb{P% }}(a_{N})| over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) - italic_Ï€ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) | = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) for a decreasing sequence aNsubscriptğ‘ğ‘a_{N}italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT for all râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 } âˆª caligraphic_R. Let ğšğš\boldsymbol{a}bold_italic_a and ğ›âˆˆâ„R+1ğ›superscriptâ„ğ‘…1\boldsymbol{b}\in\mathbb{R}^{R+1}bold_italic_b âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_R + 1 end_POSTSUPERSCRIPT be finite vectors satisfying ğšâŠ¤â¢ğ›‘â¢(ğ±)>0superscriptğštopğ›‘ğ±0\boldsymbol{a}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})>0bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) > 0 and ğ›âŠ¤â¢ğ›‘â¢(ğ±)>0superscriptğ›topğ›‘ğ±0\boldsymbol{b}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})>0bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) > 0 for any ğ±ğ±\boldsymbol{x}bold_italic_x in the support of ğ—isubscriptğ—ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT. Then

| |ğ’‚âŠ¤â¢ğ…^â¢(ğ’™)ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)âˆ’ğ’‚âŠ¤â¢ğ…â¢(ğ’™)ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)|=ğ’ªâ„™â¢(aN).superscriptğ’‚topbold-^ğ…ğ’™superscriptğ’ƒtopbold-^ğ…ğ’™superscriptğ’‚topğ…ğ’™superscriptğ’ƒtopğ…ğ’™subscriptğ’ªâ„™subscriptğ‘ğ‘\left|\frac{\boldsymbol{a}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x})}{% \boldsymbol{b}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x})}-\frac{\boldsymbol% {a}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}{\boldsymbol{b}^{\top}\boldsymbol% {{\pi}}(\boldsymbol{x})}\right|=\mathcal{O}_{\mathbb{P}}\left(a_{N}\right).| divide start_ARG bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG - divide start_ARG bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG | = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) . |   
---|---|---  
  
###### Proof.

Provided in Appendix G.2. âˆ

The proof is complete.

âˆ

###### Proof of Theorem 6.1.

In light of Theorem D.1, to prove part (a) it is enough to note that

| frâ¢(Ï€^0,Ï€^r1,â€¦,Ï€rR^)=(Ï€^r1âˆ‘râˆˆâ„›Ï€^rÏ€^r2âˆ‘râˆˆâ„›Ï€^râ‹®Ï€^rRâˆ‘râˆˆâ„›Ï€^r)subscriptğ‘“ğ‘Ÿsubscript^ğœ‹0subscript^ğœ‹subscriptğ‘Ÿ1â€¦^subscriptğœ‹subscriptğ‘Ÿğ‘…matrixsubscript^ğœ‹subscriptğ‘Ÿ1subscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ2subscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿâ‹®subscript^ğœ‹subscriptğ‘Ÿğ‘…subscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿf_{r}(\hat{\pi}_{0},\hat{\pi}_{r_{1}},\ldots,\hat{\pi_{r_{R}}})=\begin{pmatrix% }\frac{\hat{\pi}_{r_{1}}}{\sum_{r\in\mathcal{R}}\hat{\pi}_{r}}\\\ \frac{\hat{\pi}_{r_{2}}}{\sum_{r\in\mathcal{R}}\hat{\pi}_{r}}\\\ \vdots\\\ \frac{\hat{\pi}_{r_{R}}}{\sum_{r\in\mathcal{R}}\hat{\pi}_{r}}\end{pmatrix}italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG ) = ( start_ARG start_ROW start_CELL divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG end_CELL end_ROW start_ROW start_CELL divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG end_CELL end_ROW start_ROW start_CELL â‹® end_CELL end_ROW start_ROW start_CELL divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG end_CELL end_ROW end_ARG ) |   
---|---|---  
  
(where Ï€^r=Nr/Nsubscript^ğœ‹ğ‘Ÿsubscriptğ‘ğ‘Ÿğ‘\hat{\pi}_{r}=N_{r}/Nover^
start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT =
italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT / italic_N) is
pointwise (that is, almost surely) finite and show that its Jacobian at
(Ï€0,Ï€r1,â€¦,Ï€rR)subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})(
italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r
start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) exists and
is nonzero and finite. The Jacobian at
(Ï€0,Ï€r1,â€¦,Ï€rR)subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})(
italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r
start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) is

| (00â‹¯0âˆ‘râˆˆâ„›âˆ–r1Ï€^r(âˆ‘râˆˆâ„›Ï€^r)2âˆ’Ï€^r2(âˆ‘râˆˆâ„›Ï€^r)2â‹¯âˆ’Ï€^rR(âˆ‘râˆˆâ„›Ï€^r)2âˆ’Ï€^r1(âˆ‘râˆˆâ„›Ï€^r)2âˆ‘râˆˆâ„›âˆ–r2Ï€^r(âˆ‘râˆˆâ„›Ï€^r)2â‹¯âˆ’Ï€^rR(âˆ‘râˆˆâ„›Ï€^r)2â‹®â‹®â‹±â‹®âˆ’Ï€^r1(âˆ‘râˆˆâ„›Ï€^r)2âˆ’Ï€^r2(âˆ‘râˆˆâ„›Ï€^r)2â‹¯âˆ‘râˆˆâ„›âˆ–rRÏ€^r(âˆ‘râˆˆâ„›Ï€^r)2)âˆˆâ„(R+1)Ã—R;matrix00â‹¯0subscriptğ‘Ÿâ„›subscriptğ‘Ÿ1subscript^ğœ‹ğ‘Ÿsuperscriptsubscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿ2subscript^ğœ‹subscriptğ‘Ÿ2superscriptsubscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿ2â‹¯subscript^ğœ‹subscriptğ‘Ÿğ‘…superscriptsubscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿ2subscript^ğœ‹subscriptğ‘Ÿ1superscriptsubscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿ2subscriptğ‘Ÿâ„›subscriptğ‘Ÿ2subscript^ğœ‹ğ‘Ÿsuperscriptsubscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿ2â‹¯subscript^ğœ‹subscriptğ‘Ÿğ‘…superscriptsubscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿ2â‹®â‹®â‹±â‹®subscript^ğœ‹subscriptğ‘Ÿ1superscriptsubscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿ2subscript^ğœ‹subscriptğ‘Ÿ2superscriptsubscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿ2â‹¯subscriptğ‘Ÿâ„›subscriptğ‘Ÿğ‘…subscript^ğœ‹ğ‘Ÿsuperscriptsubscriptğ‘Ÿâ„›subscript^ğœ‹ğ‘Ÿ2superscriptâ„ğ‘…1ğ‘…\begin{pmatrix}0&0&\cdots&0\\\ \frac{\sum_{r\in\mathcal{R}\setminus r_{1}}\hat{\pi}_{r}}{\left(\sum_{r\in% \mathcal{R}}\hat{\pi}_{r}\right)^{2}}&-\frac{\hat{\pi}_{r_{2}}}{\left(\sum_{r% \in\mathcal{R}}\hat{\pi}_{r}\right)^{2}}&\cdots&-\frac{\hat{\pi}_{r_{R}}}{% \left(\sum_{r\in\mathcal{R}}\hat{\pi}_{r}\right)^{2}}\\\ -\frac{\hat{\pi}_{r_{1}}}{\left(\sum_{r\in\mathcal{R}}\hat{\pi}_{r}\right)^{2}% }&\frac{\sum_{r\in\mathcal{R}\setminus r_{2}}\hat{\pi}_{r}}{\left(\sum_{r\in% \mathcal{R}}\hat{\pi}_{r}\right)^{2}}&\cdots&-\frac{\hat{\pi}_{r_{R}}}{\left(% \sum_{r\in\mathcal{R}}\hat{\pi}_{r}\right)^{2}}\\\ \vdots&\vdots&\ddots&\vdots\\\ -\frac{\hat{\pi}_{r_{1}}}{\left(\sum_{r\in\mathcal{R}}\hat{\pi}_{r}\right)^{2}% }&-\frac{\hat{\pi}_{r_{2}}}{\left(\sum_{r\in\mathcal{R}}\hat{\pi}_{r}\right)^{% 2}}&\cdots&\frac{\sum_{r\in\mathcal{R}\setminus r_{R}}\hat{\pi}_{r}}{\left(% \sum_{r\in\mathcal{R}}\hat{\pi}_{r}\right)^{2}}\end{pmatrix}\in\mathbb{R}^{(R+% 1)\times R};( start_ARG start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL â‹¯ end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL divide start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R âˆ– italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL - divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL â‹¯ end_CELL start_CELL - divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL end_ROW start_ROW start_CELL - divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL divide start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R âˆ– italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL â‹¯ end_CELL start_CELL - divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL end_ROW start_ROW start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹± end_CELL start_CELL â‹® end_CELL end_ROW start_ROW start_CELL - divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL - divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL â‹¯ end_CELL start_CELL divide start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R âˆ– italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL end_ROW end_ARG ) âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_R + 1 ) Ã— italic_R end_POSTSUPERSCRIPT ; |   
---|---|---  
  
notice it is nonzero as required.

Part (b) is immediate from Theorem D.1(b) using
ar=ğ’†rsubscriptğ‘ğ‘Ÿsubscriptğ’†ğ‘Ÿa_{r}=\boldsymbol{e}_{r}italic_a
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT = bold_italic_e
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT, the selector vector with a 1
in the rthsuperscriptğ‘Ÿthr^{\text{th}}italic_r start_POSTSUPERSCRIPT th
end_POSTSUPERSCRIPT position and zeroes elsewhere, and
ğ’ƒr=(1,1,â€¦,1)âŠ¤subscriptğ’ƒğ‘Ÿsuperscript11â€¦1top\boldsymbol{b}_{r}=(1,1,\ldots,1)^{\top}bold_italic_b
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT = ( 1 , 1 , â€¦ , 1 )
start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT. âˆ

###  E.2 Proofs of Theorems D.2, 6.3, and 6.4

Next we prove Theorem D.2. Then we will use this result to prove Theorem 6.4,
and finally Theorem 6.3.

###### Proof of Theorem D.2.

By Theorem A.5, the average treatment effect
Ï„ATTâ¢(r,t)subscriptğœATTğ‘Ÿğ‘¡\tau_{\text{ATT}}(r,t)italic_Ï„
start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) is equal to
the regression estimand
Ï„râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡\tau_{rt}^{*}italic_Ï„
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
âˆ— end_POSTSUPERSCRIPT. We will prove Theorem D.2 by applying Theorem C.1(e),
(g), and (h) with particular choices of vectors
ğNsubscriptğğ‘\boldsymbol{\psi}_{N}bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT and
ğ^Nsubscriptbold-^ğğ‘\boldsymbol{\hat{\psi}}_{N}overbold_^ start_ARG
bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT.

  1. (a)

Let iâ¢(r,t)ğ‘–ğ‘Ÿğ‘¡i(r,t)italic_i ( italic_r , italic_t ) be the index of
the row of ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT corresponding to
Ï„^râ¢t(q)superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘\hat{\tau}_{rt}^{(q)}over^ start_ARG
italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT (that is, the column of
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG
corresponding to this regression coefficient), so that

| Ï„^râ¢t(q)=(ğ‘«Nâˆ’1)iâ¢(r,t)â£â‹…â¢ğœ½^(q)superscriptsubscript^ğœğ‘Ÿğ‘¡ğ‘subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptbold-^ğœ½ğ‘\hat{\tau}_{rt}^{(q)}=(\boldsymbol{D}_{N}^{-1})_{i(r,t)\cdot}\boldsymbol{\hat{% \theta}}^{(q)}over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT = ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) â‹… end_POSTSUBSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT |   
---|---|---  
  
and

| Ï„râ¢tâˆ—=(ğ‘«Nâˆ’1)iâ¢(r,t)â£â‹…â¢ğœ½Nâˆ—.superscriptsubscriptğœğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptsubscriptğœ½ğ‘\tau_{rt}^{*}=(\boldsymbol{D}_{N}^{-1})_{i(r,t)\cdot}\boldsymbol{\theta}_{N}^{% *}.italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT = ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) â‹… end_POSTSUBSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT . |   
---|---|---  
  
We can see from Lemma E.1 that each row of
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT contains at most (Tâˆ’1)2superscriptğ‘‡12(T-1)^{2}(
italic_T - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT nonzero entries,
all of the nonzero entries equal 1, and the entries corresponding to the sğ‘
sitalic_s relevant features will stay fixed even if
pNâ†’âˆâ†’subscriptğ‘ğ‘p_{N}\to\inftyitalic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT â†’ âˆ. So the vector
ğN=((ğ‘«Nâˆ’1)iâ¢(r,t),â‹…)âŠ¤subscriptğğ‘superscriptsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…top\boldsymbol{\psi}_{N}=\left((\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}\right)^{\top}bold_italic_Ïˆ
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = ( ( bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) ,
â‹… end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT is a
valid choice for Theorem C.1(d) - (h). In fact, any fixed, finite linear
combination of rows
(ğ‘«Nâˆ’1)iâ¢(r,t),â‹…subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…(\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}(
bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i (
italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT is a valid choice. We therefore
have from Theorem C.1(e) that if at least one of the nonzero components of
(ğ‘«Nâˆ’1)iâ¢(r,t),â‹…subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…(\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}(
bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i (
italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT corresponds to one of the sğ‘
sitalic_s features in ğ’®ğ’®\mathcal{S}caligraphic_S,

| Nâ¢Tv^NATT;r,tâ¢((ğ‘«Nâˆ’1)iâ¢(r,t),â‹…â¢ğœ½^(q)âˆ’(ğ‘«Nâˆ’1)iâ¢(r,t),â‹…â¢ğœ½Nâˆ—)â†’ğ‘‘ğ‘‘â†’ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘ATTğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptbold-^ğœ½ğ‘subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptsubscriptğœ½ğ‘absent\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{\text{ATT};r,t}}}\left((\boldsymbol{% D}_{N}^{-1})_{i(r,t),\cdot}\boldsymbol{\hat{\theta}}^{(q)}-(\boldsymbol{D}_{N}% ^{-1})_{i(r,t),\cdot}\boldsymbol{\theta}_{N}^{*}\right)\xrightarrow{d}% \leavevmode\nobreak\ square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ATT ; italic_r , italic_t end_POSTSUPERSCRIPT end_ARG end_ARG ( ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,1)ğ’©01\displaystyle\mathcal{N}(0,1)caligraphic_N ( 0 , 1 ) |   
---|---|---|---  
| â‡”Nâ¢Tv^NATT;r,tâ¢(Ï„^ATTâ¢(r,t)âˆ’Ï„ATTâ¢(r,t))â†’ğ‘‘ğ‘‘â†’iffğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘ATTğ‘Ÿğ‘¡subscript^ğœATTğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡absent\displaystyle\iff\qquad\sqrt{\frac{NT}{\hat{v}_{N}^{\text{ATT};r,t}}}\left(% \hat{\tau}_{\text{ATT}}(r,t)-\tau_{\text{ATT}}(r,t)\right)\xrightarrow{d}% \leavevmode\nobreak\ â‡” square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ATT ; italic_r , italic_t end_POSTSUPERSCRIPT end_ARG end_ARG ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,1),ğ’©01\displaystyle\mathcal{N}(0,1),caligraphic_N ( 0 , 1 ) , |   
  
where

| v^NATT;r,t:=Ïƒ2â¢(ğ‘«Nâˆ’1)iâ¢(r,t),ğ’®^â¢(Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®^))âˆ’1â¢((ğ‘«Nâˆ’1)iâ¢(r,t),ğ’®^)âŠ¤,assignsuperscriptsubscript^ğ‘£ğ‘ATTğ‘Ÿğ‘¡superscriptğœ2subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡^ğ’®superscript^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…^ğ’®1superscriptsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡^ğ’®top\hat{v}_{N}^{\text{ATT};r,t}:=\sigma^{2}(\boldsymbol{D}_{N}^{-1})_{i(r,t),\hat% {\mathcal{S}}}\left(\widehat{\mathrm{Cov}}\left((\boldsymbol{Z}\boldsymbol{D}_% {N}^{-1})_{(\cdot\cdot)\hat{\mathcal{S}}}\right)\right)^{-1}((\boldsymbol{D}_{% N}^{-1})_{i(r,t),\hat{\mathcal{S}}})^{\top},over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ATT ; italic_r , italic_t end_POSTSUPERSCRIPT := italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT ( over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT , |   
---|---|---  
  
Cov^â¢(â‹…)^Covâ‹…\widehat{\mathrm{Cov}}(\cdot)over^ start_ARG roman_Cov end_ARG ( â‹… ) is defined in (C.2) and (ğ‘«Nâˆ’1)iâ¢(r,t),ğ’®^âˆˆâ„|ğ’®^|subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡^ğ’®superscriptâ„^ğ’®(\boldsymbol{D}_{N}^{-1})_{i(r,t),\hat{\mathcal{S}}}\in\mathbb{R}^{|\hat{% \mathcal{S}}|}( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT | over^ start_ARG caligraphic_S end_ARG | end_POSTSUPERSCRIPT is a row vector that contains the |ğ’®^|^ğ’®|\hat{\mathcal{S}}|| over^ start_ARG caligraphic_S end_ARG | components of the iâ¢(r,t)ğ‘–ğ‘Ÿğ‘¡i(r,t)italic_i ( italic_r , italic_t ) row of ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT corresponding to the selected features. Similarly, for any deterministic fixed set of constants {Ïˆrâ¢t}subscriptğœ“ğ‘Ÿğ‘¡\\{\psi_{rt}\\}{ italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT }, since

| âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢Ï„râ¢tâˆ—=âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(ğ‘«Nâˆ’1)iâ¢(r,t),â‹…â¢ğœ½Nâˆ—,subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptğœğ‘Ÿğ‘¡subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptsubscriptğœ½ğ‘\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\tau_{rt}^{*}=\sum_{r\in\mathcal{% R}}\sum_{t=r}^{T}\psi_{rt}(\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}\boldsymbol{% \theta}_{N}^{*},âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT = âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , |   
---|---|---  
  
we can choose
ğN(C):=âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(ğ‘«Nâˆ’1)iâ¢(r,t),â‹…âŠ¤assignsuperscriptsubscriptğğ‘Csubscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…top\boldsymbol{\psi}_{N}^{(\text{C})}:=\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{%
rt}(\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}^{\top}bold_italic_Ïˆ
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C )
end_POSTSUPERSCRIPT := âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R
end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ
start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) ,
â‹… end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT to
establish that

| Nâ¢Tv^N(C)â¢((ğN(C))âŠ¤â¢(ğœ½^(q)âˆ’ğœ½Nâˆ—))â†’ğ‘‘ğ‘‘â†’ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘Csuperscriptsuperscriptsubscriptğğ‘Ctopsuperscriptbold-^ğœ½ğ‘superscriptsubscriptğœ½ğ‘absent\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{C})}}}\left((\boldsymbol{\psi% }_{N}^{(\text{C})})^{\top}(\boldsymbol{\hat{\theta}}^{(q)}-\boldsymbol{\theta}% _{N}^{*})\right)\xrightarrow{d}\leavevmode\nobreak\ square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C ) end_POSTSUPERSCRIPT end_ARG end_ARG ( ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,1)ğ’©01\displaystyle\mathcal{N}(0,1)caligraphic_N ( 0 , 1 ) |   
---|---|---|---  
| â‡”Nâ¢Tv^N(C)â¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï„^ATTâ¢(r,t)âˆ’Ï„ATTâ¢(r,t))â†’ğ‘‘ğ‘‘â†’iffğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘Csubscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœATTğ‘Ÿğ‘¡subscriptğœATTğ‘Ÿğ‘¡absent\displaystyle\iff\qquad\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{C})}}}\sum_{r\in% \mathcal{R}}\sum_{t=r}^{T}\psi_{rt}(\hat{\tau}_{\text{ATT}}(r,t)-\tau_{\text{% ATT}}(r,t))\xrightarrow{d}\leavevmode\nobreak\ â‡” square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C ) end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,1),ğ’©01\displaystyle\mathcal{N}(0,1),caligraphic_N ( 0 , 1 ) , |   
  
where

| v^N(C):=Ïƒ2â¢((ğN(C))ğ’®^)âŠ¤â¢(Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®^))âˆ’1â¢(ğN(C))ğ’®^.assignsuperscriptsubscript^ğ‘£ğ‘Csuperscriptğœ2superscriptsubscriptsuperscriptsubscriptğğ‘C^ğ’®topsuperscript^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…^ğ’®1subscriptsuperscriptsubscriptğğ‘C^ğ’®\hat{v}_{N}^{(\text{C})}:=\sigma^{2}\left((\boldsymbol{\psi}_{N}^{(\text{C})})% _{\hat{\mathcal{S}}}\right)^{\top}\left(\widehat{\mathrm{Cov}}\left((% \boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot\cdot)\hat{\mathcal{S}}}\right)% \right)^{-1}(\boldsymbol{\psi}_{N}^{(\text{C})})_{\hat{\mathcal{S}}}.over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C ) end_POSTSUPERSCRIPT := italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT . |  | (E.7)  
---|---|---|---  
  
  2. (b)

We will prove the convergence of the results with estimated cohort
probabilities by applying Theorem C.1(g). Consider the random vector

| ğ^N(C;Â â¢Ï€^):=âˆ‘râˆˆâ„›frâ¢(Ï€^r1,Ï€^r2,â€¦,Ï€^rR)â¢âˆ‘t=rTÏˆrâ¢tâ¢(ğ‘«Nâˆ’1)iâ¢(r,t),â‹…âˆˆâ„pNassignsuperscriptsubscriptbold-^ğğ‘C;Â ^ğœ‹subscriptğ‘Ÿâ„›subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1subscript^ğœ‹subscriptğ‘Ÿ2â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptâ„subscriptğ‘ğ‘\boldsymbol{\hat{\psi}}_{N}^{(\text{C; }\hat{\pi})}:=\sum_{r\in\mathcal{R}}f_{% r}(\hat{\pi}_{r_{1}},\hat{\pi}_{r_{2}},\ldots,\hat{\pi}_{r_{R}})\sum_{t=r}^{T}% \psi_{rt}(\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}\in\mathbb{R}^{p_{N}}overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG ) end_POSTSUPERSCRIPT := âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT |  | (E.8)  
---|---|---|---  
  
and define

| ğN(C;Â â¢Ï€):=âˆ‘râˆˆâ„›frâ¢(Ï€r1,Ï€r2,â€¦,Ï€rR)â¢âˆ‘t=rTÏˆrâ¢tâ¢(ğ‘«Nâˆ’1)iâ¢(r,t),â‹…âˆˆâ„pN,assignsuperscriptsubscriptğğ‘C;Â ğœ‹subscriptğ‘Ÿâ„›subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1subscriptğœ‹subscriptğ‘Ÿ2â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptâ„subscriptğ‘ğ‘\boldsymbol{\psi}_{N}^{(\text{C; }\pi)}:=\sum_{r\in\mathcal{R}}f_{r}(\pi_{r_{1% }},\pi_{r_{2}},\ldots,\pi_{r_{R}})\sum_{t=r}^{T}\psi_{rt}(\boldsymbol{D}_{N}^{% -1})_{i(r,t),\cdot}\in\mathbb{R}^{p_{N}},bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; italic_Ï€ ) end_POSTSUPERSCRIPT := âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , |   
---|---|---  
  
so that

|  | (ğ^N(C;Â â¢Ï€^))âŠ¤â¢ğœ½^(q)âˆ’(ğN(C;Â â¢Ï€))âŠ¤â¢ğœ½Nâˆ—superscriptsuperscriptsubscriptbold-^ğğ‘C;Â ^ğœ‹topsuperscriptbold-^ğœ½ğ‘superscriptsuperscriptsubscriptğğ‘C;Â ğœ‹topsuperscriptsubscriptğœ½ğ‘\displaystyle(\boldsymbol{\hat{\psi}}_{N}^{(\text{C; }\hat{\pi})})^{\top}% \boldsymbol{\hat{\theta}}^{(q)}-(\boldsymbol{\psi}_{N}^{(\text{C; }\pi)})^{% \top}\boldsymbol{\theta}_{N}^{*}( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(frâ¢(Ï€^r1,Ï€^r2,â€¦,Ï€^rR)â¢Ï„^ATTâ¢(r,t)âˆ’frâ¢(Ï€r1,Ï€r2,â€¦,Ï€rR)â¢Ï„ATTâ¢(r,t)).subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1subscript^ğœ‹subscriptğ‘Ÿ2â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscript^ğœATTğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1subscriptğœ‹subscriptğ‘Ÿ2â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…subscriptğœATTğ‘Ÿğ‘¡\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(f_{r}(\hat{\pi% }_{r_{1}},\hat{\pi}_{r_{2}},\ldots,\hat{\pi}_{r_{R}})\hat{\tau}_{\text{ATT}}(r% ,t)-f_{r}(\pi_{r_{1}},\pi_{r_{2}},\ldots,\pi_{r_{R}})\tau_{\text{ATT}}(r,t)% \right).âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) . |   
  
We have assumed that the
(Ï€^r1,Ï€^r2,â€¦,Ï€^rR)subscript^ğœ‹subscriptğ‘Ÿ1subscript^ğœ‹subscriptğ‘Ÿ2â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…(\hat{\pi}_{r_{1}},\hat{\pi}_{r_{2}},\ldots,\hat{\pi}_{r_{R}})(
over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r
start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over^ start_ARG
italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2
end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT
end_POSTSUBSCRIPT ) values (and therefore ğ^N(C;Â
â¢Ï€^)superscriptsubscriptbold-^ğğ‘C;Â
^ğœ‹\boldsymbol{\hat{\psi}}_{N}^{(\text{C; }\hat{\pi})}overbold_^ start_ARG
bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG )
end_POSTSUPERSCRIPT) are estimated on an independent data set from the one
used to estimate
ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT. It remains to show that

| Nâ¢Tâ¢(ğœ½âˆ—)ğ’®âŠ¤â¢((ğ^N(C;Â â¢Ï€^))ğ’®âˆ’(ğN(C;Â â¢Ï€))ğ’®)ğ‘ğ‘‡superscriptsubscriptsuperscriptğœ½ğ’®topsubscriptsuperscriptsubscriptbold-^ğğ‘C;Â ^ğœ‹ğ’®subscriptsuperscriptsubscriptğğ‘C;Â ğœ‹ğ’®\sqrt{NT}(\boldsymbol{\theta}^{*})_{\mathcal{S}}^{\top}\left((\boldsymbol{\hat% {\psi}}_{N}^{(\text{C; }\hat{\pi})})_{\mathcal{S}}-(\boldsymbol{\psi}_{N}^{(% \text{C; }\pi)})_{\mathcal{S}}\right)square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT - ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ) |   
---|---|---  
  
is asymptotically normal and to identify a consistent estimator for the
asymptotic variance. First we establish asymptotic normality. Because by
assumption ğ’‡â¢(â‹…)ğ’‡â‹…\boldsymbol{f}(\cdot)bold_italic_f ( â‹… ) has a
finite Jacobian
âˆ‡ğ’‡âˆˆâ„(R+1)Ã—Râˆ‡ğ’‡superscriptâ„ğ‘…1ğ‘…\nabla\boldsymbol{f}\in\mathbb{R}^{(R+1)\times
R}âˆ‡ bold_italic_f âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_R + 1 ) Ã—
italic_R end_POSTSUPERSCRIPT at
(Ï€0,Ï€r1,â€¦,Ï€rR)subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})(
italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r
start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) that exists
and is nonzero and finite, using the asymptotic normality of the maximum
likelihood estimator
(N0N,Nr1N,Nr2N,â€¦,NrRN)subscriptğ‘0ğ‘subscriptğ‘subscriptğ‘Ÿ1ğ‘subscriptğ‘subscriptğ‘Ÿ2ğ‘â€¦subscriptğ‘subscriptğ‘Ÿğ‘…ğ‘\left(\frac{N_{0}}{N},\frac{N_{r_{1}}}{N},\frac{N_{r_{2}}}{N},\ldots,\frac{N_{%
r_{R}}}{N}\right)( divide start_ARG italic_N start_POSTSUBSCRIPT 0
end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG , divide start_ARG
italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG , divide start_ARG
italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG , â€¦ , divide start_ARG
italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R
end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG )
(Theorem 14.6 in Wasserman 2004) and the delta method (Theorem 3.1 in vanÂ der
Vaart 2000) that

| Nâ¢(ğ’‡â¢(Ï€^0,Ï€^r1,â€¦,Ï€^rR)âˆ’ğ’‡â¢(Ï€0,Ï€r1,â€¦,Ï€rR))â†’ğ‘‘ğ‘‘â†’ğ‘ğ’‡subscript^ğœ‹0subscript^ğœ‹subscriptğ‘Ÿ1â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’‡subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…absent\displaystyle\sqrt{N}\left(\boldsymbol{f}(\hat{\pi}_{0},\hat{\pi}_{r_{1}},% \ldots,\hat{\pi}_{r_{R}})-\boldsymbol{f}(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}% })\right)\xrightarrow{d}\leavevmode\nobreak\ square-root start_ARG italic_N end_ARG ( bold_italic_f ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - bold_italic_f ( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,âˆ‡ğ’‡âŠ¤â¢ğšºMâ¢âˆ‡ğ’‡),ğ’©0âˆ‡superscriptğ’‡topsubscriptğšºğ‘€âˆ‡ğ’‡\displaystyle\mathcal{N}(0,\nabla\boldsymbol{f}^{\top}\boldsymbol{\Sigma}_{M}% \nabla\boldsymbol{f}),caligraphic_N ( 0 , âˆ‡ bold_italic_f start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_Î£ start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT âˆ‡ bold_italic_f ) , |   
---|---|---|---  
  
where ğšºMsubscriptğšºğ‘€\boldsymbol{\Sigma}_{M}bold_Î£ start_POSTSUBSCRIPT
italic_M end_POSTSUBSCRIPT was defined in (E.4). Then

|  | Nâ¢Tâ¢(ğœ½âˆ—)ğ’®âŠ¤â¢((ğ^N(C;Â â¢Ï€^))ğ’®âˆ’(ğN(C;Â â¢Ï€))ğ’®)ğ‘ğ‘‡superscriptsubscriptsuperscriptğœ½ğ’®topsubscriptsuperscriptsubscriptbold-^ğğ‘C;Â ^ğœ‹ğ’®subscriptsuperscriptsubscriptğğ‘C;Â ğœ‹ğ’®\displaystyle\sqrt{NT}(\boldsymbol{\theta}^{*})_{\mathcal{S}}^{\top}\left((% \boldsymbol{\hat{\psi}}_{N}^{(\text{C; }\hat{\pi})})_{\mathcal{S}}-(% \boldsymbol{\psi}_{N}^{(\text{C; }\pi)})_{\mathcal{S}}\right)square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT - ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢Tâ¢(ğœ½Nâˆ—)ğ’®âŠ¤â¢(âˆ‘râˆˆâ„›[frâ¢(Ï€^r1,Ï€^r2,â€¦,Ï€^rR)âˆ’frâ¢(Ï€r1,Ï€r2,â€¦,Ï€rR)]â¢âˆ‘t=rTÏˆrâ¢tâ¢(ğ‘«Nâˆ’1)iâ¢(r,t),ğ’®)ğ‘ğ‘‡superscriptsubscriptsuperscriptsubscriptğœ½ğ‘ğ’®topsubscriptğ‘Ÿâ„›delimited-[]subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1subscript^ğœ‹subscriptğ‘Ÿ2â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1subscriptğœ‹subscriptğ‘Ÿ2â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’®\displaystyle\sqrt{NT}(\boldsymbol{\theta}_{N}^{*})_{\mathcal{S}}^{\top}\left(% \sum_{r\in\mathcal{R}}\left[f_{r}(\hat{\pi}_{r_{1}},\hat{\pi}_{r_{2}},\ldots,% \hat{\pi}_{r_{R}})-f_{r}(\pi_{r_{1}},\pi_{r_{2}},\ldots,\pi_{r_{R}})\right]% \sum_{t=r}^{T}\psi_{rt}(\boldsymbol{D}_{N}^{-1})_{i(r,t),\mathcal{S}}\right)square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT [ italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ] âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , caligraphic_S end_POSTSUBSCRIPT ) |   
| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢Tâ¢(ğœ½Nâˆ—)ğ’®âŠ¤â¢(ğ‘´âŠ¤â¢[ğ’‡â¢(Ï€^r1,Ï€^r2,â€¦,Ï€^rR)âˆ’ğ’‡â¢(Ï€r1,Ï€r2,â€¦,Ï€rR)])ğ‘ğ‘‡superscriptsubscriptsuperscriptsubscriptğœ½ğ‘ğ’®topsuperscriptğ‘´topdelimited-[]ğ’‡subscript^ğœ‹subscriptğ‘Ÿ1subscript^ğœ‹subscriptğ‘Ÿ2â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’‡subscriptğœ‹subscriptğ‘Ÿ1subscriptğœ‹subscriptğ‘Ÿ2â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…\displaystyle\sqrt{NT}(\boldsymbol{\theta}_{N}^{*})_{\mathcal{S}}^{\top}\left(% \boldsymbol{M}^{\top}\left[\boldsymbol{f}(\hat{\pi}_{r_{1}},\hat{\pi}_{r_{2}},% \ldots,\hat{\pi}_{r_{R}})-\boldsymbol{f}(\pi_{r_{1}},\pi_{r_{2}},\ldots,\pi_{r% _{R}})\right]\right)square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_M start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT [ bold_italic_f ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - bold_italic_f ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ] ) |   
| â†’ğ‘‘ğ‘‘â†’\displaystyle\xrightarrow{d}\leavevmode\nobreak\ start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,ğ‘´âŠ¤â¢âˆ‡ğ’‡âŠ¤â¢ğšºMâ¢âˆ‡ğ’‡â¢ğ‘´),ğ’©0superscriptğ‘´topâˆ‡superscriptğ’‡topsubscriptğšºğ‘€âˆ‡ğ’‡ğ‘´\displaystyle\mathcal{N}(0,\boldsymbol{M}^{\top}\nabla\boldsymbol{f}^{\top}% \boldsymbol{\Sigma}_{M}\nabla\boldsymbol{f}\boldsymbol{M}),caligraphic_N ( 0 , bold_italic_M start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‡ bold_italic_f start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_Î£ start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT âˆ‡ bold_italic_f bold_italic_M ) , |   
  
where

| ğ‘´:=(âˆ‘t=r1TÏˆr1â¢tâ¢(ğ‘«Nâˆ’1)iâ¢(r1,t),ğ’®âˆ‘t=r2TÏˆr2â¢tâ¢(ğ‘«Nâˆ’1)iâ¢(r2,t),ğ’®â‹®âˆ‘t=rRTÏˆrRâ¢tâ¢(ğ‘«Nâˆ’1)iâ¢(rR,t),ğ’®)âˆˆâ„RÃ—s.assignğ‘´matrixsuperscriptsubscriptğ‘¡subscriptğ‘Ÿ1ğ‘‡subscriptğœ“subscriptğ‘Ÿ1ğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–subscriptğ‘Ÿ1ğ‘¡ğ’®superscriptsubscriptğ‘¡subscriptğ‘Ÿ2ğ‘‡subscriptğœ“subscriptğ‘Ÿ2ğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–subscriptğ‘Ÿ2ğ‘¡ğ’®â‹®missing-subexpressionsuperscriptsubscriptğ‘¡subscriptğ‘Ÿğ‘…ğ‘‡subscriptğœ“subscriptğ‘Ÿğ‘…ğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–subscriptğ‘Ÿğ‘…ğ‘¡ğ’®superscriptâ„ğ‘…ğ‘ \boldsymbol{M}:=\begin{pmatrix}\sum_{t=r_{1}}^{T}\psi_{r_{1}t}(\boldsymbol{D}_% {N}^{-1})_{i(r_{1},t),\mathcal{S}}\\\ \sum_{t=r_{2}}^{T}\psi_{r_{2}t}(\boldsymbol{D}_{N}^{-1})_{i(r_{2},t),\mathcal{% S}}\\\ \vdots\\\ \\\ \sum_{t=r_{R}}^{T}\psi_{r_{R}t}(\boldsymbol{D}_{N}^{-1})_{i(r_{R},t),\mathcal{% S}}\end{pmatrix}\in\mathbb{R}^{R\times s}.bold_italic_M := ( start_ARG start_ROW start_CELL âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ) , caligraphic_S end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_t ) , caligraphic_S end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL â‹® end_CELL end_ROW start_ROW start_CELL end_CELL end_ROW start_ROW start_CELL âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT , italic_t ) , caligraphic_S end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ) âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_R Ã— italic_s end_POSTSUPERSCRIPT . |   
---|---|---  
  
Further, we can estimate this covariance matrix by
ğ‘½^â¢(ğ’œN)bold-^ğ‘½subscriptğ’œğ‘\boldsymbol{\hat{V}}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_V end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) defined for any
ğ’œNâŠ†[pN]subscriptğ’œğ‘delimited-[]subscriptğ‘ğ‘\mathcal{A}_{N}\subseteq[p_{N}]caligraphic_A
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âŠ† [ italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] by

| ğ‘½^â¢(ğ’œN)=Tâ‹…ğ‘´^â¢(ğ’œN)âŠ¤â¢âˆ‡ğ’‡^âŠ¤â¢ğšº^Mâ¢âˆ‡ğ’‡^â¢ğ‘´^â¢(ğ’œN),bold-^ğ‘½subscriptğ’œğ‘â‹…ğ‘‡bold-^ğ‘´superscriptsubscriptğ’œğ‘topâˆ‡superscriptbold-^ğ’‡topsubscriptbold-^ğšºğ‘€âˆ‡bold-^ğ’‡bold-^ğ‘´subscriptğ’œğ‘\boldsymbol{\hat{V}}(\mathcal{A}_{N})=T\cdot\boldsymbol{\hat{M}}(\mathcal{A}_{% N})^{\top}\nabla\boldsymbol{\hat{f}}^{\top}\boldsymbol{\hat{\Sigma}}_{M}\nabla% \boldsymbol{\hat{f}}\boldsymbol{\hat{M}}(\mathcal{A}_{N}),overbold_^ start_ARG bold_italic_V end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) = italic_T â‹… overbold_^ start_ARG bold_italic_M end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‡ overbold_^ start_ARG bold_italic_f end_ARG start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_Î£ end_ARG start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT âˆ‡ overbold_^ start_ARG bold_italic_f end_ARG overbold_^ start_ARG bold_italic_M end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) , |  | (E.9)  
---|---|---|---  
  
where

| ğ‘´^â¢(ğ’œN):=(âˆ‘t=r1TÏˆr1â¢tâ¢(ğ‘«Nâˆ’1)iâ¢(r1,t),ğ’œNâˆ‘t=r2TÏˆr2â¢tâ¢(ğ‘«Nâˆ’1)iâ¢(r2,t),ğ’œNâ‹®âˆ‘t=rRTÏˆrRâ¢tâ¢(ğ‘«Nâˆ’1)iâ¢(rR,t),ğ’œN)âˆˆâ„RÃ—|ğ’œN|,assignbold-^ğ‘´subscriptğ’œğ‘matrixsuperscriptsubscriptğ‘¡subscriptğ‘Ÿ1ğ‘‡subscriptğœ“subscriptğ‘Ÿ1ğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–subscriptğ‘Ÿ1ğ‘¡subscriptğ’œğ‘superscriptsubscriptğ‘¡subscriptğ‘Ÿ2ğ‘‡subscriptğœ“subscriptğ‘Ÿ2ğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–subscriptğ‘Ÿ2ğ‘¡subscriptğ’œğ‘â‹®missing-subexpressionsuperscriptsubscriptğ‘¡subscriptğ‘Ÿğ‘…ğ‘‡subscriptğœ“subscriptğ‘Ÿğ‘…ğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–subscriptğ‘Ÿğ‘…ğ‘¡subscriptğ’œğ‘superscriptâ„ğ‘…subscriptğ’œğ‘\boldsymbol{\hat{M}}(\mathcal{A}_{N}):=\begin{pmatrix}\sum_{t=r_{1}}^{T}\psi_{% r_{1}t}(\boldsymbol{D}_{N}^{-1})_{i(r_{1},t),\mathcal{A}_{N}}\\\ \sum_{t=r_{2}}^{T}\psi_{r_{2}t}(\boldsymbol{D}_{N}^{-1})_{i(r_{2},t),\mathcal{% A}_{N}}\\\ \vdots\\\ \\\ \sum_{t=r_{R}}^{T}\psi_{r_{R}t}(\boldsymbol{D}_{N}^{-1})_{i(r_{R},t),\mathcal{% A}_{N}}\end{pmatrix}\in\mathbb{R}^{R\times|\mathcal{A}_{N}|},overbold_^ start_ARG bold_italic_M end_ARG ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) := ( start_ARG start_ROW start_CELL âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t ) , caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_t ) , caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL â‹® end_CELL end_ROW start_ROW start_CELL end_CELL end_ROW start_ROW start_CELL âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT , italic_t ) , caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ) âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_R Ã— | caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT , |   
---|---|---  
| ğšº^M:=1N2â¢(N0â¢(Nâˆ’N0)âˆ’N0â¢Nr1â‹¯âˆ’N0â¢NrRâˆ’N0â¢Nr1Nr1â¢(Nâˆ’Nr1)â‹¯âˆ’Nr1â¢NrRâ‹®â‹®â‹±â‹®âˆ’N0â¢NrRâˆ’Nr1â¢NrRâ‹¯NrRâ¢(Nâˆ’NrR))âˆˆâ„(R+1)Ã—(R+1),assignsubscriptbold-^ğšºğ‘€1superscriptğ‘2matrixsubscriptğ‘0ğ‘subscriptğ‘0subscriptğ‘0subscriptğ‘subscriptğ‘Ÿ1â‹¯subscriptğ‘0subscriptğ‘subscriptğ‘Ÿğ‘…subscriptğ‘0subscriptğ‘subscriptğ‘Ÿ1subscriptğ‘subscriptğ‘Ÿ1ğ‘subscriptğ‘subscriptğ‘Ÿ1â‹¯subscriptğ‘subscriptğ‘Ÿ1subscriptğ‘subscriptğ‘Ÿğ‘…â‹®â‹®â‹±â‹®subscriptğ‘0subscriptğ‘subscriptğ‘Ÿğ‘…subscriptğ‘subscriptğ‘Ÿ1subscriptğ‘subscriptğ‘Ÿğ‘…â‹¯subscriptğ‘subscriptğ‘Ÿğ‘…ğ‘subscriptğ‘subscriptğ‘Ÿğ‘…superscriptâ„ğ‘…1ğ‘…1\boldsymbol{\hat{\Sigma}}_{M}:=\frac{1}{N^{2}}\begin{pmatrix}N_{0}(N-N_{0})&-N% _{0}N_{r_{1}}&\cdots&-N_{0}N_{r_{R}}\\\ -N_{0}N_{r_{1}}&N_{r_{1}}(N-N_{r_{1}})&\cdots&-N_{r_{1}}N_{r_{R}}\\\ \vdots&\vdots&\ddots&\vdots\\\ -N_{0}N_{r_{R}}&-N_{r_{1}}N_{r_{R}}&\cdots&N_{r_{R}}(N-N_{r_{R}})\end{pmatrix}% \in\mathbb{R}^{(R+1)\times(R+1)},overbold_^ start_ARG bold_Î£ end_ARG start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT := divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( start_ARG start_ROW start_CELL italic_N start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( italic_N - italic_N start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) end_CELL start_CELL - italic_N start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL start_CELL â‹¯ end_CELL start_CELL - italic_N start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL - italic_N start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL start_CELL italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_N - italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_CELL start_CELL â‹¯ end_CELL start_CELL - italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹± end_CELL start_CELL â‹® end_CELL end_ROW start_ROW start_CELL - italic_N start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL start_CELL - italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL start_CELL â‹¯ end_CELL start_CELL italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_N - italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_CELL end_ROW end_ARG ) âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_R + 1 ) Ã— ( italic_R + 1 ) end_POSTSUPERSCRIPT , |  | (E.10)  
---|---|---|---  
  
and âˆ‡ğ’‡^âˆ‡bold-^ğ’‡\nabla\boldsymbol{\hat{f}}âˆ‡ overbold_^ start_ARG
bold_italic_f end_ARG is defined by replacing each instance of
Ï€rsubscriptğœ‹ğ‘Ÿ\pi_{r}italic_Ï€ start_POSTSUBSCRIPT italic_r
end_POSTSUBSCRIPT in âˆ‡ğ’‡âˆ‡ğ’‡\nabla\boldsymbol{f}âˆ‡ bold_italic_f with
its estimator Ï€^rsubscript^ğœ‹ğ‘Ÿ\hat{\pi}_{r}over^ start_ARG italic_Ï€
end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT. Using the consistency
of ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT and the sample covariance matrix, the continuous mapping
theorem yields that

| (ğœ½^(q))ğ’®âŠ¤â¢ğ‘½^â¢(ğ’®)â¢ğœ½^ğ’®(q)â†’ğ‘Tâ¢(ğœ½Nâˆ—)ğ’®âŠ¤â¢(âˆ‡ğN(C;Â â¢Ï€))ğ’®âŠ¤â¢ğšºMâ¢(âˆ‡ğN(C;Â â¢Ï€))ğ’®â¢(ğœ½Nâˆ—)ğ’®,ğ‘â†’superscriptsubscriptsuperscriptbold-^ğœ½ğ‘ğ’®topbold-^ğ‘½ğ’®subscriptsuperscriptbold-^ğœ½ğ‘ğ’®ğ‘‡superscriptsubscriptsuperscriptsubscriptğœ½ğ‘ğ’®topsuperscriptsubscriptâˆ‡superscriptsubscriptğğ‘C;Â ğœ‹ğ’®topsubscriptğšºğ‘€subscriptâˆ‡superscriptsubscriptğğ‘C;Â ğœ‹ğ’®subscriptsuperscriptsubscriptğœ½ğ‘ğ’®(\boldsymbol{\hat{\theta}}^{(q)})_{\mathcal{S}}^{\top}\boldsymbol{\hat{V}}(% \mathcal{S})\boldsymbol{\hat{\theta}}^{(q)}_{\mathcal{S}}\xrightarrow{p}T(% \boldsymbol{\theta}_{N}^{*})_{\mathcal{S}}^{\top}(\nabla\boldsymbol{\psi}_{N}^% {(\text{C; }\pi)})_{\mathcal{S}}^{\top}\boldsymbol{\Sigma}_{M}(\nabla% \boldsymbol{\psi}_{N}^{(\text{C; }\pi)})_{\mathcal{S}}(\boldsymbol{\theta}_{N}% ^{*})_{\mathcal{S}},( overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_V end_ARG ( caligraphic_S ) overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT start_ARROW overitalic_p â†’ end_ARROW italic_T ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( âˆ‡ bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_Î£ start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( âˆ‡ bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT , |   
---|---|---  
  
where ğšºMsubscriptğšºğ‘€\boldsymbol{\Sigma}_{M}bold_Î£ start_POSTSUBSCRIPT
italic_M end_POSTSUBSCRIPT was defined in (E.4). It follows from Theorem
C.1(g) that if at least one of the nonzero components of ğN(C;Â
â¢Ï€)superscriptsubscriptğğ‘C;Â ğœ‹\boldsymbol{\psi}_{N}^{(\text{C;
}\pi)}bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( C; italic_Ï€ ) end_POSTSUPERSCRIPT corresponds to one
of the sğ‘ sitalic_s features in ğ’®ğ’®\mathcal{S}caligraphic_S, we have

|  | Nâ¢Tv^NC;Ï€^â¢((ğ^N(C;Â â¢Ï€^))âŠ¤â¢ğœ½^(q)âˆ’(ğN(C;Â â¢Ï€))âŠ¤â¢ğœ½Nâˆ—)â†’ğ‘‘ğ’©â¢(0,1)ğ‘‘â†’ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘C^ğœ‹superscriptsuperscriptsubscriptbold-^ğğ‘C;Â ^ğœ‹topsuperscriptbold-^ğœ½ğ‘superscriptsuperscriptsubscriptğğ‘C;Â ğœ‹topsuperscriptsubscriptğœ½ğ‘ğ’©01\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{\text{C};\hat{\pi}}}}\left((% \boldsymbol{\hat{\psi}}_{N}^{(\text{C; }\hat{\pi})})^{\top}\boldsymbol{\hat{% \theta}}^{(q)}-(\boldsymbol{\psi}_{N}^{(\text{C; }\pi)})^{\top}\boldsymbol{% \theta}_{N}^{*}\right)\xrightarrow{d}\mathcal{N}(0,1)square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT C ; over^ start_ARG italic_Ï€ end_ARG end_POSTSUPERSCRIPT end_ARG end_ARG ( ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , 1 ) |   
---|---|---|---  
| â‡”iff\displaystyle\iff\qquadâ‡” | Nâ¢Tv^NC;Ï€^â¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(frâ¢(Ï€^r1,Ï€^r2,â€¦,Ï€^rR)â¢Ï„^ATTâ¢(r,t)âˆ’frâ¢(Ï€r1,Ï€r2,â€¦,Ï€rR)â¢Ï„ATTâ¢(r,t))ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘C^ğœ‹subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1subscript^ğœ‹subscriptğ‘Ÿ2â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…subscript^ğœATTğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1subscriptğœ‹subscriptğ‘Ÿ2â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…subscriptğœATTğ‘Ÿğ‘¡\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{\text{C};\hat{\pi}}}}\sum_{r\in% \mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(f_{r}(\hat{\pi}_{r_{1}},\hat{\pi}_{r_% {2}},\ldots,\hat{\pi}_{r_{R}})\hat{\tau}_{\text{ATT}}(r,t)-f_{r}(\pi_{r_{1}},% \pi_{r_{2}},\ldots,\pi_{r_{R}})\tau_{\text{ATT}}(r,t)\right)square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT C ; over^ start_ARG italic_Ï€ end_ARG end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) ) |   
| â†’ğ‘‘ğ‘‘â†’\displaystyle\xrightarrow{d}\leavevmode\nobreak\ start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,1),ğ’©01\displaystyle\mathcal{N}(0,1),caligraphic_N ( 0 , 1 ) , |   
  
where

| v^NC;Ï€^:=Ïƒ2â¢(ğ^N(C;Â â¢Ï€^))ğ’®^âŠ¤â¢(Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®^))âˆ’1â¢(ğ^N(C;Â â¢Ï€^))ğ’®^+(ğœ½^(q))ğ’®^âŠ¤â¢ğ‘½^â¢(ğ’®^)â¢(ğœ½^(q))ğ’®^.assignsuperscriptsubscript^ğ‘£ğ‘C^ğœ‹superscriptğœ2superscriptsubscriptsuperscriptsubscriptbold-^ğğ‘C;Â ^ğœ‹^ğ’®topsuperscript^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…^ğ’®1subscriptsuperscriptsubscriptbold-^ğğ‘C;Â ^ğœ‹^ğ’®superscriptsubscriptsuperscriptbold-^ğœ½ğ‘^ğ’®topbold-^ğ‘½^ğ’®subscriptsuperscriptbold-^ğœ½ğ‘^ğ’®\hat{v}_{N}^{\text{C};\hat{\pi}}:=\sigma^{2}(\boldsymbol{\hat{\psi}}_{N}^{(% \text{C; }\hat{\pi})})_{\hat{\mathcal{S}}}^{\top}\left(\widehat{\mathrm{Cov}}% \left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot\cdot)\hat{\mathcal{S}}}% \right)\right)^{-1}(\boldsymbol{\hat{\psi}}_{N}^{(\text{C; }\hat{\pi})})_{\hat% {\mathcal{S}}}+(\boldsymbol{\hat{\theta}}^{(q)})_{\hat{\mathcal{S}}}^{\top}% \boldsymbol{\hat{V}}(\hat{\mathcal{S}})(\boldsymbol{\hat{\theta}}^{(q)})_{\hat% {\mathcal{S}}}.over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT C ; over^ start_ARG italic_Ï€ end_ARG end_POSTSUPERSCRIPT := italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT + ( overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_V end_ARG ( over^ start_ARG caligraphic_S end_ARG ) ( overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT . |  | (E.11)  
---|---|---|---  
  
  3. (c)

Part (b) follows from the same argument as part (a) but applying Theorem
C.1(h) to yield the stated convergence when using the conservative variance
estimator

|  | v^NC, (cons);Ï€^superscriptsubscript^ğ‘£ğ‘C, (cons)^ğœ‹\displaystyle\hat{v}_{N}^{\text{C, (cons)};\hat{\pi}}over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT C, (cons) ; over^ start_ARG italic_Ï€ end_ARG end_POSTSUPERSCRIPT |   
---|---|---|---  
| :=assign\displaystyle:=\leavevmode\nobreak\ := | Ïƒ2â¢(ğ^N(C;Â â¢Ï€^))ğ’®^âŠ¤â¢(Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®^))âˆ’1â¢(ğ^N(C;Â â¢Ï€^))ğ’®^+(ğœ½^(q))ğ’®^âŠ¤â¢ğ‘½^â¢(ğ’®^)â¢(ğœ½^(q))ğ’®^superscriptğœ2superscriptsubscriptsuperscriptsubscriptbold-^ğğ‘C;Â ^ğœ‹^ğ’®topsuperscript^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…^ğ’®1subscriptsuperscriptsubscriptbold-^ğğ‘C;Â ^ğœ‹^ğ’®superscriptsubscriptsuperscriptbold-^ğœ½ğ‘^ğ’®topbold-^ğ‘½^ğ’®subscriptsuperscriptbold-^ğœ½ğ‘^ğ’®\displaystyle\sigma^{2}(\boldsymbol{\hat{\psi}}_{N}^{(\text{C; }\hat{\pi})})_{% \hat{\mathcal{S}}}^{\top}\left(\widehat{\mathrm{Cov}}\left((\boldsymbol{Z}% \boldsymbol{D}_{N}^{-1})_{(\cdot\cdot)\hat{\mathcal{S}}}\right)\right)^{-1}(% \boldsymbol{\hat{\psi}}_{N}^{(\text{C; }\hat{\pi})})_{\hat{\mathcal{S}}}+(% \boldsymbol{\hat{\theta}}^{(q)})_{\hat{\mathcal{S}}}^{\top}\boldsymbol{\hat{V}% }(\hat{\mathcal{S}})(\boldsymbol{\hat{\theta}}^{(q)})_{\hat{\mathcal{S}}}italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT + ( overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_V end_ARG ( over^ start_ARG caligraphic_S end_ARG ) ( overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT |   
|  | +2â¢Ïƒ2â¢(ğ^N(C;Â â¢Ï€^))ğ’®^âŠ¤â¢(Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®^))âˆ’1â¢(ğ^N(C;Â â¢Ï€^))ğ’®^â‹…(ğœ½^(q))ğ’®^âŠ¤â¢ğ‘½^â¢(ğ’®^)â¢(ğœ½^(q))ğ’®^.2â‹…superscriptğœ2superscriptsubscriptsuperscriptsubscriptbold-^ğğ‘C;Â ^ğœ‹^ğ’®topsuperscript^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…^ğ’®1subscriptsuperscriptsubscriptbold-^ğğ‘C;Â ^ğœ‹^ğ’®superscriptsubscriptsuperscriptbold-^ğœ½ğ‘^ğ’®topbold-^ğ‘½^ğ’®subscriptsuperscriptbold-^ğœ½ğ‘^ğ’®\displaystyle+2\sqrt{\sigma^{2}(\boldsymbol{\hat{\psi}}_{N}^{(\text{C; }\hat{% \pi})})_{\hat{\mathcal{S}}}^{\top}\left(\widehat{\mathrm{Cov}}\left((% \boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot\cdot)\hat{\mathcal{S}}}\right)% \right)^{-1}(\boldsymbol{\hat{\psi}}_{N}^{(\text{C; }\hat{\pi})})_{\hat{% \mathcal{S}}}\cdot(\boldsymbol{\hat{\theta}}^{(q)})_{\hat{\mathcal{S}}}^{\top}% \boldsymbol{\hat{V}}(\hat{\mathcal{S}})(\boldsymbol{\hat{\theta}}^{(q)})_{\hat% {\mathcal{S}}}}.\+ 2 square-root start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT â‹… ( overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_V end_ARG ( over^ start_ARG caligraphic_S end_ARG ) ( overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT end_ARG . |  | (E.12)  
  
(Recall that the random vector ğ^N(C;Â â¢Ï€^)superscriptsubscriptbold-^ğğ‘C;Â
^ğœ‹\boldsymbol{\hat{\psi}}_{N}^{(\text{C; }\hat{\pi})}overbold_^ start_ARG
bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( C; over^ start_ARG italic_Ï€ end_ARG )
end_POSTSUPERSCRIPT was defined in Equation E.8 and the covariance matrix
estimator
ğ‘½^â¢(ğ’®^)bold-^ğ‘½^ğ’®\boldsymbol{\hat{V}}(\hat{\mathcal{S}})overbold_^
start_ARG bold_italic_V end_ARG ( over^ start_ARG caligraphic_S end_ARG ) was
defined in Equation E.9.)

âˆ

###### Proof of Theorem 6.4.

Part (a) is immediate from Theorem D.2(a). To prove parts (b) and (c), in
light of Theorem D.2(b) and (c) it suffices to show that
(Nr1/NÏ„,â€¦,NrR/NÏ„)subscriptğ‘subscriptğ‘Ÿ1subscriptğ‘ğœâ€¦subscriptğ‘subscriptğ‘Ÿğ‘…subscriptğ‘ğœ(N_{r_{1}}/N_{\tau},\ldots,N_{r_{R}}/N_{\tau})(
italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT / italic_N start_POSTSUBSCRIPT italic_Ï„ end_POSTSUBSCRIPT ,
â€¦ , italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R
end_POSTSUBSCRIPT end_POSTSUBSCRIPT / italic_N start_POSTSUBSCRIPT italic_Ï„
end_POSTSUBSCRIPT ) is almost surely finite and has a Jacobian at
(Ï€0,Ï€r1,â€¦,Ï€rR)subscriptğœ‹0subscriptğœ‹subscriptğ‘Ÿ1â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…(\pi_{0},\pi_{r_{1}},\ldots,\pi_{r_{R}})(
italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_Ï€
start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
end_POSTSUBSCRIPT , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r
start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) that exists
and is nonzero and finite, which we already showed in the proof of Theorem
6.1.

âˆ

###### Proof of Theorem 6.3.

In the case where the treatment effects are nonzero, this result follows from
the same arguments that we used in the proof of Theorem D.2, but applying
Theorem C.1(d) and (f). The oracle properties persist even in the case that
the treatment effects equal 0 because, as noted in Theorem 6.2, in this case
the random variables scaled by Nâ¢Tğ‘ğ‘‡\sqrt{NT}square-root start_ARG
italic_N italic_T end_ARG converge in probability (and distribution) to 0. âˆ

###  E.3 Proof of Theorem D.3

  1. (a)

From Theorem A.5, under our assumptions the regression estimands correspond to
our causal estimands. Similarly to the proof of Theorem D.2, we will prove the
result by applying Theorem C.1(g) and Lemma E.3. Let
iâ¢(r,t,ğ’™)ğ‘–ğ‘Ÿğ‘¡ğ’™i(r,t,\boldsymbol{x})italic_i ( italic_r , italic_t ,
bold_italic_x ) denote the indices of dğ‘‘ditalic_d rows of
ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT corresponding to
Ï^râ¢t(q)superscriptsubscript^ğœŒğ‘Ÿğ‘¡ğ‘\hat{\rho}_{rt}^{(q)}over^ start_ARG
italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT (that is, the columns
of ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG
corresponding to the indicator variables for those regression coefficients),
so that

| ğ†râ¢tâˆ—=(ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…â¢ğœ½Nâˆ—,superscriptsubscriptğ†ğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’™â‹…superscriptsubscriptğœ½ğ‘\boldsymbol{\rho}_{rt}^{*}=(\boldsymbol{D}_{N}^{-1})_{i(r,t,\boldsymbol{x}),% \cdot}\boldsymbol{\theta}_{N}^{*},bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT = ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , |   
---|---|---  
  
and for any râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R,
tâ‰¥rğ‘¡ğ‘Ÿt\geq ritalic_t â‰¥ italic_r, and ğ’™ğ’™\boldsymbol{x}bold_italic_x
in the support of ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT,

| Ï„CATTâ¢(r,t,ğ’™)=subscriptğœCATTğ‘Ÿğ‘¡ğ’™absent\displaystyle\tau_{\text{CATT}}(r,t,\boldsymbol{x})=\leavevmode\nobreak\ italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) = | Ï„râ¢tâˆ—+(ğ’™âˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r])âŠ¤â¢ğ†râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡superscriptğ’™ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡\displaystyle\tau_{rt}^{*}+\left(\boldsymbol{x}-\mathbb{E}[\boldsymbol{X}_{i}% \mid W_{i}=r]\right)^{\top}\boldsymbol{\rho}_{rt}^{*}italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + ( bold_italic_x - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | (ğ‘«Nâˆ’1)iâ¢(r,t),â‹…â¢ğœ½Nâˆ—+(ğ’™âˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r])âŠ¤â¢(ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…â¢ğœ½Nâˆ—.subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptsubscriptğœ½ğ‘superscriptğ’™ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’™â‹…superscriptsubscriptğœ½ğ‘\displaystyle(\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}\boldsymbol{\theta}_{N}^{% *}+\left(\boldsymbol{x}-\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]\right)^{% \top}(\boldsymbol{D}_{N}^{-1})_{i(r,t,\boldsymbol{x}),\cdot}\boldsymbol{\theta% }_{N}^{*}.( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + ( bold_italic_x - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT . |   
  
Define

| ğN(C;CATT):=âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢((ğ‘«Nâˆ’1)iâ¢(r,t),â‹…+(ğ’™âˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r])âŠ¤â¢(ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…)assignsuperscriptsubscriptğğ‘C;CATTsubscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptğ’™ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’™â‹…\boldsymbol{\psi}_{N}^{(\text{C;CATT})}:=\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}% \psi_{rt}\left((\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}+\left(\boldsymbol{x}-% \mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]\right)^{\top}(\boldsymbol{D}_{N}^{-% 1})_{i(r,t,\boldsymbol{x}),\cdot}\right)bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT := âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT + ( bold_italic_x - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT ) |   
---|---|---  
  
and

| ğ^N(C;CATT):=âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢((ğ‘«Nâˆ’1)iâ¢(r,t),â‹…+(ğ’™âˆ’ğ‘¿Â¯r)âŠ¤â¢(ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…),assignsuperscriptsubscriptbold-^ğğ‘C;CATTsubscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptğ’™subscriptbold-Â¯ğ‘¿ğ‘Ÿtopsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’™â‹…\boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT})}:=\sum_{r\in\mathcal{R}}\sum_{t=r% }^{T}\psi_{rt}\left((\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}+(\boldsymbol{x}-% \boldsymbol{\overline{X}}_{r})^{\top}(\boldsymbol{D}_{N}^{-1})_{i(r,t,% \boldsymbol{x}),\cdot}\right),overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT := âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT + ( bold_italic_x - overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT ) , |   
---|---|---  
  
so

| (ğ^N(C;CATT))âŠ¤â¢ğœ½^(q)âˆ’(ğN(C;CATT))âŠ¤â¢ğœ½Nâˆ—=âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï„^CATTâ¢(r,t,ğ’™)âˆ’Ï„CATTâ¢(r,t,ğ’™)).superscriptsuperscriptsubscriptbold-^ğğ‘C;CATTtopsuperscriptbold-^ğœ½ğ‘superscriptsuperscriptsubscriptğğ‘C;CATTtopsuperscriptsubscriptğœ½ğ‘subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœCATTğ‘Ÿğ‘¡ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle(\boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT})})^{\top}\boldsymbol% {\hat{\theta}}^{(q)}-(\boldsymbol{\psi}_{N}^{(\text{C;CATT})})^{\top}% \boldsymbol{\theta}_{N}^{*}=\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left% (\hat{\tau}_{\text{CATT}}(r,t,\boldsymbol{x})-\tau_{\text{CATT}}(r,t,% \boldsymbol{x})\right).( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT = âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) - italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) . |   
---|---|---  
  
Since ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT and each
ğ‘¿Â¯rsubscriptbold-Â¯ğ‘¿ğ‘Ÿ\boldsymbol{\overline{X}}_{r}overbold_Â¯ start_ARG
bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT are
estimated on two independent data sets,
ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT is independent of
ğ^N(C;CATT)superscriptsubscriptbold-^ğğ‘C;CATT\boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT})}overbold_^
start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT. So to
apply Theorem C.1(g) we need to establish the asymptotic normality of
Nâ¢Tâ¢(ğ^N(C;CATT)âˆ’ğN(C;CATT))âŠ¤â¢ğœ½Nâˆ—ğ‘ğ‘‡superscriptsuperscriptsubscriptbold-^ğğ‘C;CATTsuperscriptsubscriptğğ‘C;CATTtopsuperscriptsubscriptğœ½ğ‘\sqrt{NT}\left(\boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT})}-\boldsymbol{\psi}%
_{N}^{(\text{C;CATT})}\right)^{\top}\boldsymbol{\theta}_{N}^{*}square-root
start_ARG italic_N italic_T end_ARG ( overbold_^ start_ARG bold_italic_Ïˆ
end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT (
C;CATT ) end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT )
start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT and identify a consistent estimator for its asymptotic
variance. Applying Lemma E.3 we see that

| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢Tâ¢(ğ^N(C;CATT)âˆ’ğN(C;CATT))âŠ¤â¢ğœ½Nâˆ—ğ‘ğ‘‡superscriptsuperscriptsubscriptbold-^ğğ‘C;CATTsuperscriptsubscriptğğ‘C;CATTtopsuperscriptsubscriptğœ½ğ‘\displaystyle\sqrt{NT}\left(\boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT})}-% \boldsymbol{\psi}_{N}^{(\text{C;CATT})}\right)^{\top}\boldsymbol{\theta}_{N}^{*}square-root start_ARG italic_N italic_T end_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢Tâ¢(âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢((ğ”¼â¢[ğ‘¿iâˆ£Wi=r]âˆ’ğ‘¿Â¯r)âŠ¤â¢(ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…))â¢ğœ½Nâˆ—ğ‘ğ‘‡subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsubscriptbold-Â¯ğ‘¿ğ‘Ÿtopsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’™â‹…superscriptsubscriptğœ½ğ‘\displaystyle\sqrt{NT}\left(\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left% ((\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]-\boldsymbol{\overline{X}}_{r})^{% \top}(\boldsymbol{D}_{N}^{-1})_{i(r,t,\boldsymbol{x}),\cdot}\right)\right)% \boldsymbol{\theta}_{N}^{*}square-root start_ARG italic_N italic_T end_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( ( blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT ) ) bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢Tâ¢(âˆ‘râˆˆâ„›âˆ‘t=rTâˆ’Ïˆrâ¢tâ¢((ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…â¢ğœ½Nâˆ—)âŠ¤â¢(ğ‘¿Â¯râˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r]))ğ‘ğ‘‡subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’™â‹…superscriptsubscriptğœ½ğ‘topsubscriptbold-Â¯ğ‘¿ğ‘Ÿğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\displaystyle\sqrt{NT}\left(\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}-\psi_{rt}% \left((\boldsymbol{D}_{N}^{-1})_{i(r,t,\boldsymbol{x}),\cdot}\boldsymbol{% \theta}_{N}^{*}\right)^{\top}\left(\boldsymbol{\overline{X}}_{r}-\mathbb{E}[% \boldsymbol{X}_{i}\mid W_{i}=r]\right)\right)square-root start_ARG italic_N italic_T end_ARG ( âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT - italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ) ) |   
| â†’ğ‘‘ğ‘‘â†’\displaystyle\xrightarrow{d}\leavevmode\nobreak\ start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,vRCATT),ğ’©0superscriptsubscriptğ‘£ğ‘…CATT\displaystyle\mathcal{N}\left(0,v_{R}^{\text{CATT}}\right),caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT end_POSTSUPERSCRIPT ) , |   
  
where

| vRCATT:=assignsuperscriptsubscriptğ‘£ğ‘…CATTabsent\displaystyle v_{R}^{\text{CATT}}:=\leavevmode\nobreak\ italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT end_POSTSUPERSCRIPT := | Tâ¢âˆ‘râˆˆâ„›(ğrCATT)âŠ¤â¢Covâ¢(ğ‘¿iâˆ£Wi=r)â¢ğrCATTâ„™â¢(Wi=r)ğ‘‡subscriptğ‘Ÿâ„›superscriptsuperscriptsubscriptğğ‘ŸCATTtopCovconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğğ‘ŸCATTâ„™subscriptğ‘Šğ‘–ğ‘Ÿ\displaystyle T\sum_{r\in\mathcal{R}}\frac{(\boldsymbol{\psi}_{r}^{\text{CATT}% })^{\top}\mathrm{Cov}(\boldsymbol{X}_{i}\mid W_{i}=r)\boldsymbol{\psi}_{r}^{% \text{CATT}}}{\mathbb{P}(W_{i}=r)}italic_T âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT divide start_ARG ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT end_POSTSUPERSCRIPT end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) end_ARG |   
---|---|---|---  
  
for

| ğrCATT:=assignsuperscriptsubscriptğğ‘ŸCATTabsent\displaystyle\boldsymbol{\psi}_{r}^{\text{CATT}}:=\leavevmode\nobreak\ bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT end_POSTSUPERSCRIPT := | âˆ‘t=rTÏˆrâ¢tâ¢((ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…â¢ğœ½Nâˆ—)âŠ¤=âˆ‘t=rTÏˆrâ¢tâ¢ğ†râ¢tâˆ—,râˆˆâ„›.formulae-sequencesuperscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’™â‹…superscriptsubscriptğœ½ğ‘topsuperscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptğ†ğ‘Ÿğ‘¡ğ‘Ÿâ„›\displaystyle\sum_{t=r}^{T}\psi_{rt}\left((\boldsymbol{D}_{N}^{-1})_{i(r,t,% \boldsymbol{x}),\cdot}\boldsymbol{\theta}_{N}^{*}\right)^{\top}=\sum_{t=r}^{T}% \psi_{rt}\boldsymbol{\rho}_{rt}^{*},\qquad r\in\mathcal{R}.âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT = âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , italic_r âˆˆ caligraphic_R . |   
---|---|---|---  
  
Notice that each
vRCATTsuperscriptsubscriptğ‘£ğ‘…CATTv_{R}^{\text{CATT}}italic_v
start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT
end_POSTSUPERSCRIPT is strictly positive and finite because each
Covâ¢(ğ‘¿iâˆ£Wi=r)Covconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\mathrm{Cov}(\boldsymbol{X}_{i}\mid
W_{i}=r)roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
= italic_r ) is assumed to be finite and have a strictly positive minimum
eigenvalue under Assumption (R6) and each
â„™â¢(Wi=r)â„™subscriptğ‘Šğ‘–ğ‘Ÿ\mathbb{P}(W_{i}=r)blackboard_P ( italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) is strictly
positive under Assumption (F2). Also, by the consistency of
ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT and each Nr/Nsubscriptğ‘ğ‘Ÿğ‘N_{r}/Nitalic_N
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT / italic_N and
Cov^â¢(ğ‘¿iâˆ£Wi=r)^Covconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\widehat{\mathrm{Cov}}(\boldsymbol{X}_{i}\mid
W_{i}=r)over^ start_ARG roman_Cov end_ARG ( bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT = italic_r ), along with the continuous mapping theorem, we
have that

| Tâ¢âˆ‘râˆˆâ„›(ğ^rCATT)âŠ¤â¢Cov^â¢(ğ‘¿iâˆ£Wi=r)â¢ğ^rCATTNr/Nâ†’ğ‘vRCATTğ‘â†’ğ‘‡subscriptğ‘Ÿâ„›superscriptsuperscriptsubscriptbold-^ğğ‘ŸCATTtop^Covconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptbold-^ğğ‘ŸCATTsubscriptğ‘ğ‘Ÿğ‘superscriptsubscriptğ‘£ğ‘…CATTT\sum_{r\in\mathcal{R}}\frac{(\boldsymbol{\hat{\psi}}_{r}^{\text{CATT}})^{\top% }\widehat{\mathrm{Cov}}(\boldsymbol{X}_{i}\mid W_{i}=r)\boldsymbol{\hat{\psi}}% _{r}^{\text{CATT}}}{N_{r}/N}\xrightarrow{p}v_{R}^{\text{CATT}}italic_T âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT divide start_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG roman_Cov end_ARG ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT end_POSTSUPERSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT / italic_N end_ARG start_ARROW overitalic_p â†’ end_ARROW italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT end_POSTSUPERSCRIPT |   
---|---|---  
  
where

| ğ^rCATT:=âˆ‘t=rTÏˆrâ¢tâ¢ğ†^râ¢t(q),râˆˆâ„›.formulae-sequenceassignsuperscriptsubscriptbold-^ğğ‘ŸCATTsuperscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptbold-^ğ†ğ‘Ÿğ‘¡ğ‘ğ‘Ÿâ„›\boldsymbol{\hat{\psi}}_{r}^{\text{CATT}}:=\sum_{t=r}^{T}\psi_{rt}\boldsymbol{% \hat{\rho}}_{rt}^{(q)},\qquad r\in\mathcal{R}.overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT end_POSTSUPERSCRIPT := âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT overbold_^ start_ARG bold_italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT , italic_r âˆˆ caligraphic_R . |   
---|---|---  
  
Then from Theorem C.1(g) we have

| Nâ¢Tv^N(C;CATT)â¢((ğ^N(C;CATT))âŠ¤â¢ğœ½^(q)âˆ’(ğN(C;CATT))âŠ¤â¢ğœ½Nâˆ—)â†’ğ‘‘ğ’©â¢(0,1)ğ‘‘â†’ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘C;CATTsuperscriptsuperscriptsubscriptbold-^ğğ‘C;CATTtopsuperscriptbold-^ğœ½ğ‘superscriptsuperscriptsubscriptğğ‘C;CATTtopsuperscriptsubscriptğœ½ğ‘ğ’©01\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{C;CATT})}}}\left((\boldsymbol% {\hat{\psi}}_{N}^{(\text{C;CATT})})^{\top}\boldsymbol{\hat{\theta}}^{(q)}-(% \boldsymbol{\psi}_{N}^{(\text{C;CATT})})^{\top}\boldsymbol{\theta}_{N}^{*}% \right)\xrightarrow{d}\mathcal{N}(0,1)square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT end_ARG end_ARG ( ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , 1 ) |   
---|---|---  
| â‡”Nâ¢Tv^N(C;CATT)â¢âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢(Ï„^CATTâ¢(r,t,ğ’™)âˆ’Ï„CATTâ¢(r,t,ğ’™))â†’ğ‘‘ğ’©â¢(0,1)ğ‘‘â†’iffğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘C;CATTsubscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscript^ğœCATTğ‘Ÿğ‘¡ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™ğ’©01\displaystyle\iff\qquad\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{C;CATT})}}}\sum_{r% \in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\left(\hat{\tau}_{\text{CATT}}(r,t,% \boldsymbol{x})-\tau_{\text{CATT}}(r,t,\boldsymbol{x})\right)\xrightarrow{d}% \mathcal{N}(0,1)â‡” square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) - italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , 1 ) |   
  
for

| v^N(C;CATT):=assignsuperscriptsubscript^ğ‘£ğ‘C;CATTabsent\displaystyle\hat{v}_{N}^{(\text{C;CATT})}:=\leavevmode\nobreak\ over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT := | Ïƒ2â¢(ğ^N(C;CATT))âŠ¤â¢(Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®^))âˆ’1â¢ğ^N(C;CATT)superscriptğœ2superscriptsuperscriptsubscriptbold-^ğğ‘C;CATTtopsuperscript^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…^ğ’®1superscriptsubscriptbold-^ğğ‘C;CATT\displaystyle\sigma^{2}(\boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT})})^{\top}% \left(\widehat{\mathrm{Cov}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(% \cdot\cdot)\hat{\mathcal{S}}}\right)\right)^{-1}\boldsymbol{\hat{\psi}}_{N}^{(% \text{C;CATT})}italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT ) end_POSTSUPERSCRIPT |   
---|---|---|---  
|  | +Tâ¢âˆ‘râˆˆâ„›(ğ^rCATT)âŠ¤â¢Cov^â¢(ğ‘¿iâˆ£Wi=r)â¢ğ^rCATTNr/N.ğ‘‡subscriptğ‘Ÿâ„›superscriptsuperscriptsubscriptbold-^ğğ‘ŸCATTtop^Covconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptbold-^ğğ‘ŸCATTsubscriptğ‘ğ‘Ÿğ‘\displaystyle+T\sum_{r\in\mathcal{R}}\frac{(\boldsymbol{\hat{\psi}}_{r}^{\text% {CATT}})^{\top}\widehat{\mathrm{Cov}}(\boldsymbol{X}_{i}\mid W_{i}=r)% \boldsymbol{\hat{\psi}}_{r}^{\text{CATT}}}{N_{r}/N}.\+ italic_T âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT divide start_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG roman_Cov end_ARG ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT end_POSTSUPERSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT / italic_N end_ARG . |  | (E.13)  
  
  2. (b)

Observe that

|  | âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))â¢Ï„CATTâ¢(r,t,ğ’™)subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™subscriptğœCATTğ‘Ÿğ‘¡ğ’™\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}f_{r}\left(\pi_{r_{1% }}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x}),\ldots,\pi_{r_{R}}(\boldsymbol{% x})\right)\tau_{\text{CATT}}(r,t,\boldsymbol{x})âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tfr(Ï€r1(ğ’™),Ï€r2(ğ’™),â€¦,Ï€rR(ğ’™))((ğ‘«Nâˆ’1)iâ¢(r,t),â‹…âŠ¤\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}f_{r}\left(\pi_{r_{1% }}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x}),\ldots,\pi_{r_{R}}(\boldsymbol{% x})\right)\Big{(}(\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}^{\top}âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) ( ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT |   
|  | +(ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…âŠ¤(ğ’™âˆ’ğ”¼[ğ‘¿iâˆ£Wi=r]))ğœ½Nâˆ—\displaystyle+(\boldsymbol{D}_{N}^{-1})_{i(r,t,\boldsymbol{x}),\cdot}^{\top}% \left(\boldsymbol{x}-\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]\right)\Big{)}% \boldsymbol{\theta}_{N}^{*}\+ ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_x - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ) ) bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
| =\displaystyle=\leavevmode\nobreak\ = | âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))â¢(ğrâ¢tâˆ—)âŠ¤â¢ğœ½Nâˆ—subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsuperscriptsubscriptğğ‘Ÿğ‘¡topsuperscriptsubscriptğœ½ğ‘\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}f_{r}\left(\pi_{r_{1% }}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x}),\ldots,\pi_{r_{R}}(\boldsymbol{% x})\right)(\boldsymbol{\psi}_{rt}^{*})^{\top}\boldsymbol{\theta}_{N}^{*}âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
| =\displaystyle=\leavevmode\nobreak\ = | (ğN(C;CATT,â¢Ï€))âŠ¤â¢ğœ½Nâˆ—superscriptsuperscriptsubscriptğğ‘C;CATT,ğœ‹topsuperscriptsubscriptğœ½ğ‘\displaystyle(\boldsymbol{\psi}_{N}^{(\text{C;CATT,}\pi)})^{\top}\boldsymbol{% \theta}_{N}^{*}( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
  
where

| ğrâ¢tâˆ—:=(ğ‘«Nâˆ’1)iâ¢(r,t),â‹…+(ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…âŠ¤â¢(ğ’™âˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r])âˆˆâ„passignsuperscriptsubscriptğğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’™â‹…topğ’™ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptâ„ğ‘\boldsymbol{\psi}_{rt}^{*}:=(\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}+(% \boldsymbol{D}_{N}^{-1})_{i(r,t,\boldsymbol{x}),\cdot}^{\top}\left(\boldsymbol% {x}-\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]\right)\in\mathbb{R}^{p}bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT := ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT + ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_x - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ) âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT |  | (E.14)  
---|---|---|---  
  
and

| ğN(C;CATT,â¢Ï€):=âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))â¢ğrâ¢tâˆ—âˆˆâ„p.assignsuperscriptsubscriptğğ‘C;CATT,ğœ‹subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsubscriptğğ‘Ÿğ‘¡superscriptâ„ğ‘\boldsymbol{\psi}_{N}^{(\text{C;CATT,}\pi)}:=\sum_{r\in\mathcal{R}}\sum_{t=r}^% {T}\psi_{rt}f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x})% ,\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\boldsymbol{\psi}_{rt}^{*}\in\mathbb% {R}^{p}.bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT := âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT . |   
---|---|---  
  
Define the estimators

| ğ^râ¢tâˆ—:=(ğ‘«Nâˆ’1)iâ¢(r,t),â‹…+(ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…âŠ¤â¢(ğ’™âˆ’ğ‘¿Â¯r)assignsuperscriptsubscriptbold-^ğğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡â‹…superscriptsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’™â‹…topğ’™subscriptbold-Â¯ğ‘¿ğ‘Ÿ\boldsymbol{\hat{\psi}}_{rt}^{*}:=(\boldsymbol{D}_{N}^{-1})_{i(r,t),\cdot}+(% \boldsymbol{D}_{N}^{-1})_{i(r,t,\boldsymbol{x}),\cdot}^{\top}\left(\boldsymbol% {x}-\boldsymbol{\overline{X}}_{r}\right)overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT := ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t ) , â‹… end_POSTSUBSCRIPT + ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_x - overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) |  | (E.15)  
---|---|---|---  
  
and

| ğ^N(C;CATT,â¢Ï€):=âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢tâ¢frâ¢(Ï€^r1â¢(ğ’™),Ï€^r2â¢(ğ’™),â€¦,Ï€^rRâ¢(ğ’™))â¢ğ^râ¢tâˆ—assignsuperscriptsubscriptbold-^ğğ‘C;CATT,ğœ‹subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1ğ’™subscript^ğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsubscriptbold-^ğğ‘Ÿğ‘¡\boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT,}\pi)}:=\sum_{r\in\mathcal{R}}\sum_% {t=r}^{T}\psi_{rt}f_{r}\left(\hat{\pi}_{r_{1}}(\boldsymbol{x}),\hat{\pi}_{r_{2% }}(\boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(\boldsymbol{x})\right)\boldsymbol{% \hat{\psi}}_{rt}^{*}overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT := âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
---|---|---  
  
and notice that

|  | (ğ^N(C;CATT,â¢Ï€))âŠ¤â¢ğœ½^(q)âˆ’(ğN(C;CATT,â¢Ï€))âŠ¤â¢ğœ½Nâˆ—superscriptsuperscriptsubscriptbold-^ğğ‘C;CATT,ğœ‹topsuperscriptbold-^ğœ½ğ‘superscriptsuperscriptsubscriptğğ‘C;CATT,ğœ‹topsuperscriptsubscriptğœ½ğ‘\displaystyle(\boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT,}\pi)})^{\top}% \boldsymbol{\hat{\theta}}^{(q)}-(\boldsymbol{\psi}_{N}^{(\text{C;CATT,}\pi)})^% {\top}\boldsymbol{\theta}_{N}^{*}( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢t(fr(Ï€^r1(ğ’™),Ï€^r2(ğ’™),â€¦,Ï€^rR(ğ’™))Ï„^CATT(r,t,ğ’™)\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\big{(}f_{r}\left(% \hat{\pi}_{r_{1}}(\boldsymbol{x}),\hat{\pi}_{r_{2}}(\boldsymbol{x}),\ldots,% \hat{\pi}_{r_{R}}(\boldsymbol{x})\right)\hat{\tau}_{\text{CATT}}(r,t,% \boldsymbol{x})âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) |   
|  | âˆ’fr(Ï€r1(ğ’™),Ï€r2(ğ’™),â€¦,Ï€rR(ğ’™))Ï„CATT(r,t,ğ’™)).\displaystyle-f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x% }),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\tau_{\text{CATT}}(r,t,\boldsymbol% {x})\big{)}.\- italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) . |   
  
Since by assumption each
Ï€^râ¢(ğ’™)subscript^ğœ‹ğ‘Ÿğ’™\hat{\pi}_{r}(\boldsymbol{x})over^ start_ARG
italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT (
bold_italic_x ) and
ğ‘¿Â¯rsubscriptbold-Â¯ğ‘¿ğ‘Ÿ\boldsymbol{\overline{X}}_{r}overbold_Â¯ start_ARG
bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT is
independent of
ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT,
ğ^N(C;CATT,â¢Ï€)superscriptsubscriptbold-^ğğ‘C;CATT,ğœ‹\boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT,}\pi)}overbold_^
start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ )
end_POSTSUPERSCRIPT is independent of
ğœ½^(q)superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\theta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT, and the result follows from applying Theorem C.1(g) if we
can show that

| Nâ¢Tâ¢(ğœ½Nâˆ—)âŠ¤â¢(ğ^N(C;CATT,â¢Ï€)âˆ’ğN(C;CATT,â¢Ï€))ğ‘ğ‘‡superscriptsuperscriptsubscriptğœ½ğ‘topsuperscriptsubscriptbold-^ğğ‘C;CATT,ğœ‹superscriptsubscriptğğ‘C;CATT,ğœ‹\sqrt{NT}(\boldsymbol{\theta}_{N}^{*})^{\top}\left(\boldsymbol{\hat{\psi}}_{N}% ^{(\text{C;CATT,}\pi)}-\boldsymbol{\psi}_{N}^{(\text{C;CATT,}\pi)}\right)square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) |   
---|---|---  
  
is asymptotically normal and identify a consistent estimator for the
asymptotic variance. Showing this is conceptually straightforwardâ€”we can
decompose
Nâ¢Tâ¢(ğœ½Nâˆ—)âŠ¤â¢(ğ^N(C;CATT,â¢Ï€)âˆ’ğN(C;CATT,â¢Ï€))ğ‘ğ‘‡superscriptsuperscriptsubscriptğœ½ğ‘topsuperscriptsubscriptbold-^ğğ‘C;CATT,ğœ‹superscriptsubscriptğğ‘C;CATT,ğœ‹\sqrt{NT}(\boldsymbol{\theta}_{N}^{*})^{\top}\left(\boldsymbol{\hat{\psi}}_{N}%
^{(\text{C;CATT,}\pi)}-\boldsymbol{\psi}_{N}^{(\text{C;CATT,}\pi)}\right)square-
root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT )
start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG
bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT -
bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) into a term
that converges in probability to 0, a term that has an asymptotic distribution
depending on
Nâ¢(ğ‘¿Â¯râˆ’ğr)ğ‘subscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿ\sqrt{N}\left(\boldsymbol{\overline{X}}_{r}-\boldsymbol{\mu}_{r}\right)square-
root start_ARG italic_N end_ARG ( overbold_Â¯ start_ARG bold_italic_X end_ARG
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) (asymptotically normal due to
Lemma E.3), and a term that depends on the
Ï€^râ¢(ğ’™)subscript^ğœ‹ğ‘Ÿğ’™\hat{\pi}_{r}(\boldsymbol{x})over^ start_ARG
italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT (
bold_italic_x ) predictions (asymptotically normal by assumption and
application of the delta method). Then the sum converges to a normal
distribution because of the independence of each
Ï€^râ¢(ğ’™)subscript^ğœ‹ğ‘Ÿğ’™\hat{\pi}_{r}(\boldsymbol{x})over^ start_ARG
italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT (
bold_italic_x ) and
ğ‘¿Â¯rsubscriptbold-Â¯ğ‘¿ğ‘Ÿ\boldsymbol{\overline{X}}_{r}overbold_Â¯ start_ARG
bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT and
Slutskyâ€™s theorem.

However, the calculations are sufficiently tedious that we defer the work to
the proof of Lemma E.5.

######  Lemma E.5.

Under the assumptions of Theorem D.3(b),

| Nâ¢Tâ¢(ğœ½Nâˆ—)âŠ¤â¢(ğ^N(C;CATT,â¢Ï€)âˆ’ğN(C;CATT,â¢Ï€))â†’ğ‘‘ğ’©â¢(0,vR(C;CATT,â¢Ï€))ğ‘‘â†’ğ‘ğ‘‡superscriptsuperscriptsubscriptğœ½ğ‘topsuperscriptsubscriptbold-^ğğ‘C;CATT,ğœ‹superscriptsubscriptğğ‘C;CATT,ğœ‹ğ’©0superscriptsubscriptğ‘£ğ‘…C;CATT,ğœ‹\sqrt{NT}(\boldsymbol{\theta}_{N}^{*})^{\top}\left(\boldsymbol{\hat{\psi}}_{N}% ^{(\text{C;CATT,}\pi)}-\boldsymbol{\psi}_{N}^{(\text{C;CATT,}\pi)}\right)% \xrightarrow{d}\mathcal{N}\left(0,v_{R}^{(\text{C;CATT,}\pi)}\right)square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) |   
---|---|---  
  
for

| vR(C;CATT,â¢Ï€):=âˆ‘râˆˆâ„›(ğrCATT; prob)âŠ¤â¢Covâ¢(ğ‘¿iâˆ£Wi=r)â¢ğrCATT; probâ„™â¢(Wi=r)+Tâ‹…ğÏ€âŠ¤â¢âˆ‡ğ’‡âŠ¤â¢ğšºÏ€â¢âˆ‡ğ’‡â¢ğÏ€,assignsuperscriptsubscriptğ‘£ğ‘…C;CATT,ğœ‹subscriptğ‘Ÿâ„›superscriptsuperscriptsubscriptğğ‘ŸCATT; probtopCovconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğğ‘ŸCATT; probâ„™subscriptğ‘Šğ‘–ğ‘Ÿâ‹…ğ‘‡superscriptsubscriptğğœ‹topâˆ‡superscriptğ’‡topsubscriptğšºğœ‹âˆ‡ğ’‡subscriptğğœ‹v_{R}^{(\text{C;CATT,}\pi)}:=\sum_{r\in\mathcal{R}}\frac{(\boldsymbol{\psi}_{r% }^{\text{CATT; prob}})^{\top}\mathrm{Cov}(\boldsymbol{X}_{i}\mid W_{i}=r)% \boldsymbol{\psi}_{r}^{\text{CATT; prob}}}{\mathbb{P}(W_{i}=r)}+T\cdot% \boldsymbol{\psi}_{\pi}^{\top}\nabla\boldsymbol{f}^{\top}\boldsymbol{\Sigma}_{% \pi}\nabla\boldsymbol{f}\boldsymbol{\psi}_{\pi},italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT := âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT divide start_ARG ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) end_ARG + italic_T â‹… bold_italic_Ïˆ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‡ bold_italic_f start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_Î£ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT âˆ‡ bold_italic_f bold_italic_Ïˆ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT , |   
---|---|---  
  
ğrCATT; probsuperscriptsubscriptğğ‘ŸCATT;
prob\boldsymbol{\psi}_{r}^{\text{CATT; prob}}bold_italic_Ïˆ
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT;
prob end_POSTSUPERSCRIPT is defined in (G.9), and
ğšºÏ€subscriptğšºğœ‹\boldsymbol{\Sigma}_{\pi}bold_Î£ start_POSTSUBSCRIPT
italic_Ï€ end_POSTSUBSCRIPT was defined in the statement of Theorem D.3.
Further,
v^R(C;CATT,â¢Ï€)superscriptsubscript^ğ‘£ğ‘…C;CATT,ğœ‹\hat{v}_{R}^{(\text{C;CATT,}\pi)}over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT, defined in
(G.10), is a consistent estimator for
vR(C;CATT,â¢Ï€)superscriptsubscriptğ‘£ğ‘…C;CATT,ğœ‹v_{R}^{(\text{C;CATT,}\pi)}italic_v
start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT,
italic_Ï€ ) end_POSTSUPERSCRIPT.

###### Proof.

Provided in Appendix G.2. âˆ

Then from Lemma E.5 and Theorem C.1(g) we have

|  | Nâ¢Tv^N(C;CATT,â¢Ï€)â¢((ğ^N(C;CATT,â¢Ï€))âŠ¤â¢ğœ½^(q)âˆ’(ğN(C;CATT,â¢Ï€))âŠ¤â¢ğœ½Nâˆ—)â†’ğ‘‘ğ’©â¢(0,1)ğ‘‘â†’ğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘C;CATT,ğœ‹superscriptsuperscriptsubscriptbold-^ğğ‘C;CATT,ğœ‹topsuperscriptbold-^ğœ½ğ‘superscriptsuperscriptsubscriptğğ‘C;CATT,ğœ‹topsuperscriptsubscriptğœ½ğ‘ğ’©01\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{C;CATT,}\pi)}}}\left((% \boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT,}\pi)})^{\top}\boldsymbol{\hat{% \theta}}^{(q)}-(\boldsymbol{\psi}_{N}^{(\text{C;CATT,}\pi)})^{\top}\boldsymbol% {\theta}_{N}^{*}\right)\xrightarrow{d}\mathcal{N}(0,1)square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT end_ARG end_ARG ( ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , 1 ) |   
---|---|---|---  
| â‡”iff\displaystyle\iff\qquadâ‡” | Nâ¢Tv^N(C;CATT,â¢Ï€)âˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢t(fr(Ï€^r1(ğ’™),Ï€^r2(ğ’™),â€¦,Ï€^rR(ğ’™))Ï„^CATT(r,t,ğ’™)\displaystyle\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{C;CATT,}\pi)}}}\sum_{r\in% \mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\big{(}f_{r}\left(\hat{\pi}_{r_{1}}(% \boldsymbol{x}),\hat{\pi}_{r_{2}}(\boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(% \boldsymbol{x})\right)\hat{\tau}_{\text{CATT}}(r,t,\boldsymbol{x})square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) over^ start_ARG italic_Ï„ end_ARG start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) |   
|  | âˆ’fr(Ï€r1(ğ’™),Ï€r2(ğ’™),â€¦,Ï€rR(ğ’™))Ï„CATT(r,t,ğ’™))â†’ğ‘‘ğ’©(0,1).\displaystyle-f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x% }),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\tau_{\text{CATT}}(r,t,\boldsymbol% {x})\big{)}\xrightarrow{d}\mathcal{N}(0,1).\- italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) italic_Ï„ start_POSTSUBSCRIPT CATT end_POSTSUBSCRIPT ( italic_r , italic_t , bold_italic_x ) ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , 1 ) . |   
  
for

| v^N(C;CATT,â¢Ï€):=assignsuperscriptsubscript^ğ‘£ğ‘C;CATT,ğœ‹absent\displaystyle\hat{v}_{N}^{(\text{C;CATT,}\pi)}:=\leavevmode\nobreak\ over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT := | Ïƒ2â¢(ğ^N(C;CATT,â¢Ï€))âŠ¤â¢(Cov^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®^))âˆ’1â¢ğ^N(C;CATT,â¢Ï€)superscriptğœ2superscriptsuperscriptsubscriptbold-^ğğ‘C;CATT,ğœ‹topsuperscript^Covsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…^ğ’®1superscriptsubscriptbold-^ğğ‘C;CATT,ğœ‹\displaystyle\sigma^{2}(\boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT,}\pi)})^{% \top}\left(\widehat{\mathrm{Cov}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})% _{(\cdot\cdot)\hat{\mathcal{S}}}\right)\right)^{-1}\boldsymbol{\hat{\psi}}_{N}% ^{(\text{C;CATT,}\pi)}italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG roman_Cov end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) over^ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT |   
---|---|---|---  
|  | +v^R(C;CATT,â¢Ï€).superscriptsubscript^ğ‘£ğ‘…C;CATT,ğœ‹\displaystyle+\hat{v}_{R}^{(\text{C;CATT,}\pi)}.\+ over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT . |  | (E.16)  
  

##  Appendix F Proof of Theorem C.1

Before we prove the individual statements, we outline our general approach.
Notice that the assumptions leading to equation (6.33) in Wooldridge [2021,
Section 6.3] are satisfied, so we have for any
iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ]

| ğ”¼â¢[ğ’š~(iâ‹…)âˆ£Wi,ğ‘¿i]=ğ’~(iâ‹…)â‹…â¢ğœ·Nâˆ—,\mathbb{E}\left[\boldsymbol{\tilde{y}}_{(i\cdot)}\mid W_{i},\boldsymbol{X}_{i}% \right]=\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{\beta}_{N}^{*},blackboard_E [ overbold_~ start_ARG bold_italic_y end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , |  | (F.1)  
---|---|---|---  
  
where the subscript (iâ‹…)(i\cdot)( italic_i â‹… ) refers to the Tğ‘‡Titalic_T
observations corresponding to unit iğ‘–iitalic_i. (This verifies part (a) of
Theorem C.1, though we also provide a proof in our notation below.) We propose
estimating the bridge regression (5.4),

| ğœ·^(q)=argâ¡minğœ·âˆˆâ„pNâ¢{âˆ¥ğ’šâˆ’ğ’â¢ğœ·âˆ¥22+Î»Nâ¢âˆ¥ğ‘«Nâ¢ğœ·âˆ¥qq}.superscriptbold-^ğœ·ğ‘ğœ·superscriptâ„subscriptğ‘ğ‘superscriptsubscriptdelimited-âˆ¥âˆ¥ğ’šğ’ğœ·22subscriptğœ†ğ‘superscriptsubscriptdelimited-âˆ¥âˆ¥subscriptğ‘«ğ‘ğœ·ğ‘ğ‘\boldsymbol{\hat{\beta}}^{(q)}=\underset{\boldsymbol{\beta}\in\mathbb{R}^{p_{N% }}}{\arg\min}\left\\{\lVert\boldsymbol{y}-\boldsymbol{Z}\boldsymbol{\beta}% \rVert_{2}^{2}+\lambda_{N}\lVert\boldsymbol{D}_{N}\boldsymbol{\beta}\rVert_{q}% ^{q}\right\\}.overbold_^ start_ARG bold_italic_Î² end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT = start_UNDERACCENT bold_italic_Î² âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_UNDERACCENT start_ARG roman_arg roman_min end_ARG { âˆ¥ bold_italic_y - bold_italic_Z bold_italic_Î² âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT bold_italic_Î² âˆ¥ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT } . |   
---|---|---  
  
We proved in Lemma E.1 that the differences matrix
ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT is invertible. We can therefore solve (5.4) through the
reparameterization
ğœ½^(q)=ğ‘«Nâ¢ğœ·^(q)superscriptbold-^ğœ½ğ‘subscriptğ‘«ğ‘superscriptbold-^ğœ·ğ‘\boldsymbol{\hat{\theta}}^{(q)}=\boldsymbol{D}_{N}\boldsymbol{\hat{\beta}}^{(q)}overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT = bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT overbold_^ start_ARG bold_italic_Î² end_ARG
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT, solving for

| ğœ½^(q)=argâ¡minğœ½âˆˆâ„pNâ¢{âˆ¥ğ’šâˆ’ğ’â¢ğ‘«Nâˆ’1â¢ğœ½âˆ¥22+Î»Nâ¢âˆ¥ğœ½âˆ¥qq}superscriptbold-^ğœ½ğ‘ğœ½superscriptâ„subscriptğ‘ğ‘superscriptsubscriptdelimited-âˆ¥âˆ¥ğ’šğ’superscriptsubscriptğ‘«ğ‘1ğœ½22subscriptğœ†ğ‘superscriptsubscriptdelimited-âˆ¥âˆ¥ğœ½ğ‘ğ‘\boldsymbol{\hat{\theta}}^{(q)}=\underset{\boldsymbol{\theta}\in\mathbb{R}^{p_% {N}}}{\arg\min}\left\\{\lVert\boldsymbol{y}-\boldsymbol{Z}\boldsymbol{D}_{N}^{-% 1}\boldsymbol{\theta}\rVert_{2}^{2}+\lambda_{N}\lVert\boldsymbol{\theta}\rVert% _{q}^{q}\right\\}overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT = start_UNDERACCENT bold_italic_Î¸ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_UNDERACCENT start_ARG roman_arg roman_min end_ARG { âˆ¥ bold_italic_y - bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î¸ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ bold_italic_Î¸ âˆ¥ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT } |   
---|---|---  
  
using standard bridge regression. Then
ğœ·^(q)=ğ‘«Nâˆ’1â¢ğœ½^(q)superscriptbold-^ğœ·ğ‘superscriptsubscriptğ‘«ğ‘1superscriptbold-^ğœ½ğ‘\boldsymbol{\hat{\beta}}^{(q)}=\boldsymbol{D}_{N}^{-1}\boldsymbol{\hat{\theta}%
}^{(q)}overbold_^ start_ARG bold_italic_Î² end_ARG start_POSTSUPERSCRIPT (
italic_q ) end_POSTSUPERSCRIPT = bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^
start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT is identical to the solution to (5.4) [Tibshirani and
Taylor, 2011, Section 3].

Having cast (5.4) as a standard bridge regression optimization problem, our
results will follow from Theorem 1, Lemma 3, and Theorem 2(ii) from Kock
[2013] if we show the assumptions are met in our setting where

| ğ’€~iâ¢N=subscriptbold-~ğ’€ğ‘–ğ‘absent\displaystyle\boldsymbol{\tilde{Y}}_{iN}=\leavevmode\nobreak\ overbold_~ start_ARG bold_italic_Y end_ARG start_POSTSUBSCRIPT italic_i italic_N end_POSTSUBSCRIPT = | ğ’š~(iâ‹…),\displaystyle\boldsymbol{\tilde{y}}_{(i\cdot)},overbold_~ start_ARG bold_italic_y end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT , |   
---|---|---|---  
| ğ‘¿~iâ¢N=subscriptbold-~ğ‘¿ğ‘–ğ‘absent\displaystyle\boldsymbol{\tilde{X}}_{iN}=\leavevmode\nobreak\ overbold_~ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_i italic_N end_POSTSUBSCRIPT = | ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1,\displaystyle\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1},overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , |   
| Î²0=subscriptğ›½0absent\displaystyle\beta_{0}=\leavevmode\nobreak\ italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = | ğœ½Nâˆ—,superscriptsubscriptğœ½ğ‘\displaystyle\boldsymbol{\theta}_{N}^{*},bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , |   
| ğ’„iâ¢N=subscriptğ’„ğ‘–ğ‘absent\displaystyle\boldsymbol{c}_{iN}=\leavevmode\nobreak\ bold_italic_c start_POSTSUBSCRIPT italic_i italic_N end_POSTSUBSCRIPT = | ciâ¢ğŸT,subscriptğ‘ğ‘–subscript1ğ‘‡\displaystyle c_{i}\boldsymbol{1}_{T},italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_1 start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , |   
| Ïµ~iâ¢N=subscriptbold-~bold-italic-Ïµğ‘–ğ‘absent\displaystyle\boldsymbol{\tilde{\epsilon}}_{iN}=\leavevmode\nobreak\ overbold_~ start_ARG bold_italic_Ïµ end_ARG start_POSTSUBSCRIPT italic_i italic_N end_POSTSUBSCRIPT = | ğ’–(iâ‹…),\displaystyle\boldsymbol{u}_{(i\cdot)},bold_italic_u start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT , |   
| ğ’€iâ¢N=subscriptğ’€ğ‘–ğ‘absent\displaystyle\boldsymbol{Y}_{iN}=\leavevmode\nobreak\ bold_italic_Y start_POSTSUBSCRIPT italic_i italic_N end_POSTSUBSCRIPT = | ğ’š(iâ‹…),\displaystyle\boldsymbol{y}_{(i\cdot)},bold_italic_y start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT , |   
| ğ‘¿iâ¢N=subscriptğ‘¿ğ‘–ğ‘absent\displaystyle\boldsymbol{X}_{iN}=\leavevmode\nobreak\ bold_italic_X start_POSTSUBSCRIPT italic_i italic_N end_POSTSUBSCRIPT = | ğ’(iâ‹…)â‹…â¢ğ‘«Nâˆ’1,\displaystyle\boldsymbol{Z}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1},bold_italic_Z start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , |   
| ğ‘¿N=subscriptğ‘¿ğ‘absent\displaystyle\boldsymbol{X}_{N}=\leavevmode\nobreak\ bold_italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = | ğ’â¢ğ‘«Nâˆ’1,ğ’superscriptsubscriptğ‘«ğ‘1\displaystyle\boldsymbol{Z}\boldsymbol{D}_{N}^{-1},bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , |   
| ğ‘¾N=subscriptğ‘¾ğ‘absent\displaystyle\boldsymbol{W}_{N}=\leavevmode\nobreak\ bold_italic_W start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = | (ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®,subscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…ğ’®\displaystyle(\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot\cdot)\mathcal{S}},( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT , |   
| ğšº1â¢N=subscriptğšº1ğ‘absent\displaystyle\boldsymbol{\Sigma}_{1N}=\leavevmode\nobreak\ bold_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT = | ğšº^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®),bold-^ğšºsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…ğ’®\displaystyle\boldsymbol{\hat{\Sigma}}((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})% _{(\cdot\cdot)\mathcal{S}}),overbold_^ start_ARG bold_Î£ end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT ) , |   
| Ïµiâ¢N=subscriptbold-italic-Ïµğ‘–ğ‘absent\displaystyle\boldsymbol{\epsilon}_{iN}=\leavevmode\nobreak\ bold_italic_Ïµ start_POSTSUBSCRIPT italic_i italic_N end_POSTSUBSCRIPT = | Ïƒâ¢ğ›€âˆ’1/2â¢Ïµ(iâ‹…),\displaystyle\sigma\boldsymbol{\Omega}^{-1/2}\boldsymbol{\epsilon}_{(i\cdot)},italic_Ïƒ bold_Î© start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT bold_italic_Ïµ start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT , |   
| Î³=ğ›¾absent\displaystyle\gamma=\leavevmode\nobreak\ italic_Î³ = | q,andğ‘and\displaystyle q,\qquad\text{and}italic_q , and |   
| kN=subscriptğ‘˜ğ‘absent\displaystyle k_{N}=\leavevmode\nobreak\ italic_k start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = | sN,subscriptğ‘ ğ‘\displaystyle s_{N},italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , |   
  
where the left side of each equation uses the notation from Kock [2013] and
the right side uses the notation in our setting. We focus on the random
effects setting of Kock [2013] because we cannot perform the forward
orthogonal deviations transform since
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG
(and
ğ’~â¢ğ‘«Nâˆ’1bold-~ğ’superscriptsubscriptğ‘«ğ‘1\boldsymbol{\tilde{Z}}\boldsymbol{D}_{N}^{-1}overbold_~
start_ARG bold_italic_Z end_ARG bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT) contain
(linear combinations of) time-invariant covariates and cohort indicators.

Now we are prepared to prove each statement.

  1. (a)

As mentioned earlier, under our assumptions correct specification is immediate
from Equation (6.33) in Wooldridge [2021, Section 6.3]. We also provide a
derivation for the correct specification here in our notation. Observe that
for any iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ],

|  | ğ”¼â¢[y~(iâ¢1)âˆ£Wi,ğ‘¿i=ğ’™]ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–1subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tilde{y}_{(i1)}\mid W_{i},\boldsymbol{X}_{i}=% \boldsymbol{x}\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğŸ™â¢{Wi=0}â¢ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]+âˆ‘râˆˆâ„›ğŸ™â¢{Wi=r}â¢ğ”¼â¢[y~(iâ¢1)â¢(r)âˆ£Wi=r,ğ‘¿i=ğ’™]1subscriptğ‘Šğ‘–0ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™subscriptğ‘Ÿâ„›1subscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–1ğ‘Ÿsubscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbbm{1}\\{W_{i}=0\\}\mathbb{E}\left[\tilde{y}_{(i1)}(0)\mid W_{% i}=0,\boldsymbol{X}_{i}=\boldsymbol{x}\right]+\sum_{r\in\mathcal{R}}\mathbbm{1% }\\{W_{i}=r\\}\mathbb{E}\left[\tilde{y}_{(i1)}(r)\mid W_{i}=r,\boldsymbol{X}_{i}% =\boldsymbol{x}\right]blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 } blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] + âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
| =(a)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(a)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_a ) end_ARG end_RELOP | ğŸ™â¢{Wi=0}â¢ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]+âˆ‘râˆˆâ„›ğŸ™â¢{Wi=r}â¢ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i=ğ’™]1subscriptğ‘Šğ‘–0ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™subscriptğ‘Ÿâ„›1subscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbbm{1}\\{W_{i}=0\\}\mathbb{E}\left[\tilde{y}_{(i1)}(0)\mid W_{% i}=0,\boldsymbol{X}_{i}=\boldsymbol{x}\right]+\sum_{r\in\mathcal{R}}\mathbbm{1% }\\{W_{i}=r\\}\mathbb{E}\left[\tilde{y}_{(i1)}(0)\mid W_{i}=r,\boldsymbol{X}_{i}% =\boldsymbol{x}\right]blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 } blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] + âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
| =(b)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(b)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_b ) end_ARG end_RELOP | ğŸ™â¢{Wi=0}â¢(Î·âˆ—+ğ’™âŠ¤â¢ğœ¿âˆ—)+âˆ‘râˆˆâ„›ğŸ™â¢{Wi=r}â¢(Î·âˆ—+Î½râˆ—+ğ’™âŠ¤â¢(ğœ¿âˆ—+ğœ»râˆ—))1subscriptğ‘Šğ‘–0superscriptğœ‚superscriptğ’™topsuperscriptğœ¿subscriptğ‘Ÿâ„›1subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptğœ‚superscriptsubscriptğœˆğ‘Ÿsuperscriptğ’™topsuperscriptğœ¿superscriptsubscriptğœ»ğ‘Ÿ\displaystyle\mathbbm{1}\\{W_{i}=0\\}\left(\eta^{*}+\boldsymbol{x}^{\top}% \boldsymbol{\kappa}^{*}\right)+\sum_{r\in\mathcal{R}}\mathbbm{1}\\{W_{i}=r\\}% \left(\eta^{*}+\nu_{r}^{*}+\boldsymbol{x}^{\top}\left(\boldsymbol{\kappa}^{*}+% \boldsymbol{\zeta}_{r}^{*}\right)\right)blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 } ( italic_Î· start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_x start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Îº start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) + âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } ( italic_Î· start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Î½ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_x start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_Îº start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_Î¶ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) ) |   
| =\displaystyle=\leavevmode\nobreak\ = | Î·âˆ—+ğ’™âŠ¤â¢ğœ¿âˆ—+âˆ‘râˆˆâ„›ğŸ™â¢{Wi=r}â¢(Î½râˆ—+ğ’™âŠ¤â¢ğœ»râˆ—),superscriptğœ‚superscriptğ’™topsuperscriptğœ¿subscriptğ‘Ÿâ„›1subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğœˆğ‘Ÿsuperscriptğ’™topsuperscriptsubscriptğœ»ğ‘Ÿ\displaystyle\eta^{*}+\boldsymbol{x}^{\top}\boldsymbol{\kappa}^{*}+\sum_{r\in% \mathcal{R}}\mathbbm{1}\\{W_{i}=r\\}\left(\nu_{r}^{*}+\boldsymbol{x}^{\top}% \boldsymbol{\zeta}_{r}^{*}\right),italic_Î· start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_x start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Îº start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } ( italic_Î½ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_x start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¶ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) , |  | (F.2)  
  
where in (a)ğ‘(a)( italic_a ) we used Assumption (CNAS) and in (b)ğ‘(b)(
italic_b ) we used (3.3) and (3.4) from (LINS). Next, for any
tâˆˆ{2,â€¦,T}ğ‘¡2â€¦ğ‘‡t\in\\{2,\ldots,T\\}italic_t âˆˆ { 2 , â€¦ , italic_T }
and iğ‘–iitalic_i such that Wi=0subscriptğ‘Šğ‘–0W_{i}=0italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0,

|  | ğ”¼â¢[y~(iâ¢t)âˆ£Wi=0,ğ‘¿i]ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}\mid W_{i}=0,\boldsymbol{X}_{i}\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]+ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}% =0,\boldsymbol{X}_{i}=\boldsymbol{x}\right]+\mathbb{E}\left[\tilde{y}_{(i1)}(0% )\mid W_{i}=0,\boldsymbol{X}_{i}=\boldsymbol{x}\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] + blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
| =(c)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(c)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_c ) end_ARG end_RELOP | Î·âˆ—+Î³tâˆ—+ğ’™âŠ¤â¢(ğƒtâˆ—+ğœ¿âˆ—),superscriptğœ‚superscriptsubscriptğ›¾ğ‘¡superscriptğ’™topsuperscriptsubscriptğƒğ‘¡superscriptğœ¿\displaystyle\eta^{*}+\gamma_{t}^{*}+\boldsymbol{x}^{\top}(\boldsymbol{\xi}_{t% }^{*}+\boldsymbol{\kappa}^{*}),italic_Î· start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_x start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_Îº start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) , |   
  
where in (c)ğ‘(c)( italic_c ) we used (3.5) from (LINS) and (F.2). Then for
any iğ‘–iitalic_i such that
Wi=râˆˆâ„›âˆ–{2}subscriptğ‘Šğ‘–ğ‘Ÿâ„›2W_{i}=r\in\mathcal{R}\setminus\\{2\\}italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r âˆˆ caligraphic_R
âˆ– { 2 } and tâˆˆ{2,â€¦,râˆ’1}ğ‘¡2â€¦ğ‘Ÿ1t\in\\{2,\ldots,r-1\\}italic_t âˆˆ {
2 , â€¦ , italic_r - 1 },

|  | ğ”¼â¢[y~(iâ¢t)âˆ£Wi=r,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–ğ‘¡subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}\mid W_{i}=r,\boldsymbol{X}_{i}=% \boldsymbol{x}\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼â¢[y~(iâ¢1)âˆ£Wi=r,ğ‘¿i=ğ’™]+ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ’y~(iâ¢1)â¢(r)âˆ£Wi=r,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–1subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿconditionalsubscript~ğ‘¦ğ‘–1ğ‘Ÿsubscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tilde{y}_{(i1)}\mid W_{i}=r,\boldsymbol{X}_{i}=% \boldsymbol{x}\right]+\mathbb{E}\left[\tilde{y}_{(it)}(r)-\tilde{y}_{(i1)}(r)% \mid W_{i}=r,\boldsymbol{X}_{i}=\boldsymbol{x}\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] + blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
| =(e)superscriptğ‘’\displaystyle\stackrel{{\scriptstyle(e)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_e ) end_ARG end_RELOP | ğ”¼â¢[y~(iâ¢1)âˆ£Wi=r,ğ‘¿i=ğ’™]+ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–1subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tilde{y}_{(i1)}\mid W_{i}=r,\boldsymbol{X}_{i}=% \boldsymbol{x}\right]+\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)% \mid W_{i}=r,\boldsymbol{X}_{i}=\boldsymbol{x}\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] + blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
| =(f)superscriptğ‘“\displaystyle\stackrel{{\scriptstyle(f)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_f ) end_ARG end_RELOP | ğ”¼â¢[y~(iâ¢1)âˆ£Wi=r,ğ‘¿i=ğ’™]+ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–1subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tilde{y}_{(i1)}\mid W_{i}=r,\boldsymbol{X}_{i}=% \boldsymbol{x}\right]+\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)% \mid W_{i}=0,\boldsymbol{X}_{i}=\boldsymbol{x}\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] + blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
| =(g)superscriptğ‘”\displaystyle\stackrel{{\scriptstyle(g)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_g ) end_ARG end_RELOP | Î·âˆ—+Î½râˆ—+ğ’™âŠ¤â¢(ğœ¿âˆ—+ğœ»râˆ—+ğƒtâˆ—)+Î³tâˆ—,superscriptğœ‚superscriptsubscriptğœˆğ‘Ÿsuperscriptğ’™topsuperscriptğœ¿superscriptsubscriptğœ»ğ‘Ÿsuperscriptsubscriptğƒğ‘¡superscriptsubscriptğ›¾ğ‘¡\displaystyle\eta^{*}+\nu_{r}^{*}+\boldsymbol{x}^{\top}(\boldsymbol{\kappa}^{*% }+\boldsymbol{\zeta}_{r}^{*}+\boldsymbol{\xi}_{t}^{*})+\gamma_{t}^{*},italic_Î· start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Î½ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_x start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_Îº start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_Î¶ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) + italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , |   
  
where in (e)ğ‘’(e)( italic_e ) we used (CNAS), in (f)ğ‘“(f)( italic_f ) we
used (CCTSB), and in (g)ğ‘”(g)( italic_g ) we used (F.2) and (3.5) from
(LINS). Finally, for any iğ‘–iitalic_i such that
Wi=râˆˆâ„›subscriptğ‘Šğ‘–ğ‘Ÿâ„›W_{i}=r\in\mathcal{R}italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r âˆˆ caligraphic_R
and tâˆˆ{r,â€¦,T}ğ‘¡ğ‘Ÿâ€¦ğ‘‡t\in\\{r,\ldots,T\\}italic_t âˆˆ { italic_r , â€¦
, italic_T },

|  | ğ”¼â¢[y~(iâ¢t)âˆ£Wi=r,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–ğ‘¡subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}\mid W_{i}=r,\boldsymbol{X}_{i}=% \boldsymbol{x}\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼â¢[y~(iâ¢1)âˆ£Wi=r,ğ‘¿i=ğ’™]+ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequenceconditionalsubscript~ğ‘¦ğ‘–1subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™\displaystyle\mathbb{E}\left[\tilde{y}_{(i1)}\mid W_{i}=r,\boldsymbol{X}_{i}=% \boldsymbol{x}\right]+\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)% \mid W_{i}=0,\boldsymbol{X}_{i}=\boldsymbol{x}\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] + blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
|  | +ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ’y~(iâ¢1)â¢(r)âˆ£Wi=r,ğ‘¿i=ğ’™]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ’™]ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿconditionalsubscript~ğ‘¦ğ‘–1ğ‘Ÿsubscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–ğ’™ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ’™\displaystyle+\mathbb{E}\left[\tilde{y}_{(it)}(r)-\tilde{y}_{(i1)}(r)\mid W_{i% }=r,\boldsymbol{X}_{i}=\boldsymbol{x}\right]-\mathbb{E}\left[\tilde{y}_{(it)}(% 0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,\boldsymbol{X}_{i}=\boldsymbol{x}\right]\+ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x ] |   
| =(h)superscriptâ„\displaystyle\stackrel{{\scriptstyle(h)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_h ) end_ARG end_RELOP | Î·âˆ—+Î½râˆ—+ğ’™âŠ¤â¢(ğœ¿âˆ—+ğœ»râˆ—+ğƒtâˆ—)+Î³tâˆ—+Ï„râ¢tâˆ—+ğ’™Ë™râ¢ğ†râ¢tâˆ—,superscriptğœ‚superscriptsubscriptğœˆğ‘Ÿsuperscriptğ’™topsuperscriptğœ¿superscriptsubscriptğœ»ğ‘Ÿsuperscriptsubscriptğƒğ‘¡superscriptsubscriptğ›¾ğ‘¡superscriptsubscriptğœğ‘Ÿğ‘¡subscriptbold-Ë™ğ’™ğ‘Ÿsuperscriptsubscriptğ†ğ‘Ÿğ‘¡\displaystyle\eta^{*}+\nu_{r}^{*}+\boldsymbol{x}^{\top}(\boldsymbol{\kappa}^{*% }+\boldsymbol{\zeta}_{r}^{*}+\boldsymbol{\xi}_{t}^{*})+\gamma_{t}^{*}+\tau_{rt% }^{*}+\boldsymbol{\dot{x}}_{r}\boldsymbol{\rho}_{rt}^{*},italic_Î· start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Î½ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_x start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_Îº start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_Î¶ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) + italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + overbold_Ë™ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , |  | (F.3)  
  
where in (h)â„(h)( italic_h ) we used (F.2) and (3.5) and (3.6) from (LINS).
Therefore regression (1.5) is correctly specified and (F.1) holds.

  2. (b)

First we will show that Assumptions (FE1) - (FE3), (RE4), (A1), (A3), (A5),
and (A6) from Kock [2013] are satisfied. Then we will show that the conclusion
of Theorem 1 in Kock [2013] about
ğœ½Nâˆ—superscriptsubscriptğœ½ğ‘\boldsymbol{\theta}_{N}^{*}bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT leads to our statement about
ğœ·Nâˆ—superscriptsubscriptğœ·ğ‘\boldsymbol{\beta}_{N}^{*}bold_italic_Î²
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT. We will use three lemmas:

######  Lemma F.1.

The smallest and largest singular values of
ğƒNsubscriptğƒğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT are bounded as follows:
Ïƒmaxâ¢(ğƒN)â‰¤3subscriptğœmaxsubscriptğƒğ‘3\sigma_{\text{max}}(\boldsymbol{D}_{N})\leq
3italic_Ïƒ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) â‰¤ 3 and
Ïƒminâ¢(ğƒN)â‰¥1Tâ¢2â¢Tsubscriptğœminsubscriptğƒğ‘1ğ‘‡2ğ‘‡\sigma_{\text{min}}\left(\boldsymbol{D}_{N}\right)\geq\frac{1}{T\sqrt{2T}}italic_Ïƒ
start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT ) â‰¥ divide start_ARG 1 end_ARG start_ARG italic_T
square-root start_ARG 2 italic_T end_ARG end_ARG.

######  Lemma F.2.

Under Assumption (R1) it holds that

| ğ”¼â¢[(ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1)(iâ¢t)â¢j4]â‰¤Îº4âˆ€iâˆˆ[N],jâˆˆ[pN],tâˆˆ[T]\mathbb{E}\left[(\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1}% )_{(it)j}^{4}\right]\leq\kappa_{4}\qquad\forall i\in[N],j\in[p_{N}],t\in[T]blackboard_E [ ( overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( italic_i italic_t ) italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ] â‰¤ italic_Îº start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT âˆ€ italic_i âˆˆ [ italic_N ] , italic_j âˆˆ [ italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] , italic_t âˆˆ [ italic_T ] |   
---|---|---  
  
for some finite Îº4>0subscriptğœ…40\kappa_{4}>0italic_Îº start_POSTSUBSCRIPT 4
end_POSTSUBSCRIPT > 0.

######  Lemma F.3.

Under the assumptions of Theorem C.1(b),

| Ï1â¢N=Î»minâ¢(ğšº^â¢(ğ’â¢ğ‘«Nâˆ’1))â‰¥subscriptğœŒ1ğ‘subscriptğœ†minbold-^ğšºğ’superscriptsubscriptğ‘«ğ‘1absent\displaystyle\rho_{1N}=\lambda_{\text{min}}\left(\boldsymbol{\hat{\Sigma}}% \left(\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}\right)\right)\geq\leavevmode\nobreak\ italic_Ï start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT = italic_Î» start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ) â‰¥ | 19â¢e1â¢Nand19subscriptğ‘’1ğ‘and\displaystyle\frac{1}{9}e_{1N}\qquad\text{and}divide start_ARG 1 end_ARG start_ARG 9 end_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT and |   
---|---|---|---  
| Ï2â¢N=Î»maxâ¢(ğšº^â¢(ğ’â¢ğ‘«Nâˆ’1))â‰¤subscriptğœŒ2ğ‘subscriptğœ†maxbold-^ğšºğ’superscriptsubscriptğ‘«ğ‘1absent\displaystyle\rho_{2N}=\lambda_{\text{max}}\left(\boldsymbol{\hat{\Sigma}}% \left(\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}\right)\right)\leq\leavevmode\nobreak\ italic_Ï start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT = italic_Î» start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ) â‰¤ | e2â¢Nâ‹…2â¢T3.â‹…subscriptğ‘’2ğ‘2superscriptğ‘‡3\displaystyle e_{2N}\cdot 2T^{3}.italic_e start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT â‹… 2 italic_T start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT . |   
  
The proofs of all three of these lemmas are provided in Appendix H. Now we
will verify one assumption at a time.

     * â€¢

In our notation, Assumption (FE1) from Kock [2013] requires that
(ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1,ci,ğ’–(iâ‹…))i=1N(\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1},c_{i},%
\boldsymbol{u}_{(i\cdot)})_{i=1}^{N}( overbold_~ start_ARG bold_italic_Z
end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT
bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , italic_c start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT , bold_italic_u start_POSTSUBSCRIPT ( italic_i â‹…
) end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT are iid. This is satisfied
by our Assumption (F2) since
ğ’~(iâ‹…)â‹…\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}overbold_~ start_ARG
bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT is a deterministic, invertible function of
(Wi,ğ‘¿i)subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–(W_{i},\boldsymbol{X}_{i})( italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ), and
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT is also deterministic and invertible conditional on
(Wi,ğ‘¿i)subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–(W_{i},\boldsymbol{X}_{i})( italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ).

     * â€¢

Assumption (FE2) requires that
ğ”¼â¢[(ğ’~â¢ğ‘«Nâˆ’1)(iâ¢t)â¢j4]ğ”¼delimited-[]superscriptsubscriptbold-~ğ’superscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘¡ğ‘—4\mathbb{E}[(\boldsymbol{\tilde{Z}}\boldsymbol{D}_{N}^{-1})_{(it)j}^{4}]blackboard_E
[ ( overbold_~ start_ARG bold_italic_Z end_ARG bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( italic_i italic_t ) italic_j
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ] and
ğ”¼â¢[u(iâ¢t)4]ğ”¼delimited-[]superscriptsubscriptğ‘¢ğ‘–ğ‘¡4\mathbb{E}[u_{(it)}^{4}]blackboard_E
[ italic_u start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ] are finite for all
iâˆˆ[N],jâˆˆ[dN],tâˆˆ[T]formulae-sequenceğ‘–delimited-[]ğ‘formulae-
sequenceğ‘—delimited-[]subscriptğ‘‘ğ‘ğ‘¡delimited-[]ğ‘‡i\in[N],j\in[d_{N}],t\in[T]italic_i
âˆˆ [ italic_N ] , italic_j âˆˆ [ italic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ] , italic_t âˆˆ [ italic_T ]. We assumed the latter in
Assumption (R1). We proved that the former is satisfied in Lemma F.2.

     * â€¢

Next, Assumption (FE3) requires that

| ğ”¼â¢[ğ’–(iâ‹…)âˆ£ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1,ci]=\displaystyle\mathbb{E}\left[\boldsymbol{u}_{(i\cdot)}\mid\boldsymbol{\tilde{Z% }}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1},c_{i}\right]=\leavevmode\nobreak\ blackboard_E [ bold_italic_u start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆ£ overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = | ğŸand0and\displaystyle\boldsymbol{0}\qquad\text{and}bold_0 and |   
---|---|---|---  
| Varâ¢[ğ’–(iâ‹…)âˆ£ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1,ci]=\displaystyle\mathrm{Var}\left[\boldsymbol{u}_{(i\cdot)}\mid\boldsymbol{\tilde% {Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1},c_{i}\right]=\leavevmode\nobreak\ roman_Var [ bold_italic_u start_POSTSUBSCRIPT ( italic_i â‹… ) end_POSTSUBSCRIPT âˆ£ overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = | Ïƒ2â¢ğ‘°T,iâˆˆ[N],superscriptğœ2subscriptğ‘°ğ‘‡ğ‘–delimited-[]ğ‘\displaystyle\sigma^{2}\boldsymbol{I}_{T},\qquad i\in[N],italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_i âˆˆ [ italic_N ] , |   
  
and Assumption (RE4) requires

| ğ”¼â¢[ciâˆ£ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1]=\displaystyle\mathbb{E}\left[c_{i}\mid\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}% \boldsymbol{D}_{N}^{-1}\right]=\leavevmode\nobreak\ blackboard_E [ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ] = | 0,0\displaystyle 0,0 , |   
---|---|---|---  
| Varâ¢[ciâˆ£ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1]=\displaystyle\mathrm{Var}\left[c_{i}\mid\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}% \boldsymbol{D}_{N}^{-1}\right]=\leavevmode\nobreak\ roman_Var [ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ] = | Ïƒc2,superscriptsubscriptğœğ‘2\displaystyle\sigma_{c}^{2},italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , |   
  
and that Ïƒğœ\sigmaitalic_Ïƒ and
Ïƒc2superscriptsubscriptğœğ‘2\sigma_{c}^{2}italic_Ïƒ start_POSTSUBSCRIPT
italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT are
known and finite. Our Assumption (F1) is sufficient for this because
conditioning on
Wi,ğ‘¿isubscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–W_{i},\boldsymbol{X}_{i}italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT is the same as conditioning on
ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1}overbold_~
start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT by the following argument.
Because ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT is invertible, the Ïƒğœ\sigmaitalic_Ïƒ-algebra generated
by
ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1}overbold_~
start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT,
Ïƒâ¢(ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1)\sigma(\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1})italic_Ïƒ
( overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i
â‹… ) â‹… end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ), contains
the same information as
Ïƒâ¢(ğ’~(iâ‹…)â‹…)\sigma(\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot})italic_Ïƒ (
overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹…
) â‹… end_POSTSUBSCRIPT ). Similarly, for each
(Wi,ğ‘¿i)subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–(W_{i},\boldsymbol{X}_{i})( italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) there is only one valid
ğ’~(iâ‹…)â‹…\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}overbold_~ start_ARG
bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT, and every valid
ğ’~(iâ‹…)â‹…\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}overbold_~ start_ARG
bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT corresponds to a unique
(Wi,ğ‘¿i)subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–(W_{i},\boldsymbol{X}_{i})( italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )â€”that is, the mapping from
(Wi,ğ‘¿i)subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–(W_{i},\boldsymbol{X}_{i})( italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) to
ğ’~(iâ‹…)â‹…\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}overbold_~ start_ARG
bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT is also invertible, so
Ïƒâ¢(Wi,ğ‘¿i)=Ïƒâ¢(ğ’~(iâ‹…)â‹…)\sigma(W_{i},\boldsymbol{X}_{i})=\sigma(\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot})italic_Ïƒ
( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_Ïƒ ( overbold_~
start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT ).

     * â€¢

Our Assumptions (R1), (R2), and (R3) exactly match assumptions (A1), (A3), and
(A5), respectively, from Kock [2013] (in our setting where we assume
Tğ‘‡Titalic_T is fixed).

     * â€¢

Finally, Assumption (A6) in Kock [2013] requires that

| pN+Î»Nâ¢sNNâ¢Ï1â¢Nâ†’a.s.0,\frac{p_{N}+\lambda_{N}s_{N}}{N\rho_{1N}}\xrightarrow{a.s.}0,divide start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT + italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_N italic_Ï start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT end_ARG start_ARROW start_OVERACCENT italic_a . italic_s . end_OVERACCENT â†’ end_ARROW 0 , |   
---|---|---  
  
where Ï1â¢NsubscriptğœŒ1ğ‘\rho_{1N}italic_Ï start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT is the smallest eigenvalue of the random matrix
ğšº^â¢(ğ’â¢ğ‘«Nâˆ’1)bold-^ğšºğ’superscriptsubscriptğ‘«ğ‘1\boldsymbol{\hat{\Sigma}}\left(\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}\right)overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ).
Under Lemma F.3 the smallest eigenvalue of
ğšº^â¢(ğ’)bold-^ğšºğ’\boldsymbol{\hat{\Sigma}}(\boldsymbol{Z})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_Z ),
e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT, is within a constant factor of
Ï1â¢NsubscriptğœŒ1ğ‘\rho_{1N}italic_Ï start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT, so our Assumption (R2) suffices to satisfy this condition.

We have shown that the assumptions of Theorem 1 in Kock [2013] are satisfied,
so we have
âˆ¥ğœ½^(q)âˆ’ğœ½Nâˆ—âˆ¥2=ğ’ªâ„™â¢(minâ¡{hN,hNâ€²})subscriptdelimited-
âˆ¥âˆ¥superscriptbold-^ğœ½ğ‘superscriptsubscriptğœ½ğ‘2subscriptğ’ªâ„™subscriptâ„ğ‘subscriptsuperscriptâ„â€²ğ‘\lVert\boldsymbol{\hat{\theta}}^{(q)}-\boldsymbol{\theta}_{N}^{*}\rVert_{2}=%
\mathcal{O}_{\mathbb{P}}\left(\min\\{h_{N},h^{\prime}_{N}\\}\right)âˆ¥
overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT - bold_italic_Î¸ start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥
start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = caligraphic_O start_POSTSUBSCRIPT
blackboard_P end_POSTSUBSCRIPT ( roman_min { italic_h start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT â€²
end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT } ).
Finally, part (2) is proven because
âˆ¥ğœ·^(q)âˆ’ğœ·Nâˆ—âˆ¥2subscriptdelimited-
âˆ¥âˆ¥superscriptbold-^ğœ·ğ‘superscriptsubscriptğœ·ğ‘2\left\lVert\boldsymbol{\hat{\beta}}^{(q)}-\boldsymbol{\beta}_{N}^{*}\right%
\rVert_{2}âˆ¥ overbold_^ start_ARG bold_italic_Î² end_ARG
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Î²
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT is within a
constant factor of âˆ¥ğœ½^(q)âˆ’ğœ½Nâˆ—âˆ¥2subscriptdelimited-
âˆ¥âˆ¥superscriptbold-^ğœ½ğ‘superscriptsubscriptğœ½ğ‘2\lVert\boldsymbol{\hat{\theta}}^{(q)}-\boldsymbol{\theta}_{N}^{*}\rVert_{2}âˆ¥
overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT - bold_italic_Î¸ start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥
start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT:

| âˆ¥ğœ·^(q)âˆ’ğœ·Nâˆ—âˆ¥2=subscriptdelimited-âˆ¥âˆ¥superscriptbold-^ğœ·ğ‘superscriptsubscriptğœ·ğ‘2absent\displaystyle\lVert\boldsymbol{\hat{\beta}}^{(q)}-\boldsymbol{\beta}_{N}^{*}% \rVert_{2}=\leavevmode\nobreak\ âˆ¥ overbold_^ start_ARG bold_italic_Î² end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = | âˆ¥ğ‘«Nâˆ’1â¢(ğœ½^(q)âˆ’ğœ½Nâˆ—)âˆ¥2â‰¤âˆ¥ğ‘«Nâˆ’1âˆ¥opâ¢âˆ¥ğœ½^(q)âˆ’ğœ½Nâˆ—âˆ¥2â‰¤Tâ¢2â¢Tâ¢âˆ¥ğœ½^(q)âˆ’ğœ½Nâˆ—âˆ¥2,subscriptdelimited-âˆ¥âˆ¥superscriptsubscriptğ‘«ğ‘1superscriptbold-^ğœ½ğ‘superscriptsubscriptğœ½ğ‘2subscriptdelimited-âˆ¥âˆ¥superscriptsubscriptğ‘«ğ‘1opsubscriptdelimited-âˆ¥âˆ¥superscriptbold-^ğœ½ğ‘superscriptsubscriptğœ½ğ‘2ğ‘‡2ğ‘‡subscriptdelimited-âˆ¥âˆ¥superscriptbold-^ğœ½ğ‘superscriptsubscriptğœ½ğ‘2\displaystyle\left\lVert\boldsymbol{D}_{N}^{-1}\left(\boldsymbol{\hat{\theta}}% ^{(q)}-\boldsymbol{\theta}_{N}^{*}\right)\right\rVert_{2}\leq\left\lVert% \boldsymbol{D}_{N}^{-1}\right\rVert_{\text{op}}\left\lVert\boldsymbol{\hat{% \theta}}^{(q)}-\boldsymbol{\theta}_{N}^{*}\right\rVert_{2}\leq T\sqrt{2T}\left% \lVert\boldsymbol{\hat{\theta}}^{(q)}-\boldsymbol{\theta}_{N}^{*}\right\rVert_% {2},âˆ¥ bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT â‰¤ âˆ¥ bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT op end_POSTSUBSCRIPT âˆ¥ overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT â‰¤ italic_T square-root start_ARG 2 italic_T end_ARG âˆ¥ overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT - bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , |   
---|---|---|---  
  
where in the last step we applied Lemma F.1.

  3. (c)

In light of the results from part (a), part (c) follows from Theorem F.4
below, which extends Lemma 3 from Kock [2013], under our assumptions. In
particular, we will show that our Assumptions (R4) and (R5) suffice for Kock
[2013]â€™s Assumptions (A4) and (A7), as well as the needed part of Assumption
(A2) for Lemma 3, in Kock [2013].

######  Theorem F.4 (Extension of Lemma 3 from Kock 2013).

Under the assumptions of Lemma 3 from Kock [2013],

| limNâ†’âˆâ„™â¢(ğ’®^=ğ’®)=1.subscriptâ†’ğ‘â„™^ğ’®ğ’®1\lim_{N\to\infty}\mathbb{P}\left(\hat{\mathcal{S}}=\mathcal{S}\right)=1.roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( over^ start_ARG caligraphic_S end_ARG = caligraphic_S ) = 1 . |   
---|---|---  
  
###### Proof.

Provided in Appendix H. âˆ

######  Remark F.1.

It appears that the strategy for the proof of of Theorem F.4 could be used to
analogously extend Lemma 2, and Theorem 2(i), in Huang etÂ al. [2008].

Again we verify one assumption at a time.

     * â€¢

Although Lemma 3 from Kock [2013] requires their Assumption (A2) in the
statement of the theorem, examining the proof we see that a lower bound on the
minimum eigenvalue is not neededâ€”the only thing that is needed is an almost
sure upper bound on the maximum eigenvalue of
ğšº^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®)bold-^ğšºsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…ğ’®\boldsymbol{\hat{\Sigma}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot%
\cdot)\mathcal{S}}\right)overbold_^ start_ARG bold_Î£ end_ARG ( (
bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹…
) caligraphic_S end_POSTSUBSCRIPT ), the empirical Gram matrix of the columns
of
ğ’â¢ğ‘«Nâˆ’1ğ’superscriptsubscriptğ‘«ğ‘1\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}bold_italic_Z
bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT corresponding to the relevant
features in
ğœ½Nâˆ—superscriptsubscriptğœ½ğ‘\boldsymbol{\theta}_{N}^{*}bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT. (In the proof, note the use of
Ï„2subscriptğœ2\tau_{2}italic_Ï„ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT on p.
140, and note that Ï„1subscriptğœ1\tau_{1}italic_Ï„ start_POSTSUBSCRIPT 1
end_POSTSUBSCRIPT is not needed.) Our Assumption (R4) is sufficient for this,
since we assume the maximum eigenvalue of the empirical Gram matrix for
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG,
e2â¢Nsubscriptğ‘’2ğ‘e_{2N}italic_e start_POSTSUBSCRIPT 2 italic_N
end_POSTSUBSCRIPT is finite, which ensures that the maximum eigenvalue of the
Gram matrix for the full
ğ’â¢ğ‘«Nâˆ’1ğ’superscriptsubscriptğ‘«ğ‘1\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}bold_italic_Z
bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT is finite due to Lemma F.3. This
maximum eigenvalue upper-bounds the maximum eigenvalue of the submatrix
ğšº^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®)bold-^ğšºsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…ğ’®\boldsymbol{\hat{\Sigma}}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot%
\cdot)\mathcal{S}}\right)overbold_^ start_ARG bold_Î£ end_ARG ( (
bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹…
) caligraphic_S end_POSTSUBSCRIPT ).

     * â€¢

Our Assumption (R5) matches Assumption (A4) in Kock [2013] in our setting
where TN=Tsubscriptğ‘‡ğ‘ğ‘‡T_{N}=Titalic_T start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT = italic_T is fixed.

     * â€¢

Finally, we show that Assumption (A7) in Kock [2013] is satisfied under our
Assumption (R4). We need to show that

| e1â¢Nâ¢e2â¢NpN=ğ’ªpâ¢(1).subscriptğ‘’1ğ‘subscriptğ‘’2ğ‘subscriptğ‘ğ‘subscriptğ’ªğ‘1e_{1N}\sqrt{\frac{e_{2N}}{p_{N}}}=\mathcal{O}_{p}(1).italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT square-root start_ARG divide start_ARG italic_e start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG end_ARG = caligraphic_O start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( 1 ) . |   
---|---|---  
  
But since e1â¢Nâ‰¤e2â¢Nsubscriptğ‘’1ğ‘subscriptğ‘’2ğ‘e_{1N}\leq e_{2N}italic_e
start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT â‰¤ italic_e
start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT, almost surely

| e1â¢Nâ¢e2â¢NpNâ‰¤e2â¢N3pNâ‰¤emax3pN=ğ’ªâ¢(1pN),subscriptğ‘’1ğ‘subscriptğ‘’2ğ‘subscriptğ‘ğ‘superscriptsubscriptğ‘’2ğ‘3subscriptğ‘ğ‘superscriptsubscriptğ‘’max3subscriptğ‘ğ‘ğ’ª1subscriptğ‘ğ‘e_{1N}\sqrt{\frac{e_{2N}}{p_{N}}}\leq\sqrt{\frac{e_{2N}^{3}}{p_{N}}}\leq\sqrt{% \frac{e_{\text{max}}^{3}}{p_{N}}}=\mathcal{O}\left(\frac{1}{\sqrt{p_{N}}}% \right),italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT square-root start_ARG divide start_ARG italic_e start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG end_ARG â‰¤ square-root start_ARG divide start_ARG italic_e start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG end_ARG â‰¤ square-root start_ARG divide start_ARG italic_e start_POSTSUBSCRIPT max end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG end_ARG = caligraphic_O ( divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG end_ARG ) , |   
---|---|---  
  
so
e1â¢Nâ¢e2â¢N/pN=ğ’ªpâ¢(1)subscriptğ‘’1ğ‘subscriptğ‘’2ğ‘subscriptğ‘ğ‘subscriptğ’ªğ‘1e_{1N}\sqrt{e_{2N}/p_{N}}=\mathcal{O}_{p}(1)italic_e
start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT square-root start_ARG
italic_e start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT / italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG = caligraphic_O
start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( 1 ).

So the first part of the result is now immediate. It only remains to show that

| limNâ†’âˆâ„™â¢(Nâ¢Tâ¢ğœ½^ğ’®c(q)=ğŸ)=1.subscriptâ†’ğ‘â„™ğ‘ğ‘‡subscriptsuperscriptbold-^ğœ½ğ‘superscriptğ’®ğ‘01\lim_{N\to\infty}\mathbb{P}\left(\sqrt{NT}\boldsymbol{\hat{\theta}}^{(q)}_{% \mathcal{S}^{c}}=\boldsymbol{0}\right)=1.roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( square-root start_ARG italic_N italic_T end_ARG overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT caligraphic_S start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = bold_0 ) = 1 . |   
---|---|---  
  
From part (c)ğ‘(c)( italic_c ), we have that
limnâ†’âˆâ„™â¢(ğœ½^ğ’®C(q)=ğŸ)=1subscriptâ†’ğ‘›â„™superscriptsubscriptbold-^ğœ½superscriptğ’®ğ¶ğ‘01\lim_{n\to\infty}\mathbb{P}\left(\boldsymbol{\hat{\theta}}_{\mathcal{S}^{C}}^{%
(q)}=\boldsymbol{0}\right)=1roman_lim start_POSTSUBSCRIPT italic_n â†’ âˆ
end_POSTSUBSCRIPT blackboard_P ( overbold_^ start_ARG bold_italic_Î¸ end_ARG
start_POSTSUBSCRIPT caligraphic_S start_POSTSUPERSCRIPT italic_C
end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q )
end_POSTSUPERSCRIPT = bold_0 ) = 1, so using
{Nâ¢Tâ¢ğœ½^ğ’®c(q)=0}={ğœ½^ğ’®c(q)=0}ğ‘ğ‘‡subscriptsuperscriptbold-^ğœ½ğ‘superscriptğ’®ğ‘0subscriptsuperscriptbold-^ğœ½ğ‘superscriptğ’®ğ‘0\\{\sqrt{NT}\boldsymbol{\hat{\theta}}^{(q)}_{\mathcal{S}^{c}}=0\\}=\\{\boldsymbol%
{\hat{\theta}}^{(q)}_{\mathcal{S}^{c}}=0\\}{ square-root start_ARG italic_N
italic_T end_ARG overbold_^ start_ARG bold_italic_Î¸ end_ARG
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT
caligraphic_S start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT
end_POSTSUBSCRIPT = 0 } = { overbold_^ start_ARG bold_italic_Î¸ end_ARG
start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT
caligraphic_S start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT
end_POSTSUBSCRIPT = 0 },

| limNâ†’âˆâ„™â¢(Nâ¢Tâ¢ğœ½^ğ’®c(q)=0)=limNâ†’âˆâ„™â¢(ğœ½^ğ’®c(q)=0)=1.subscriptâ†’ğ‘â„™ğ‘ğ‘‡subscriptsuperscriptbold-^ğœ½ğ‘superscriptğ’®ğ‘0subscriptâ†’ğ‘â„™subscriptsuperscriptbold-^ğœ½ğ‘superscriptğ’®ğ‘01\displaystyle\lim_{N\to\infty}\mathbb{P}\left(\sqrt{NT}\boldsymbol{\hat{\theta% }}^{(q)}_{\mathcal{S}^{c}}=0\right)=\lim_{N\to\infty}\mathbb{P}\left(% \boldsymbol{\hat{\theta}}^{(q)}_{\mathcal{S}^{c}}=0\right)=1.roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( square-root start_ARG italic_N italic_T end_ARG overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT caligraphic_S start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = 0 ) = roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( overbold_^ start_ARG bold_italic_Î¸ end_ARG start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT caligraphic_S start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = 0 ) = 1 . |   
---|---|---  
  
  4. (d)

To prove parts (d) - (h), we will present an extension of Theorem 2(ii) from
Kock [2013] that yields our result when in applied in our setting. Then we
will show that the needed assumptions are satisfied to conclude the proof. In
particular, our extension (a) obtains the asymptotic convergence of linear
combinations of the coefficients of both relevant and irrelevant features; (b)
establishes the asymptotic convergence of a statistic formed using the
estimated Gram matrix on the selected set of coefficients, not the population
covariance matrix of the true active set; (c) is like (a) when
ğNsubscriptğğ‘\boldsymbol{\psi}_{N}bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT is estimated rather than known and is independent of
Î²^Nsubscript^ğ›½ğ‘\hat{\beta}_{N}over^ start_ARG italic_Î² end_ARG
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT; (d) is like (b) when
ğNsubscriptğğ‘\boldsymbol{\psi}_{N}bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT is estimated rather than known; and (e) is like (d) when
Î²^Nsubscript^ğ›½ğ‘\hat{\beta}_{N}over^ start_ARG italic_Î² end_ARG
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT and
ğ^Nsubscriptbold-^ğğ‘\boldsymbol{\hat{\psi}}_{N}overbold_^ start_ARG
bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT are
estimated on the same data set, so they are dependent.

######  Theorem F.5 (Extension of Theorem 2(ii) from Kock 2013).

Suppose the assumptions of Theorem 2(ii) from Kock [2013] are satisfied.

    1. (a)

(Asymptotic normality when coefficients equal to 0 are included.) Let
{ğN}N=1âˆsuperscriptsubscriptsubscriptğğ‘ğ‘1\\{\boldsymbol{\psi}_{N}\\}_{N=1}^{\infty}{
bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT }
start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ
end_POSTSUPERSCRIPT be a sequence of real-valued vectors where
ğNâˆˆâ„pNsubscriptğğ‘superscriptâ„subscriptğ‘ğ‘\boldsymbol{\psi}_{N}\in\mathbb{R}^{p_{N}}bold_italic_Ïˆ
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
end_POSTSUPERSCRIPT has the structure
(ğœ¶âŠ¤,ğ’ƒNâŠ¤)âŠ¤superscriptsuperscriptğœ¶topsuperscriptsubscriptğ’ƒğ‘toptop(\boldsymbol{\alpha}^{\top},\boldsymbol{b}_{N}^{\top})^{\top}(
bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT , bold_italic_b
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤
end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT where
ğœ¶âˆˆâ„kğœ¶superscriptâ„ğ‘˜\boldsymbol{\alpha}\in\mathbb{R}^{k}bold_italic_Î±
âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT is a
fixed, finite, nonzero vector and
{ğ’ƒN}N=1âˆsuperscriptsubscriptsubscriptğ’ƒğ‘ğ‘1\\{\boldsymbol{b}_{N}\\}_{N=1}^{\infty}{
bold_italic_b start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT }
start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ
end_POSTSUPERSCRIPT is any sequence of constants where each
ğ’ƒNâˆˆâ„pNâˆ’ksubscriptğ’ƒğ‘superscriptâ„subscriptğ‘ğ‘ğ‘˜\boldsymbol{b}_{N}\in\mathbb{R}^{p_{N}-k}bold_italic_b
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
- italic_k end_POSTSUPERSCRIPT contains all finite entries. Then

| Nâ¢Tâ¢ğNâŠ¤â¢(Î²^Nâˆ’Î²0)â†’ğ‘‘ğ’©â¢(0,Ïƒ2â¢ğœ¶âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶).ğ‘‘â†’ğ‘ğ‘‡superscriptsubscriptğğ‘topsubscript^ğ›½ğ‘subscriptğ›½0ğ’©0superscriptğœ2superscriptğœ¶topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶\sqrt{NT}\boldsymbol{\psi}_{N}^{\top}(\hat{\beta}_{N}-\beta_{0})\xrightarrow{d% }\mathcal{N}\left(0,\sigma^{2}\boldsymbol{\alpha}^{\top}\left(\lim_{N\to\infty% }\mathbb{E}\left[\Sigma_{1N}\right]\right)^{-1}\boldsymbol{\alpha}\right).square-root start_ARG italic_N italic_T end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± ) . |   
---|---|---  
  
    2. (b)

(Asymptotic normality when coefficients equal to 0 are included and the covariance matrix and selected set are estimated.) Define a function ğœ¶ğœ¶\boldsymbol{\alpha}bold_italic_Î± that maps any ğ’œâˆˆğ’«â¢(â„•)ğ’œğ’«â„•\mathcal{A}\in\mathcal{P}(\mathbb{N})caligraphic_A âˆˆ caligraphic_P ( blackboard_N ) to a fixed vector ğœ¶â¢(ğ’œ)âˆˆ(â„âˆ–{0})|ğ’œ|ğœ¶ğ’œsuperscriptâ„0ğ’œ\boldsymbol{\alpha}(\mathcal{A})\in(\mathbb{R}\setminus\\{0\\})^{|\mathcal{A}|}bold_italic_Î± ( caligraphic_A ) âˆˆ ( blackboard_R âˆ– { 0 } ) start_POSTSUPERSCRIPT | caligraphic_A | end_POSTSUPERSCRIPT. Define the sequence of vectors {ğNâ¢(ğ’œN)}N=1âˆsuperscriptsubscriptsubscriptğğ‘subscriptğ’œğ‘ğ‘1\\{\boldsymbol{\psi}_{N}(\mathcal{A}_{N})\\}_{N=1}^{\infty}{ bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ end_POSTSUPERSCRIPT to have components in ğ’œNsubscriptğ’œğ‘\mathcal{A}_{N}caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT equal to ğœ¶â¢(ğ’œN)ğœ¶subscriptğ’œğ‘\boldsymbol{\alpha}(\mathcal{A}_{N})bold_italic_Î± ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) and components {ğ’ƒNâ¢(ğ’œN)}N=1âˆsuperscriptsubscriptsubscriptğ’ƒğ‘subscriptğ’œğ‘ğ‘1\\{\boldsymbol{b}_{N}(\mathcal{A}_{N})\\}_{N=1}^{\infty}{ bold_italic_b start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ end_POSTSUPERSCRIPT in the components corresponding to [pN]âˆ–ğ’œNdelimited-[]subscriptğ‘ğ‘subscriptğ’œğ‘[p_{N}]\setminus\mathcal{A}_{N}[ italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] âˆ– caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT that are all finite for all Nğ‘Nitalic_N (but are otherwise arbitrary). Define the sequence of random variables Ubâ¢(ğ’œ)subscriptğ‘ˆğ‘ğ’œU_{b}(\mathcal{A})italic_U start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( caligraphic_A ) to equal

| 1Ïƒâ¢Nâ¢Tğœ¶â¢(ğ’œ)âŠ¤â¢(ğšº^â¢(ğ‘¿(â‹…â‹…)â£ğ’œ))âˆ’1â¢ğœ¶â¢(ğ’œ)â‹…(ğNâ¢(ğ’œ)âŠ¤â¢(Î²^âˆ’Î²0)),â‹…1ğœğ‘ğ‘‡ğœ¶superscriptğ’œtopsuperscriptbold-^ğšºsubscriptğ‘¿â‹…absentâ‹…ğ’œ1ğœ¶ğ’œsubscriptğğ‘superscriptğ’œtop^ğ›½subscriptğ›½0\frac{1}{\sigma}\sqrt{\frac{NT}{\boldsymbol{\alpha}(\mathcal{A})^{\top}\left(% \boldsymbol{\hat{\Sigma}}(\boldsymbol{X}_{(\cdot\cdot)\mathcal{A}})\right)^{-1% }\boldsymbol{\alpha}(\mathcal{A})}}\cdot\left(\boldsymbol{\psi}_{N}(\mathcal{A% })^{\top}\left(\hat{\beta}-\beta_{0}\right)\right),divide start_ARG 1 end_ARG start_ARG italic_Ïƒ end_ARG square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG bold_italic_Î± ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_X start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_A end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± ( caligraphic_A ) end_ARG end_ARG â‹… ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG - italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ) , |   
---|---|---  
  
if ğ’œâ‰ âˆ…ğ’œ\mathcal{A}\neq\emptysetcaligraphic_A â‰ âˆ… and
ğšº^â¢(ğ‘¿(â‹…â‹…)â£ğ’œ)bold-^ğšºsubscriptğ‘¿â‹…absentâ‹…ğ’œ\boldsymbol{\hat{\Sigma}}(\boldsymbol{X}_{(\cdot\cdot)\mathcal{A}})overbold_^
start_ARG bold_Î£ end_ARG ( bold_italic_X start_POSTSUBSCRIPT ( â‹… â‹… )
caligraphic_A end_POSTSUBSCRIPT ) is invertible and 0 otherwise, where
Î²^^ğ›½\hat{\beta}over^ start_ARG italic_Î² end_ARG is the bridge estimator of
Kock [2013, Section 3]. Let ğ’®^N:={j:Î²^Nâ¢jâ‰
0}assignsubscript^ğ’®ğ‘conditional-
setğ‘—subscript^ğ›½ğ‘ğ‘—0\hat{\mathcal{S}}_{N}:=\\{j:\hat{\beta}_{Nj}\neq
0\\}over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT := { italic_j : over^ start_ARG italic_Î² end_ARG
start_POSTSUBSCRIPT italic_N italic_j end_POSTSUBSCRIPT â‰ 0 } be the
estimated selected set on a data set of size Nğ‘Nitalic_N, and suppose Î²0â‰
ğŸsubscriptğ›½00\beta_{0}\neq\boldsymbol{0}italic_Î² start_POSTSUBSCRIPT 0
end_POSTSUBSCRIPT â‰ bold_0. Then if ğœ¶â¢(ğ’®)â‰
ğŸğœ¶ğ’®0\boldsymbol{\alpha}(\mathcal{S})\neq\boldsymbol{0}bold_italic_Î± (
caligraphic_S ) â‰ bold_0, the sequence
{Ubâ¢(ğ’®^N)}subscriptğ‘ˆğ‘subscript^ğ’®ğ‘\\{U_{b}(\hat{\mathcal{S}}_{N})\\}{
italic_U start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( over^ start_ARG
caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) }
converges in distribution to a standard Gaussian random variable.

    3. (c)

(Asymptotic normality when coefficients equal to 0 are included and the
weights are estimated.) For any
ğ’œâˆˆğ’«â¢(â„•)ğ’œğ’«â„•\mathcal{A}\in\mathcal{P}(\mathbb{N})caligraphic_A
âˆˆ caligraphic_P ( blackboard_N ), suppose that
ğœ¶^Nâ¢(ğ’œN)subscriptbold-^ğœ¶ğ‘subscriptğ’œğ‘\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) is a random vector with the property that for a given data
set,
ğ’œ=ğ’œâ€²ğ’œsuperscriptğ’œâ€²\mathcal{A}=\mathcal{A}^{\prime}caligraphic_A =
caligraphic_A start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT implies
ğœ¶^Nâ¢(ğ’œ)=ğœ¶^Nâ¢(ğ’œâ€²)subscriptbold-^ğœ¶ğ‘ğ’œsubscriptbold-^ğœ¶ğ‘superscriptğ’œâ€²\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A})=\boldsymbol{\hat{\alpha}}_{N}(%
\mathcal{A}^{\prime})overbold_^ start_ARG bold_italic_Î± end_ARG
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) = overbold_^
start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUPERSCRIPT â€²
end_POSTSUPERSCRIPT ). Define the sequence of random vectors
{ğ^Nâ¢(ğ’œN)}N=1âˆsuperscriptsubscriptsubscriptbold-^ğğ‘subscriptğ’œğ‘ğ‘1\\{\boldsymbol{\hat{\psi}}_{N}(\mathcal{A}_{N})\\}_{N=1}^{\infty}{
overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT âˆ end_POSTSUPERSCRIPT to have components in
ğ’œNsubscriptğ’œğ‘\mathcal{A}_{N}caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT equal to
ğœ¶^Nâ¢(ğ’œN)subscriptbold-^ğœ¶ğ‘subscriptğ’œğ‘\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) and components
{ğ’ƒ^Nâ¢(ğ’œN)}N=1âˆsuperscriptsubscriptsubscriptbold-^ğ’ƒğ‘subscriptğ’œğ‘ğ‘1\\{\boldsymbol{\hat{b}}_{N}(\mathcal{A}_{N})\\}_{N=1}^{\infty}{
overbold_^ start_ARG bold_italic_b end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT âˆ end_POSTSUPERSCRIPT in the components corresponding
to
[pN]âˆ–ğ’œNdelimited-[]subscriptğ‘ğ‘subscriptğ’œğ‘[p_{N}]\setminus\mathcal{A}_{N}[
italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] âˆ– caligraphic_A
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT that are all almost surely
finite for all Nğ‘Nitalic_N (but are otherwise arbitrary). Assume that for any
fixed
Î²0âˆˆâ„pNsubscriptğ›½0superscriptâ„subscriptğ‘ğ‘\beta_{0}\in\mathbb{R}^{p_{N}}italic_Î²
start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT
italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT
with the kğ‘˜kitalic_k entries in the ğ’®ğ’®\mathcal{S}caligraphic_S positions
finite and the remaining entries all equal to 0,

| Nâ¢Tâ¢Î²0âŠ¤â¢(ğ^Nâ¢(ğ’®)âˆ’ğNâ¢(ğ’®))â†’ğ‘‘ğ’©â¢(0,vÏˆâ¢(Î²0,ğ’®)).ğ‘‘â†’ğ‘ğ‘‡superscriptsubscriptğ›½0topsubscriptbold-^ğğ‘ğ’®subscriptğğ‘ğ’®ğ’©0subscriptğ‘£ğœ“subscriptğ›½0ğ’®\sqrt{NT}\beta_{0}^{\top}\left(\boldsymbol{\hat{\psi}}_{N}(\mathcal{S})-% \boldsymbol{\psi}_{N}(\mathcal{S})\right)\xrightarrow{d}\mathcal{N}(0,v_{\psi}% (\beta_{0},\mathcal{S})).square-root start_ARG italic_N italic_T end_ARG italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) ) . |   
---|---|---  
  
Define the sequence of random variables
Ucâ¢(ğ’œ)subscriptğ‘ˆğ‘ğ’œU_{c}(\mathcal{A})italic_U start_POSTSUBSCRIPT
italic_c end_POSTSUBSCRIPT ( caligraphic_A ) to equal

| Nâ¢Tâ¢(ğ^Nâ¢(ğ’œ)âŠ¤â¢Î²^Nâˆ’ğNâ¢(ğ’œ)â¢Î²0),ğ‘ğ‘‡subscriptbold-^ğğ‘superscriptğ’œtopsubscript^ğ›½ğ‘subscriptğğ‘ğ’œsubscriptğ›½0\sqrt{NT}\left(\boldsymbol{\hat{\psi}}_{N}(\mathcal{A})^{\top}\hat{\beta}_{N}-% \boldsymbol{\psi}_{N}(\mathcal{A})\beta_{0}\right),square-root start_ARG italic_N italic_T end_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) , |   
---|---|---  
  
where Î²^Nsubscript^ğ›½ğ‘\hat{\beta}_{N}over^ start_ARG italic_Î² end_ARG
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT is the bridge estimator of Kock
[2013, Section 3]. Assume
ğœ¶^Nâ¢(ğ’œN)subscriptbold-^ğœ¶ğ‘subscriptğ’œğ‘\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) is independent of Î²^Nsubscript^ğ›½ğ‘\hat{\beta}_{N}over^
start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT.
Let ğ’®^N:={j:Î²^Nâ¢jâ‰ 0}assignsubscript^ğ’®ğ‘conditional-
setğ‘—subscript^ğ›½ğ‘ğ‘—0\hat{\mathcal{S}}_{N}:=\\{j:\hat{\beta}_{Nj}\neq
0\\}over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT := { italic_j : over^ start_ARG italic_Î² end_ARG
start_POSTSUBSCRIPT italic_N italic_j end_POSTSUBSCRIPT â‰ 0 } be the
estimated selected set on a data set of size Nğ‘Nitalic_N, and suppose Î²0â‰
ğŸsubscriptğ›½00\beta_{0}\neq\boldsymbol{0}italic_Î² start_POSTSUBSCRIPT 0
end_POSTSUBSCRIPT â‰ bold_0. Then

| Ucâ¢(ğ’®^N)â†’ğ‘‘ğ’©â¢(0,Ïƒ2â¢ğœ¶âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶+vÏˆâ¢(Î²0,ğ’®)).ğ‘‘â†’subscriptğ‘ˆğ‘subscript^ğ’®ğ‘ğ’©0superscriptğœ2superscriptğœ¶topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶subscriptğ‘£ğœ“subscriptğ›½0ğ’®U_{c}(\hat{\mathcal{S}}_{N})\xrightarrow{d}\mathcal{N}\left(0,\sigma^{2}% \boldsymbol{\alpha}^{\top}\left(\lim_{N\to\infty}\mathbb{E}\left[\Sigma_{1N}% \right]\right)^{-1}\boldsymbol{\alpha}+v_{\psi}(\beta_{0},\mathcal{S})\right).italic_U start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± + italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) ) . |   
---|---|---  
  
    4. (d)

(Asymptotic normality when coefficients equal to 0 are included and the
weights, covariance matrix, and selected set are estimated.) Define
ğœ¶^Nâ¢(ğ’œN)subscriptbold-^ğœ¶ğ‘subscriptğ’œğ‘\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) and the sequence of random vectors
{ğ^Nâ¢(ğ’œN)}N=1âˆsuperscriptsubscriptsubscriptbold-^ğğ‘subscriptğ’œğ‘ğ‘1\\{\boldsymbol{\hat{\psi}}_{N}(\mathcal{A}_{N})\\}_{N=1}^{\infty}{
overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT âˆ end_POSTSUPERSCRIPT as in part (c)ğ‘(c)( italic_c ),
and assume they have the same properties. Define the sequence of random
variables Udâ¢(ğ’œ)subscriptğ‘ˆğ‘‘ğ’œU_{d}(\mathcal{A})italic_U
start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( caligraphic_A ) to equal

| Nâ¢Tv^Nâ¢(ğ’œ)â¢(ğ^Nâ¢(ğ’œ)âŠ¤â¢Î²^Nâˆ’ğNâ¢(ğ’œ)âŠ¤â¢Î²0)ğ‘ğ‘‡subscript^ğ‘£ğ‘ğ’œsubscriptbold-^ğğ‘superscriptğ’œtopsubscript^ğ›½ğ‘subscriptğğ‘superscriptğ’œtopsubscriptğ›½0\sqrt{\frac{NT}{\hat{v}_{N}(\mathcal{A})}}\left(\boldsymbol{\hat{\psi}}_{N}(% \mathcal{A})^{\top}\hat{\beta}_{N}-\boldsymbol{\psi}_{N}(\mathcal{A})^{\top}% \beta_{0}\right)square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) end_ARG end_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) |   
---|---|---  
  
if ğ’œâ‰ âˆ…,ğšº^â¢(ğ‘¿(â‹…â‹…)â£ğ’œ)â¢Â is invertible, andÂ â¢ğœ¶^Nâ¢(ğ’œ)â‰
ğŸformulae-sequenceğ’œbold-^ğšºsubscriptğ‘¿â‹…absentâ‹…ğ’œÂ is invertible,
andÂ
subscriptbold-^ğœ¶ğ‘ğ’œ0\mathcal{A}\neq\emptyset,\boldsymbol{\hat{\Sigma}}(\boldsymbol{X}_{(\cdot\cdot%
)\mathcal{A}})\text{ is invertible, and }\boldsymbol{\hat{\alpha}}_{N}(%
\mathcal{A})\neq\boldsymbol{0}caligraphic_A â‰ âˆ… , overbold_^ start_ARG
bold_Î£ end_ARG ( bold_italic_X start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_A
end_POSTSUBSCRIPT ) is invertible, and overbold_^ start_ARG bold_italic_Î±
end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) â‰
bold_0; and equals 0 otherwise; where Î²^Nsubscript^ğ›½ğ‘\hat{\beta}_{N}over^
start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT is
the bridge estimator of Kock [2013, Section 3],

| v^Nâ¢(ğ’œ):=Ïƒ2â¢ğœ¶^â¢(ğ’œ)âŠ¤â¢(ğšº^â¢(ğ‘¿(â‹…â‹…)â£ğ’œ))âˆ’1â¢ğœ¶^â¢(ğ’œ)+v^Ïˆâ¢(Î²^N,ğ’œ),assignsubscript^ğ‘£ğ‘ğ’œsuperscriptğœ2bold-^ğœ¶superscriptğ’œtopsuperscriptbold-^ğšºsubscriptğ‘¿â‹…absentâ‹…ğ’œ1bold-^ğœ¶ğ’œsubscript^ğ‘£ğœ“subscript^ğ›½ğ‘ğ’œ\hat{v}_{N}(\mathcal{A}):=\sigma^{2}\boldsymbol{\hat{\alpha}}(\mathcal{A})^{% \top}\left(\boldsymbol{\hat{\Sigma}}(\boldsymbol{X}_{(\cdot\cdot)\mathcal{A}})% \right)^{-1}\boldsymbol{\hat{\alpha}}(\mathcal{A})+\hat{v}_{\psi}(\hat{\beta}_% {N},\mathcal{A}),over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) := italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_X start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_A end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A ) + over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , caligraphic_A ) , |  | (F.4)  
---|---|---|---  
  
and
v^Ïˆâ¢(Î²^N,ğ’œ)subscript^ğ‘£ğœ“subscript^ğ›½ğ‘ğ’œ\hat{v}_{\psi}(\hat{\beta}_{N},\mathcal{A})over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT (
over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT , caligraphic_A ) is an estimator of
vÏˆâ¢(Î²0,ğ’œ)subscriptğ‘£ğœ“subscriptğ›½0ğ’œv_{\psi}(\beta_{0},\mathcal{A})italic_v
start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î²
start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_A ) that satisfies
v^Ïˆâ¢(Î²^N,ğ’®)â†’ğ‘vÏˆâ¢(Î²0,ğ’®)ğ‘â†’subscript^ğ‘£ğœ“subscript^ğ›½ğ‘ğ’®subscriptğ‘£ğœ“subscriptğ›½0ğ’®\hat{v}_{\psi}(\hat{\beta}_{N},\mathcal{S})\xrightarrow{p}v_{\psi}(\beta_{0},%
\mathcal{S})over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ
end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT , caligraphic_S ) start_ARROW overitalic_p â†’
end_ARROW italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î²
start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ). Assume
ğœ¶^Nâ¢(ğ’œN)subscriptbold-^ğœ¶ğ‘subscriptğ’œğ‘\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) is independent of Î²^Nsubscript^ğ›½ğ‘\hat{\beta}_{N}over^
start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT,
and suppose Î²0â‰ ğŸsubscriptğ›½00\beta_{0}\neq\boldsymbol{0}italic_Î²
start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT â‰ bold_0. Then
Udâ¢(ğ’®^N)subscriptğ‘ˆğ‘‘subscript^ğ’®ğ‘U_{d}(\hat{\mathcal{S}}_{N})italic_U
start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S
end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) converges in
distribution to a standard Gaussian random variable.

    5. (e)

(Asymptotic subgaussianity when coefficients equal to 0 are included and the
weights, covariance matrix, and selected set are estimated.) Let the sequence
of random variables Ueâ¢(ğ’œ)subscriptğ‘ˆğ‘’ğ’œU_{e}(\mathcal{A})italic_U
start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( caligraphic_A ) be defined
the same was as Udâ¢(ğ’œ)subscriptğ‘ˆğ‘‘ğ’œU_{d}(\mathcal{A})italic_U
start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( caligraphic_A ), except that
we assume that
ğœ¶^Nâ¢(ğ’œN)subscriptbold-^ğœ¶ğ‘subscriptğ’œğ‘\boldsymbol{\hat{\alpha}}_{N}(\mathcal{A}_{N})overbold_^
start_ARG bold_italic_Î± end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ) is estimated on the same data as
Î²^Nsubscript^ğ›½ğ‘\hat{\beta}_{N}over^ start_ARG italic_Î² end_ARG
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT, so they are not independent,
and we use a different variance estimator:

| Ueâ¢(ğ’œ):=Nâ¢Tv^N(cons)â¢(ğ’œ)â¢(ğ^Nâ¢(ğ’œ)âŠ¤â¢Î²^Nâˆ’ğNâ¢(ğ’œ)âŠ¤â¢Î²0)assignsubscriptğ‘ˆğ‘’ğ’œğ‘ğ‘‡superscriptsubscript^ğ‘£ğ‘consğ’œsubscriptbold-^ğğ‘superscriptğ’œtopsubscript^ğ›½ğ‘subscriptğğ‘superscriptğ’œtopsubscriptğ›½0U_{e}(\mathcal{A}):=\sqrt{\frac{NT}{\hat{v}_{N}^{(\text{cons})}(\mathcal{A})}}% \left(\boldsymbol{\hat{\psi}}_{N}(\mathcal{A})^{\top}\hat{\beta}_{N}-% \boldsymbol{\psi}_{N}(\mathcal{A})^{\top}\beta_{0}\right)italic_U start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( caligraphic_A ) := square-root start_ARG divide start_ARG italic_N italic_T end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( cons ) end_POSTSUPERSCRIPT ( caligraphic_A ) end_ARG end_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) |   
---|---|---  
  
(unless
v^N(cons)â¢(ğ’œ)superscriptsubscript^ğ‘£ğ‘consğ’œ\hat{v}_{N}^{(\text{cons})}(\mathcal{A})over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( cons ) end_POSTSUPERSCRIPT ( caligraphic_A ) is not
well-defined or equals 0, in which case
Ueâ¢(ğ’œ)=0subscriptğ‘ˆğ‘’ğ’œ0U_{e}(\mathcal{A})=0italic_U start_POSTSUBSCRIPT
italic_e end_POSTSUBSCRIPT ( caligraphic_A ) = 0), where

| v^N(cons)â¢(ğ’œ):=assignsuperscriptsubscript^ğ‘£ğ‘consğ’œabsent\displaystyle\hat{v}_{N}^{(\text{cons})}(\mathcal{A}):=\leavevmode\nobreak\ over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( cons ) end_POSTSUPERSCRIPT ( caligraphic_A ) := | Ïƒ2â¢ğœ¶^â¢(ğ’œ)âŠ¤â¢(ğšº^â¢(ğ‘¿(â‹…â‹…)â£ğ’œ))âˆ’1â¢ğœ¶^â¢(ğ’œ)+v^Ïˆâ¢(Î²^N,ğ’œ)superscriptğœ2bold-^ğœ¶superscriptğ’œtopsuperscriptbold-^ğšºsubscriptğ‘¿â‹…absentâ‹…ğ’œ1bold-^ğœ¶ğ’œsubscript^ğ‘£ğœ“subscript^ğ›½ğ‘ğ’œ\displaystyle\sigma^{2}\boldsymbol{\hat{\alpha}}(\mathcal{A})^{\top}\left(% \boldsymbol{\hat{\Sigma}}(\boldsymbol{X}_{(\cdot\cdot)\mathcal{A}})\right)^{-1% }\boldsymbol{\hat{\alpha}}(\mathcal{A})+\hat{v}_{\psi}(\hat{\beta}_{N},% \mathcal{A})italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_X start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_A end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A ) + over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , caligraphic_A ) |   
---|---|---|---  
|  | +2â¢Ïƒ2â¢ğœ¶^â¢(ğ’œ)âŠ¤â¢(ğšº^â¢(ğ‘¿(â‹…â‹…)â£ğ’œ))âˆ’1â¢ğœ¶^â¢(ğ’œ)â‹…v^Ïˆâ¢(Î²^N,ğ’œ)2â‹…superscriptğœ2bold-^ğœ¶superscriptğ’œtopsuperscriptbold-^ğšºsubscriptğ‘¿â‹…absentâ‹…ğ’œ1bold-^ğœ¶ğ’œsubscript^ğ‘£ğœ“subscript^ğ›½ğ‘ğ’œ\displaystyle+2\sqrt{\sigma^{2}\boldsymbol{\hat{\alpha}}(\mathcal{A})^{\top}% \left(\boldsymbol{\hat{\Sigma}}(\boldsymbol{X}_{(\cdot\cdot)\mathcal{A}})% \right)^{-1}\boldsymbol{\hat{\alpha}}(\mathcal{A})\cdot\hat{v}_{\psi}(\hat{% \beta}_{N},\mathcal{A})}\+ 2 square-root start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_X start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_A end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_A ) â‹… over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , caligraphic_A ) end_ARG |  | (F.5)  
  
is a conservative variance estimator. Assume again that
v^Ïˆâ¢(Î²^N,ğ’®)â†’ğ‘vÏˆâ¢(Î²0,ğ’®)ğ‘â†’subscript^ğ‘£ğœ“subscript^ğ›½ğ‘ğ’®subscriptğ‘£ğœ“subscriptğ›½0ğ’®\hat{v}_{\psi}(\hat{\beta}_{N},\mathcal{S})\xrightarrow{p}v_{\psi}(\beta_{0},%
\mathcal{S})over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ
end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT , caligraphic_S ) start_ARROW overitalic_p â†’
end_ARROW italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î²
start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) and Î²0â‰
ğŸsubscriptğ›½00\beta_{0}\neq\boldsymbol{0}italic_Î² start_POSTSUBSCRIPT 0
end_POSTSUBSCRIPT â‰ bold_0. Then
Ueâ¢(ğ’®^N)subscriptğ‘ˆğ‘’subscript^ğ’®ğ‘U_{e}(\hat{\mathcal{S}}_{N})italic_U
start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S
end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) converges in
distribution to a mean-zero subgaussian random variable with variance at most
1.

###### Proof.

Provided in Appendix H. âˆ

######  Remark F.2.

It appears that the strategies used to prove Theorem F.5 could be used to
analogously extend Theorem 2(ii) in Huang etÂ al. [2008].

It only remains to show that the assumptions of Theorem F.5 are satisfied in
our setting. First, we note that Kock [2013] states on p. 123 that a fixed
Tğ‘‡Titalic_T is enough to satisfy the last two assumptions of Theorem 2(ii).
We have already shown that Assumptions (FE1), (FE2), (FE3), (RE4), (A1), (A3),
(A4), (A5), (A6), and (A7) in Kock [2013] are satisfied. Due to Theorem 3(i)
from Kock [2013], our fixed Tğ‘‡Titalic_T setting ensures that the uniform
integrability assumption of Theorem 2(ii) from Kock [2013] is satisfied. We
have assumed fixed sparsity in Assumption S(sğ‘ sitalic_s), and on p. 122 Kock
[2013] explains why our fixed Tğ‘‡Titalic_T setting satisfies all of the
remaining assumptions except for (A2).

We conclude by showing that the conditions implied by Assumption (A2) in Kock
[2013] are satisfied. Kock [2013] makes an assumption that the minimum
eigenvalue of the empirical Gram matrix of the columns of
ğ’â¢ğ‘«Nâˆ’1ğ’superscriptsubscriptğ‘«ğ‘1\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}bold_italic_Z
bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT corresponding to the nonzero
features in
ğœ½Nâˆ—superscriptsubscriptğœ½ğ‘\boldsymbol{\theta}_{N}^{*}bold_italic_Î¸
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT,

| 1Nâ¢Tâ¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®)âŠ¤â¢(ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®,1ğ‘ğ‘‡superscriptsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…ğ’®topsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…ğ’®\frac{1}{NT}\left((\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot\cdot)% \mathcal{S}}\right)^{\top}(\boldsymbol{Z}\boldsymbol{D}_{N}^{-1})_{(\cdot\cdot% )\mathcal{S}},divide start_ARG 1 end_ARG start_ARG italic_N italic_T end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT , |   
---|---|---  
  
is bounded away from 0 almost surely. Call this minimum eigenvalue
e1â¢ğ’®â¢Nsubscriptğ‘’1ğ’®ğ‘e_{1\mathcal{S}N}italic_e start_POSTSUBSCRIPT 1
caligraphic_S italic_N end_POSTSUBSCRIPT. This assumption is used in two
places, both in the proof of Theorem 2(ii).

    1. (a)

On p. 142, this assumption is used to establish that

| q2â¢1e1â¢ğ’®â¢Nâ¢(b02)qâˆ’1â¢Î»Nâ¢sNNâ¢Tâ†’ğ‘ğ‘â†’ğ‘21subscriptğ‘’1ğ’®ğ‘superscriptsubscriptğ‘02ğ‘1subscriptğœ†ğ‘subscriptğ‘ ğ‘ğ‘ğ‘‡absent\displaystyle\frac{q}{2}\frac{1}{e_{1\mathcal{S}N}}\left(\frac{b_{0}}{2}\right% )^{q-1}\lambda_{N}\sqrt{\frac{s_{N}}{NT}}\xrightarrow{p}\leavevmode\nobreak\ divide start_ARG italic_q end_ARG start_ARG 2 end_ARG divide start_ARG 1 end_ARG start_ARG italic_e start_POSTSUBSCRIPT 1 caligraphic_S italic_N end_POSTSUBSCRIPT end_ARG ( divide start_ARG italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG ) start_POSTSUPERSCRIPT italic_q - 1 end_POSTSUPERSCRIPT italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT square-root start_ARG divide start_ARG italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG italic_N italic_T end_ARG end_ARG start_ARROW overitalic_p â†’ end_ARROW | 00\displaystyle 0 |   
---|---|---|---  
| â‡”1e1â¢ğ’®â¢Nâ¢Î»NNâ†’ğ‘iffabsentğ‘â†’1subscriptğ‘’1ğ’®ğ‘subscriptğœ†ğ‘ğ‘absent\displaystyle\iff\frac{1}{e_{1\mathcal{S}N}}\frac{\lambda_{N}}{\sqrt{N}}% \xrightarrow{p}\leavevmode\nobreak\ â‡” divide start_ARG 1 end_ARG start_ARG italic_e start_POSTSUBSCRIPT 1 caligraphic_S italic_N end_POSTSUBSCRIPT end_ARG divide start_ARG italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG start_ARROW overitalic_p â†’ end_ARROW | 00\displaystyle 0 |   
| â‡”1e1â¢ğ’®â¢Nâˆˆiffabsent1subscriptğ‘’1ğ’®ğ‘absent\displaystyle\iff\frac{1}{e_{1\mathcal{S}N}}\in\leavevmode\nobreak\ â‡” divide start_ARG 1 end_ARG start_ARG italic_e start_POSTSUBSCRIPT 1 caligraphic_S italic_N end_POSTSUBSCRIPT end_ARG âˆˆ | oâ„™â¢(NÎ»N),subscriptğ‘œâ„™ğ‘subscriptğœ†ğ‘\displaystyle o_{\mathbb{P}}\left(\frac{\sqrt{N}}{\lambda_{N}}\right),italic_o start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG square-root start_ARG italic_N end_ARG end_ARG start_ARG italic_Î» start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG ) , |   
  
where the first equivalence follows because the removed quantities are
constant under our assumptions (specifically, that Tğ‘‡Titalic_T and
sNsubscriptğ‘ ğ‘s_{N}italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
are fixed). Note that our assumption (6.5) ensures that this condition holds
for the full empirical Gram matrix due to Lemma F.3. The minimum eigenvalue of
the full empirical Gram matrix lower bounds
e1â¢ğ’®â¢Nsubscriptğ‘’1ğ’®ğ‘e_{1\mathcal{S}N}italic_e start_POSTSUBSCRIPT 1
caligraphic_S italic_N end_POSTSUBSCRIPT, so (6.5) is sufficient for this
condition to hold.

    2. (b)

The assumption is used again on p. 144 of Kock [2013], where it is sufficient
for the minimum eigenvalue of the (population) matrix

| ğ”¼â¢[ğšº^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®)]ğ”¼delimited-[]bold-^ğšºsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…ğ’®\mathbb{E}\left[\boldsymbol{\hat{\Sigma}}\left(\left(\boldsymbol{Z}\boldsymbol% {D}_{N}^{-1}\right)_{(\cdot\cdot)\mathcal{S}}\right)\right]blackboard_E [ overbold_^ start_ARG bold_Î£ end_ARG ( ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT ) ] |  | (F.6)  
---|---|---|---  
  
to be bounded away from 0. This is a submatrix of (6.4), so the minimum
eigenvalue of (6.4) is a lower bound for the minimum eigenvalue of
ğ”¼â¢[ğšº^â¢((ğ’â¢ğ‘«Nâˆ’1)(â‹…â‹…)â£ğ’®)]ğ”¼delimited-[]bold-^ğšºsubscriptğ’superscriptsubscriptğ‘«ğ‘1â‹…absentâ‹…ğ’®\mathbb{E}\left[\boldsymbol{\hat{\Sigma}}\left(\left(\boldsymbol{Z}\boldsymbol%
{D}_{N}^{-1}\right)_{(\cdot\cdot)\mathcal{S}}\right)\right]blackboard_E [
overbold_^ start_ARG bold_Î£ end_ARG ( ( bold_italic_Z bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S
end_POSTSUBSCRIPT ) ]. Therefore our assumption in (R6) that the minimum
eigenvalue of (6.4) is bounded away from 0 is enough to satisfy this
assumption.

So our Assumption (R6), in combination with all of the previous assumptions,
is enough to apply Theorem F.5, and the proof is complete.

##  Appendix G Proofs of Results Stated in the Appendix

In Appendix G.1 we prove results that were stated but not proven in Appendix
A. In Appendix G.2 we prove supporting results for our main theorems.

###  G.1 Proofs of Results from Appendix A

###### Proof of Theorem A.2.

First we provide a counterexample to show that (CCTS) does not imply (CTS).
This counterexample is inspired by discussions in Sections 2 and 3 of Callaway
and Karami [2023] that touch on closely related issues. For simplicity, let
T=2ğ‘‡2T=2italic_T = 2 and â„›={2}â„›2\mathcal{R}=\\{2\\}caligraphic_R = { 2
}. Assume that treatment status is not independent of the covariates, so
ğ”¼â¢[ğ‘¿iâˆ£Wi=2]â‰
ğ”¼â¢[ğ‘¿iâˆ£Wi=0]ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–2ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–0\mathbb{E}[\boldsymbol{X}_{i}\mid
W_{i}=2]\neq\mathbb{E}[\boldsymbol{X}_{i}% \mid W_{i}=0]blackboard_E [
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 2 ] â‰ blackboard_E [
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ]. Consider a setting where
(3.5) from Assumption (LINS) holds with ğƒ2âˆ—â‰
ğŸsuperscriptsubscriptğƒ20\boldsymbol{\xi}_{2}^{*}\neq\boldsymbol{0}bold_italic_Î¾
start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT â‰ bold_0:

| ğ”¼â¢[y~(iâ¢2)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i]=Î³2âˆ—+ğ‘¿iâŠ¤â¢ğƒ2âˆ—a.s.,formulae-sequenceğ”¼delimited-[]subscript~ğ‘¦ğ‘–20conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–superscriptsubscriptğ›¾2superscriptsubscriptğ‘¿ğ‘–topsuperscriptsubscriptğƒ2ğ‘ğ‘ \mathbb{E}\left[\tilde{y}_{(i2)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,% \boldsymbol{X}_{i}\right]=\gamma_{2}^{*}+\boldsymbol{X}_{i}^{\top}\boldsymbol{% \xi}_{2}^{*}\qquad a.s.,blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 2 ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = italic_Î³ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT italic_a . italic_s . , |   
---|---|---  
  
and the same condition holds for the untreated potential outcomes of the
treated units:

| ğ”¼â¢[y~(iâ¢2)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=2,ğ‘¿i]=Î³2âˆ—+ğ‘¿iâŠ¤â¢ğƒ2âˆ—a.s.formulae-sequenceğ”¼delimited-[]subscript~ğ‘¦ğ‘–20conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–2subscriptğ‘¿ğ‘–superscriptsubscriptğ›¾2superscriptsubscriptğ‘¿ğ‘–topsuperscriptsubscriptğƒ2ğ‘ğ‘ \mathbb{E}\left[\tilde{y}_{(i2)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=2,% \boldsymbol{X}_{i}\right]=\gamma_{2}^{*}+\boldsymbol{X}_{i}^{\top}\boldsymbol{% \xi}_{2}^{*}\qquad a.s.blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 2 ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 2 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = italic_Î³ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT italic_a . italic_s . |   
---|---|---  
  
(CCTS) holds since
ğ”¼â¢[y~(iâ¢2)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=2,ğ‘¿i]=ğ”¼â¢[y~(iâ¢2)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i]ğ”¼delimited-[]subscript~ğ‘¦ğ‘–20conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–2subscriptğ‘¿ğ‘–ğ”¼delimited-[]subscript~ğ‘¦ğ‘–20conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–\mathbb{E}[\tilde{y}_{(i2)}(0)-\tilde{y}_{(i1)}(0)\mid
W_{i}=2,\boldsymbol{X}_%
{i}]=\mathbb{E}[\tilde{y}_{(i2)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,%
\boldsymbol{X}_{i}]blackboard_E [ over~ start_ARG italic_y end_ARG
start_POSTSUBSCRIPT ( italic_i 2 ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG
italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 )
âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 2 ,
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = blackboard_E
[ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 2 )
end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT
( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT ] almost surely. But for râˆˆ{0,2}ğ‘Ÿ02r\in\\{0,2\\}italic_r
âˆˆ { 0 , 2 },

| ğ”¼â¢[y~(iâ¢2)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r]=ğ”¼delimited-[]subscript~ğ‘¦ğ‘–20conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿabsent\displaystyle\mathbb{E}[\tilde{y}_{(i2)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=r]=% \leavevmode\nobreak\ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 2 ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] = | ğ”¼â¢[ğ”¼â¢[y~(iâ¢2)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r,ğ‘¿i]âˆ£Wi=r]ğ”¼delimited-[]conditionalğ”¼delimited-[]subscript~ğ‘¦ğ‘–20conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\displaystyle\mathbb{E}\left[\mathbb{E}\left[\tilde{y}_{(i2)}(0)-\tilde{y}_{(i% 1)}(0)\mid W_{i}=r,\boldsymbol{X}_{i}\right]\mid W_{i}=r\right]blackboard_E [ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 2 ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | Î³2âˆ—+ğ”¼â¢[ğ‘¿iâˆ£Wi=r]âŠ¤â¢ğƒ2âˆ—,superscriptsubscriptğ›¾2ğ”¼superscriptdelimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsuperscriptsubscriptğƒ2\displaystyle\gamma_{2}^{*}+\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]^{\top}% \boldsymbol{\xi}_{2}^{*},italic_Î³ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , |   
  
so ğ”¼â¢[y~(iâ¢2)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=2]â‰
ğ”¼â¢[y~(iâ¢2)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0]ğ”¼delimited-[]subscript~ğ‘¦ğ‘–20conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–2ğ”¼delimited-[]subscript~ğ‘¦ğ‘–20conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0\mathbb{E}[\tilde{y}_{(i2)}(0)-\tilde{y}_{(i1)}(0)\mid
W_{i}=2]\neq\mathbb{E}[% \tilde{y}_{(i2)}(0)-\tilde{y}_{(i1)}(0)\mid
W_{i}=0]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT (
italic_i 2 ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG
start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 2 ] â‰ blackboard_E [ over~
start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 2 )
end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT
( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT = 0 ] since ğ”¼â¢[ğ‘¿iâˆ£Wi=2]â‰
ğ”¼â¢[ğ‘¿iâˆ£Wi=0]ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–2ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–0\mathbb{E}[\boldsymbol{X}_{i}\mid
W_{i}=2]\neq\mathbb{E}[\boldsymbol{X}_{i}% \mid W_{i}=0]blackboard_E [
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 2 ] â‰ blackboard_E [
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ].

Next we show an example where (CTS) holds but (CCTS) does not. Let
â„›={2,â€¦,T}â„›2â€¦ğ‘‡\mathcal{R}=\\{2,\ldots,T\\}caligraphic_R = { 2 , â€¦ ,
italic_T }, and suppose ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT has a discrete distribution,
only taking on values ğ’™1subscriptğ’™1\boldsymbol{x}_{1}bold_italic_x
start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT and
ğ’™2subscriptğ’™2\boldsymbol{x}_{2}bold_italic_x start_POSTSUBSCRIPT 2
end_POSTSUBSCRIPT. To simplify notation, define
Giâ¢t:=y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)assignsubscriptğºğ‘–ğ‘¡subscript~ğ‘¦ğ‘–ğ‘¡0subscript~ğ‘¦ğ‘–10G_{it}:=\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)italic_G
start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT := over~ start_ARG
italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT (
0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 )
end_POSTSUBSCRIPT ( 0 ) for all
tâˆˆ{2,â€¦,T}ğ‘¡2â€¦ğ‘‡t\in\\{2,\ldots,T\\}italic_t âˆˆ { 2 , â€¦ , italic_T
}. Then (CTS) is equivalent to

| ğ”¼â¢[Giâ¢tâˆ£Wi]=ğ”¼delimited-[]conditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–absent\displaystyle\mathbb{E}[G_{it}\mid W_{i}]=\leavevmode\nobreak\ blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = | ğ”¼â¢[Giâ¢t],iâˆˆ[N],tâˆˆ{2,â€¦,T}formulae-sequenceğ”¼delimited-[]subscriptğºğ‘–ğ‘¡ğ‘–delimited-[]ğ‘ğ‘¡2â€¦ğ‘‡\displaystyle\mathbb{E}[G_{it}],\qquad i\in[N],t\in\\{2,\ldots,T\\}blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT ] , italic_i âˆˆ [ italic_N ] , italic_t âˆˆ { 2 , â€¦ , italic_T } |   
---|---|---|---  
| â‡”ğ”¼â¢[Giâ¢tâˆ£Wi=0]=iffğ”¼delimited-[]conditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–0absent\displaystyle\iff\qquad\mathbb{E}[G_{it}\mid W_{i}=0]=\leavevmode\nobreak\ â‡” blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] = | ğ”¼â¢[Giâ¢tâˆ£Wi=r],râˆˆâ„›,iâˆˆ[N],tâˆˆ{2,â€¦,T}formulae-sequenceğ”¼delimited-[]conditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–ğ‘Ÿğ‘Ÿâ„›formulae-sequenceğ‘–delimited-[]ğ‘ğ‘¡2â€¦ğ‘‡\displaystyle\mathbb{E}[G_{it}\mid W_{i}=r],\qquad r\in\mathcal{R},i\in[N],t% \in\\{2,\ldots,T\\}blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] , italic_r âˆˆ caligraphic_R , italic_i âˆˆ [ italic_N ] , italic_t âˆˆ { 2 , â€¦ , italic_T } |  | (G.1)  
  
and (CCTS) is equivalent to, for all iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i
âˆˆ [ italic_N ] and tâˆˆ{2,â€¦,T}ğ‘¡2â€¦ğ‘‡t\in\\{2,\ldots,T\\}italic_t âˆˆ {
2 , â€¦ , italic_T },

| ğ”¼â¢[Giâ¢tâˆ£Wi,ğ‘¿i]=ğ”¼delimited-[]conditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–absent\displaystyle\mathbb{E}[G_{it}\mid W_{i},\boldsymbol{X}_{i}]=\leavevmode\nobreak\ blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = | ğ”¼â¢[Giâ¢tâˆ£ğ‘¿i]ğ”¼delimited-[]conditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘¿ğ‘–\displaystyle\mathbb{E}[G_{it}\mid\boldsymbol{X}_{i}]blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] |   
---|---|---|---  
| â‡”ğ”¼â¢[Giâ¢tâˆ£Wi=0,ğ‘¿i=ğ’™j]=iffğ”¼delimited-[]formulae-sequenceconditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–subscriptğ’™ğ‘—absent\displaystyle\iff\qquad\mathbb{E}[G_{it}\mid W_{i}=0,\boldsymbol{X}_{i}=% \boldsymbol{x}_{j}]=\leavevmode\nobreak\ â‡” blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ] = | ğ”¼â¢[Giâ¢tâˆ£Wi=r,ğ‘¿i=ğ’™j],jâˆˆ{1,2},râˆˆâ„›.formulae-sequenceğ”¼delimited-[]formulae-sequenceconditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–subscriptğ’™ğ‘—ğ‘—12ğ‘Ÿâ„›\displaystyle\mathbb{E}[G_{it}\mid W_{i}=r,\boldsymbol{X}_{i}=\boldsymbol{x}_{% j}],\qquad j\in\\{1,2\\},r\in\mathcal{R}.blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ] , italic_j âˆˆ { 1 , 2 } , italic_r âˆˆ caligraphic_R . |  | (G.2)  
  
Our goal is to construct an example where (G.1) holds and (G.2) does not hold.
Suppose that for some a>0ğ‘0a>0italic_a > 0, for all
iâˆˆ[N]ğ‘–delimited-[]ğ‘i\in[N]italic_i âˆˆ [ italic_N ],
tâˆˆ{2,â€¦,T}ğ‘¡2â€¦ğ‘‡t\in\\{2,\ldots,T\\}italic_t âˆˆ { 2 , â€¦ , italic_T }

| ğ”¼â¢[Giâ¢tâˆ£Wi=0,ğ‘¿i=ğ’™1]=ğ”¼delimited-[]formulae-sequenceconditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–subscriptğ’™1absent\displaystyle\mathbb{E}[G_{it}\mid W_{i}=0,\boldsymbol{X}_{i}=\boldsymbol{x}_{% 1}]=\leavevmode\nobreak\ blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] = | âˆ’a,ğ‘\displaystyle-a,\- italic_a , |   
---|---|---|---  
| ğ”¼â¢[Giâ¢tâˆ£Wi=r,ğ‘¿i=ğ’™1]=ğ”¼delimited-[]formulae-sequenceconditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–subscriptğ’™1absent\displaystyle\mathbb{E}[G_{it}\mid W_{i}=r,\boldsymbol{X}_{i}=\boldsymbol{x}_{% 1}]=\leavevmode\nobreak\ blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] = | âˆ’râ¢a,râˆˆâ„›,ğ‘Ÿğ‘ğ‘Ÿâ„›\displaystyle-ra,\qquad r\in\mathcal{R},\- italic_r italic_a , italic_r âˆˆ caligraphic_R , |   
| ğ”¼â¢[Giâ¢tâˆ£Wi=0,ğ‘¿i=ğ’™2]=ğ”¼delimited-[]formulae-sequenceconditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–subscriptğ’™2absent\displaystyle\mathbb{E}[G_{it}\mid W_{i}=0,\boldsymbol{X}_{i}=\boldsymbol{x}_{% 2}]=\leavevmode\nobreak\ blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] = | a,andğ‘and\displaystyle a,\qquad\text{and}italic_a , and |   
| ğ”¼â¢[Giâ¢tâˆ£Wi=r,ğ‘¿i=ğ’™2]=ğ”¼delimited-[]formulae-sequenceconditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–subscriptğ’™2absent\displaystyle\mathbb{E}[G_{it}\mid W_{i}=r,\boldsymbol{X}_{i}=\boldsymbol{x}_{% 2}]=\leavevmode\nobreak\ blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] = | râ¢a,râˆˆâ„›.ğ‘Ÿğ‘ğ‘Ÿâ„›\displaystyle ra,\qquad r\in\mathcal{R}.italic_r italic_a , italic_r âˆˆ caligraphic_R . |   
  
By inspection, one can see that (G.2) does not hold. We are done if we show
that (G.1) does. Suppose Wisubscriptğ‘Šğ‘–W_{i}italic_W start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT and
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT are independent: let
â„™â¢(Wi=w,ğ‘¿i=ğ’™j)=1/(2â¢[R+1])=1/(2â¢T)â„™formulae-
sequencesubscriptğ‘Šğ‘–ğ‘¤subscriptğ‘¿ğ‘–subscriptğ’™ğ‘—12delimited-[]ğ‘…112ğ‘‡\mathbb{P}(W_{i}=w,\boldsymbol{X}_{i}=\boldsymbol{x}_{j})=1/(2[R+1])=1/(2T)blackboard_P
( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_w ,
bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x
start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = 1 / ( 2 [ italic_R + 1 ] )
= 1 / ( 2 italic_T ) for
wâˆˆ{0}âˆªâ„›ğ‘¤0â„›w\in\\{0\\}\cup\mathcal{R}italic_w âˆˆ { 0 } âˆª
caligraphic_R and jâˆˆ{1,2}ğ‘—12j\in\\{1,2\\}italic_j âˆˆ { 1 , 2 }. We have

|  | ğ”¼â¢[Giâ¢tâˆ£Wi=0]ğ”¼delimited-[]conditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–0\displaystyle\mathbb{E}[G_{it}\mid W_{i}=0]blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | 1â„™â¢(Wi=0)(ğ”¼[Giâ¢tâˆ£Wi=0,ğ‘¿i=ğ’™1]â„™(Wi=0,ğ‘¿i=ğ’™1)\displaystyle\frac{1}{\mathbb{P}(W_{i}=0)}\big{(}\mathbb{E}[G_{it}\mid W_{i}=0% ,\boldsymbol{X}_{i}=\boldsymbol{x}_{1}]\mathbb{P}(W_{i}=0,\boldsymbol{X}_{i}=% \boldsymbol{x}_{1})divide start_ARG 1 end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ) end_ARG ( blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) |   
|  | +ğ”¼[Giâ¢tâˆ£Wi=0,ğ‘¿i=ğ’™2]â„™(Wi=0,ğ‘¿i=ğ’™2))\displaystyle+\mathbb{E}[G_{it}\mid W_{i}=0,\boldsymbol{X}_{i}=\boldsymbol{x}_% {2}]\mathbb{P}(W_{i}=0,\boldsymbol{X}_{i}=\boldsymbol{x}_{2})\big{)}\+ blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) |   
| =\displaystyle=\leavevmode\nobreak\ = | Tâ¢(âˆ’aâ‹…12â¢T+aâ‹…12â¢T)ğ‘‡â‹…ğ‘12ğ‘‡â‹…ğ‘12ğ‘‡\displaystyle T\left(-a\cdot\frac{1}{2T}+a\cdot\frac{1}{2T}\right)italic_T ( - italic_a â‹… divide start_ARG 1 end_ARG start_ARG 2 italic_T end_ARG + italic_a â‹… divide start_ARG 1 end_ARG start_ARG 2 italic_T end_ARG ) |   
| =\displaystyle=\leavevmode\nobreak\ = | 00\displaystyle 0 |   
  
and for any râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R,

|  | ğ”¼â¢[Giâ¢tâˆ£Wi=r]ğ”¼delimited-[]conditionalsubscriptğºğ‘–ğ‘¡subscriptğ‘Šğ‘–ğ‘Ÿ\displaystyle\mathbb{E}[G_{it}\mid W_{i}=r]blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | 1â„™â¢(Wi=r)(ğ”¼[Giâ¢tâˆ£Wi=r,ğ‘¿i=ğ’™1]â„™(Wi=r,ğ‘¿i=ğ’™1)\displaystyle\frac{1}{\mathbb{P}(W_{i}=r)}\big{(}\mathbb{E}[G_{it}\mid W_{i}=r% ,\boldsymbol{X}_{i}=\boldsymbol{x}_{1}]\mathbb{P}(W_{i}=r,\boldsymbol{X}_{i}=% \boldsymbol{x}_{1})divide start_ARG 1 end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) end_ARG ( blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) |   
|  | +ğ”¼[Giâ¢tâˆ£Wi=r,ğ‘¿i=ğ’™2]â„™(Wi=r,ğ‘¿i=ğ’™2))\displaystyle+\mathbb{E}[G_{it}\mid W_{i}=r,\boldsymbol{X}_{i}=\boldsymbol{x}_% {2}]\mathbb{P}(W_{i}=r,\boldsymbol{X}_{i}=\boldsymbol{x}_{2})\big{)}\+ blackboard_E [ italic_G start_POSTSUBSCRIPT italic_i italic_t end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) |   
| =\displaystyle=\leavevmode\nobreak\ = | Tâ¢(âˆ’râ¢aâ‹…12â¢T+râ¢aâ‹…12â¢T)ğ‘‡â‹…ğ‘Ÿğ‘12ğ‘‡â‹…ğ‘Ÿğ‘12ğ‘‡\displaystyle T\left(-ra\cdot\frac{1}{2T}+ra\cdot\frac{1}{2T}\right)italic_T ( - italic_r italic_a â‹… divide start_ARG 1 end_ARG start_ARG 2 italic_T end_ARG + italic_r italic_a â‹… divide start_ARG 1 end_ARG start_ARG 2 italic_T end_ARG ) |   
| =\displaystyle=\leavevmode\nobreak\ = | 0.0\displaystyle 0.0 . |   
  
âˆ

###### Proof of Theorem A.5(b) and (c).

For any râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R and
tâˆˆ{r,â€¦,T}ğ‘¡ğ‘Ÿâ€¦ğ‘‡t\in\\{r,\ldots,T\\}italic_t âˆˆ { italic_r , â€¦ ,
italic_T },

|  | Ï„râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡\displaystyle\tau_{rt}^{*}italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼â¢[Ï„râ¢tâˆ—+(ğ‘¿iâˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r])âŠ¤â¢ğ†râ¢tâˆ—âˆ£Wi=r]ğ”¼delimited-[]superscriptsubscriptğœğ‘Ÿğ‘¡conditionalsuperscriptsubscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsuperscriptsubscriptğ†ğ‘Ÿğ‘¡subscriptğ‘Šğ‘–ğ‘Ÿ\displaystyle\mathbb{E}[\tau_{rt}^{*}+\left(\boldsymbol{X}_{i}-\mathbb{E}\left% [\boldsymbol{X}_{i}\mid W_{i}=r\right]\right)^{\top}\boldsymbol{\rho}_{rt}^{*}% \mid W_{i}=r]blackboard_E [ italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |   
| =(a)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(a)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_a ) end_ARG end_RELOP | ğ”¼â¢[ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ’y~(iâ¢1)â¢(r)âˆ£Wi=r,ğ‘¿i]âˆ£Wi=r]âˆ’ğ”¼â¢[ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i]âˆ£Wi=r]ğ”¼delimited-[]conditionalğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿconditionalsubscript~ğ‘¦ğ‘–1ğ‘Ÿsubscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]conditionalğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\displaystyle\mathbb{E}\left[\mathbb{E}\left[\tilde{y}_{(it)}(r)-\tilde{y}_{(i% 1)}(r)\mid W_{i}=r,\boldsymbol{X}_{i}\right]\mid W_{i}=r\right]-\mathbb{E}% \left[\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,% \boldsymbol{X}_{i}\right]\mid W_{i}=r\right]blackboard_E [ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - blackboard_E [ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |   
| =(b)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(b)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_b ) end_ARG end_RELOP | ğ”¼[ğ”¼[y~(iâ¢t)(r)âˆ£Wi=r,ğ‘¿i]âˆ£Wi=r]âˆ’ğ”¼[(ğ”¼[y~(iâ¢1)(0)âˆ£Wi=r,ğ‘¿i]\displaystyle\mathbb{E}\left[\mathbb{E}[\tilde{y}_{(it)}(r)\mid W_{i}=r,% \boldsymbol{X}_{i}]\mid W_{i}=r\right]-\mathbb{E}\bigg{[}\bigg{(}\mathbb{E}[% \tilde{y}_{(i1)}(0)\mid W_{i}=r,\boldsymbol{X}_{i}]blackboard_E [ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - blackboard_E [ ( blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] |   
|  | +ğ”¼[y~(iâ¢t)(0)âˆ’y~(iâ¢1)(0)âˆ£Wi=0,ğ‘¿i])âˆ£Wi=r]\displaystyle+\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,% \boldsymbol{X}_{i}]\bigg{)}\mid W_{i}=r\bigg{]}\+ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |  | (G.3)  
| =(c)superscriptğ‘\displaystyle\stackrel{{\scriptstyle(c)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_c ) end_ARG end_RELOP | ğ”¼[ğ”¼[y~(iâ¢t)(r)âˆ£Wi=r,ğ‘¿i]âˆ£Wi=r]âˆ’ğ”¼[(ğ”¼[y~(iâ¢1)(0)âˆ£Wi=r,ğ‘¿i]\displaystyle\mathbb{E}\left[\mathbb{E}[\tilde{y}_{(it)}(r)\mid W_{i}=r,% \boldsymbol{X}_{i}]\mid W_{i}=r\right]-\mathbb{E}\bigg{[}\bigg{(}\mathbb{E}[% \tilde{y}_{(i1)}(0)\mid W_{i}=r,\boldsymbol{X}_{i}]blackboard_E [ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - blackboard_E [ ( blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] |   
|  | +ğ”¼[y~(iâ¢t)(0)âˆ’y~(iâ¢1)(0)âˆ£Wi=0])âˆ£Wi=r]\displaystyle+\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0]% \bigg{)}\mid W_{i}=r\bigg{]}\+ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |   
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ£Wi=r]âˆ’(ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi=r]+ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0])ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿsubscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}(r)\mid W_{i}=r\right]-\Big{(}% \mathbb{E}[\tilde{y}_{(i1)}(0)\mid W_{i}=r]+\mathbb{E}\left[\tilde{y}_{(it)}(0% )-\tilde{y}_{(i1)}(0)\mid W_{i}=0\right]\Big{)}blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - ( blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] + blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] ) |   
| =(d)superscriptğ‘‘\displaystyle\stackrel{{\scriptstyle(d)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_d ) end_ARG end_RELOP | ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ£Wi=r]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ£Wi=r]ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿsubscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡0subscriptğ‘Šğ‘–ğ‘Ÿ\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}(r)\mid W_{i}=r\right]-\mathbb{E}% \left[\tilde{y}_{(it)}(0)\mid W_{i}=r\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |   
| =\displaystyle=\leavevmode\nobreak\ = | Ï„ATTâ¢(r,t),subscriptğœATTğ‘Ÿğ‘¡\displaystyle\tau_{\text{ATT}}(r,t),italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) , |   
  
where in (a)ğ‘(a)( italic_a ) we used (3.6) from (LINS), in (b)ğ‘(b)( italic_b
) we used (CNAS), in (c)ğ‘(c)( italic_c ) we used (CIUN), and in (d)ğ‘‘(d)(
italic_d ) we used (CTSA). This proves part (b).

Next we prove part (c). Observe that under (3.5) and (3.6) from (LINS), for
any râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R and
tâˆˆ{r,â€¦,T}ğ‘¡ğ‘Ÿâ€¦ğ‘‡t\in\\{r,\ldots,T\\}italic_t âˆˆ { italic_r , â€¦ ,
italic_T }, starting from (G.3) we have

|  | Ï„râ¢tâˆ—superscriptsubscriptğœğ‘Ÿğ‘¡\displaystyle\tau_{rt}^{*}italic_Ï„ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼[ğ”¼[y~(iâ¢t)(r)âˆ£Wi=r,ğ‘¿i]âˆ£Wi=r]âˆ’ğ”¼[(ğ”¼[y~(iâ¢1)(0)âˆ£Wi=r,ğ‘¿i]\displaystyle\mathbb{E}\left[\mathbb{E}[\tilde{y}_{(it)}(r)\mid W_{i}=r,% \boldsymbol{X}_{i}]\mid W_{i}=r\right]-\mathbb{E}\bigg{[}\bigg{(}\mathbb{E}[% \tilde{y}_{(i1)}(0)\mid W_{i}=r,\boldsymbol{X}_{i}]blackboard_E [ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - blackboard_E [ ( blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] |   
|  | +ğ”¼[y~(iâ¢t)(0)âˆ’y~(iâ¢1)(0)âˆ£Wi=0,ğ‘¿i])âˆ£Wi=r]\displaystyle+\mathbb{E}[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,% \boldsymbol{X}_{i}]\bigg{)}\mid W_{i}=r\bigg{]}\+ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |   
| =(e)superscriptğ‘’\displaystyle\stackrel{{\scriptstyle(e)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_e ) end_ARG end_RELOP | ğ”¼[ğ”¼[y~(iâ¢t)(r)âˆ£Wi=r,ğ‘¿i]âˆ£Wi=r]âˆ’ğ”¼[(ğ”¼[y~(iâ¢1)(0)âˆ£Wi=r,ğ‘¿i]\displaystyle\mathbb{E}\left[\mathbb{E}[\tilde{y}_{(it)}(r)\mid W_{i}=r,% \boldsymbol{X}_{i}]\mid W_{i}=r\right]-\mathbb{E}\bigg{[}\bigg{(}\mathbb{E}[% \tilde{y}_{(i1)}(0)\mid W_{i}=r,\boldsymbol{X}_{i}]blackboard_E [ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - blackboard_E [ ( blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] |   
|  | +Î³tâˆ—+ğ‘¿iâŠ¤ğƒtâˆ—)âˆ£Wi=r]\displaystyle+\gamma_{t}^{*}+\boldsymbol{X}_{i}^{\top}\boldsymbol{\xi}_{t}^{*}% \bigg{)}\mid W_{i}=r\bigg{]}\+ italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |   
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ£Wi=r]âˆ’(ğ”¼â¢[y~(iâ¢1)â¢(0)âˆ£Wi=r]+Î³tâˆ—+ğ”¼â¢[ğ‘¿iâˆ£Wi=r]âŠ¤â¢ğƒtâˆ—)ğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿsubscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğ›¾ğ‘¡ğ”¼superscriptdelimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsuperscriptsubscriptğƒğ‘¡\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}(r)\mid W_{i}=r\right]-\left(% \mathbb{E}[\tilde{y}_{(i1)}(0)\mid W_{i}=r]+\gamma_{t}^{*}+\mathbb{E}[% \boldsymbol{X}_{i}\mid W_{i}=r]^{\top}\boldsymbol{\xi}_{t}^{*}\right)blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - ( blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] + italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
| =(f)superscriptğ‘“\displaystyle\stackrel{{\scriptstyle(f)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_f ) end_ARG end_RELOP | ğ”¼[y~(iâ¢t)(r)âˆ£Wi=r]âˆ’(ğ”¼[y~(iâ¢1)(0)âˆ£Wi=r]\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}(r)\mid W_{i}=r\right]-\Big{(}% \mathbb{E}[\tilde{y}_{(i1)}(0)\mid W_{i}=r]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - ( blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] |   
|  | +ğ”¼[y~(iâ¢t)(0)âˆ’y~(iâ¢1)(0)âˆ£Wi=0,ğ‘¿i=ğ”¼[ğ‘¿iâˆ£Wi=r]])\displaystyle+\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i% }=0,\boldsymbol{X}_{i}=\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]\right]\Big{)}\+ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ] ) |   
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼â¢[y~(iâ¢t)â¢(r)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=r]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0]ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡ğ‘Ÿconditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–ğ‘Ÿğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0\displaystyle\mathbb{E}\left[\tilde{y}_{(it)}(r)-\tilde{y}_{(i1)}(0)\mid W_{i}% =r\right]-\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0\right]blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( italic_r ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] |   
|  | +ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0]âˆ’ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i=ğ”¼â¢[ğ‘¿iâˆ£Wi=r]]ğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0ğ”¼delimited-[]formulae-sequencesubscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\displaystyle+\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i% }=0\right]-\mathbb{E}\left[\tilde{y}_{(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0% ,\boldsymbol{X}_{i}=\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]\right]\+ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] - blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ] |   
| =(g)superscriptğ‘”\displaystyle\stackrel{{\scriptstyle(g)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_g ) end_ARG end_RELOP | Ï„ATTâ¢(r,t)+ğ”¼â¢[ğ”¼â¢[y~(iâ¢t)â¢(0)âˆ’y~(iâ¢1)â¢(0)âˆ£Wi=0,ğ‘¿i]âˆ£Wi=0]âˆ’(Î³tâˆ—+ğ”¼â¢[ğ‘¿iâˆ£Wi=r]âŠ¤â¢ğƒtâˆ—)subscriptğœATTğ‘Ÿğ‘¡ğ”¼delimited-[]conditionalğ”¼delimited-[]subscript~ğ‘¦ğ‘–ğ‘¡0conditionalsubscript~ğ‘¦ğ‘–10subscriptğ‘Šğ‘–0subscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–0superscriptsubscriptğ›¾ğ‘¡ğ”¼superscriptdelimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsuperscriptsubscriptğƒğ‘¡\displaystyle\tau_{\text{ATT}}(r,t)+\mathbb{E}\left[\mathbb{E}\left[\tilde{y}_% {(it)}(0)-\tilde{y}_{(i1)}(0)\mid W_{i}=0,\boldsymbol{X}_{i}\right]\mid W_{i}=% 0\right]-\left(\gamma_{t}^{*}+\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]^{\top% }\boldsymbol{\xi}_{t}^{*}\right)italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) + blackboard_E [ blackboard_E [ over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i italic_t ) end_POSTSUBSCRIPT ( 0 ) - over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT ( italic_i 1 ) end_POSTSUBSCRIPT ( 0 ) âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 , bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] - ( italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
| =(h)superscriptâ„\displaystyle\stackrel{{\scriptstyle(h)}}{{=}}\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG ( italic_h ) end_ARG end_RELOP | Ï„ATTâ¢(r,t)+ğ”¼â¢[Î³tâˆ—+ğ‘¿iâŠ¤â¢ğƒtâˆ—âˆ£Wi=0]âˆ’(Î³tâˆ—+ğ”¼â¢[ğ‘¿iâˆ£Wi=r]âŠ¤â¢ğƒtâˆ—)subscriptğœATTğ‘Ÿğ‘¡ğ”¼delimited-[]superscriptsubscriptğ›¾ğ‘¡conditionalsuperscriptsubscriptğ‘¿ğ‘–topsuperscriptsubscriptğƒğ‘¡subscriptğ‘Šğ‘–0superscriptsubscriptğ›¾ğ‘¡ğ”¼superscriptdelimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsuperscriptsubscriptğƒğ‘¡\displaystyle\tau_{\text{ATT}}(r,t)+\mathbb{E}\left[\gamma_{t}^{*}+\boldsymbol% {X}_{i}^{\top}\boldsymbol{\xi}_{t}^{*}\mid W_{i}=0\right]-\left(\gamma_{t}^{*}% +\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]^{\top}\boldsymbol{\xi}_{t}^{*}\right)italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) + blackboard_E [ italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] - ( italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
| =\displaystyle=\leavevmode\nobreak\ = | Ï„ATTâ¢(r,t)+Î³tâˆ—+ğ”¼â¢[ğ‘¿iâˆ£Wi=0]âŠ¤â¢ğƒtâˆ—âˆ’(Î³tâˆ—+ğ”¼â¢[ğ‘¿iâˆ£Wi=r]âŠ¤â¢ğƒtâˆ—)subscriptğœATTğ‘Ÿğ‘¡superscriptsubscriptğ›¾ğ‘¡ğ”¼superscriptdelimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–0topsuperscriptsubscriptğƒğ‘¡superscriptsubscriptğ›¾ğ‘¡ğ”¼superscriptdelimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsuperscriptsubscriptğƒğ‘¡\displaystyle\tau_{\text{ATT}}(r,t)+\gamma_{t}^{*}+\mathbb{E}\left[\boldsymbol% {X}_{i}\mid W_{i}=0\right]^{\top}\boldsymbol{\xi}_{t}^{*}-\left(\gamma_{t}^{*}% +\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]^{\top}\boldsymbol{\xi}_{t}^{*}\right)italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) + italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT - ( italic_Î³ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
| =\displaystyle=\leavevmode\nobreak\ = | Ï„ATTâ¢(r,t)+(ğ”¼â¢[ğ‘¿iâˆ£Wi=0]âˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r])âŠ¤â¢ğƒtâˆ—,subscriptğœATTğ‘Ÿğ‘¡superscriptğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–0ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿtopsuperscriptsubscriptğƒğ‘¡\displaystyle\tau_{\text{ATT}}(r,t)+\left(\mathbb{E}\left[\boldsymbol{X}_{i}% \mid W_{i}=0\right]-\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]\right)^{\top}% \boldsymbol{\xi}_{t}^{*},italic_Ï„ start_POSTSUBSCRIPT ATT end_POSTSUBSCRIPT ( italic_r , italic_t ) + ( blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , |   
  
where in (e), (f), and (h) we used (3.5) from (LINS) and (g) uses an equality
we found under (CTSA) in the proof of part (b) above as well as (3.5) from
(LINS).

âˆ

###  G.2 Proofs of Supporting Results for Main Theorems

###### Proof of Lemma E.1.

First, ğ”šâ‰¤(Tâˆ’1)2ğ”šsuperscriptğ‘‡12\mathfrak{W}\leq(T-1)^{2}fraktur_W â‰¤
( italic_T - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT because treatment
effects are interactions between the Râ‰¤Tâˆ’1ğ‘…ğ‘‡1R\leq T-1italic_R â‰¤
italic_T - 1 cohort indicators and (at most) Tâˆ’1ğ‘‡1T-1italic_T - 1
treatment times.

Next, for any tâˆˆâ„•ğ‘¡â„•t\in\mathbb{N}italic_t âˆˆ blackboard_N, define

| ğ‘«(1)â¢(t):=(1âˆ’100â‹¯0001âˆ’10â‹¯00001âˆ’1â‹¯00â‹®â‹®â‹®â‹®â‹±â‹®â‹®0000â‹¯1âˆ’10000â‹¯01)âˆˆâ„tÃ—t.assignsuperscriptğ‘«1ğ‘¡matrix1100â‹¯000110â‹¯000011â‹¯00â‹®â‹®â‹®â‹®â‹±â‹®â‹®0000â‹¯110000â‹¯01superscriptâ„ğ‘¡ğ‘¡\boldsymbol{D}^{(1)}(t):=\begin{pmatrix}1&-1&0&0&\cdots&0&0\\\ 0&1&-1&0&\cdots&0&0\\\ 0&0&1&-1&\cdots&0&0\\\ \vdots&\vdots&\vdots&\vdots&\ddots&\vdots&\vdots\\\ 0&0&0&0&\cdots&1&-1\\\ 0&0&0&0&\cdots&0&1\end{pmatrix}\in\mathbb{R}^{t\times t}.bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_t ) := ( start_ARG start_ROW start_CELL 1 end_CELL start_CELL - 1 end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL â‹¯ end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 1 end_CELL start_CELL - 1 end_CELL start_CELL 0 end_CELL start_CELL â‹¯ end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL 1 end_CELL start_CELL - 1 end_CELL start_CELL â‹¯ end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹± end_CELL start_CELL â‹® end_CELL start_CELL â‹® end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL â‹¯ end_CELL start_CELL 1 end_CELL start_CELL - 1 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL â‹¯ end_CELL start_CELL 0 end_CELL start_CELL 1 end_CELL end_ROW end_ARG ) âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_t Ã— italic_t end_POSTSUPERSCRIPT . |  | (G.4)  
---|---|---|---  
  
Note that this is the linear transformation we apply to several groups of
coefficients in ğœ·ğœ·\boldsymbol{\beta}bold_italic_Î². For example, for the
vector of cohort fixed effects if
ğ‚âˆˆâ„Rğ‚superscriptâ„ğ‘…\boldsymbol{\nu}\in\mathbb{R}^{R}bold_italic_Î½ âˆˆ
blackboard_R start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT,

| ğ‘«(1)â¢(R)â¢ğ‚=(Î½2âˆ’Î½1â‹®Î½Râˆ’Î½Râˆ’1Î½R),superscriptğ‘«1ğ‘…ğ‚matrixsubscriptğœˆ2subscriptğœˆ1â‹®subscriptğœˆğ‘…subscriptğœˆğ‘…1subscriptğœˆğ‘…\boldsymbol{D}^{(1)}(R)\boldsymbol{\nu}=\begin{pmatrix}\nu_{2}-\nu_{1}\\\ \vdots\\\ \nu_{R}-\nu_{R-1}\\\ \nu_{R}\end{pmatrix},bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_R ) bold_italic_Î½ = ( start_ARG start_ROW start_CELL italic_Î½ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - italic_Î½ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL â‹® end_CELL end_ROW start_ROW start_CELL italic_Î½ start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT - italic_Î½ start_POSTSUBSCRIPT italic_R - 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL italic_Î½ start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ) , |   
---|---|---  
  
which are the transformed coefficients to which we apply an
â„“qsubscriptâ„“ğ‘\ell_{q}roman_â„“ start_POSTSUBSCRIPT italic_q
end_POSTSUBSCRIPT penalty. We similarly penalize
ğœ¸ğœ¸\boldsymbol{\gamma}bold_italic_Î³ as well as
ğœ»jsubscriptğœ»ğ‘—\boldsymbol{\zeta}_{j}bold_italic_Î¶ start_POSTSUBSCRIPT
italic_j end_POSTSUBSCRIPT, the coefficients for the interactions of the
cohort fixed effects and covariate jğ‘—jitalic_j (separately for each of the
dğ‘‘ditalic_d covariates) and
ğƒjsubscriptğƒğ‘—\boldsymbol{\xi}_{j}bold_italic_Î¾ start_POSTSUBSCRIPT
italic_j end_POSTSUBSCRIPT, the coefficients for the interactions of the time
fixed effects and covariate jğ‘—jitalic_j. So if we rearrange the columns of
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG
corresponding to the cohort-covariate interactions so that all of the cohort
interactions with the base effect of feature j=1ğ‘—1j=1italic_j = 1 come
first, then the cohort interactions with feature 2, and so on, we can write
this Râ¢dNÃ—Râ¢dNğ‘…subscriptğ‘‘ğ‘ğ‘…subscriptğ‘‘ğ‘Rd_{N}\times Rd_{N}italic_R
italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT Ã— italic_R italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT block diagonal part of
ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT as ğ‘°dNâŠ—ğ‘«(1)â¢(R)tensor-
productsubscriptğ‘°subscriptğ‘‘ğ‘superscriptğ‘«1ğ‘…\boldsymbol{I}_{d_{N}}\otimes\boldsymbol{D}^{(1)}(R)bold_italic_I
start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
end_POSTSUBSCRIPT âŠ— bold_italic_D start_POSTSUPERSCRIPT ( 1 )
end_POSTSUPERSCRIPT ( italic_R ), where âŠ—tensor-product\otimesâŠ— denotes
the Kronecker product. We can likewise rearrange the columns of
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG
and write the part of ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT corresponding to the time-
covariate interactions as ğ‘°dNâŠ—ğ‘«(1)â¢(Tâˆ’1)tensor-
productsubscriptğ‘°subscriptğ‘‘ğ‘superscriptğ‘«1ğ‘‡1\boldsymbol{I}_{d_{N}}\otimes\boldsymbol{D}^{(1)}(T-1)bold_italic_I
start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
end_POSTSUBSCRIPT âŠ— bold_italic_D start_POSTSUPERSCRIPT ( 1 )
end_POSTSUPERSCRIPT ( italic_T - 1 ).

We penalize the coefficients ğœ¿ğœ¿\boldsymbol{\kappa}bold_italic_Îº directly,
so this part of ğ‘«ğ‘«\boldsymbol{D}bold_italic_D can be represented simply as
ğ‘°dNsubscriptğ‘°subscriptğ‘‘ğ‘\boldsymbol{I}_{d_{N}}bold_italic_I
start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
end_POSTSUBSCRIPT.

Next we consider the matrix
ğ‘«(2)â¢(â„›)superscriptğ‘«2â„›\boldsymbol{D}^{(2)}(\mathcal{R})bold_italic_D
start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) we use to
transform the base treatment effects ğ‰ğ‰\boldsymbol{\tau}bold_italic_Ï„ for
â„“1subscriptâ„“1\ell_{1}roman_â„“ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
penalization. The matrix
ğ‘«(2)â¢(â„›)superscriptğ‘«2â„›\boldsymbol{D}^{(2)}(\mathcal{R})bold_italic_D
start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) has a
similar structure to
ğ‘«(1)â¢(t)superscriptğ‘«1ğ‘¡\boldsymbol{D}^{(1)}(t)bold_italic_D
start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_t ), except that we
directly penalize each cohortâ€™s first treatment effect, not the last one,
and we penalize each cohortâ€™s first treatment effect towards the previous
cohortâ€™s first treatment effect. So denoting
â„›=(r1,r2,â€¦,rR)â„›subscriptğ‘Ÿ1subscriptğ‘Ÿ2â€¦subscriptğ‘Ÿğ‘…\mathcal{R}=(r_{1},r_{2},\ldots,r_{R})caligraphic_R
= ( italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r
start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , â€¦ , italic_r start_POSTSUBSCRIPT
italic_R end_POSTSUBSCRIPT ),
ğ‘«(2)â¢(â„›)superscriptğ‘«2â„›\boldsymbol{D}^{(2)}(\mathcal{R})bold_italic_D
start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) has a nearly
block diagonal structure

| ğ‘«(2)â¢(â„›):=(ğ‘«~(1)â¢(1)âŠ¤ğŸğŸâ‹¯ğŸğŸğ‘¼â¢(r1)ğ‘«~(1)â¢(2)âŠ¤ğŸâ‹¯ğŸğŸğŸğ‘¼â¢(r2)ğ‘«~(1)â¢(3)âŠ¤â‹¯ğŸğŸâ‹®â‹®â‹®â‹±â‹®â‹®ğŸğŸğŸâ‹¯ğ‘¼â¢(rR)ğ‘«~(1)â¢(R)âŠ¤)âˆˆâ„ğ”šÃ—ğ”š,assignsuperscriptğ‘«2â„›matrixsuperscriptbold-~ğ‘«1superscript1top00â‹¯00ğ‘¼subscriptğ‘Ÿ1superscriptbold-~ğ‘«1superscript2top0â‹¯000ğ‘¼subscriptğ‘Ÿ2superscriptbold-~ğ‘«1superscript3topâ‹¯00â‹®â‹®â‹®â‹±â‹®â‹®000â‹¯ğ‘¼subscriptğ‘Ÿğ‘…superscriptbold-~ğ‘«1superscriptğ‘…topsuperscriptâ„ğ”šğ”š\boldsymbol{D}^{(2)}(\mathcal{R}):=\begin{pmatrix}\boldsymbol{\tilde{D}}^{(1)}% (1)^{\top}&\boldsymbol{0}&\boldsymbol{0}&\cdots&\boldsymbol{0}&\boldsymbol{0}% \\\ \boldsymbol{U}(r_{1})&\boldsymbol{\tilde{D}}^{(1)}(2)^{\top}&\boldsymbol{0}&% \cdots&\boldsymbol{0}&\boldsymbol{0}\\\ \boldsymbol{0}&\boldsymbol{U}(r_{2})&\boldsymbol{\tilde{D}}^{(1)}(3)^{\top}&% \cdots&\boldsymbol{0}&\boldsymbol{0}\\\ \vdots&\vdots&\vdots&\ddots&\vdots&\vdots\\\ \boldsymbol{0}&\boldsymbol{0}&\boldsymbol{0}&\cdots&\boldsymbol{U}(r_{R})&% \boldsymbol{\tilde{D}}^{(1)}(R)^{\top}\end{pmatrix}\in\mathbb{R}^{\mathfrak{W}% \times\mathfrak{W}},bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) := ( start_ARG start_ROW start_CELL overbold_~ start_ARG bold_italic_D end_ARG start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( 1 ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_CELL start_CELL bold_0 end_CELL start_CELL bold_0 end_CELL start_CELL â‹¯ end_CELL start_CELL bold_0 end_CELL start_CELL bold_0 end_CELL end_ROW start_ROW start_CELL bold_italic_U ( italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) end_CELL start_CELL overbold_~ start_ARG bold_italic_D end_ARG start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( 2 ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_CELL start_CELL bold_0 end_CELL start_CELL â‹¯ end_CELL start_CELL bold_0 end_CELL start_CELL bold_0 end_CELL end_ROW start_ROW start_CELL bold_0 end_CELL start_CELL bold_italic_U ( italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_CELL start_CELL overbold_~ start_ARG bold_italic_D end_ARG start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( 3 ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_CELL start_CELL â‹¯ end_CELL start_CELL bold_0 end_CELL start_CELL bold_0 end_CELL end_ROW start_ROW start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹± end_CELL start_CELL â‹® end_CELL start_CELL â‹® end_CELL end_ROW start_ROW start_CELL bold_0 end_CELL start_CELL bold_0 end_CELL start_CELL bold_0 end_CELL start_CELL â‹¯ end_CELL start_CELL bold_italic_U ( italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) end_CELL start_CELL overbold_~ start_ARG bold_italic_D end_ARG start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_R ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_CELL end_ROW end_ARG ) âˆˆ blackboard_R start_POSTSUPERSCRIPT fraktur_W Ã— fraktur_W end_POSTSUPERSCRIPT , |  | (G.5)  
---|---|---|---  
  
where
ğ‘«~â¢(x):=ğ‘«(1)â¢(Tâˆ’rx+1)assignbold-~ğ‘«ğ‘¥superscriptğ‘«1ğ‘‡subscriptğ‘Ÿğ‘¥1\boldsymbol{\tilde{D}}(x):=\boldsymbol{D}^{(1)}(T-r_{x}+1)overbold_~
start_ARG bold_italic_D end_ARG ( italic_x ) := bold_italic_D
start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_T - italic_r
start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT + 1 ) and

| ğ‘¼â¢(w):=(âˆ’1ğŸ1Ã—(Tâˆ’w)ğŸ(Tâˆ’w)Ã—1ğŸ(Tâˆ’w)Ã—(Tâˆ’w))âˆˆâ„(Tâˆ’w+1)Ã—(Tâˆ’w+1).assignğ‘¼ğ‘¤matrix1subscript01ğ‘‡ğ‘¤subscript0ğ‘‡ğ‘¤1subscript0ğ‘‡ğ‘¤ğ‘‡ğ‘¤superscriptâ„ğ‘‡ğ‘¤1ğ‘‡ğ‘¤1\boldsymbol{U}(w):=\begin{pmatrix}-1&\boldsymbol{0}_{1\times(T-w)}\\\ \boldsymbol{0}_{(T-w)\times 1}&\boldsymbol{0}_{(T-w)\times(T-w)}\end{pmatrix}% \in\mathbb{R}^{(T-w+1)\times(T-w+1)}.bold_italic_U ( italic_w ) := ( start_ARG start_ROW start_CELL - 1 end_CELL start_CELL bold_0 start_POSTSUBSCRIPT 1 Ã— ( italic_T - italic_w ) end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL bold_0 start_POSTSUBSCRIPT ( italic_T - italic_w ) Ã— 1 end_POSTSUBSCRIPT end_CELL start_CELL bold_0 start_POSTSUBSCRIPT ( italic_T - italic_w ) Ã— ( italic_T - italic_w ) end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ) âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_T - italic_w + 1 ) Ã— ( italic_T - italic_w + 1 ) end_POSTSUPERSCRIPT . |   
---|---|---  
  
Then
ğ‘«(2)â¢(â„›)â¢ğ‰superscriptğ‘«2â„›ğ‰\boldsymbol{D}^{(2)}(\mathcal{R})\boldsymbol{\tau}bold_italic_D
start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R )
bold_italic_Ï„ yields the transformed treatment effects to which we apply an
â„“qsubscriptâ„“ğ‘\ell_{q}roman_â„“ start_POSTSUBSCRIPT italic_q
end_POSTSUBSCRIPT penalty, and similarly, for every
jâˆˆ[dN]ğ‘—delimited-[]subscriptğ‘‘ğ‘j\in[d_{N}]italic_j âˆˆ [ italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ],
ğ‘«(2)â¢(â„›)â¢ğ†jsuperscriptğ‘«2â„›subscriptğ†ğ‘—\boldsymbol{D}^{(2)}(\mathcal{R})\boldsymbol{\rho}_{j}bold_italic_D
start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R )
bold_italic_Ï start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT yields the
transformed coefficients of the interactions between the
jthsuperscriptğ‘—thj^{\text{th}}italic_j start_POSTSUPERSCRIPT th
end_POSTSUPERSCRIPT centered covariate and the treatment effects. Putting this
all together, after re-ordering the columns appropriately we can write
ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT as (E.1).

Next we show that these matrices are invertible by explicitly presenting their
inverses. One can verify by matrix multiplication that

| ğ‘«(1)â¢(t)âˆ’1=(111â‹¯1011â‹¯1001â‹¯1â‹®â‹®â‹®â‹±â‹®000â‹¯1)âˆˆâ„tÃ—t,superscriptğ‘«1superscriptğ‘¡1matrix111â‹¯1011â‹¯1001â‹¯1â‹®â‹®â‹®â‹±â‹®000â‹¯1superscriptâ„ğ‘¡ğ‘¡\boldsymbol{D}^{(1)}(t)^{-1}=\begin{pmatrix}1&1&1&\cdots&1\\\ 0&1&1&\cdots&1\\\ 0&0&1&\cdots&1\\\ \vdots&\vdots&\vdots&\ddots&\vdots\\\ 0&0&0&\cdots&1\end{pmatrix}\in\mathbb{R}^{t\times t},bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_t ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT = ( start_ARG start_ROW start_CELL 1 end_CELL start_CELL 1 end_CELL start_CELL 1 end_CELL start_CELL â‹¯ end_CELL start_CELL 1 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 1 end_CELL start_CELL 1 end_CELL start_CELL â‹¯ end_CELL start_CELL 1 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL 1 end_CELL start_CELL â‹¯ end_CELL start_CELL 1 end_CELL end_ROW start_ROW start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹± end_CELL start_CELL â‹® end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL â‹¯ end_CELL start_CELL 1 end_CELL end_ROW end_ARG ) âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_t Ã— italic_t end_POSTSUPERSCRIPT , |  | (G.6)  
---|---|---|---  
  
Similarly,

| (ğ‘«(2)â¢(â„›))âˆ’1=superscriptsuperscriptğ‘«2â„›1absent\displaystyle(\boldsymbol{D}^{(2)}(\mathcal{R}))^{-1}=\leavevmode\nobreak\ ( bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT = | (ğ‘«~âˆ’1â¢(1)âŠ¤ğŸâ‹¯ğŸğŸğ‘¼~â¢(r1,r2)ğ‘«~âˆ’1â¢(2)âŠ¤â‹¯ğŸğŸâ‹®â‹®â‹±â‹®â‹®ğ‘¼~â¢(r1,rR)ğ‘¼~â¢(r2,rR)â‹¯ğ‘¼~â¢(rRâˆ’1,rR)ğ‘«~âˆ’1â¢(R)âŠ¤),matrixsuperscriptbold-~ğ‘«1superscript1top0â‹¯00bold-~ğ‘¼subscriptğ‘Ÿ1subscriptğ‘Ÿ2superscriptbold-~ğ‘«1superscript2topâ‹¯00â‹®â‹®â‹±â‹®â‹®bold-~ğ‘¼subscriptğ‘Ÿ1subscriptğ‘Ÿğ‘…bold-~ğ‘¼subscriptğ‘Ÿ2subscriptğ‘Ÿğ‘…â‹¯bold-~ğ‘¼subscriptğ‘Ÿğ‘…1subscriptğ‘Ÿğ‘…superscriptbold-~ğ‘«1superscriptğ‘…top\displaystyle\begin{pmatrix}\boldsymbol{\tilde{D}}^{-1}(1)^{\top}&\boldsymbol{% 0}&\cdots&\boldsymbol{0}&\boldsymbol{0}\\\ \boldsymbol{\tilde{U}}(r_{1},r_{2})&\boldsymbol{\tilde{D}}^{-1}(2)^{\top}&% \cdots&\boldsymbol{0}&\boldsymbol{0}\\\ \vdots&\vdots&\ddots&\vdots&\vdots\\\ \boldsymbol{\tilde{U}}(r_{1},r_{R})&\boldsymbol{\tilde{U}}(r_{2},r_{R})&\cdots% &\boldsymbol{\tilde{U}}(r_{R-1},r_{R})&\boldsymbol{\tilde{D}}^{-1}(R)^{\top}% \end{pmatrix},( start_ARG start_ROW start_CELL overbold_~ start_ARG bold_italic_D end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( 1 ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_CELL start_CELL bold_0 end_CELL start_CELL â‹¯ end_CELL start_CELL bold_0 end_CELL start_CELL bold_0 end_CELL end_ROW start_ROW start_CELL overbold_~ start_ARG bold_italic_U end_ARG ( italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_CELL start_CELL overbold_~ start_ARG bold_italic_D end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( 2 ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_CELL start_CELL â‹¯ end_CELL start_CELL bold_0 end_CELL start_CELL bold_0 end_CELL end_ROW start_ROW start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹± end_CELL start_CELL â‹® end_CELL start_CELL â‹® end_CELL end_ROW start_ROW start_CELL overbold_~ start_ARG bold_italic_U end_ARG ( italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) end_CELL start_CELL overbold_~ start_ARG bold_italic_U end_ARG ( italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) end_CELL start_CELL â‹¯ end_CELL start_CELL overbold_~ start_ARG bold_italic_U end_ARG ( italic_r start_POSTSUBSCRIPT italic_R - 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) end_CELL start_CELL overbold_~ start_ARG bold_italic_D end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_R ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_CELL end_ROW end_ARG ) , |  | (G.7)  
---|---|---|---|---  
  
where

| ğ‘¼~â¢(w1,w2)=(100â‹¯0100â‹¯0â‹®â‹®â‹®â‹±â‹®100â‹¯0)âˆˆâ„(Tâˆ’w2+1)Ã—(Tâˆ’w1+1).bold-~ğ‘¼subscriptğ‘¤1subscriptğ‘¤2matrix100â‹¯0100â‹¯0â‹®â‹®â‹®â‹±â‹®100â‹¯0superscriptâ„ğ‘‡subscriptğ‘¤21ğ‘‡subscriptğ‘¤11\boldsymbol{\tilde{U}}(w_{1},w_{2})=\begin{pmatrix}1&0&0&\cdots&0\\\ 1&0&0&\cdots&0\\\ \vdots&\vdots&\vdots&\ddots&\vdots\\\ 1&0&0&\cdots&0\end{pmatrix}\in\mathbb{R}^{(T-w_{2}+1)\times(T-w_{1}+1)}.overbold_~ start_ARG bold_italic_U end_ARG ( italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) = ( start_ARG start_ROW start_CELL 1 end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL â‹¯ end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL 1 end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL â‹¯ end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹± end_CELL start_CELL â‹® end_CELL end_ROW start_ROW start_CELL 1 end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL â‹¯ end_CELL start_CELL 0 end_CELL end_ROW end_ARG ) âˆˆ blackboard_R start_POSTSUPERSCRIPT ( italic_T - italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + 1 ) Ã— ( italic_T - italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + 1 ) end_POSTSUPERSCRIPT . |   
---|---|---  
  
Finally, using the properties of block diagonal matrices and the fact that
ğ‘«(1)â¢(t)superscriptğ‘«1ğ‘¡\boldsymbol{D}^{(1)}(t)bold_italic_D
start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_t ) and
ğ‘«(2)â¢(â„›)superscriptğ‘«2â„›\boldsymbol{D}^{(2)}(\mathcal{R})bold_italic_D
start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) are
invertible, we have from (E.1) that
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT is

| diag(\displaystyle\operatorname{diag}\Big{(}roman_diag ( | ğ‘«(1)(R)âˆ’1,((ğ‘«(1)(Tâˆ’1))âˆ’1,ğ‘°dN,ğ‘°dNâŠ—ğ‘«(1)(R)âˆ’1,ğ‘°dNâŠ—((ğ‘«(1)(Tâˆ’1))âˆ’1,\displaystyle\boldsymbol{D}^{(1)}(R)^{-1},((\boldsymbol{D}^{(1)}(T-1))^{-1},% \boldsymbol{I}_{d_{N}},\boldsymbol{I}_{d_{N}}\otimes\boldsymbol{D}^{(1)}(R)^{-% 1},\boldsymbol{I}_{d_{N}}\otimes((\boldsymbol{D}^{(1)}(T-1))^{-1},bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_R ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , ( ( bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_T - 1 ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT âŠ— bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_R ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT âŠ— ( ( bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_T - 1 ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , |   
---|---|---|---  
|  | (ğ‘«(2)(â„›))âˆ’1,ğ‘°dNâŠ—(ğ‘«(2)(â„›))âˆ’1),\displaystyle(\boldsymbol{D}^{(2)}(\mathcal{R}))^{-1},\boldsymbol{I}_{d_{N}}% \otimes(\boldsymbol{D}^{(2)}(\mathcal{R}))^{-1}\Big{)},( bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , bold_italic_I start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT âŠ— ( bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) , |   
  
matching the expression from (E.2).

Lastly, we show the claimed block diagonal structure of
ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT and
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT. Examining the expressions for
ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT and
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT, it is clear that they are both block diagonal with blocks
of size Râ‰¤Tâˆ’1ğ‘…ğ‘‡1R\leq T-1italic_R â‰¤ italic_T - 1,
Tâˆ’1ğ‘‡1T-1italic_T - 1, and
ğ”šâ‰¤(Tâˆ’1)2ğ”šsuperscriptğ‘‡12\mathfrak{W}\leq(T-1)^{2}fraktur_W â‰¤ (
italic_T - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT. We have shown in
this proof that all of the blocks contain entries equal to 0, -1, or 1.

âˆ

###### Proof of Lemma E.2.

By Lemma E.1,
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT has a block diagonal structure with blocks of size at most
(Tâˆ’1)2Ã—(Tâˆ’1)2superscriptğ‘‡12superscriptğ‘‡12(T-1)^{2}\times(T-1)^{2}(
italic_T - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT Ã— ( italic_T - 1 )
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT containing entries that equal
either 0 or 1, so âˆ¥ğ‘«Nâˆ’1âˆ¥âˆâ‰¤(Tâˆ’1)2subscriptdelimited-
âˆ¥âˆ¥superscriptsubscriptğ‘«ğ‘1superscriptğ‘‡12\lVert\boldsymbol{D}_{N}^{-1}\rVert_{\infty}\leq(T-1)^{2}âˆ¥
bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ
end_POSTSUBSCRIPT â‰¤ ( italic_T - 1 ) start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT, where for a matrix âˆ¥â‹…âˆ¥âˆsubscriptdelimited-
âˆ¥âˆ¥â‹…\lVert\cdot\rVert_{\infty}âˆ¥ â‹… âˆ¥ start_POSTSUBSCRIPT âˆ
end_POSTSUBSCRIPT denotes the maximum absolute row sum. Therefore

| âˆ¥ğœ·Nâˆ—âˆ¥âˆ=subscriptdelimited-âˆ¥âˆ¥superscriptsubscriptğœ·ğ‘absent\displaystyle\lVert\boldsymbol{\beta}_{N}^{*}\rVert_{\infty}=\leavevmode\nobreak\ âˆ¥ bold_italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT = | âˆ¥ğ‘«Nâˆ’1â¢ğœ½Nâˆ—âˆ¥âˆâ‰¤âˆ¥ğ‘«Nâˆ’1âˆ¥âˆâ¢âˆ¥ğœ½Nâˆ—âˆ¥âˆâ‰¤(Tâˆ’1)2â¢b1,subscriptdelimited-âˆ¥âˆ¥superscriptsubscriptğ‘«ğ‘1superscriptsubscriptğœ½ğ‘subscriptdelimited-âˆ¥âˆ¥superscriptsubscriptğ‘«ğ‘1subscriptdelimited-âˆ¥âˆ¥superscriptsubscriptğœ½ğ‘superscriptğ‘‡12subscriptğ‘1\displaystyle\left\lVert\boldsymbol{D}_{N}^{-1}\boldsymbol{\theta}_{N}^{*}% \right\rVert_{\infty}\leq\left\lVert\boldsymbol{D}_{N}^{-1}\right\rVert_{% \infty}\left\lVert\boldsymbol{\theta}_{N}^{*}\right\rVert_{\infty}\leq(T-1)^{2% }b_{1},âˆ¥ bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT â‰¤ âˆ¥ bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT âˆ¥ bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT â‰¤ ( italic_T - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , |   
---|---|---|---  
  
where in the last step we used Assumption (R3). âˆ

###### Proof of Lemma E.3.

To prove the result we will apply Theorem 5.1.7 in Lehmann [1999], which we
reproduce here:

######  Theorem G.1 (Theorem 5.1.7 from Lehmann [1999]).

Let
ğš=(a1,â€¦,ak)ğšsubscriptğ‘1â€¦subscriptğ‘ğ‘˜\boldsymbol{a}=(a_{1},\ldots,a_{k})bold_italic_a
= ( italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ , italic_a
start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) be a vector of constants, and
let {ğ”(N)}superscriptğ”ğ‘\\{\boldsymbol{U}^{(N)}\\}{ bold_italic_U
start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT } and
{ğ€(N)}superscriptğ€ğ‘\\{\boldsymbol{A}^{(N)}\\}{ bold_italic_A
start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT } be sequences of
random variables, with
ğ”(N)=(U1(N),â€¦,Uk(N))superscriptğ”ğ‘superscriptsubscriptğ‘ˆ1ğ‘â€¦superscriptsubscriptğ‘ˆğ‘˜ğ‘\boldsymbol{U}^{(N)}=(U_{1}^{(N)},\ldots,U_{k}^{(N)})bold_italic_U
start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT = ( italic_U
start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N )
end_POSTSUPERSCRIPT , â€¦ , italic_U start_POSTSUBSCRIPT italic_k
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT ) and
ğ€(N)=(A1(N),â€¦,Ak(N))superscriptğ€ğ‘superscriptsubscriptğ´1ğ‘â€¦superscriptsubscriptğ´ğ‘˜ğ‘\boldsymbol{A}^{(N)}=(A_{1}^{(N)},\ldots,A_{k}^{(N)})bold_italic_A
start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT = ( italic_A
start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N )
end_POSTSUPERSCRIPT , â€¦ , italic_A start_POSTSUBSCRIPT italic_k
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT ).
Suppose the sequence of random variables
TN=âˆ‘j=1kajâ¢Uj(N)subscriptğ‘‡ğ‘superscriptsubscriptğ‘—1ğ‘˜subscriptğ‘ğ‘—superscriptsubscriptğ‘ˆğ‘—ğ‘T_{N}=\sum_{j=1}^{k}a_{j}U_{j}^{(N)}italic_T
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = âˆ‘ start_POSTSUBSCRIPT
italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k
end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT
italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
( italic_N ) end_POSTSUPERSCRIPT converges in distribution to a random
variable Tğ‘‡Titalic_T, the random variables
Aj(N)â†’ğ‘ajğ‘â†’superscriptsubscriptğ´ğ‘—ğ‘subscriptğ‘ğ‘—A_{j}^{(N)}\xrightarrow{p}a_{j}italic_A
start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT (
italic_N ) end_POSTSUPERSCRIPT start_ARROW overitalic_p â†’ end_ARROW italic_a
start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT for each
jâˆˆ{1,â€¦,k}ğ‘—1â€¦ğ‘˜j\in\\{1,\ldots,k\\}italic_j âˆˆ { 1 , â€¦ , italic_k
}, and the random variables
Uj(N)=ğ’ªâ„™â¢(1)superscriptsubscriptğ‘ˆğ‘—ğ‘subscriptğ’ªâ„™1U_{j}^{(N)}=\mathcal{O}_{\mathbb{P}}(1)italic_U
start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT (
italic_N ) end_POSTSUPERSCRIPT = caligraphic_O start_POSTSUBSCRIPT
blackboard_P end_POSTSUBSCRIPT ( 1 ). Then the sequence of random variables
âˆ‘j=1kAj(n)â¢Uj(N)superscriptsubscriptğ‘—1ğ‘˜superscriptsubscriptğ´ğ‘—ğ‘›superscriptsubscriptğ‘ˆğ‘—ğ‘\sum_{j=1}^{k}A_{j}^{(n)}U_{j}^{(N)}âˆ‘
start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
italic_k end_POSTSUPERSCRIPT italic_A start_POSTSUBSCRIPT italic_j
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_n ) end_POSTSUPERSCRIPT
italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT
( italic_N ) end_POSTSUPERSCRIPT converges in distribution to Tğ‘‡Titalic_T.

Given the joint probability distribution
{(Wi,ğ‘¿i)}i=1Nsuperscriptsubscriptsubscriptğ‘Šğ‘–subscriptğ‘¿ğ‘–ğ‘–1ğ‘\\{(W_{i},\boldsymbol{X}_{i})\\}_{i=1}^{N}{
( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT
italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N
end_POSTSUPERSCRIPT, consider the iid random variables
Zisubscriptğ‘ğ‘–Z_{i}italic_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
defined by

| Zi:=assignsubscriptğ‘ğ‘–absent\displaystyle Z_{i}:=\leavevmode\nobreak\ italic_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT := | âˆ‘râˆˆ{0}âˆªâ„›ğŸ™â¢{Wi=r}â„™â¢(Wi=r)â¢ğrâŠ¤â¢(ğ‘¿iâˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi=r])subscriptğ‘Ÿ0â„›1subscriptğ‘Šğ‘–ğ‘Ÿâ„™subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğğ‘Ÿtopsubscriptğ‘¿ğ‘–ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ\displaystyle\sum_{r\in\\{0\\}\cup\mathcal{R}}\frac{\mathbbm{1}\\{W_{i}=r\\}}{% \mathbb{P}(W_{i}=r)}\boldsymbol{\psi}_{r}^{\top}\left(\boldsymbol{X}_{i}-% \mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r]\right)âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT divide start_ARG blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ] ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | âˆ‘râˆˆ{0}âˆªâ„›ğŸ™â¢{Wi=r}â„™â¢(Wi=r)â¢ğrâŠ¤â¢(ğ‘¿iâˆ’ğr).subscriptğ‘Ÿ0â„›1subscriptğ‘Šğ‘–ğ‘Ÿâ„™subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğğ‘Ÿtopsubscriptğ‘¿ğ‘–subscriptğğ‘Ÿ\displaystyle\sum_{r\in\\{0\\}\cup\mathcal{R}}\frac{\mathbbm{1}\\{W_{i}=r\\}}{% \mathbb{P}(W_{i}=r)}\boldsymbol{\psi}_{r}^{\top}\left(\boldsymbol{X}_{i}-% \boldsymbol{\mu}_{r}\right).âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT divide start_ARG blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) . |   
  
We have

| ğ”¼â¢[Zi]=ğ”¼delimited-[]subscriptğ‘ğ‘–absent\displaystyle\mathbb{E}[Z_{i}]=\leavevmode\nobreak\ blackboard_E [ italic_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = | ğ”¼â¢[ğ”¼â¢[Ziâˆ£Wi]]=ğ”¼â¢[1â„™â¢(Wi)â¢ğWiâŠ¤â¢(ğ”¼â¢[ğ‘¿iâˆ£Wi]âˆ’ğ”¼â¢[ğ‘¿iâˆ£Wi])]=ğ”¼â¢[0]=0ğ”¼delimited-[]ğ”¼delimited-[]conditionalsubscriptğ‘ğ‘–subscriptğ‘Šğ‘–ğ”¼delimited-[]1â„™subscriptğ‘Šğ‘–superscriptsubscriptğsubscriptğ‘Šğ‘–topğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ”¼delimited-[]conditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ”¼delimited-[]00\displaystyle\mathbb{E}[\mathbb{E}[Z_{i}\mid W_{i}]]=\mathbb{E}\left[\frac{1}{% \mathbb{P}(W_{i})}\boldsymbol{\psi}_{W_{i}}^{\top}\left(\mathbb{E}[\boldsymbol% {X}_{i}\mid W_{i}]-\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}]\right)\right]=% \mathbb{E}\left[0\right]=0blackboard_E [ blackboard_E [ italic_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ] = blackboard_E [ divide start_ARG 1 end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) ] = blackboard_E [ 0 ] = 0 |   
---|---|---|---  
  
and

| Varâ¢(Zi)=Varsubscriptğ‘ğ‘–absent\displaystyle\mathrm{Var}(Z_{i})=\leavevmode\nobreak\ roman_Var ( italic_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = | ğ”¼â¢[Zi2]=ğ”¼â¢[ğ”¼â¢[Zi2âˆ£Wi]]ğ”¼delimited-[]superscriptsubscriptğ‘ğ‘–2ğ”¼delimited-[]ğ”¼delimited-[]conditionalsuperscriptsubscriptğ‘ğ‘–2subscriptğ‘Šğ‘–\displaystyle\mathbb{E}[Z_{i}^{2}]=\mathbb{E}\left[\mathbb{E}\left[Z_{i}^{2}% \mid W_{i}\right]\right]blackboard_E [ italic_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] = blackboard_E [ blackboard_E [ italic_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ] |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğ”¼â¢[1(â„™â¢(Wi))2â¢ğWiâŠ¤â¢Covâ¢(ğ‘¿iâˆ£Wi)â¢ğWi]ğ”¼delimited-[]1superscriptâ„™subscriptğ‘Šğ‘–2superscriptsubscriptğsubscriptğ‘Šğ‘–topCovconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–subscriptğsubscriptğ‘Šğ‘–\displaystyle\mathbb{E}\left[\frac{1}{(\mathbb{P}(W_{i}))^{2}}\boldsymbol{\psi% }_{W_{i}}^{\top}\mathrm{Cov}(\boldsymbol{X}_{i}\mid W_{i})\boldsymbol{\psi}_{W% _{i}}\right]blackboard_E [ divide start_ARG 1 end_ARG start_ARG ( blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) bold_italic_Ïˆ start_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] |   
| =\displaystyle=\leavevmode\nobreak\ = | âˆ‘râˆˆ{0}âˆªâ„›1â„™â¢(Wi=r)2â¢ğrâŠ¤â¢Covâ¢(ğ‘¿iâˆ£Wi=r)â¢ğrâ‹…â„™â¢(Wi=r)subscriptğ‘Ÿ0â„›â‹…1â„™superscriptsubscriptğ‘Šğ‘–ğ‘Ÿ2superscriptsubscriptğğ‘ŸtopCovconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğğ‘Ÿâ„™subscriptğ‘Šğ‘–ğ‘Ÿ\displaystyle\sum_{r\in\\{0\\}\cup\mathcal{R}}\frac{1}{\mathbb{P}(W_{i}=r)^{2}}% \boldsymbol{\psi}_{r}^{\top}\mathrm{Cov}(\boldsymbol{X}_{i}\mid W_{i}=r)% \boldsymbol{\psi}_{r}\cdot\mathbb{P}(W_{i}=r)âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT â‹… blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) |   
| =\displaystyle=\leavevmode\nobreak\ = | vR.subscriptğ‘£ğ‘…\displaystyle v_{R}.italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT . |   
  
We can lower-bound vRsubscriptğ‘£ğ‘…v_{R}italic_v start_POSTSUBSCRIPT italic_R
end_POSTSUBSCRIPT uniformly across choices of
ğrsubscriptğğ‘Ÿ\boldsymbol{\psi}_{r}bold_italic_Ïˆ start_POSTSUBSCRIPT
italic_r end_POSTSUBSCRIPT: since ğrâ‰
ğŸsubscriptğğ‘Ÿ0\boldsymbol{\psi}_{r}\neq\boldsymbol{0}bold_italic_Ïˆ
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT â‰ bold_0 for at least one
r=râˆ—ğ‘Ÿsuperscriptğ‘Ÿr=r^{*}italic_r = italic_r start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT and by assumption the smallest eigenvalue of
Covâ¢(ğ‘¿iâˆ£Wi=râˆ—)Covconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–superscriptğ‘Ÿ\mathrm{Cov}(\boldsymbol{X}_{i}\mid
W_{i}=r^{*})roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
= italic_r start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) is bounded below by
some Î»min>0subscriptğœ†min0\lambda_{\text{min}}>0italic_Î»
start_POSTSUBSCRIPT min end_POSTSUBSCRIPT > 0, we have

| vRâ‰¥ğrâˆ—âŠ¤â¢Covâ¢(ğ‘¿iâˆ£Wi=râˆ—)â¢ğrâˆ—â„™â¢(Wi=râˆ—)â‰¥Î»minâ¢âˆ¥ğrâˆ—âˆ¥221>0.subscriptğ‘£ğ‘…superscriptsubscriptğsuperscriptğ‘ŸtopCovconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–superscriptğ‘Ÿsubscriptğsuperscriptğ‘Ÿâ„™subscriptğ‘Šğ‘–superscriptğ‘Ÿsubscriptğœ†minsuperscriptsubscriptdelimited-âˆ¥âˆ¥subscriptğsuperscriptğ‘Ÿ2210v_{R}\geq\frac{\boldsymbol{\psi}_{r^{*}}^{\top}\mathrm{Cov}(\boldsymbol{X}_{i}% \mid W_{i}=r^{*})\boldsymbol{\psi}_{r^{*}}}{\mathbb{P}(W_{i}=r^{*})}\geq\frac{% \lambda_{\text{min}}\lVert\boldsymbol{\psi}_{r^{*}}\rVert_{2}^{2}}{1}>0.italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT â‰¥ divide start_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT end_POSTSUBSCRIPT end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) end_ARG â‰¥ divide start_ARG italic_Î» start_POSTSUBSCRIPT min end_POSTSUBSCRIPT âˆ¥ bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG 1 end_ARG > 0 . |   
---|---|---  
  
Similarly, since the largest eigenvalue of
Covâ¢(ğ‘¿iâˆ£Wi=r)â‰¤Î»maxCovconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğœ†max\mathrm{Cov}(\boldsymbol{X}_{i}\mid
W_{i}=r)\leq\lambda_{\text{max}}roman_Cov ( bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i
end_POSTSUBSCRIPT = italic_r ) â‰¤ italic_Î» start_POSTSUBSCRIPT max
end_POSTSUBSCRIPT for some finite
Î»maxsubscriptğœ†max\lambda_{\text{max}}italic_Î» start_POSTSUBSCRIPT max
end_POSTSUBSCRIPT for all
râˆˆ{0}âˆªâ„›ğ‘Ÿ0â„›r\in\\{0\\}\cup\mathcal{R}italic_r âˆˆ { 0 } âˆª
caligraphic_R and
minrâˆˆ{0}âˆªâ„›â¡{â„™â¢(Wi=r)}>0subscriptğ‘Ÿ0â„›â„™subscriptğ‘Šğ‘–ğ‘Ÿ0\min_{r\in\\{0\\}\cup\mathcal{R}}\\{\mathbb{P}(W_{i}=r)\\}>0roman_min
start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT {
blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT =
italic_r ) } > 0 by Assumption (R1), we can upper-bound
vRsubscriptğ‘£ğ‘…v_{R}italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT
by a constant. So by the central limit theorem, for any choice of finite
{ğr}subscriptğğ‘Ÿ\\{\boldsymbol{\psi}_{r}\\}{ bold_italic_Ïˆ
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT } with at least one ğrâˆ—â‰
ğŸsubscriptğsuperscriptğ‘Ÿ0\boldsymbol{\psi}_{r^{*}}\neq\boldsymbol{0}bold_italic_Ïˆ
start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT
end_POSTSUBSCRIPT â‰ bold_0,

| 1Nâ¢âˆ‘i=1NZiâ†’ğ‘‘ğ‘‘â†’1ğ‘superscriptsubscriptğ‘–1ğ‘subscriptğ‘ğ‘–absent\displaystyle\frac{1}{\sqrt{N}}\sum_{i=1}^{N}Z_{i}\xrightarrow{d}\leavevmode\nobreak\ divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,vR)ğ’©0subscriptğ‘£ğ‘…\displaystyle\mathcal{N}(0,v_{R})caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) |   
---|---|---|---  
| â‡”1Nâ¢âˆ‘râˆˆ{0}âˆªâ„›âˆ‘{i:Wi=r}1â„™â¢(Wi=r)â¢ğrâŠ¤â¢(ğ‘¿iâˆ’ğr)â†’ğ‘‘ğ‘‘â†’iff1ğ‘subscriptğ‘Ÿ0â„›subscriptconditional-setğ‘–subscriptğ‘Šğ‘–ğ‘Ÿ1â„™subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğğ‘Ÿtopsubscriptğ‘¿ğ‘–subscriptğğ‘Ÿabsent\displaystyle\iff\qquad\frac{1}{\sqrt{N}}\sum_{r\in\\{0\\}\cup\mathcal{R}}\sum_{% \\{i:W_{i}=r\\}}\frac{1}{\mathbb{P}(W_{i}=r)}\boldsymbol{\psi}_{r}^{\top}\left(% \boldsymbol{X}_{i}-\boldsymbol{\mu}_{r}\right)\xrightarrow{d}\leavevmode\nobreak\ â‡” divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT { italic_i : italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,vR)ğ’©0subscriptğ‘£ğ‘…\displaystyle\mathcal{N}(0,v_{R})caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) |   
| â‡”1Nâ¢âˆ‘râˆˆ{0}âˆªâ„›Nrâ„™â¢(Wi=r)â¢ğrâŠ¤â¢(1Nrâ¢âˆ‘{i:Wi=r}ğ‘¿iâˆ’ğr)â†’ğ‘‘ğ‘‘â†’iff1ğ‘subscriptğ‘Ÿ0â„›subscriptğ‘ğ‘Ÿâ„™subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğğ‘Ÿtop1subscriptğ‘ğ‘Ÿsubscriptconditional-setğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsubscriptğ‘¿ğ‘–subscriptğğ‘Ÿabsent\displaystyle\iff\qquad\frac{1}{\sqrt{N}}\sum_{r\in\\{0\\}\cup\mathcal{R}}\frac{% N_{r}}{\mathbb{P}(W_{i}=r)}\boldsymbol{\psi}_{r}^{\top}\left(\frac{1}{N_{r}}% \sum_{\\{i:W_{i}=r\\}}\boldsymbol{X}_{i}-\boldsymbol{\mu}_{r}\right)\xrightarrow% {d}\leavevmode\nobreak\ â‡” divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT divide start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG âˆ‘ start_POSTSUBSCRIPT { italic_i : italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r } end_POSTSUBSCRIPT bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,vR)ğ’©0subscriptğ‘£ğ‘…\displaystyle\mathcal{N}(0,v_{R})caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) |   
| â‡”âˆ‘râˆˆ{0}âˆªâ„›Nâ¢Nr/Nâ„™â¢(Wi=r)â¢ğrâŠ¤â¢(ğ‘¿Â¯râˆ’ğr)â†’ğ‘‘ğ‘‘â†’iffsubscriptğ‘Ÿ0â„›ğ‘subscriptğ‘ğ‘Ÿğ‘â„™subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğğ‘Ÿtopsubscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿabsent\displaystyle\iff\qquad\sum_{r\in\\{0\\}\cup\mathcal{R}}\sqrt{N}\frac{N_{r}/N}{% \mathbb{P}(W_{i}=r)}\boldsymbol{\psi}_{r}^{\top}\left(\boldsymbol{\overline{X}% }_{r}-\boldsymbol{\mu}_{r}\right)\xrightarrow{d}\leavevmode\nobreak\ â‡” âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT square-root start_ARG italic_N end_ARG divide start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT / italic_N end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,vR).ğ’©0subscriptğ‘£ğ‘…\displaystyle\mathcal{N}(0,v_{R}).caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) . |  | (G.8)  
  
Now consider the random variables

| ğ‘¨(N):=assignsuperscriptğ‘¨ğ‘absent\displaystyle\boldsymbol{A}^{(N)}:=\leavevmode\nobreak\ bold_italic_A start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT := | (Ï€0â‹…Nâˆ‘i=1NğŸ™â¢{Wi=0},Ï€r1â‹…Nâˆ‘i=1NğŸ™â¢{Wi=r1},â€¦,Ï€rRâ‹…Nâˆ‘i=1NğŸ™â¢{Wi=rR})â‹…subscriptğœ‹0ğ‘superscriptsubscriptğ‘–1ğ‘1subscriptğ‘Šğ‘–0â‹…subscriptğœ‹subscriptğ‘Ÿ1ğ‘superscriptsubscriptğ‘–1ğ‘1subscriptğ‘Šğ‘–subscriptğ‘Ÿ1â€¦â‹…subscriptğœ‹subscriptğ‘Ÿğ‘…ğ‘superscriptsubscriptğ‘–1ğ‘1subscriptğ‘Šğ‘–subscriptğ‘Ÿğ‘…\displaystyle\left(\pi_{0}\cdot\frac{N}{\sum_{i=1}^{N}\mathbbm{1}\\{W_{i}=0\\}},% \pi_{r_{1}}\cdot\frac{N}{\sum_{i=1}^{N}\mathbbm{1}\\{W_{i}=r_{1}\\}},\ldots,\pi_% {r_{R}}\cdot\frac{N}{\sum_{i=1}^{N}\mathbbm{1}\\{W_{i}=r_{R}\\}}\right)( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT â‹… divide start_ARG italic_N end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 } end_ARG , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT â‹… divide start_ARG italic_N end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT } end_ARG , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT â‹… divide start_ARG italic_N end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT } end_ARG ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | (Ï€0â‹…NN0,Ï€r1â‹…NNr1,â€¦,Ï€rRâ‹…NNrR).â‹…subscriptğœ‹0ğ‘subscriptğ‘0â‹…subscriptğœ‹subscriptğ‘Ÿ1ğ‘subscriptğ‘subscriptğ‘Ÿ1â€¦â‹…subscriptğœ‹subscriptğ‘Ÿğ‘…ğ‘subscriptğ‘subscriptğ‘Ÿğ‘…\displaystyle\left(\pi_{0}\cdot\frac{N}{N_{0}},\pi_{r_{1}}\cdot\frac{N}{N_{r_{% 1}}},\ldots,\pi_{r_{R}}\cdot\frac{N}{N_{r_{R}}}\right).( italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT â‹… divide start_ARG italic_N end_ARG start_ARG italic_N start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT â‹… divide start_ARG italic_N end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT â‹… divide start_ARG italic_N end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG ) . |   
  
By the continuous mapping theorem
ğ‘¨(N)â†’ğ‘(1,1,â€¦,1)ğ‘â†’superscriptğ‘¨ğ‘11â€¦1\boldsymbol{A}^{(N)}\xrightarrow{p}\left(1,1,\ldots,1\right)bold_italic_A
start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT start_ARROW
overitalic_p â†’ end_ARROW ( 1 , 1 , â€¦ , 1 ). Further, let

| ğ‘¼(N):=assignsuperscriptğ‘¼ğ‘absent\displaystyle\boldsymbol{U}^{(N)}:=\leavevmode\nobreak\ bold_italic_U start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT := | (âˆ‘i=1NğŸ™â¢{Wi=0}Ï€0ğ0âŠ¤(ğ‘¿iâˆ’ğ”¼[ğ‘¿iâˆ£Wi=0]),âˆ‘i=1NğŸ™â¢{Wi=r1}Ï€r1ğr1âŠ¤(ğ‘¿iâˆ’ğ”¼[ğ‘¿iâˆ£Wi=r1]),\displaystyle\Bigg{(}\sum_{i=1}^{N}\frac{\mathbbm{1}\\{W_{i}=0\\}}{\pi_{0}}% \boldsymbol{\psi}_{0}^{\top}\left(\boldsymbol{X}_{i}-\mathbb{E}[\boldsymbol{X}% _{i}\mid W_{i}=0]\right),\sum_{i=1}^{N}\frac{\mathbbm{1}\\{W_{i}=r_{1}\\}}{\pi_{% r_{1}}}\boldsymbol{\psi}_{r_{1}}^{\top}\left(\boldsymbol{X}_{i}-\mathbb{E}[% \boldsymbol{X}_{i}\mid W_{i}=r_{1}]\right),( âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 } end_ARG start_ARG italic_Ï€ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 0 ] ) , âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT } end_ARG start_ARG italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] ) , |   
---|---|---|---  
|  | â‹¯,âˆ‘i=1NğŸ™â¢{Wi=rR}Ï€rRğrRâŠ¤(ğ‘¿iâˆ’ğ”¼[ğ‘¿iâˆ£Wi=rR])).\displaystyle\cdots,\sum_{i=1}^{N}\frac{\mathbbm{1}\\{W_{i}=r_{R}\\}}{\pi_{r_{R}% }}\boldsymbol{\psi}_{r_{R}}^{\top}\left(\boldsymbol{X}_{i}-\mathbb{E}[% \boldsymbol{X}_{i}\mid W_{i}=r_{R}]\right)\Bigg{)}.â‹¯ , âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG blackboard_1 { italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT } end_ARG start_ARG italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ] ) ) . |   
  
Since from (G.8) we have

| âˆ‘râˆˆ{0}âˆªâ„›1â‹…1Nâ¢Ur(N)â†’ğ‘‘ğ’©â¢(0,vR),ğ‘‘â†’subscriptğ‘Ÿ0â„›â‹…11ğ‘superscriptsubscriptğ‘ˆğ‘Ÿğ‘ğ’©0subscriptğ‘£ğ‘…\sum_{r\in\\{0\\}\cup\mathcal{R}}1\cdot\frac{1}{\sqrt{N}}U_{r}^{(N)}\xrightarrow% {d}\mathcal{N}(0,v_{R}),âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT 1 â‹… divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) , |   
---|---|---  
  
we have from Theorem G.1

| âˆ‘râˆˆ{0}âˆªâ„›Ar(N)â‹…1Nâ¢Ur(N)â†’ğ‘‘ğ‘‘â†’subscriptğ‘Ÿ0â„›â‹…superscriptsubscriptğ´ğ‘Ÿğ‘1ğ‘superscriptsubscriptğ‘ˆğ‘Ÿğ‘absent\displaystyle\sum_{r\in\\{0\\}\cup\mathcal{R}}A_{r}^{(N)}\cdot\frac{1}{\sqrt{N}}% U_{r}^{(N)}\xrightarrow{d}\leavevmode\nobreak\ âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT italic_A start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT â‹… divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,vR)ğ’©0subscriptğ‘£ğ‘…\displaystyle\mathcal{N}(0,v_{R})caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ) |   
---|---|---|---  
| â‡”âˆ‘râˆˆ{0}âˆªâ„›NvRâ¢ğrâŠ¤â¢(ğ‘¿Â¯râˆ’ğr)â†’ğ‘‘ğ‘‘â†’iffsubscriptğ‘Ÿ0â„›ğ‘subscriptğ‘£ğ‘…superscriptsubscriptğğ‘Ÿtopsubscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿabsent\displaystyle\iff\qquad\sum_{r\in\\{0\\}\cup\mathcal{R}}\sqrt{\frac{N}{v_{R}}}% \boldsymbol{\psi}_{r}^{\top}\left(\boldsymbol{\overline{X}}_{r}-\boldsymbol{% \mu}_{r}\right)\xrightarrow{d}\leavevmode\nobreak\ â‡” âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ { 0 } âˆª caligraphic_R end_POSTSUBSCRIPT square-root start_ARG divide start_ARG italic_N end_ARG start_ARG italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_ARG end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,1).ğ’©01\displaystyle\mathcal{N}(0,1).caligraphic_N ( 0 , 1 ) . |   
  
Finally we prove the last claim. It follows from the above that

| Nâ¢âˆ¥ğ‘¿Â¯râˆ’ğrâˆ¥22ğ‘superscriptsubscriptdelimited-âˆ¥âˆ¥subscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿ22N\lVert\boldsymbol{\overline{X}}_{r}-\boldsymbol{\mu}_{r}\rVert_{2}^{2}italic_N âˆ¥ overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT |   
---|---|---  
  
converges in distribution to a generalized chi-squared random variable, so by
Theorem 2.4(i) in vanÂ der Vaart [2000] and Proposition 1.8(iii) in
GarcÃ­a-PortuguÃ©s [2023] we have

| Nâ¢âˆ¥ğ‘¿Â¯râˆ’ğrâˆ¥22=ğ‘superscriptsubscriptdelimited-âˆ¥âˆ¥subscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿ22absent\displaystyle N\lVert\boldsymbol{\overline{X}}_{r}-\boldsymbol{\mu}_{r}\rVert_% {2}^{2}=\leavevmode\nobreak\ italic_N âˆ¥ overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = | ğ’ªâ„™â¢(1)subscriptğ’ªâ„™1\displaystyle\mathcal{O}_{\mathbb{P}}(1)caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( 1 ) |   
---|---|---|---  
| âŸ¹âˆ¥ğ‘¿Â¯râˆ’ğrâˆ¥22=superscriptsubscriptdelimited-âˆ¥âˆ¥subscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿ22absent\displaystyle\implies\qquad\lVert\boldsymbol{\overline{X}}_{r}-\boldsymbol{\mu% }_{r}\rVert_{2}^{2}=\leavevmode\nobreak\ âŸ¹ âˆ¥ overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = | ğ’ªâ„™â¢(1N)subscriptğ’ªâ„™1ğ‘\displaystyle\mathcal{O}_{\mathbb{P}}\left(\frac{1}{N}\right)caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ) |   
| âŸ¹âˆ¥ğ‘¿Â¯râˆ’ğrâˆ¥2=subscriptdelimited-âˆ¥âˆ¥subscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿ2absent\displaystyle\implies\qquad\lVert\boldsymbol{\overline{X}}_{r}-\boldsymbol{\mu% }_{r}\rVert_{2}=\leavevmode\nobreak\ âŸ¹ âˆ¥ overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = | ğ’ªâ„™â¢(1N).subscriptğ’ªâ„™1ğ‘\displaystyle\mathcal{O}_{\mathbb{P}}\left(\frac{1}{\sqrt{N}}\right).caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG ) . |   
  
âˆ

###### Proof of Lemma E.4.

For any râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R,

|  | |ğ’‚âŠ¤â¢ğ…^â¢(ğ’™)ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)âˆ’ğ’‚âŠ¤â¢ğ…â¢(ğ’™)ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)|superscriptğ’‚topbold-^ğ…ğ’™superscriptğ’ƒtopbold-^ğ…ğ’™superscriptğ’‚topğ…ğ’™superscriptğ’ƒtopğ…ğ’™\displaystyle\left|\frac{\boldsymbol{a}^{\top}\boldsymbol{\hat{\pi}}(% \boldsymbol{x})}{\boldsymbol{b}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x})}-% \frac{\boldsymbol{a}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}{\boldsymbol{b}^% {\top}\boldsymbol{{\pi}}(\boldsymbol{x})}\right|| divide start_ARG bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG - divide start_ARG bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG | |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | |ğ’‚âŠ¤â¢ğ…^â¢(ğ’™)â‹…ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)âˆ’ğ’‚âŠ¤â¢ğ…â¢(ğ’™)â¢ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)â¢ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)|â‹…superscriptğ’‚topbold-^ğ…ğ’™superscriptğ’ƒtopğ…ğ’™superscriptğ’‚topğ…ğ’™superscriptğ’ƒtopbold-^ğ…ğ’™superscriptğ’ƒtopbold-^ğ…ğ’™superscriptğ’ƒtopğ…ğ’™\displaystyle\left|\frac{\boldsymbol{a}^{\top}\boldsymbol{\hat{\pi}}(% \boldsymbol{x})\cdot\boldsymbol{b}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})-% \boldsymbol{a}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})\boldsymbol{b}^{\top}% \boldsymbol{\hat{\pi}}(\boldsymbol{x})}{\boldsymbol{b}^{\top}\boldsymbol{\hat{% \pi}}(\boldsymbol{x})\boldsymbol{b}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}\right|| divide start_ARG bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) â‹… bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) - bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG | |   
| =\displaystyle=\leavevmode\nobreak\ = | |ğ’‚âŠ¤â¢ğ…^â¢(ğ’™)â‹…ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)âˆ’ğ’‚âŠ¤â¢ğ…â¢(ğ’™)â‹…ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)+ğ’‚âŠ¤â¢ğ…â¢(ğ’™)â‹…ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)âˆ’ğ’‚âŠ¤â¢ğ…â¢(ğ’™)â¢ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)â¢ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)|â‹…superscriptğ’‚topbold-^ğ…ğ’™superscriptğ’ƒtopğ…ğ’™â‹…superscriptğ’‚topğ…ğ’™superscriptğ’ƒtopğ…ğ’™â‹…superscriptğ’‚topğ…ğ’™superscriptğ’ƒtopğ…ğ’™superscriptğ’‚topğ…ğ’™superscriptğ’ƒtopbold-^ğ…ğ’™superscriptğ’ƒtopbold-^ğ…ğ’™superscriptğ’ƒtopğ…ğ’™\displaystyle\left|\frac{\boldsymbol{a}^{\top}\boldsymbol{\hat{\pi}}(% \boldsymbol{x})\cdot\boldsymbol{b}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})-% \boldsymbol{a}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})\cdot\boldsymbol{b}^{% \top}\boldsymbol{{\pi}}(\boldsymbol{x})+\boldsymbol{a}^{\top}\boldsymbol{{\pi}% }(\boldsymbol{x})\cdot\boldsymbol{b}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})-% \boldsymbol{a}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})\boldsymbol{b}^{\top}% \boldsymbol{\hat{\pi}}(\boldsymbol{x})}{\boldsymbol{b}^{\top}\boldsymbol{\hat{% \pi}}(\boldsymbol{x})\boldsymbol{b}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x})}\right|| divide start_ARG bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) â‹… bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) - bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) â‹… bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) + bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) â‹… bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) - bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG start_ARG bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG | |   
| =\displaystyle=\leavevmode\nobreak\ = | |ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)â‹…ğ’‚âŠ¤â¢(ğ…^â¢(ğ’™)âˆ’ğ…â¢(ğ’™))+ğ’‚âŠ¤â¢ğ…â¢(ğ’™)â‹…ğ’ƒâŠ¤â¢(ğ…â¢(ğ’™)âˆ’ğ…^â¢(ğ’™))ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)â¢ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)|â‹…superscriptğ’ƒtopğ…ğ’™superscriptğ’‚topbold-^ğ…ğ’™ğ…ğ’™â‹…superscriptğ’‚topğ…ğ’™superscriptğ’ƒtopğ…ğ’™bold-^ğ…ğ’™superscriptğ’ƒtopbold-^ğ…ğ’™superscriptğ’ƒtopğ…ğ’™\displaystyle\left|\frac{\boldsymbol{b}^{\top}\boldsymbol{{\pi}}(\boldsymbol{x% })\cdot\boldsymbol{a}^{\top}\left(\boldsymbol{\hat{\pi}}(\boldsymbol{x})-% \boldsymbol{{\pi}}(\boldsymbol{x})\right)+\boldsymbol{a}^{\top}\boldsymbol{{% \pi}}(\boldsymbol{x})\cdot\boldsymbol{b}^{\top}\left(\boldsymbol{{\pi}}(% \boldsymbol{x})-\boldsymbol{\hat{\pi}}(\boldsymbol{x})\right)}{\boldsymbol{b}^% {\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x})\boldsymbol{b}^{\top}\boldsymbol{{% \pi}}(\boldsymbol{x})}\right|| divide start_ARG bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) â‹… bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) - bold_italic_Ï€ ( bold_italic_x ) ) + bold_italic_a start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) â‹… bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_Ï€ ( bold_italic_x ) - overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) ) end_ARG start_ARG bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) end_ARG | |   
| =\displaystyle=\leavevmode\nobreak\ = | 1ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)â¢ğ’ªâ„™â¢(aN),1superscriptğ’ƒtopbold-^ğ…ğ’™subscriptğ’ªâ„™subscriptğ‘ğ‘\displaystyle\frac{1}{\boldsymbol{b}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{% x})}\mathcal{O}_{\mathbb{P}}\left(a_{N}\right),divide start_ARG 1 end_ARG start_ARG bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) , |   
  
where in the last step we used our consistency assumption and the finiteness
of ğ’‚ğ’‚\boldsymbol{a}bold_italic_a and ğ’ƒğ’ƒ\boldsymbol{b}bold_italic_b. We
are done if we can show that

| 1ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)=ğ’ªâ„™â¢(1).1superscriptğ’ƒtopbold-^ğ…ğ’™subscriptğ’ªâ„™1\frac{1}{\boldsymbol{b}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x})}=\mathcal% {O}_{\mathbb{P}}(1).divide start_ARG 1 end_ARG start_ARG bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( 1 ) . |   
---|---|---  
  
That is, we want to show that for any Ïµ>0italic-Ïµ0\epsilon>0italic_Ïµ > 0
there exists a finite MÏµ>0subscriptğ‘€italic-Ïµ0M_{\epsilon}>0italic_M
start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT > 0 and
NÏµ>0subscriptğ‘italic-Ïµ0N_{\epsilon}>0italic_N start_POSTSUBSCRIPT italic_Ïµ
end_POSTSUBSCRIPT > 0 such that for all N>NÏµğ‘subscriptğ‘italic-
ÏµN>N_{\epsilon}italic_N > italic_N start_POSTSUBSCRIPT italic_Ïµ
end_POSTSUBSCRIPT,

| â„™â¢(1ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)>MÏµ)<Ïµâ‡”â„™â¢(ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)<1MÏµ)<Ïµ.formulae-sequenceâ„™1superscriptğ’ƒtopbold-^ğ…ğ’™subscriptğ‘€italic-Ïµitalic-Ïµiffâ„™superscriptğ’ƒtopbold-^ğ…ğ’™1subscriptğ‘€italic-Ïµitalic-Ïµ\mathbb{P}\left(\frac{1}{\boldsymbol{b}^{\top}\boldsymbol{\hat{\pi}}(% \boldsymbol{x})}>M_{\epsilon}\right)<\epsilon\qquad\iff\qquad\mathbb{P}\left(% \boldsymbol{b}^{\top}\boldsymbol{\hat{\pi}}(\boldsymbol{x})<\frac{1}{M_{% \epsilon}}\right)<\epsilon.blackboard_P ( divide start_ARG 1 end_ARG start_ARG bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) end_ARG > italic_M start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ) < italic_Ïµ â‡” blackboard_P ( bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) < divide start_ARG 1 end_ARG start_ARG italic_M start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT end_ARG ) < italic_Ïµ . |   
---|---|---  
  
Fix Ïµ>0italic-Ïµ0\epsilon>0italic_Ïµ > 0. By assumption, for any ğ’™ğ’™\boldsymbol{x}bold_italic_x in the support of ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT we have |ğ’ƒâŠ¤â¢(ğ…^â¢(ğ’™)âˆ’ğ…â¢(ğ’™))|=ğ’ªâ„™â¢(aN)superscriptğ’ƒtopbold-^ğ…ğ’™ğ…ğ’™subscriptğ’ªâ„™subscriptğ‘ğ‘|\boldsymbol{b}^{\top}(\boldsymbol{\hat{\pi}}(\boldsymbol{x})-\boldsymbol{\pi}% (\boldsymbol{x}))|=\mathcal{O}_{\mathbb{P}}(a_{N})| bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) - bold_italic_Ï€ ( bold_italic_x ) ) | = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ), so there exists a finite MÏµ(1)>0superscriptsubscriptğ‘€italic-Ïµ10M_{\epsilon}^{(1)}>0italic_M start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT > 0 and NÏµ(1)>0superscriptsubscriptğ‘italic-Ïµ10N_{\epsilon}^{(1)}>0italic_N start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT > 0 such that for all N>NÏµ(1)ğ‘superscriptsubscriptğ‘italic-Ïµ1N>N_{\epsilon}^{(1)}italic_N > italic_N start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT,

| â„™â¢(|ğ’ƒâŠ¤â¢(ğ…^â¢(ğ’™)âˆ’ğ…â¢(ğ’™))|aN>MÏµ(1))<ÏµâŸ¹â„™superscriptğ’ƒtopbold-^ğ…ğ’™ğ…ğ’™subscriptğ‘ğ‘superscriptsubscriptğ‘€italic-Ïµ1italic-Ïµ\displaystyle\mathbb{P}\left(\frac{|\boldsymbol{b}^{\top}(\boldsymbol{\hat{\pi% }}(\boldsymbol{x})-\boldsymbol{\pi}(\boldsymbol{x}))|}{a_{N}}>M_{\epsilon}^{(1% )}\right)<\epsilon\qquad\implies\qquadblackboard_P ( divide start_ARG | bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) - bold_italic_Ï€ ( bold_italic_x ) ) | end_ARG start_ARG italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG > italic_M start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ) < italic_Ïµ âŸ¹ | â„™â¢(ğ’ƒâŠ¤â¢ğ…^â¢(ğ’™)<ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)âˆ’MÏµ(1)â¢aN)<Ïµ.â„™superscriptğ’ƒtopbold-^ğ…ğ’™superscriptğ’ƒtopğ…ğ’™superscriptsubscriptğ‘€italic-Ïµ1subscriptğ‘ğ‘italic-Ïµ\displaystyle\mathbb{P}\left(\boldsymbol{b}^{\top}\boldsymbol{\hat{\pi}}(% \boldsymbol{x})<\boldsymbol{b}^{\top}\boldsymbol{\pi}(\boldsymbol{x})-M_{% \epsilon}^{(1)}a_{N}\right)<\epsilon.blackboard_P ( bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï€ end_ARG ( bold_italic_x ) < bold_italic_b start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) - italic_M start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) < italic_Ïµ . |   
---|---|---|---  
  
Since by assumption
ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)>0superscriptğ’ƒtopğ…ğ’™0\boldsymbol{b}^{\top}\boldsymbol{\pi}(\boldsymbol{x})>0bold_italic_b
start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x )
> 0, the result holds for NÏµâ‰¥NÏµ(1)subscriptğ‘italic-
Ïµsuperscriptsubscriptğ‘italic-Ïµ1N_{\epsilon}\geq N_{\epsilon}^{(1)}italic_N
start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT â‰¥ italic_N
start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 )
end_POSTSUPERSCRIPT large enough so that for all N>NÏµğ‘subscriptğ‘italic-
ÏµN>N_{\epsilon}italic_N > italic_N start_POSTSUBSCRIPT italic_Ïµ
end_POSTSUBSCRIPT it holds that
ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)âˆ’MÏµ(1)â¢aN>0superscriptğ’ƒtopğ…ğ’™superscriptsubscriptğ‘€italic-
Ïµ1subscriptğ‘ğ‘0\boldsymbol{b}^{\top}\boldsymbol{\pi}(\boldsymbol{x})-M_{\epsilon}^{(1)}a_{N}>0bold_italic_b
start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x )
- italic_M start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT > 0 (which is assured since
aNsubscriptğ‘ğ‘a_{N}italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT is
decreasing), and
MÏµ:=1/(ğ’ƒâŠ¤â¢ğ…â¢(ğ’™)âˆ’MÏµ(1)â¢aNÏµ)assignsubscriptğ‘€italic-
Ïµ1superscriptğ’ƒtopğ…ğ’™superscriptsubscriptğ‘€italic-
Ïµ1subscriptğ‘subscriptğ‘italic-
ÏµM_{\epsilon}:=1/(\boldsymbol{b}^{\top}\boldsymbol{\pi}(\boldsymbol{x})-M_{%
\epsilon}^{(1)}a_{N_{\epsilon}})italic_M start_POSTSUBSCRIPT italic_Ïµ
end_POSTSUBSCRIPT := 1 / ( bold_italic_b start_POSTSUPERSCRIPT âŠ¤
end_POSTSUPERSCRIPT bold_italic_Ï€ ( bold_italic_x ) - italic_M
start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 )
end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT
italic_Ïµ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ). âˆ

###### Proof of Lemma E.5.

Observe that

|  | ğ^N(C;CATT,â¢Ï€)âˆ’ğN(C;CATT,â¢Ï€)superscriptsubscriptbold-^ğğ‘C;CATT,ğœ‹superscriptsubscriptğğ‘C;CATT,ğœ‹\displaystyle\boldsymbol{\hat{\psi}}_{N}^{(\text{C;CATT,}\pi)}-\boldsymbol{% \psi}_{N}^{(\text{C;CATT,}\pi)}overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | âˆ‘râˆˆâ„›âˆ‘t=rTfrâ¢(Ï€^r1â¢(ğ’™),Ï€^r2â¢(ğ’™),â€¦,Ï€^rRâ¢(ğ’™))â¢Ïˆrâ¢tâ¢ğ^râ¢tâˆ—âˆ’âˆ‘râˆˆâ„›frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))â¢âˆ‘t=rTÏˆrâ¢tâ¢ğrâ¢tâˆ—subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1ğ’™subscript^ğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’™subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptbold-^ğğ‘Ÿğ‘¡subscriptğ‘Ÿâ„›subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptğğ‘Ÿğ‘¡\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}f_{r}\left(\hat{\pi}_{r_{1}}(% \boldsymbol{x}),\hat{\pi}_{r_{2}}(\boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(% \boldsymbol{x})\right)\psi_{rt}\boldsymbol{\hat{\psi}}_{rt}^{*}-\sum_{r\in% \mathcal{R}}f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x})% ,\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\sum_{t=r}^{T}\psi_{rt}\boldsymbol{% \psi}_{rt}^{*}âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT - âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
| =\displaystyle=\leavevmode\nobreak\ = | âˆ‘râˆˆâ„›âˆ‘t=rTfrâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))â¢Ïˆrâ¢tâ¢(ğ^râ¢tâˆ—âˆ’ğrâ¢tâˆ—)subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptbold-^ğğ‘Ÿğ‘¡superscriptsubscriptğğ‘Ÿğ‘¡\displaystyle\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}f_{r}\left(\pi_{r_{1}}(% \boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x}),\ldots,\pi_{r_{R}}(\boldsymbol{x})% \right)\psi_{rt}\left(\boldsymbol{\hat{\psi}}_{rt}^{*}-\boldsymbol{\psi}_{rt}^% {*}\right)âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
|  | +âˆ‘râˆˆâ„›âˆ‘t=rT(frâ¢(Ï€^r1â¢(ğ’™),Ï€^r2â¢(ğ’™),â€¦,Ï€^rRâ¢(ğ’™))âˆ’frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™)))â¢Ïˆrâ¢tâ¢ğrâ¢tâˆ—subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1ğ’™subscript^ğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’™subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptğğ‘Ÿğ‘¡\displaystyle+\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\left(f_{r}\left(\hat{\pi}_{% r_{1}}(\boldsymbol{x}),\hat{\pi}_{r_{2}}(\boldsymbol{x}),\ldots,\hat{\pi}_{r_{% R}}(\boldsymbol{x})\right)-f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(% \boldsymbol{x}),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\right)\psi_{rt}% \boldsymbol{\psi}_{rt}^{*}\+ âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) ) italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
|  | +âˆ‘râˆˆâ„›âˆ‘t=rT(frâ¢(Ï€^r1â¢(ğ’™),Ï€^r2â¢(ğ’™),â€¦,Ï€^rRâ¢(ğ’™))âˆ’frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™)))â¢Ïˆrâ¢tâ¢(ğ^râ¢tâˆ—âˆ’ğrâ¢tâˆ—),subscriptğ‘Ÿâ„›superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1ğ’™subscript^ğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’™subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptbold-^ğğ‘Ÿğ‘¡superscriptsubscriptğğ‘Ÿğ‘¡\displaystyle+\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\left(f_{r}\left(\hat{\pi}_{% r_{1}}(\boldsymbol{x}),\hat{\pi}_{r_{2}}(\boldsymbol{x}),\ldots,\hat{\pi}_{r_{% R}}(\boldsymbol{x})\right)-f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(% \boldsymbol{x}),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\right)\psi_{rt}\left% (\boldsymbol{\hat{\psi}}_{rt}^{*}-\boldsymbol{\psi}_{rt}^{*}\right),\+ âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) ) italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) , |   
  
where
ğ^râ¢tâˆ—superscriptsubscriptbold-^ğğ‘Ÿğ‘¡\boldsymbol{\hat{\psi}}_{rt}^{*}overbold_^
start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT was defined in
(E.15) and
ğ^râ¢tâˆ—superscriptsubscriptbold-^ğğ‘Ÿğ‘¡\boldsymbol{\hat{\psi}}_{rt}^{*}overbold_^
start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT was defined in
(E.14). We will show that after scaling by Nâ¢Tğ‘ğ‘‡\sqrt{NT}square-root
start_ARG italic_N italic_T end_ARG and multiplying by
(ğœ½Nâˆ—)âŠ¤superscriptsuperscriptsubscriptğœ½ğ‘top(\boldsymbol{\theta}_{N}^{*})^{\top}(
bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤
end_POSTSUPERSCRIPT, terms of the first two forms converge in distribution to
independent Gaussian random variables, and terms of the third form converge in
probability to 0.

  * â€¢

Applying Lemma E.3, we have

|  | Nâ¢Tâ¢(ğœ½Nâˆ—)âŠ¤â¢âˆ‘râˆˆâ„›frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))â¢âˆ‘t=rTÏˆrâ¢tâ¢(ğ^râ¢tâˆ—âˆ’ğrâ¢tâˆ—)ğ‘ğ‘‡superscriptsuperscriptsubscriptğœ½ğ‘topsubscriptğ‘Ÿâ„›subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptbold-^ğğ‘Ÿğ‘¡superscriptsubscriptğğ‘Ÿğ‘¡\displaystyle\sqrt{NT}(\boldsymbol{\theta}_{N}^{*})^{\top}\sum_{r\in\mathcal{R% }}f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x}),\ldots,% \pi_{r_{R}}(\boldsymbol{x})\right)\sum_{t=r}^{T}\psi_{rt}\left(\boldsymbol{% \hat{\psi}}_{rt}^{*}-\boldsymbol{\psi}_{rt}^{*}\right)square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢Tâ¢âˆ‘râˆˆâ„›frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))â¢âˆ‘t=rTâˆ’Ïˆrâ¢tâ¢(ğœ½Nâˆ—)âŠ¤â¢((ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…âŠ¤â¢(ğ‘¿Â¯râˆ’ğr))ğ‘ğ‘‡subscriptğ‘Ÿâ„›subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsuperscriptsubscriptğœ½ğ‘topsuperscriptsubscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’™â‹…topsubscriptbold-Â¯ğ‘¿ğ‘Ÿsubscriptğğ‘Ÿ\displaystyle\sqrt{NT}\sum_{r\in\mathcal{R}}f_{r}\left(\pi_{r_{1}}(\boldsymbol% {x}),\pi_{r_{2}}(\boldsymbol{x}),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\sum% _{t=r}^{T}-\psi_{rt}(\boldsymbol{\theta}_{N}^{*})^{\top}\left((\boldsymbol{D}_% {N}^{-1})_{i(r,t,\boldsymbol{x}),\cdot}^{\top}\left(\boldsymbol{\overline{X}}_% {r}-\boldsymbol{\mu}_{r}\right)\right)square-root start_ARG italic_N italic_T end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT - italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT - bold_italic_Î¼ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) ) |   
| â†’ğ‘‘ğ‘‘â†’\displaystyle\xrightarrow{d}\leavevmode\nobreak\ start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,vRCATT; prob),ğ’©0superscriptsubscriptğ‘£ğ‘…CATT; prob\displaystyle\mathcal{N}(0,v_{R}^{\text{CATT; prob}}),caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT ) , |   
  
where

| vRCATT; prob:=Tâ‹…âˆ‘râˆˆâ„›(ğrCATT; prob)âŠ¤â¢Covâ¢(ğ‘¿iâˆ£Wi=r)â¢ğrCATT; probâ„™â¢(Wi=r)assignsuperscriptsubscriptğ‘£ğ‘…CATT; probâ‹…ğ‘‡subscriptğ‘Ÿâ„›superscriptsuperscriptsubscriptğğ‘ŸCATT; probtopCovconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğğ‘ŸCATT; probâ„™subscriptğ‘Šğ‘–ğ‘Ÿv_{R}^{\text{CATT; prob}}:=T\cdot\sum_{r\in\mathcal{R}}\frac{(\boldsymbol{\psi% }_{r}^{\text{CATT; prob}})^{\top}\mathrm{Cov}(\boldsymbol{X}_{i}\mid W_{i}=r)% \boldsymbol{\psi}_{r}^{\text{CATT; prob}}}{\mathbb{P}(W_{i}=r)}italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT := italic_T â‹… âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT divide start_ARG ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) end_ARG |   
---|---|---  
  
for

| ğrCATT; prob:=assignsuperscriptsubscriptğğ‘ŸCATT; probabsent\displaystyle\boldsymbol{\psi}_{r}^{\text{CATT; prob}}:=\leavevmode\nobreak\ bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT := | frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))â¢âˆ‘t=rTÏˆrâ¢tâ¢(ğ‘«Nâˆ’1)iâ¢(r,t,ğ’™),â‹…â¢ğœ½Nâˆ—subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡subscriptsuperscriptsubscriptğ‘«ğ‘1ğ‘–ğ‘Ÿğ‘¡ğ’™â‹…superscriptsubscriptğœ½ğ‘\displaystyle f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x% }),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\sum_{t=r}^{T}\psi_{rt}(% \boldsymbol{D}_{N}^{-1})_{i(r,t,\boldsymbol{x}),\cdot}\boldsymbol{\theta}_{N}^% {*}italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i ( italic_r , italic_t , bold_italic_x ) , â‹… end_POSTSUBSCRIPT bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™))â¢âˆ‘t=rTÏˆrâ¢tâ¢ğ†râ¢tâˆ—,râˆˆâ„›.subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptğ†ğ‘Ÿğ‘¡ğ‘Ÿâ„›\displaystyle f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x% }),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\sum_{t=r}^{T}\psi_{rt}\boldsymbol% {\rho}_{rt}^{*},\qquad r\in\mathcal{R}.italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , italic_r âˆˆ caligraphic_R . |  | (G.9)  
  
  * â€¢

Next, using the assumed joint asymptotic normality of
(Ï€^0â¢(ğ’™),Ï€^r1â¢(ğ’™),â€¦,Ï€^rRâ¢(ğ’™))subscript^ğœ‹0ğ’™subscript^ğœ‹subscriptğ‘Ÿ1ğ’™â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’™(\hat{\pi}_{0}(\boldsymbol{x}),\hat{\pi}_{r_{1}}(\boldsymbol{x}),\ldots,\hat{%
\pi}_{r_{R}}(\boldsymbol{x}))( over^ start_ARG italic_Ï€ end_ARG
start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG
italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1
end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG
italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R
end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) and the delta method
(Theorem 3.1 in vanÂ der Vaart 2000), we have for each
râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R

|  | Nâ¢T(fr1(Ï€^r1(ğ’™),Ï€^r2(ğ’™),â€¦,Ï€^rR(ğ’™))âˆ’fr1(Ï€r1(ğ’™),Ï€r2(ğ’™),â€¦,Ï€rR(ğ’™)),â€¦,\displaystyle\sqrt{NT}\big{(}f_{r_{1}}\left(\hat{\pi}_{r_{1}}(\boldsymbol{x}),% \hat{\pi}_{r_{2}}(\boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(\boldsymbol{x})% \right)-f_{r_{1}}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x})% ,\ldots,\pi_{r_{R}}(\boldsymbol{x})\right),\ldots,square-root start_ARG italic_N italic_T end_ARG ( italic_f start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) - italic_f start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) , â€¦ , |   
---|---|---|---  
|  | frR(Ï€^r1(ğ’™),Ï€^r2(ğ’™),â€¦,Ï€^rR(ğ’™))âˆ’frR(Ï€r1(ğ’™),Ï€r2(ğ’™),â€¦,Ï€rR(ğ’™)))\displaystyle f_{r_{R}}\left(\hat{\pi}_{r_{1}}(\boldsymbol{x}),\hat{\pi}_{r_{2% }}(\boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(\boldsymbol{x})\right)-f_{r_{R}}% \left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x}),\ldots,\pi_{r_{R% }}(\boldsymbol{x})\right)\big{)}italic_f start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) - italic_f start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) ) |   
| â†’ğ‘‘ğ‘‘â†’\displaystyle\xrightarrow{d}\leavevmode\nobreak\ start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(ğŸ,Tâ‹…âˆ‡ğ’‡âŠ¤â¢ğšºÏ€â¢âˆ‡ğ’‡)ğ’©0â‹…ğ‘‡âˆ‡superscriptğ’‡topsubscriptğšºğœ‹âˆ‡ğ’‡\displaystyle\mathcal{N}\left(\boldsymbol{0},T\cdot\nabla\boldsymbol{f}^{\top}% \boldsymbol{\Sigma}_{\pi}\nabla\boldsymbol{f}\right)caligraphic_N ( bold_0 , italic_T â‹… âˆ‡ bold_italic_f start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_Î£ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT âˆ‡ bold_italic_f ) |   
  
Therefore

|  | Nâ¢Tâ¢(ğœ½Nâˆ—)âŠ¤â¢âˆ‘râˆˆâ„›(frâ¢(Ï€^r1â¢(ğ’™),Ï€^r2â¢(ğ’™),â€¦,Ï€^rRâ¢(ğ’™))âˆ’frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™)))â¢âˆ‘t=rTÏˆrâ¢tâ¢ğrâ¢tâˆ—ğ‘ğ‘‡superscriptsuperscriptsubscriptğœ½ğ‘topsubscriptğ‘Ÿâ„›subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1ğ’™subscript^ğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’™subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptğğ‘Ÿğ‘¡\displaystyle\sqrt{NT}(\boldsymbol{\theta}_{N}^{*})^{\top}\sum_{r\in\mathcal{R% }}\left(f_{r}\left(\hat{\pi}_{r_{1}}(\boldsymbol{x}),\hat{\pi}_{r_{2}}(% \boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(\boldsymbol{x})\right)-f_{r}\left(\pi% _{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x}),\ldots,\pi_{r_{R}}(% \boldsymbol{x})\right)\right)\sum_{t=r}^{T}\psi_{rt}\boldsymbol{\psi}_{rt}^{*}square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) ) âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢Tâ¢âˆ‘râˆˆâ„›(frâ¢(Ï€^r1â¢(ğ’™),Ï€^r2â¢(ğ’™),â€¦,Ï€^rRâ¢(ğ’™))âˆ’frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™)))â¢âˆ‘t=rTÏˆrâ¢tâ¢(ğœ½Nâˆ—)âŠ¤â¢ğrâ¢tâˆ—ğ‘ğ‘‡subscriptğ‘Ÿâ„›subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1ğ’™subscript^ğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’™subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsuperscriptsubscriptğœ½ğ‘topsuperscriptsubscriptğğ‘Ÿğ‘¡\displaystyle\sqrt{NT}\sum_{r\in\mathcal{R}}\left(f_{r}\left(\hat{\pi}_{r_{1}}% (\boldsymbol{x}),\hat{\pi}_{r_{2}}(\boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(% \boldsymbol{x})\right)-f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(% \boldsymbol{x}),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\right)\sum_{t=r}^{T}% \psi_{rt}(\boldsymbol{\theta}_{N}^{*})^{\top}\boldsymbol{\psi}_{rt}^{*}square-root start_ARG italic_N italic_T end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) ) âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT |   
| â†’ğ‘‘ğ‘‘â†’\displaystyle\xrightarrow{d}\leavevmode\nobreak\ start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,Tâ‹…ğÏ€âŠ¤â¢âˆ‡ğ’‡âŠ¤â¢ğšºÏ€â¢âˆ‡ğ’‡â¢ğÏ€)ğ’©0â‹…ğ‘‡superscriptsubscriptğğœ‹topâˆ‡superscriptğ’‡topsubscriptğšºğœ‹âˆ‡ğ’‡subscriptğğœ‹\displaystyle\mathcal{N}\left(0,T\cdot\boldsymbol{\psi}_{\pi}^{\top}\nabla% \boldsymbol{f}^{\top}\boldsymbol{\Sigma}_{\pi}\nabla\boldsymbol{f}\boldsymbol{% \psi}_{\pi}\right)caligraphic_N ( 0 , italic_T â‹… bold_italic_Ïˆ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‡ bold_italic_f start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_Î£ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT âˆ‡ bold_italic_f bold_italic_Ïˆ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT ) |   
  
for

| ğÏ€:=assignsubscriptğğœ‹absent\displaystyle\boldsymbol{\psi}_{\pi}:=\leavevmode\nobreak\ bold_italic_Ïˆ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT := | (âˆ‘t=r1TÏˆr1â¢tâ¢(ğœ½Nâˆ—)âŠ¤â¢ğr1â¢tâˆ—,âˆ‘t=r2TÏˆr2â¢tâ¢(ğœ½Nâˆ—)âŠ¤â¢ğr2â¢tâˆ—,â€¦,âˆ‘t=rRTÏˆrRâ¢tâ¢(ğœ½Nâˆ—)âŠ¤â¢ğrRâ¢tâˆ—)superscriptsubscriptğ‘¡subscriptğ‘Ÿ1ğ‘‡subscriptğœ“subscriptğ‘Ÿ1ğ‘¡superscriptsuperscriptsubscriptğœ½ğ‘topsuperscriptsubscriptğsubscriptğ‘Ÿ1ğ‘¡superscriptsubscriptğ‘¡subscriptğ‘Ÿ2ğ‘‡subscriptğœ“subscriptğ‘Ÿ2ğ‘¡superscriptsuperscriptsubscriptğœ½ğ‘topsuperscriptsubscriptğsubscriptğ‘Ÿ2ğ‘¡â€¦superscriptsubscriptğ‘¡subscriptğ‘Ÿğ‘…ğ‘‡subscriptğœ“subscriptğ‘Ÿğ‘…ğ‘¡superscriptsuperscriptsubscriptğœ½ğ‘topsuperscriptsubscriptğsubscriptğ‘Ÿğ‘…ğ‘¡\displaystyle\left(\sum_{t=r_{1}}^{T}\psi_{r_{1}t}(\boldsymbol{\theta}_{N}^{*}% )^{\top}\boldsymbol{\psi}_{r_{1}t}^{*},\sum_{t=r_{2}}^{T}\psi_{r_{2}t}(% \boldsymbol{\theta}_{N}^{*})^{\top}\boldsymbol{\psi}_{r_{2}t}^{*},\ldots,\sum_% {t=r_{R}}^{T}\psi_{r_{R}t}(\boldsymbol{\theta}_{N}^{*})^{\top}\boldsymbol{\psi% }_{r_{R}t}^{*}\right)( âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , â€¦ , âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | (âˆ‘t=r1TÏˆr1â¢t(ğ‰r1â¢tâˆ—+(ğ’™âˆ’ğ”¼[ğ‘¿iâˆ£Wi=r1])âŠ¤ğ†r1â¢tâˆ—),â€¦,\displaystyle\bigg{(}\sum_{t=r_{1}}^{T}\psi_{r_{1}t}\left(\boldsymbol{\tau}_{r% _{1}t}^{*}+\left(\boldsymbol{x}-\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r_{1}]% \right)^{\top}\boldsymbol{\rho}_{r_{1}t}^{*}\right),\ldots,( âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Ï„ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + ( bold_italic_x - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) , â€¦ , |   
|  | âˆ‘t=rRTÏˆrRâ¢t(ğ‰rRâ¢tâˆ—+(ğ’™âˆ’ğ”¼[ğ‘¿iâˆ£Wi=rR])âŠ¤ğ†rRâ¢tâˆ—)).\displaystyle\sum_{t=r_{R}}^{T}\psi_{r_{R}t}\left(\boldsymbol{\tau}_{r_{R}t}^{% *}+\left(\boldsymbol{x}-\mathbb{E}[\boldsymbol{X}_{i}\mid W_{i}=r_{R}]\right)^% {\top}\boldsymbol{\rho}_{r_{R}t}^{*}\right)\bigg{)}.âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Ï„ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT + ( bold_italic_x - blackboard_E [ bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Ï start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) ) . |   
  
  * â€¢

Finally, the above two results, along with Theorem 2.4(i) in vanÂ der Vaart
[2000] and Proposition 1.8(iii) in GarcÃ­a-PortuguÃ©s [2023], yield that for
any râˆˆâ„›ğ‘Ÿâ„›r\in\mathcal{R}italic_r âˆˆ caligraphic_R

|  | (frâ¢(Ï€^r1â¢(ğ’™),Ï€^r2â¢(ğ’™),â€¦,Ï€^rRâ¢(ğ’™))âˆ’frâ¢(Ï€r1â¢(ğ’™),Ï€r2â¢(ğ’™),â€¦,Ï€rRâ¢(ğ’™)))â¢(ğœ½Nâˆ—)âŠ¤â¢âˆ‘t=rT(ğ^râ¢tâˆ—âˆ’ğrâ¢tâˆ—)subscriptğ‘“ğ‘Ÿsubscript^ğœ‹subscriptğ‘Ÿ1ğ’™subscript^ğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscript^ğœ‹subscriptğ‘Ÿğ‘…ğ’™subscriptğ‘“ğ‘Ÿsubscriptğœ‹subscriptğ‘Ÿ1ğ’™subscriptğœ‹subscriptğ‘Ÿ2ğ’™â€¦subscriptğœ‹subscriptğ‘Ÿğ‘…ğ’™superscriptsuperscriptsubscriptğœ½ğ‘topsuperscriptsubscriptğ‘¡ğ‘Ÿğ‘‡superscriptsubscriptbold-^ğğ‘Ÿğ‘¡superscriptsubscriptğğ‘Ÿğ‘¡\displaystyle\left(f_{r}\left(\hat{\pi}_{r_{1}}(\boldsymbol{x}),\hat{\pi}_{r_{% 2}}(\boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(\boldsymbol{x})\right)-f_{r}\left% (\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x}),\ldots,\pi_{r_{R}}(% \boldsymbol{x})\right)\right)(\boldsymbol{\theta}_{N}^{*})^{\top}\sum_{t=r}^{T% }\left(\boldsymbol{\hat{\psi}}_{rt}^{*}-\boldsymbol{\psi}_{rt}^{*}\right)( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) - italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) ) ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | ğ’ªâ„™â¢(1N)â¢ğ’ªâ„™â¢(1N)=ğ’ªâ„™â¢(1N),subscriptğ’ªâ„™1ğ‘subscriptğ’ªâ„™1ğ‘subscriptğ’ªâ„™1ğ‘\displaystyle\mathcal{O}_{\mathbb{P}}\left(\frac{1}{\sqrt{N}}\right)\mathcal{O% }_{\mathbb{P}}\left(\frac{1}{\sqrt{N}}\right)=\mathcal{O}_{\mathbb{P}}\left(% \frac{1}{N}\right),caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG ) caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG ) = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ) , |   
  
so

|  | Nâ¢T(ğœ½Nâˆ—)âŠ¤âˆ‘râˆˆâ„›(fr(Ï€^r1(ğ’™),Ï€^r2(ğ’™),â€¦,Ï€^rR(ğ’™))\displaystyle\sqrt{NT}(\boldsymbol{\theta}_{N}^{*})^{\top}\sum_{r\in\mathcal{R% }}\big{(}f_{r}\left(\hat{\pi}_{r_{1}}(\boldsymbol{x}),\hat{\pi}_{r_{2}}(% \boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(\boldsymbol{x})\right)square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) |   
---|---|---|---  
|  | âˆ’fr(Ï€r1(ğ’™),Ï€r2(ğ’™),â€¦,Ï€rR(ğ’™)))âˆ‘t=rTÏˆrâ¢t(ğ^râ¢tâˆ—âˆ’ğrâ¢tâˆ—)\displaystyle-f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x% }),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\big{)}\sum_{t=r}^{T}\psi_{rt}% \left(\boldsymbol{\hat{\psi}}_{rt}^{*}-\boldsymbol{\psi}_{rt}^{*}\right)\- italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) ) âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢Tâˆ‘râˆˆâ„›âˆ‘t=rTÏˆrâ¢t(fr(Ï€^r1(ğ’™),Ï€^r2(ğ’™),â€¦,Ï€^rR(ğ’™))\displaystyle\sqrt{NT}\sum_{r\in\mathcal{R}}\sum_{t=r}^{T}\psi_{rt}\big{(}f_{r% }\left(\hat{\pi}_{r_{1}}(\boldsymbol{x}),\hat{\pi}_{r_{2}}(\boldsymbol{x}),% \ldots,\hat{\pi}_{r_{R}}(\boldsymbol{x})\right)square-root start_ARG italic_N italic_T end_ARG âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) |   
|  | âˆ’fr(Ï€r1(ğ’™),Ï€r2(ğ’™),â€¦,Ï€rR(ğ’™)))(ğœ½Nâˆ—)âŠ¤(ğ^râ¢tâˆ—âˆ’ğrâ¢tâˆ—)\displaystyle-f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x% }),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\big{)}(\boldsymbol{\theta}_{N}^{*% })^{\top}\left(\boldsymbol{\hat{\psi}}_{rt}^{*}-\boldsymbol{\psi}_{rt}^{*}\right)\- italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) ) ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) |   
| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢ğ’ªâ„™â¢(1N),ğ‘subscriptğ’ªâ„™1ğ‘\displaystyle\sqrt{N}\mathcal{O}_{\mathbb{P}}\left(\frac{1}{N}\right),square-root start_ARG italic_N end_ARG caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ) , |   
  
and

| Nâ¢T(ğœ½Nâˆ—)âŠ¤âˆ‘râˆˆâ„›(fr(Ï€^r1(ğ’™),Ï€^r2(ğ’™),â€¦,Ï€^rR(ğ’™))\displaystyle\sqrt{NT}(\boldsymbol{\theta}_{N}^{*})^{\top}\sum_{r\in\mathcal{R% }}\big{(}f_{r}\left(\hat{\pi}_{r_{1}}(\boldsymbol{x}),\hat{\pi}_{r_{2}}(% \boldsymbol{x}),\ldots,\hat{\pi}_{r_{R}}(\boldsymbol{x})\right)square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) |   
---|---|---  
| âˆ’fr(Ï€r1(ğ’™),Ï€r2(ğ’™),â€¦,Ï€rR(ğ’™)))âˆ‘t=rTÏˆrâ¢t(ğ^râ¢tâˆ—âˆ’ğrâ¢tâˆ—)â†’ğ‘0.\displaystyle-f_{r}\left(\pi_{r_{1}}(\boldsymbol{x}),\pi_{r_{2}}(\boldsymbol{x% }),\ldots,\pi_{r_{R}}(\boldsymbol{x})\right)\big{)}\sum_{t=r}^{T}\psi_{rt}% \left(\boldsymbol{\hat{\psi}}_{rt}^{*}-\boldsymbol{\psi}_{rt}^{*}\right)% \xrightarrow{p}0.\- italic_f start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) , â€¦ , italic_Ï€ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) ) ) âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_ARROW overitalic_p â†’ end_ARROW 0 . |   
  

Putting this together and using the assumed independence, we have

| Nâ¢Tâ¢(ğœ½Nâˆ—)âŠ¤â¢(ğ^N(C;CATT,â¢Ï€)âˆ’ğN(C;CATT,â¢Ï€))â†’ğ‘‘ğ’©â¢(0,vR(C;CATT,â¢Ï€))ğ‘‘â†’ğ‘ğ‘‡superscriptsuperscriptsubscriptğœ½ğ‘topsuperscriptsubscriptbold-^ğğ‘C;CATT,ğœ‹superscriptsubscriptğğ‘C;CATT,ğœ‹ğ’©0superscriptsubscriptğ‘£ğ‘…C;CATT,ğœ‹\sqrt{NT}(\boldsymbol{\theta}_{N}^{*})^{\top}\left(\boldsymbol{\hat{\psi}}_{N}% ^{(\text{C;CATT,}\pi)}-\boldsymbol{\psi}_{N}^{(\text{C;CATT,}\pi)}\right)% \xrightarrow{d}\mathcal{N}\left(0,v_{R}^{(\text{C;CATT,}\pi)}\right)square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Î¸ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT ) |   
---|---|---  
  
for

| vR(C;CATT,â¢Ï€):=Tâ‹…âˆ‘râˆˆâ„›(ğrCATT; prob)âŠ¤â¢Covâ¢(ğ‘¿iâˆ£Wi=r)â¢ğrCATT; probâ„™â¢(Wi=r)+Tâ‹…ğÏ€âŠ¤â¢âˆ‡ğ’‡âŠ¤â¢ğšºÏ€â¢âˆ‡ğ’‡â¢ğÏ€.assignsuperscriptsubscriptğ‘£ğ‘…C;CATT,ğœ‹â‹…ğ‘‡subscriptğ‘Ÿâ„›superscriptsuperscriptsubscriptğğ‘ŸCATT; probtopCovconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptğğ‘ŸCATT; probâ„™subscriptğ‘Šğ‘–ğ‘Ÿâ‹…ğ‘‡superscriptsubscriptğğœ‹topâˆ‡superscriptğ’‡topsubscriptğšºğœ‹âˆ‡ğ’‡subscriptğğœ‹v_{R}^{(\text{C;CATT,}\pi)}:=T\cdot\sum_{r\in\mathcal{R}}\frac{(\boldsymbol{% \psi}_{r}^{\text{CATT; prob}})^{\top}\mathrm{Cov}(\boldsymbol{X}_{i}\mid W_{i}% =r)\boldsymbol{\psi}_{r}^{\text{CATT; prob}}}{\mathbb{P}(W_{i}=r)}+T\cdot% \boldsymbol{\psi}_{\pi}^{\top}\nabla\boldsymbol{f}^{\top}\boldsymbol{\Sigma}_{% \pi}\nabla\boldsymbol{f}\boldsymbol{\psi}_{\pi}.italic_v start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT := italic_T â‹… âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT divide start_ARG ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT roman_Cov ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) bold_italic_Ïˆ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT end_ARG start_ARG blackboard_P ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) end_ARG + italic_T â‹… bold_italic_Ïˆ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‡ bold_italic_f start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_Î£ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT âˆ‡ bold_italic_f bold_italic_Ïˆ start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT . |   
---|---|---  
  
Finally, consider the plug-in estimator

| v^R(C;CATT,â¢Ï€):=Tâ‹…âˆ‘râˆˆâ„›(ğ^rCATT; prob)âŠ¤â¢Cov^â¢(ğ‘¿iâˆ£Wi=r)â¢ğ^rCATT; probNr/NÏ„+Tâ‹…ğ^Ï€âŠ¤â¢âˆ‡ğ’‡^âŠ¤â¢ğšº^Ï€â¢âˆ‡ğ’‡^â¢ğ^Ï€,assignsuperscriptsubscript^ğ‘£ğ‘…C;CATT,ğœ‹â‹…ğ‘‡subscriptğ‘Ÿâ„›superscriptsuperscriptsubscriptbold-^ğğ‘ŸCATT; probtop^Covconditionalsubscriptğ‘¿ğ‘–subscriptğ‘Šğ‘–ğ‘Ÿsuperscriptsubscriptbold-^ğğ‘ŸCATT; probsubscriptğ‘ğ‘Ÿsubscriptğ‘ğœâ‹…ğ‘‡superscriptsubscriptbold-^ğğœ‹topâˆ‡superscriptbold-^ğ’‡topsubscriptbold-^ğšºğœ‹âˆ‡bold-^ğ’‡subscriptbold-^ğğœ‹\hat{v}_{R}^{(\text{C;CATT,}\pi)}:=T\cdot\sum_{r\in\mathcal{R}}\frac{(% \boldsymbol{\hat{\psi}}_{r}^{\text{CATT; prob}})^{\top}\widehat{\mathrm{Cov}}(% \boldsymbol{X}_{i}\mid W_{i}=r)\boldsymbol{\hat{\psi}}_{r}^{\text{CATT; prob}}% }{N_{r}/N_{\tau}}+T\cdot\boldsymbol{\hat{\psi}}_{\pi}^{\top}\nabla\boldsymbol{% \hat{f}}^{\top}\boldsymbol{\hat{\Sigma}}_{\pi}\nabla\boldsymbol{\hat{f}}% \boldsymbol{\hat{\psi}}_{\pi},over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT := italic_T â‹… âˆ‘ start_POSTSUBSCRIPT italic_r âˆˆ caligraphic_R end_POSTSUBSCRIPT divide start_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG roman_Cov end_ARG ( bold_italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r ) overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT / italic_N start_POSTSUBSCRIPT italic_Ï„ end_POSTSUBSCRIPT end_ARG + italic_T â‹… overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT âˆ‡ overbold_^ start_ARG bold_italic_f end_ARG start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_Î£ end_ARG start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT âˆ‡ overbold_^ start_ARG bold_italic_f end_ARG overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT , |  | (G.10)  
---|---|---|---  
  
where

| ğ^rCATT; prob:=assignsuperscriptsubscriptbold-^ğğ‘ŸCATT; probabsent\displaystyle\boldsymbol{\hat{\psi}}_{r}^{\text{CATT; prob}}:=\leavevmode\nobreak\ overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT CATT; prob end_POSTSUPERSCRIPT := | Ï€^râ¢(ğ’™)âˆ‘râ€²âˆˆâ„›Ï€^râ€²â¢(ğ’™)â¢âˆ‘t=rTÏˆrâ¢tâ¢ğ†^râ¢t(q),râˆˆâ„›,subscript^ğœ‹ğ‘Ÿğ’™subscriptsuperscriptğ‘Ÿâ€²â„›subscript^ğœ‹superscriptğ‘Ÿâ€²ğ’™superscriptsubscriptğ‘¡ğ‘Ÿğ‘‡subscriptğœ“ğ‘Ÿğ‘¡superscriptsubscriptbold-^ğ†ğ‘Ÿğ‘¡ğ‘ğ‘Ÿâ„›\displaystyle\frac{\hat{\pi}_{r}(\boldsymbol{x})}{\sum_{r^{\prime}\in\mathcal{% R}}\hat{\pi}_{r^{\prime}}(\boldsymbol{x})}\sum_{t=r}^{T}\psi_{rt}\boldsymbol{% \hat{\rho}}_{rt}^{(q)},\qquad r\in\mathcal{R},divide start_ARG over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_R end_POSTSUBSCRIPT over^ start_ARG italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT overbold_^ start_ARG bold_italic_Ï end_ARG start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT , italic_r âˆˆ caligraphic_R , |   
---|---|---|---  
| ğ^Ï€:=assignsubscriptbold-^ğğœ‹absent\displaystyle\boldsymbol{\hat{\psi}}_{\pi}:=\leavevmode\nobreak\ overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT := | (âˆ‘t=r1TÏˆr1â¢t(ğ‰^r1â¢t(q)+(ğ’™âˆ’ğ‘¿Â¯r1)âŠ¤ğ†^r1â¢t(q)),â€¦,\displaystyle\bigg{(}\sum_{t=r_{1}}^{T}\psi_{r_{1}t}\left(\boldsymbol{\hat{% \tau}}_{r_{1}t}^{(q)}+\left(\boldsymbol{x}-\boldsymbol{\overline{X}}_{r_{1}}% \right)^{\top}\boldsymbol{\hat{\rho}}_{r_{1}t}^{(q)}\right),\ldots,( âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( overbold_^ start_ARG bold_italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT + ( bold_italic_x - overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT ) , â€¦ , |   
|  | âˆ‘t=rRTÏˆrRâ¢t(ğ‰^rRâ¢t(q)+(ğ’™âˆ’ğ‘¿Â¯rR)âŠ¤ğ†^rRâ¢t(q))),\displaystyle\sum_{t=r_{R}}^{T}\psi_{r_{R}t}\left(\boldsymbol{\hat{\tau}}_{r_{% R}t}^{(q)}+\left(\boldsymbol{x}-\boldsymbol{\overline{X}}_{r_{R}}\right)^{\top% }\boldsymbol{\hat{\rho}}_{r_{R}t}^{(q)}\right)\bigg{)},âˆ‘ start_POSTSUBSCRIPT italic_t = italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Ïˆ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( overbold_^ start_ARG bold_italic_Ï„ end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT + ( bold_italic_x - overbold_Â¯ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Ï end_ARG start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_q ) end_POSTSUPERSCRIPT ) ) , |   
  
and âˆ‡ğ’‡^âˆ‡bold-^ğ’‡\nabla\boldsymbol{\hat{f}}âˆ‡ overbold_^ start_ARG
bold_italic_f end_ARG is defined by replacing each instance of
Ï€râ¢(ğ’™)subscriptğœ‹ğ‘Ÿğ’™\pi_{r}(\boldsymbol{x})italic_Ï€
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_x ) in
âˆ‡ğ’‡âˆ‡ğ’‡\nabla\boldsymbol{f}âˆ‡ bold_italic_f with its estimator
Ï€^râ¢(ğ’™)subscript^ğœ‹ğ‘Ÿğ’™\hat{\pi}_{r}(\boldsymbol{x})over^ start_ARG
italic_Ï€ end_ARG start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT (
bold_italic_x ). Notice that
v^R(C;CATT,â¢Ï€)â†’ğ‘vR(C;CATT,â¢Ï€)ğ‘â†’superscriptsubscript^ğ‘£ğ‘…C;CATT,ğœ‹superscriptsubscriptğ‘£ğ‘…C;CATT,ğœ‹\hat{v}_{R}^{(\text{C;CATT,}\pi)}\xrightarrow{p}v_{R}^{(\text{C;CATT,}\pi)}over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ ) end_POSTSUPERSCRIPT start_ARROW
overitalic_p â†’ end_ARROW italic_v start_POSTSUBSCRIPT italic_R
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( C;CATT, italic_Ï€ )
end_POSTSUPERSCRIPT by the consistency of the individual terms and the
continuous mapping theorem. âˆ

##  Appendix H Proofs of Lemmas From Proof of Theorem C.1

###### Proof of Lemma F.1.

Notice from (E.1) and the expressions in the proof of Lemma E.1 that the
â„“1subscriptâ„“1\ell_{1}roman_â„“ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT
norm of each row or column of
ğ‘«Nsubscriptğ‘«ğ‘\boldsymbol{D}_{N}bold_italic_D start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT is at most 3, so we have

| Ïƒmaxâ¢(ğ‘«N)â‰¤âˆ¥ğ‘«Nâˆ¥1â¢âˆ¥ğ‘«Nâˆ¥âˆâ‰¤3â‹…3=3,subscriptğœmaxsubscriptğ‘«ğ‘subscriptdelimited-âˆ¥âˆ¥subscriptğ‘«ğ‘1subscriptdelimited-âˆ¥âˆ¥subscriptğ‘«ğ‘â‹…333\sigma_{\text{max}}(\boldsymbol{D}_{N})\leq\sqrt{\lVert\boldsymbol{D}_{N}% \rVert_{1}\lVert\boldsymbol{D}_{N}\rVert_{\infty}}\leq\sqrt{3\cdot 3}=3,italic_Ïƒ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) â‰¤ square-root start_ARG âˆ¥ bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT âˆ¥ bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT end_ARG â‰¤ square-root start_ARG 3 â‹… 3 end_ARG = 3 , |   
---|---|---  
  
where for matrices âˆ¥â‹…âˆ¥1subscriptdelimited-
âˆ¥âˆ¥â‹…1\lVert\cdot\rVert_{1}âˆ¥ â‹… âˆ¥ start_POSTSUBSCRIPT 1
end_POSTSUBSCRIPT denotes the maximum absolute column sum of a matrix and
âˆ¥â‹…âˆ¥âˆsubscriptdelimited-âˆ¥âˆ¥â‹…\lVert\cdot\rVert_{\infty}âˆ¥ â‹… âˆ¥
start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT denotes the maximum absolute row sum.
Now we lower bound
Ïƒminâ¢(ğ‘«N)subscriptğœminsubscriptğ‘«ğ‘\sigma_{\text{min}}\left(\boldsymbol{D}_{N}\right)italic_Ïƒ
start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT ). We have that for any matrix
ğ‘¨ğ‘¨\boldsymbol{A}bold_italic_A

| Ïƒminâ¢(ğ‘¨)â‰¥1âˆ¥ğ‘¨âˆ’1âˆ¥1â¢âˆ¥ğ‘¨âˆ’1âˆ¥âˆ.subscriptğœminğ‘¨1subscriptdelimited-âˆ¥âˆ¥superscriptğ‘¨11subscriptdelimited-âˆ¥âˆ¥superscriptğ‘¨1\sigma_{\text{min}}\left(\boldsymbol{A}\right)\geq\frac{1}{\sqrt{\lVert% \boldsymbol{A}^{-1}\rVert_{1}\lVert\boldsymbol{A}^{-1}\rVert_{\infty}}}.italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_A ) â‰¥ divide start_ARG 1 end_ARG start_ARG square-root start_ARG âˆ¥ bold_italic_A start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT âˆ¥ bold_italic_A start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT end_ARG end_ARG . |  | (H.1)  
---|---|---|---  
  
Recall our expression for
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT from (E.2). The singular values of a block diagonal matrix
are the union of the singular values of the individual matrices on the
diagonal, so it is enough to lower bound the singular values of each of these
individual matrices using (H.1) and then take the minimum of all of the lower
bounds.

Using the expression for
ğ‘«(1)â¢(t)âˆ’1superscriptğ‘«1superscriptğ‘¡1\boldsymbol{D}^{(1)}(t)^{-1}bold_italic_D
start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_t )
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT from (G.6) and (H.1),

| âˆ¥ğ‘«(1)â¢(t)âˆ’1âˆ¥1â¢âˆ¥ğ‘«(1)â¢(t)âˆ’1âˆ¥âˆâ‰¤t2âŸ¹Ïƒminâ¢(ğ‘«(1)â¢(t)âˆ’1)â‰¥1/t.formulae-sequencesubscriptdelimited-âˆ¥âˆ¥superscriptğ‘«1superscriptğ‘¡11subscriptdelimited-âˆ¥âˆ¥superscriptğ‘«1superscriptğ‘¡1superscriptğ‘¡2subscriptğœminsuperscriptğ‘«1superscriptğ‘¡11ğ‘¡\lVert\boldsymbol{D}^{(1)}(t)^{-1}\rVert_{1}\lVert\boldsymbol{D}^{(1)}(t)^{-1}% \rVert_{\infty}\leq t^{2}\qquad\implies\qquad\sigma_{\text{min}}\left(% \boldsymbol{D}^{(1)}(t)^{-1}\right)\geq 1/t.âˆ¥ bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_t ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT âˆ¥ bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_t ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT â‰¤ italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT âŸ¹ italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_t ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) â‰¥ 1 / italic_t . |  | (H.2)  
---|---|---|---  
  
Therefore the maximum column â„“1subscriptâ„“1\ell_{1}roman_â„“
start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT norm of
(ğ‘«(2)â¢(â„›))âˆ’1superscriptsuperscriptğ‘«2â„›1(\boldsymbol{D}^{(2)}(\mathcal{R}))^{-1}(
bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R
) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT is
ğ”šğ”š\mathfrak{W}fraktur_W, the â„“1subscriptâ„“1\ell_{1}roman_â„“
start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT norm of the first column of
(ğ‘«(2)â¢(â„›))âˆ’1.superscriptsuperscriptğ‘«2â„›1(\boldsymbol{D}^{(2)}(\mathcal{R}))^{-1}.(
bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R
) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT .

Similarly, using the expression for
(ğ‘«(2)â¢(â„›))âˆ’1superscriptsuperscriptğ‘«2â„›1(\boldsymbol{D}^{(2)}(\mathcal{R}))^{-1}(
bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R
) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT from (G.7), we see that the
maximum row â„“1subscriptâ„“1\ell_{1}roman_â„“ start_POSTSUBSCRIPT 1
end_POSTSUBSCRIPT norm, in the bottom block of
(ğ‘«(2)â¢(â„›))âˆ’1superscriptsuperscriptğ‘«2â„›1(\boldsymbol{D}^{(2)}(\mathcal{R}))^{-1}(
bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R
) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT, is at most
Râˆ’1+Tâˆ’rR+1â‰¤R+1ğ‘…1ğ‘‡subscriptğ‘Ÿğ‘…1ğ‘…1R-1+T-r_{R}+1\leq R+1italic_R -
1 + italic_T - italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT + 1 â‰¤
italic_R + 1, because each of the Râˆ’1ğ‘…1R-1italic_R - 1 blocks of
ğ‘¼~bold-~ğ‘¼\boldsymbol{\tilde{U}}overbold_~ start_ARG bold_italic_U end_ARG
matrices has a single 1 in each row and
(ğ‘«(1)â¢(Tâˆ’rR+1)âˆ’1)âŠ¤superscriptsuperscriptğ‘«1superscriptğ‘‡subscriptğ‘Ÿğ‘…11top\left(\boldsymbol{D}^{(1)}(T-r_{R}+1)^{-1}\right)^{\top}(
bold_italic_D start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ( italic_T -
italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT + 1 )
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤
end_POSTSUPERSCRIPT has a row of Tâˆ’rR+1ğ‘‡subscriptğ‘Ÿğ‘…1T-r_{R}+1italic_T
- italic_r start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT + 1 ones. So

| âˆ¥(ğ‘«(2)â¢(â„›))âˆ’1âˆ¥1â¢âˆ¥(ğ‘«(2)â¢(â„›))âˆ’1âˆ¥âˆâ‰¤subscriptdelimited-âˆ¥âˆ¥superscriptsuperscriptğ‘«2â„›11subscriptdelimited-âˆ¥âˆ¥superscriptsuperscriptğ‘«2â„›1absent\displaystyle\lVert(\boldsymbol{D}^{(2)}(\mathcal{R}))^{-1}\rVert_{1}\lVert(% \boldsymbol{D}^{(2)}(\mathcal{R}))^{-1}\rVert_{\infty}\leq\leavevmode\nobreak\ âˆ¥ ( bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT âˆ¥ ( bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT â‰¤ | ğ”šâ¢(T+R)ğ”šğ‘‡ğ‘…\displaystyle\mathfrak{W}(T+R)fraktur_W ( italic_T + italic_R ) |   
---|---|---|---  
| âŸ¹Ïƒminâ¢((ğ‘«(2)â¢(â„›))âˆ’1)â‰¥subscriptğœminsuperscriptsuperscriptğ‘«2â„›1absent\displaystyle\implies\qquad\sigma_{\text{min}}\left((\boldsymbol{D}^{(2)}(% \mathcal{R}))^{-1}\right)\geq\leavevmode\nobreak\ âŸ¹ italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( ( bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) â‰¥ | 1ğ”šâ¢(T+R).1ğ”šğ‘‡ğ‘…\displaystyle\frac{1}{\sqrt{\mathfrak{W}(T+R)}}.divide start_ARG 1 end_ARG start_ARG square-root start_ARG fraktur_W ( italic_T + italic_R ) end_ARG end_ARG . |   
  
Using the fact that
ğ”šâ‰¤(Tâˆ’1)2ğ”šsuperscriptğ‘‡12\mathfrak{W}\leq(T-1)^{2}fraktur_W â‰¤ (
italic_T - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT from Lemma E.1, we
have

| Ïƒminâ¢((ğ‘«(2)â¢(â„›))âˆ’1)â‰¥1(Tâˆ’1)â¢T+Râ‰¥1(Tâˆ’1)â¢2â¢Tâˆ’1.subscriptğœminsuperscriptsuperscriptğ‘«2â„›11ğ‘‡1ğ‘‡ğ‘…1ğ‘‡12ğ‘‡1\sigma_{\text{min}}\left((\boldsymbol{D}^{(2)}(\mathcal{R}))^{-1}\right)\geq% \frac{1}{(T-1)\sqrt{T+R}}\geq\frac{1}{(T-1)\sqrt{2T-1}}.italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( ( bold_italic_D start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ( caligraphic_R ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) â‰¥ divide start_ARG 1 end_ARG start_ARG ( italic_T - 1 ) square-root start_ARG italic_T + italic_R end_ARG end_ARG â‰¥ divide start_ARG 1 end_ARG start_ARG ( italic_T - 1 ) square-root start_ARG 2 italic_T - 1 end_ARG end_ARG . |  | (H.3)  
---|---|---|---  
  
Finally, using (H.2) and (H.3), Tâ‰¥2ğ‘‡2T\geq 2italic_T â‰¥ 2, and the fact
that the smallest singular value of the identity matrix is 1, we have

| Ïƒminâ¢(ğ‘«N)â‰¥subscriptğœminsubscriptğ‘«ğ‘absent\displaystyle\sigma_{\text{min}}\left(\boldsymbol{D}_{N}\right)\geq\leavevmode\nobreak\ italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) â‰¥ | minâ¡{1R,1Tâˆ’1,1,1(Tâˆ’1)â¢2â¢Tâˆ’1}â‰¥1(Tâˆ’1)â¢2â¢Tâˆ’1â‰¥1Tâ¢2â¢T.1ğ‘…1ğ‘‡111ğ‘‡12ğ‘‡11ğ‘‡12ğ‘‡11ğ‘‡2ğ‘‡\displaystyle\min\left\\{\frac{1}{R},\frac{1}{T-1},1,\frac{1}{(T-1)\sqrt{2T-1}}% \right\\}\geq\frac{1}{(T-1)\sqrt{2T-1}}\geq\frac{1}{T\sqrt{2T}}.roman_min { divide start_ARG 1 end_ARG start_ARG italic_R end_ARG , divide start_ARG 1 end_ARG start_ARG italic_T - 1 end_ARG , 1 , divide start_ARG 1 end_ARG start_ARG ( italic_T - 1 ) square-root start_ARG 2 italic_T - 1 end_ARG end_ARG } â‰¥ divide start_ARG 1 end_ARG start_ARG ( italic_T - 1 ) square-root start_ARG 2 italic_T - 1 end_ARG end_ARG â‰¥ divide start_ARG 1 end_ARG start_ARG italic_T square-root start_ARG 2 italic_T end_ARG end_ARG . |   
---|---|---|---  
  
âˆ

###### Proof of Lemma F.2.

We will first show that ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT having finite fourth moments
under Assumption (R1) is enough for
ğ’~(iâ‹…)â‹…\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}overbold_~ start_ARG
bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT to have finite fourth moments as well. We will show that
each entry of
ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1}overbold_~
start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT is a bounded linear combination
of a finite number of elements of
ğ’~(iâ‹…)â‹…\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}overbold_~ start_ARG
bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT, and likewise for
ğ‘®Nâ¢ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1\boldsymbol{G}_{N}\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1}bold_italic_G
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT overbold_~ start_ARG
bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT. Then the finite moments will
follow using our Assumption (R1), Cauchy-Schwarz, and HÃ¶lderâ€™s inequality.

Besides ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT, the entries of
ğ’~isubscriptbold-~ğ’ğ‘–\boldsymbol{\tilde{Z}}_{i}overbold_~ start_ARG
bold_italic_Z end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT consist
of indicator variables and interactions of the indicator variables with
themselves and ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X
start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT. All of these terms are upper-
bounded by the greater of 1 or
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT. Using this, our assumption that
ğ”¼â¢[X(i)â¢j4]ğ”¼delimited-[]superscriptsubscriptğ‘‹ğ‘–ğ‘—4\mathbb{E}[X_{(i)j}^{4}]blackboard_E
[ italic_X start_POSTSUBSCRIPT ( italic_i ) italic_j end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ] is finite for all
jâˆˆ[pN]ğ‘—delimited-[]subscriptğ‘ğ‘j\in[p_{N}]italic_j âˆˆ [ italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ], and the fact that
ğ‘¿isubscriptğ‘¿ğ‘–\boldsymbol{X}_{i}bold_italic_X start_POSTSUBSCRIPT
italic_i end_POSTSUBSCRIPT is time-invariant, we have that for any fixed
Nğ‘Nitalic_N, maxjâˆˆ[dN],tâˆˆ[T]â¡{ğ”¼â¢[Z(iâ¢t)â¢j4]}subscriptformulae-
sequenceğ‘—delimited-[]subscriptğ‘‘ğ‘ğ‘¡delimited-[]ğ‘‡ğ”¼delimited-[]superscriptsubscriptğ‘ğ‘–ğ‘¡ğ‘—4\max_{j\in[d_{N}],t\in[T]}\\{\mathbb{E}[Z_{(it)j}^{4}]\\}roman_max
start_POSTSUBSCRIPT italic_j âˆˆ [ italic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ] , italic_t âˆˆ [ italic_T ] end_POSTSUBSCRIPT {
blackboard_E [ italic_Z start_POSTSUBSCRIPT ( italic_i italic_t ) italic_j
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ] } is finite.

Now we consider the entries of
ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1âˆˆâ„Nâ¢TÃ—pN\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1}\in\mathbb{R}^{NT%
\times p_{N}}overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT (
italic_i â‹… ) â‹… end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆˆ
blackboard_R start_POSTSUPERSCRIPT italic_N italic_T Ã— italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT. The
columns of
ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1}overbold_~
start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT are linear combinations of the
columns of ğ’~(iâ‹…)â‹…\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}overbold_~
start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT; in particular, the jthsuperscriptğ‘—thj^{\text{th}}italic_j
start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT column of
ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1}overbold_~
start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT is
ğ’~(iâ‹…)â‹…â¢(ğ‘«Nâˆ’1)â‹…jâˆˆâ„Nâ¢T\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}(\boldsymbol{D}_{N}^{-1})_{\cdot
j}\in% \mathbb{R}^{NT}overbold_~ start_ARG bold_italic_Z end_ARG
start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT ( bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT â‹… italic_j end_POSTSUBSCRIPT âˆˆ
blackboard_R start_POSTSUPERSCRIPT italic_N italic_T end_POSTSUPERSCRIPT,
where
(ğ‘«Nâˆ’1)â‹…jsubscriptsuperscriptsubscriptğ‘«ğ‘1â‹…absentğ‘—(\boldsymbol{D}_{N}^{-1})_{\cdot
j}( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT â‹…
italic_j end_POSTSUBSCRIPT is the jthsuperscriptğ‘—thj^{\text{th}}italic_j
start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT column of
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT. From (E.2) and the expressions in the proof of Lemma E.1
we see that
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT contains only entries that equal 1 or 0, so for any
tâˆˆ[T]ğ‘¡delimited-[]ğ‘‡t\in[T]italic_t âˆˆ [ italic_T ] and
jâˆˆ[pN]ğ‘—delimited-[]subscriptğ‘ğ‘j\in[p_{N}]italic_j âˆˆ [ italic_p
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ],

| (ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1)(1â¢t)â¢j4=[(ğ’~(iâ‹…)â‹…â¢(ğ‘«Nâˆ’1)â‹…j)(1â¢t)]4=(âˆ‘{jâ€²:(ğ‘«Nâˆ’1)jâ€²â¢jâ‰ 0}Z(1â¢t)â¢jâ€²)4.(\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1})_{(1t)j}^{4}=% \left[\left(\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}(\boldsymbol{D}_{N}^{-1})_{% \cdot j}\right)_{(1t)}\right]^{4}=\left(\sum_{\\{j^{\prime}:(\boldsymbol{D}_{N}% ^{-1})_{j^{\prime}j}\neq 0\\}}Z_{(1t)j^{\prime}}\right)^{4}.( overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT ( 1 italic_t ) italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT = [ ( overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹… end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT â‹… italic_j end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT ( 1 italic_t ) end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT = ( âˆ‘ start_POSTSUBSCRIPT { italic_j start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT : ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT italic_j end_POSTSUBSCRIPT â‰ 0 } end_POSTSUBSCRIPT italic_Z start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT . |   
---|---|---  
  
From (E.2) and the expressions in the proof of Lemma E.1 we have that
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT has a block diagonal structure with blocks of size at most
ğ”šâ‰¤(Tâˆ’1)2ğ”šsuperscriptğ‘‡12\mathfrak{W}\leq(T-1)^{2}fraktur_W â‰¤ (
italic_T - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT (an upper bound we
established in Lemma E.1), so this sum contains at most
(Tâˆ’1)2superscriptğ‘‡12(T-1)^{2}( italic_T - 1 ) start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT terms before expansion. By the multinomial theorem, the
number of terms after expansion is therefore at most

| (4+(Tâˆ’1)2âˆ’1(Tâˆ’1)2âˆ’1).binomial4superscriptğ‘‡121superscriptğ‘‡121\binom{4+(T-1)^{2}-1}{(T-1)^{2}-1}.( FRACOP start_ARG 4 + ( italic_T - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 1 end_ARG start_ARG ( italic_T - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 1 end_ARG ) . |   
---|---|---  
  
Tğ‘‡Titalic_T is fixed and finite, so the number of terms after expansion is
finite as well. Therefore if we can show that each summand after expansion has
finite 4thsuperscript4th4^{\text{th}}4 start_POSTSUPERSCRIPT th
end_POSTSUPERSCRIPT moment, we have shown that each entry of
ğ’~(iâ‹…)â‹…â¢ğ‘«Nâˆ’1\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}\boldsymbol{D}_{N}^{-1}overbold_~
start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT has finite
4thsuperscript4th4^{\text{th}}4 start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT
moment.

This sum when expanded contains terms of the form
Z~(1â¢t)â¢jâ€²4superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²4\tilde{Z}_{(1t)j^{\prime}}^{4}over~
start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT,
Z~(1â¢t)â¢jâ€²2â¢Z~(1â¢t)â¢jâ€²â€²2superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²2superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²2\tilde{Z}_{(1t)j^{\prime}}^{2}\tilde{Z}_{(1t)j^{\prime\prime}}^{2}over~
start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT over~ start_ARG italic_Z end_ARG
start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€²
end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT for jâ€²â‰
jâ€²â€²superscriptğ‘—â€²superscriptğ‘—â€²â€²j^{\prime}\neq
j^{\prime\prime}italic_j start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT â‰
italic_j start_POSTSUPERSCRIPT â€² â€² end_POSTSUPERSCRIPT,
Z~(1â¢t)â¢jâ€²3â¢Z~(1â¢t)â¢jâ€²â€²superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²3subscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²\tilde{Z}_{(1t)j^{\prime}}^{3}\tilde{Z}_{(1t)j^{\prime\prime}}over~
start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT over~ start_ARG italic_Z end_ARG
start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€²
end_POSTSUPERSCRIPT end_POSTSUBSCRIPT,
Z~(1â¢t)â¢jâ€²2â¢Z~(1â¢t)â¢jâ€²â€²â¢Z~(1â¢t)â¢jâ€²â€²â€²superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²2subscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²subscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²â€²\tilde{Z}_{(1t)j^{\prime}}^{2}\tilde{Z}_{(1t)j^{\prime\prime}}\tilde{Z}_{(1t)j%
^{\prime\prime\prime}}over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1
italic_t ) italic_j start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT over~ start_ARG
italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT over~
start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT and
Z~(1â¢t)â¢jâ€²â¢Z~(1â¢t)â¢jâ€²â€²â¢Z~(1â¢t)â¢jâ€²â€²â€²â¢Z~(1â¢t)â¢jâ€²â€²â€²â€²subscript~ğ‘1ğ‘¡superscriptğ‘—â€²subscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²subscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²â€²subscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²â€²â€²\tilde{Z}_{(1t)j^{\prime}}\tilde{Z}_{(1t)j^{\prime\prime}}\tilde{Z}_{(1t)j^{%
\prime\prime\prime}}\tilde{Z}_{(1t)j^{\prime\prime\prime\prime}}over~
start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT over~
start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT over~
start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT over~
start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² â€² â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT
(disregarding constant factors). We demonstrate that each of these terms has
finite fourth moment below using Cauchy-Schwarz and HÃ¶lderâ€™s inequality:

  * â€¢

We have already shown that
ğ”¼â¢[Z~(1â¢t)â¢jâ€²4]ğ”¼delimited-[]superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²4\mathbb{E}[\tilde{Z}_{(1t)j^{\prime}}^{4}]blackboard_E
[ over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ] is finite.

  * â€¢

ğ”¼â¢[Z~(1â¢t)â¢jâ€²2â¢Z~(1â¢t)â¢jâ€²â€²2]â‰¤ğ”¼â¢[Z~(1â¢t)â¢jâ€²4]â¢ğ”¼â¢[Z~(1â¢t)â¢jâ€²â€²4]ğ”¼delimited-[]superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²2superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²2ğ”¼delimited-[]superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²4ğ”¼delimited-[]superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²4\mathbb{E}[\tilde{Z}_{(1t)j^{\prime}}^{2}\tilde{Z}_{(1t)j^{\prime\prime}}^{2}]%
\leq\sqrt{\mathbb{E}[\tilde{Z}_{(1t)j^{\prime}}^{4}]\mathbb{E}[\tilde{Z}_{(1t)%
j^{\prime\prime}}^{4}]}blackboard_E [ over~ start_ARG italic_Z end_ARG
start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€²
end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1
italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€² end_POSTSUPERSCRIPT
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] â‰¤ square-
root start_ARG blackboard_E [ over~ start_ARG italic_Z end_ARG
start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€²
end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 4
end_POSTSUPERSCRIPT ] blackboard_E [ over~ start_ARG italic_Z end_ARG
start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€²
end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 4
end_POSTSUPERSCRIPT ] end_ARG, and terms of this form are finite using the
finite fourth moments of
ğ’~(iâ‹…)â‹…\boldsymbol{\tilde{Z}}_{(i\cdot)\cdot}overbold_~ start_ARG
bold_italic_Z end_ARG start_POSTSUBSCRIPT ( italic_i â‹… ) â‹…
end_POSTSUBSCRIPT.

  * â€¢

Recall that by HÃ¶lderâ€™s inequality, for any p,q>1ğ‘ğ‘1p,q>1italic_p , italic_q > 1 such that 1/p+1/q=11ğ‘1ğ‘11/p+1/q=11 / italic_p + 1 / italic_q = 1, if Xğ‘‹Xitalic_X and Yğ‘ŒYitalic_Y are random variables with (ğ”¼â¢|X|p)1/psuperscriptğ”¼superscriptğ‘‹ğ‘1ğ‘\left(\mathbb{E}|X|^{p}\right)^{1/p}( blackboard_E | italic_X | start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 1 / italic_p end_POSTSUPERSCRIPT and (ğ”¼â¢|Y|q)1/qsuperscriptğ”¼superscriptğ‘Œğ‘1ğ‘\left(\mathbb{E}|Y|^{q}\right)^{1/q}( blackboard_E | italic_Y | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 1 / italic_q end_POSTSUPERSCRIPT finite then

| ğ”¼â¢|Xâ¢Y|â‰¤(ğ”¼â¢|X|p)1/pâ¢(ğ”¼â¢|Y|q)1/q.ğ”¼ğ‘‹ğ‘Œsuperscriptğ”¼superscriptğ‘‹ğ‘1ğ‘superscriptğ”¼superscriptğ‘Œğ‘1ğ‘\mathbb{E}|XY|\leq\left(\mathbb{E}|X|^{p}\right)^{1/p}\left(\mathbb{E}|Y|^{q}% \right)^{1/q}.blackboard_E | italic_X italic_Y | â‰¤ ( blackboard_E | italic_X | start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 1 / italic_p end_POSTSUPERSCRIPT ( blackboard_E | italic_Y | start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 1 / italic_q end_POSTSUPERSCRIPT . |   
---|---|---  
  
Choosing p=4/3ğ‘43p=4/3italic_p = 4 / 3 and q=4ğ‘4q=4italic_q = 4, we have

| ğ”¼â¢[Z~(1â¢t)â¢jâ€²3â¢Z~(1â¢t)â¢jâ€²â€²]â‰¤ğ”¼delimited-[]superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²3subscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²absent\displaystyle\mathbb{E}[\tilde{Z}_{(1t)j^{\prime}}^{3}\tilde{Z}_{(1t)j^{\prime% \prime}}]\leq\leavevmode\nobreak\ blackboard_E [ over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ] â‰¤ | ğ”¼â¢[|Z~(1â¢t)â¢jâ€²|3â¢|Z~(1â¢t)â¢jâ€²â€²|]â‰¤(ğ”¼â¢[(|Z~(1â¢t)â¢jâ€²|3)4/3])3/4â¢(ğ”¼â¢[|Z~(1â¢t)â¢jâ€²â€²|4])1/4ğ”¼delimited-[]superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²3subscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²superscriptğ”¼delimited-[]superscriptsuperscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²34334superscriptğ”¼delimited-[]superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²414\displaystyle\mathbb{E}[|\tilde{Z}_{(1t)j^{\prime}}|^{3}|\tilde{Z}_{(1t)j^{% \prime\prime}}|]\leq\left(\mathbb{E}\left[(|\tilde{Z}_{(1t)j^{\prime}}|^{3})^{% 4/3}\right]\right)^{3/4}\left(\mathbb{E}\left[|\tilde{Z}_{(1t)j^{\prime\prime}% }|^{4}\right]\right)^{1/4}blackboard_E [ | over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT | over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT | ] â‰¤ ( blackboard_E [ ( | over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 4 / 3 end_POSTSUPERSCRIPT ] ) start_POSTSUPERSCRIPT 3 / 4 end_POSTSUPERSCRIPT ( blackboard_E [ | over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ] ) start_POSTSUPERSCRIPT 1 / 4 end_POSTSUPERSCRIPT |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | (ğ”¼â¢|Z~(1â¢t)â¢jâ€²|4)3/4â¢(ğ”¼â¢|Z~(1â¢t)â¢jâ€²â€²|4)1/4,superscriptğ”¼superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²434superscriptğ”¼superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²414\displaystyle\left(\mathbb{E}|\tilde{Z}_{(1t)j^{\prime}}|^{4}\right)^{3/4}% \left(\mathbb{E}|\tilde{Z}_{(1t)j^{\prime\prime}}|^{4}\right)^{1/4},( blackboard_E | over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 3 / 4 end_POSTSUPERSCRIPT ( blackboard_E | over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 1 / 4 end_POSTSUPERSCRIPT , |   
  
which is finite.

  * â€¢

ğ”¼[Z~(1â¢t)â¢jâ€²2Z~(1â¢t)â¢jâ€²â€²Z~(1â¢t)â¢jâ€²â€²â€²]â‰¤ğ”¼â¢[Z~(1â¢t)â¢jâ€²4]ğ”¼[Z~(1â¢t)â¢jâ€²â€²2Z~(1â¢t)â¢jâ€²â€²â€²2]\mathbb{E}[\tilde{Z}_{(1t)j^{\prime}}^{2}\tilde{Z}_{(1t)j^{\prime\prime}}%
\tilde{Z}_{(1t)j^{\prime\prime\prime}}]\leq\sqrt{\mathbb{E}[\tilde{Z}_{(1t)j^{%
\prime}}^{4}]}\sqrt{\mathbb{E}[\tilde{Z}_{(1t)j^{\prime\prime}}^{2}\tilde{Z}_{%
(1t)j^{\prime\prime\prime}}^{2}}]blackboard_E [ over~ start_ARG italic_Z
end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€²
end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1
italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€² end_POSTSUPERSCRIPT
end_POSTSUBSCRIPT over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1
italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€² â€² end_POSTSUPERSCRIPT
end_POSTSUBSCRIPT ] â‰¤ square-root start_ARG blackboard_E [ over~ start_ARG
italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ] end_ARG square-root start_ARG
blackboard_E [ over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1
italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€² end_POSTSUPERSCRIPT
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT over~ start_ARG
italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ], and we already showed
that terms of this form are finite.

  * â€¢

ğ”¼â¢[Z~(1â¢t)â¢jâ€²â¢Z~(1â¢t)â¢jâ€²â€²â¢Z~(1â¢t)â¢jâ€²â€²â€²â¢Z~(1â¢t)â¢jâ€²â€²â€²â€²]â‰¤ğ”¼â¢[Z~(1â¢t)â¢jâ€²2â¢Z~(1â¢t)â¢jâ€²â€²2]â¢ğ”¼â¢[Z~(1â¢t)â¢jâ€²â€²â€²2â¢Z~(1â¢t)â¢jâ€²â€²â€²â€²2]ğ”¼delimited-[]subscript~ğ‘1ğ‘¡superscriptğ‘—â€²subscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²subscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²â€²subscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²â€²â€²ğ”¼delimited-[]superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²2superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²2ğ”¼delimited-[]superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²â€²2superscriptsubscript~ğ‘1ğ‘¡superscriptğ‘—â€²â€²â€²â€²2\mathbb{E}[\tilde{Z}_{(1t)j^{\prime}}\tilde{Z}_{(1t)j^{\prime\prime}}\tilde{Z}%
_{(1t)j^{\prime\prime\prime}}\tilde{Z}_{(1t)j^{\prime\prime\prime\prime}}]\leq%
\sqrt{\mathbb{E}[\tilde{Z}_{(1t)j^{\prime}}^{2}\tilde{Z}_{(1t)j^{\prime\prime}%
}^{2}]\mathbb{E}[\tilde{Z}_{(1t)j^{\prime\prime\prime}}^{2}\tilde{Z}_{(1t)j^{%
\prime\prime\prime\prime}}^{2}]}blackboard_E [ over~ start_ARG italic_Z
end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€²
end_POSTSUPERSCRIPT end_POSTSUBSCRIPT over~ start_ARG italic_Z end_ARG
start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€²
end_POSTSUPERSCRIPT end_POSTSUBSCRIPT over~ start_ARG italic_Z end_ARG
start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€² â€²
end_POSTSUPERSCRIPT end_POSTSUBSCRIPT over~ start_ARG italic_Z end_ARG
start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€² â€²
â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ] â‰¤ square-root start_ARG
blackboard_E [ over~ start_ARG italic_Z end_ARG start_POSTSUBSCRIPT ( 1
italic_t ) italic_j start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT over~ start_ARG
italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] blackboard_E [ over~ start_ARG
italic_Z end_ARG start_POSTSUBSCRIPT ( 1 italic_t ) italic_j
start_POSTSUPERSCRIPT â€² â€² â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT over~ start_ARG italic_Z end_ARG
start_POSTSUBSCRIPT ( 1 italic_t ) italic_j start_POSTSUPERSCRIPT â€² â€² â€²
â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT ] end_ARG, and we already showed that terms of this form
are finite.

âˆ

###### Proof of Lemma F.3.

Recall that for any matrix ğ‘¨ğ‘¨\boldsymbol{A}bold_italic_A, the eigenvalues
of
ğ‘¨âŠ¤â¢ğ‘¨superscriptğ‘¨topğ‘¨\boldsymbol{A}^{\top}\boldsymbol{A}bold_italic_A
start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_A are the squares of
the singular values of ğ‘¨ğ‘¨\boldsymbol{A}bold_italic_A. So
Î»minâ¢(1Nâ¢Tâ¢(ğ’â¢ğ‘«Nâˆ’1)âŠ¤â¢ğ’â¢ğ‘«Nâˆ’1)=Ïƒminâ¢(ğ’â¢ğ‘«Nâˆ’1)2/(Nâ¢T)subscriptğœ†min1ğ‘ğ‘‡superscriptğ’superscriptsubscriptğ‘«ğ‘1topğ’superscriptsubscriptğ‘«ğ‘1subscriptğœminsuperscriptğ’superscriptsubscriptğ‘«ğ‘12ğ‘ğ‘‡\lambda_{\text{min}}\left(\frac{1}{NT}\left(\boldsymbol{Z}\boldsymbol{D}_{N}^{%
-1}\right)^{\top}\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}\right)=\sigma_{\text{%
min}}\left(\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}\right)^{2}/(NT)italic_Î»
start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG
start_ARG italic_N italic_T end_ARG ( bold_italic_Z bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT
bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) = italic_Ïƒ
start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_Z bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / ( italic_N
italic_T ) and

| Î»maxâ¢(1Nâ¢Tâ¢(ğ’â¢ğ‘«Nâˆ’1)âŠ¤â¢ğ’â¢ğ‘«Nâˆ’1)=Ïƒmaxâ¢(ğ’â¢ğ‘«Nâˆ’1)2/(Nâ¢T),subscriptğœ†max1ğ‘ğ‘‡superscriptğ’superscriptsubscriptğ‘«ğ‘1topğ’superscriptsubscriptğ‘«ğ‘1subscriptğœmaxsuperscriptğ’superscriptsubscriptğ‘«ğ‘12ğ‘ğ‘‡\lambda_{\text{max}}\left(\frac{1}{NT}\left(\boldsymbol{Z}\boldsymbol{D}_{N}^{% -1}\right)^{\top}\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}\right)=\sigma_{\text{% max}}\left(\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}\right)^{2}/(NT),italic_Î» start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_N italic_T end_ARG ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) = italic_Ïƒ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / ( italic_N italic_T ) , |   
---|---|---  
  
and it is enough to bound the singular values of
ğ’â¢ğ‘«Nâˆ’1ğ’superscriptsubscriptğ‘«ğ‘1\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}bold_italic_Z
bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT, which we can do with Lemma H.1:

######  Lemma H.1.

Let ğ€ğ€\boldsymbol{A}bold_italic_A and ğğ\boldsymbol{B}bold_italic_B be
conformable real matrices where ğğ\boldsymbol{B}bold_italic_B has full column
rank.

  1. (a)

(Theorem 2 in GÃ¼ngÃ¶r 2007.)

| Ïƒminâ¢(ğ‘¨â¢ğ‘©)â‰¥Ïƒminâ¢(ğ‘¨)â¢Ïƒminâ¢(ğ‘©).subscriptğœminğ‘¨ğ‘©subscriptğœminğ‘¨subscriptğœminğ‘©\sigma_{\text{min}}\left(\boldsymbol{A}\boldsymbol{B}\right)\geq\sigma_{\text{% min}}\left(\boldsymbol{A}\right)\sigma_{\text{min}}\left(\boldsymbol{B}\right).italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_A bold_italic_B ) â‰¥ italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_A ) italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_B ) . |   
---|---|---  
  
  2. (b)

(Theorem 3.3.4 in Horn and Johnson [1991].)

| Ïƒmaxâ¢(ğ‘¨â¢ğ‘©)â‰¤Ïƒmaxâ¢(ğ‘¨)â¢Ïƒmaxâ¢(ğ‘©).subscriptğœmaxğ‘¨ğ‘©subscriptğœmaxğ‘¨subscriptğœmaxğ‘©\sigma_{\text{max}}\left(\boldsymbol{A}\boldsymbol{B}\right)\leq\sigma_{\text{% max}}\left(\boldsymbol{A}\right)\sigma_{\text{max}}\left(\boldsymbol{B}\right).italic_Ïƒ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_italic_A bold_italic_B ) â‰¤ italic_Ïƒ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_italic_A ) italic_Ïƒ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_italic_B ) . |   
---|---|---  
  

We bounded the singular values of the deterministic
ğ‘«Nâˆ’1superscriptsubscriptğ‘«ğ‘1\boldsymbol{D}_{N}^{-1}bold_italic_D
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1
end_POSTSUPERSCRIPT in Lemma F.1. Using that and the fact that
1Nâ¢Tâ¢Ïƒminâ¢(ğ’)2=Î»minâ¢(1Nâ¢Tâ¢ğ’âŠ¤â¢ğ’)=e1â¢N1ğ‘ğ‘‡subscriptğœminsuperscriptğ’2subscriptğœ†min1ğ‘ğ‘‡superscriptğ’topğ’subscriptğ‘’1ğ‘\frac{1}{NT}\sigma_{\text{min}}\left(\boldsymbol{Z}\right)^{2}=\lambda_{\text{%
min}}\left(\frac{1}{NT}\boldsymbol{Z}^{\top}\boldsymbol{Z}\right)=e_{1N}divide
start_ARG 1 end_ARG start_ARG italic_N italic_T end_ARG italic_Ïƒ
start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_Z )
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = italic_Î» start_POSTSUBSCRIPT
min end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_N italic_T
end_ARG bold_italic_Z start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT
bold_italic_Z ) = italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT,
we have

| Î»minâ¢(1Nâ¢Tâ¢(ğ’â¢ğ‘«Nâˆ’1)âŠ¤â¢ğ’â¢ğ‘«Nâˆ’1)â‰¥subscriptğœ†min1ğ‘ğ‘‡superscriptğ’superscriptsubscriptğ‘«ğ‘1topğ’superscriptsubscriptğ‘«ğ‘1absent\displaystyle\lambda_{\text{min}}\left(\frac{1}{NT}\left(\boldsymbol{Z}% \boldsymbol{D}_{N}^{-1}\right)^{\top}\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}% \right)\geq\leavevmode\nobreak\ italic_Î» start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_N italic_T end_ARG ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) â‰¥ | 1Nâ¢Tâ¢Ïƒminâ¢(ğ’)2â¢Ïƒminâ¢(ğ‘«Nâˆ’1)21ğ‘ğ‘‡subscriptğœminsuperscriptğ’2subscriptğœminsuperscriptsuperscriptsubscriptğ‘«ğ‘12\displaystyle\frac{1}{NT}\sigma_{\text{min}}\left(\boldsymbol{Z}\right)^{2}% \sigma_{\text{min}}\left(\boldsymbol{D}_{N}^{-1}\right)^{2}divide start_ARG 1 end_ARG start_ARG italic_N italic_T end_ARG italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_Z ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT |   
---|---|---|---  
| â‰¥\displaystyle\geq\leavevmode\nobreak\ â‰¥ | Î»minâ¢(1Nâ¢Tâ¢ğ’~âŠ¤â¢ğ’~)â¢(13)2subscriptğœ†min1ğ‘ğ‘‡superscriptbold-~ğ’topbold-~ğ’superscript132\displaystyle\lambda_{\text{min}}\left(\frac{1}{NT}\boldsymbol{\tilde{Z}}^{% \top}\boldsymbol{\tilde{Z}}\right)\left(\frac{1}{3}\right)^{2}italic_Î» start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_N italic_T end_ARG overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_~ start_ARG bold_italic_Z end_ARG ) ( divide start_ARG 1 end_ARG start_ARG 3 end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT |   
| â‰¥\displaystyle\geq\leavevmode\nobreak\ â‰¥ | 19â¢e1â¢N,19subscriptğ‘’1ğ‘\displaystyle\frac{1}{9}e_{1N},divide start_ARG 1 end_ARG start_ARG 9 end_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT , |   
  
where we used that from Lemma F.1,

| Ïƒmaxâ¢(ğ‘«N)â‰¤3â‡”Ïƒminâ¢(ğ‘«Nâˆ’1)â‰¥13.formulae-sequencesubscriptğœmaxsubscriptğ‘«ğ‘3iffsubscriptğœminsuperscriptsubscriptğ‘«ğ‘113\displaystyle\sigma_{\text{max}}(\boldsymbol{D}_{N})\leq 3\qquad\iff\qquad% \sigma_{\text{min}}(\boldsymbol{D}_{N}^{-1})\geq\frac{1}{3}.italic_Ïƒ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) â‰¤ 3 â‡” italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) â‰¥ divide start_ARG 1 end_ARG start_ARG 3 end_ARG . |   
---|---|---  
  
Similarly,

| Î»maxâ¢(1Nâ¢Tâ¢(ğ’â¢ğ‘«Nâˆ’1)âŠ¤â¢ğ’â¢ğ‘«Nâˆ’1)â‰¤subscriptğœ†max1ğ‘ğ‘‡superscriptğ’superscriptsubscriptğ‘«ğ‘1topğ’superscriptsubscriptğ‘«ğ‘1absent\displaystyle\lambda_{\text{max}}\left(\frac{1}{NT}\left(\boldsymbol{Z}% \boldsymbol{D}_{N}^{-1}\right)^{\top}\boldsymbol{Z}\boldsymbol{D}_{N}^{-1}% \right)\leq\leavevmode\nobreak\ italic_Î» start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_N italic_T end_ARG ( bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Z bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) â‰¤ | Î»maxâ¢(1Nâ¢Tâ¢ğ’~âŠ¤â¢ğ’~)â¢(Tâ¢2â¢T)2â‰¤e2â¢Nâ‹…2â¢T3,subscriptğœ†max1ğ‘ğ‘‡superscriptbold-~ğ’topbold-~ğ’superscriptğ‘‡2ğ‘‡2â‹…subscriptğ‘’2ğ‘2superscriptğ‘‡3\displaystyle\lambda_{\text{max}}\left(\frac{1}{NT}\boldsymbol{\tilde{Z}}^{% \top}\boldsymbol{\tilde{Z}}\right)\left(T\sqrt{2T}\right)^{2}\leq e_{2N}\cdot 2% T^{3},italic_Î» start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_N italic_T end_ARG overbold_~ start_ARG bold_italic_Z end_ARG start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT overbold_~ start_ARG bold_italic_Z end_ARG ) ( italic_T square-root start_ARG 2 italic_T end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ italic_e start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT â‹… 2 italic_T start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT , |   
---|---|---|---  
  
where we used that from Lemma F.1,

| Ïƒminâ¢(ğ‘«N)â‰¥1Tâ¢2â¢Tâ‡”Ïƒmaxâ¢(ğ‘«Nâˆ’1)â‰¤Tâ¢2â¢T.formulae-sequencesubscriptğœminsubscriptğ‘«ğ‘1ğ‘‡2ğ‘‡iffsubscriptğœmaxsuperscriptsubscriptğ‘«ğ‘1ğ‘‡2ğ‘‡\displaystyle\sigma_{\text{min}}(\boldsymbol{D}_{N})\geq\frac{1}{T\sqrt{2T}}% \qquad\iff\qquad\sigma_{\text{max}}(\boldsymbol{D}_{N}^{-1})\leq T\sqrt{2T}.italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) â‰¥ divide start_ARG 1 end_ARG start_ARG italic_T square-root start_ARG 2 italic_T end_ARG end_ARG â‡” italic_Ïƒ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_italic_D start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) â‰¤ italic_T square-root start_ARG 2 italic_T end_ARG . |   
---|---|---  
  
âˆ

###### Proof of Theorem F.4.

For clarity, we use the notation of Kock [2013]. To extend Lemma 3 from Kock [2013], we use a similar strategy to the one used to prove Theorem 11.3(d) in Hastie etÂ al. [2015]. Since under Assumption (A5) from Kock [2013] we have min1â‰¤jâ‰¤kN{|Î²10j|}â‰¥b0\min_{1\leq j\leq k_{N}}\\{|\beta_{10j|}\\}\geq b_{0}roman_min start_POSTSUBSCRIPT 1 â‰¤ italic_j â‰¤ italic_k start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT { | italic_Î² start_POSTSUBSCRIPT 10 italic_j | end_POSTSUBSCRIPT } â‰¥ italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT, it is enough to show that with high probability Î²^2â¢N=ğŸsubscript^ğ›½2ğ‘0\hat{\beta}_{2N}=\boldsymbol{0}over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT = bold_0 and âˆ¥Î²^Nâˆ’Î²Nâˆ¥âˆâ‰¤b0/2subscriptdelimited-âˆ¥âˆ¥subscript^ğ›½ğ‘subscriptğ›½ğ‘subscriptğ‘02\lVert\hat{\beta}_{N}-\beta_{N}\rVert_{\infty}\leq b_{0}/2âˆ¥ over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT â‰¤ italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT / 2. That is,

| {Î²^2â¢N=ğŸ}âˆ©{âˆ¥Î²^Nâˆ’Î²Nâˆ¥âˆâ‰¤b02}âŠ†subscript^ğ›½2ğ‘0subscriptdelimited-âˆ¥âˆ¥subscript^ğ›½ğ‘subscriptğ›½ğ‘subscriptğ‘02absent\displaystyle\left\\{\hat{\beta}_{2N}=\boldsymbol{0}\right\\}\cap\left\\{\left% \lVert\hat{\beta}_{N}-\beta_{N}\right\rVert_{\infty}\leq\frac{b_{0}}{2}\right% \\}\subseteq\leavevmode\nobreak\ { over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT = bold_0 } âˆ© { âˆ¥ over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT â‰¤ divide start_ARG italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG } âŠ† | {ğ’®^=ğ’®}^ğ’®ğ’®\displaystyle\left\\{\hat{\mathcal{S}}=\mathcal{S}\right\\}{ over^ start_ARG caligraphic_S end_ARG = caligraphic_S } |   
---|---|---|---  
| âŸ¹{ğ’®^â‰ ğ’®}âŠ†^ğ’®ğ’®absent\displaystyle\implies\qquad\left\\{\hat{\mathcal{S}}\neq\mathcal{S}\right\\}% \subseteq\leavevmode\nobreak\ âŸ¹ { over^ start_ARG caligraphic_S end_ARG â‰ caligraphic_S } âŠ† | {Î²^2â¢Nâ‰ ğŸ}âˆª{âˆ¥Î²^Nâˆ’Î²Nâˆ¥âˆ>b02}subscript^ğ›½2ğ‘0subscriptdelimited-âˆ¥âˆ¥subscript^ğ›½ğ‘subscriptğ›½ğ‘subscriptğ‘02\displaystyle\left\\{\hat{\beta}_{2N}\neq\boldsymbol{0}\right\\}\cup\left\\{\left% \lVert\hat{\beta}_{N}-\beta_{N}\right\rVert_{\infty}>\frac{b_{0}}{2}\right\\}{ over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT â‰ bold_0 } âˆª { âˆ¥ over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT > divide start_ARG italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG } |   
| âŸ¹(a)â„™â¢(ğ’®^â‰ ğ’®)â‰¤superscriptğ‘â„™^ğ’®ğ’®absent\displaystyle\stackrel{{\scriptstyle(a)}}{{\implies}}\qquad\mathbb{P}\left(% \hat{\mathcal{S}}\neq\mathcal{S}\right)\leq\leavevmode\nobreak\ start_RELOP SUPERSCRIPTOP start_ARG âŸ¹ end_ARG start_ARG ( italic_a ) end_ARG end_RELOP blackboard_P ( over^ start_ARG caligraphic_S end_ARG â‰ caligraphic_S ) â‰¤ | â„™â¢({Î²^2â¢Nâ‰ ğŸ}âˆª{âˆ¥Î²^Nâˆ’Î²Nâˆ¥2>b02})â„™subscript^ğ›½2ğ‘0subscriptdelimited-âˆ¥âˆ¥subscript^ğ›½ğ‘subscriptğ›½ğ‘2subscriptğ‘02\displaystyle\mathbb{P}\left(\left\\{\hat{\beta}_{2N}\neq\boldsymbol{0}\right\\}% \cup\left\\{\left\lVert\hat{\beta}_{N}-\beta_{N}\right\rVert_{2}>\frac{b_{0}}{2% }\right\\}\right)blackboard_P ( { over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT â‰ bold_0 } âˆª { âˆ¥ over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT > divide start_ARG italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG } ) |   
| â‰¤\displaystyle\leq\leavevmode\nobreak\ â‰¤ | â„™â¢(Î²^2â¢Nâ‰ ğŸ)+â„™â¢(âˆ¥Î²^Nâˆ’Î²Nâˆ¥2>b02),â„™subscript^ğ›½2ğ‘0â„™subscriptdelimited-âˆ¥âˆ¥subscript^ğ›½ğ‘subscriptğ›½ğ‘2subscriptğ‘02\displaystyle\mathbb{P}\left(\hat{\beta}_{2N}\neq\boldsymbol{0}\right)+\mathbb% {P}\left(\left\lVert\hat{\beta}_{N}-\beta_{N}\right\rVert_{2}>\frac{b_{0}}{2}% \right),blackboard_P ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT â‰ bold_0 ) + blackboard_P ( âˆ¥ over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT > divide start_ARG italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG ) , |   
  
where in (a)ğ‘(a)( italic_a ) we used
âˆ¥â‹…âˆ¥âˆâ‰¤âˆ¥â‹…âˆ¥2subscriptdelimited-âˆ¥âˆ¥â‹…subscriptdelimited-
âˆ¥âˆ¥â‹…2\lVert\cdot\rVert_{\infty}\leq\lVert\cdot\rVert_{2}âˆ¥ â‹… âˆ¥
start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT â‰¤ âˆ¥ â‹… âˆ¥ start_POSTSUBSCRIPT 2
end_POSTSUBSCRIPT. Lemma 3 from Kock [2013] establishes that

| limNâ†’âˆâ„™â¢(Î²^2â¢Nâ‰ ğŸ)=0,subscriptâ†’ğ‘â„™subscript^ğ›½2ğ‘00\lim_{N\to\infty}\mathbb{P}\left(\hat{\beta}_{2N}\neq\boldsymbol{0}\right)=0,roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT â‰ bold_0 ) = 0 , |   
---|---|---  
  
and Theorem 1 in Kock [2013] (the assumptions of which are satisfied under the
assumptions of Lemma 3 in Kock 2013) establishes the consistency of
Î²^Nsubscript^ğ›½ğ‘\hat{\beta}_{N}over^ start_ARG italic_Î² end_ARG
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT, which is sufficient for

| limNâ†’âˆâ„™â¢(âˆ¥Î²^Nâˆ’Î²Nâˆ¥2>b02)=0.subscriptâ†’ğ‘â„™subscriptdelimited-âˆ¥âˆ¥subscript^ğ›½ğ‘subscriptğ›½ğ‘2subscriptğ‘020\lim_{N\to\infty}\mathbb{P}\left(\left\lVert\hat{\beta}_{N}-\beta_{N}\right% \rVert_{2}>\frac{b_{0}}{2}\right)=0.roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( âˆ¥ over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT > divide start_ARG italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG ) = 0 . |   
---|---|---  
  
So

| 0â‰¤limNâ†’âˆâ„™â¢(ğ’®^â‰ ğ’®)â‰¤0subscriptâ†’ğ‘â„™^ğ’®ğ’®absent\displaystyle 0\leq\lim_{N\to\infty}\mathbb{P}\left(\hat{\mathcal{S}}\neq% \mathcal{S}\right)\leq\leavevmode\nobreak\ 0 â‰¤ roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( over^ start_ARG caligraphic_S end_ARG â‰ caligraphic_S ) â‰¤ | limNâ†’âˆâ„™â¢(Î²^2â¢Nâ‰ ğŸ)+limNâ†’âˆâ„™â¢(âˆ¥Î²^Nâˆ’Î²Nâˆ¥2>b02)=0,subscriptâ†’ğ‘â„™subscript^ğ›½2ğ‘0subscriptâ†’ğ‘â„™subscriptdelimited-âˆ¥âˆ¥subscript^ğ›½ğ‘subscriptğ›½ğ‘2subscriptğ‘020\displaystyle\lim_{N\to\infty}\mathbb{P}\left(\hat{\beta}_{2N}\neq\boldsymbol{% 0}\right)+\lim_{N\to\infty}\mathbb{P}\left(\left\lVert\hat{\beta}_{N}-\beta_{N% }\right\rVert_{2}>\frac{b_{0}}{2}\right)=0,roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT â‰ bold_0 ) + roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( âˆ¥ over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT > divide start_ARG italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG ) = 0 , |   
---|---|---|---  
  
proving the result.

âˆ

###### Proof of Theorem F.5.

  1. (a)

Again, for clarity we use the notation of Kock [2013]. Since

| Nâ¢TNâ¢ğNâŠ¤â¢(Î²^Nâˆ’Î²0)=ğ‘subscriptğ‘‡ğ‘superscriptsubscriptğğ‘topsubscript^ğ›½ğ‘subscriptğ›½0absent\displaystyle\sqrt{NT_{N}}\boldsymbol{\psi}_{N}^{\top}(\hat{\beta}_{N}-\beta_{% 0})=\leavevmode\nobreak\ square-root start_ARG italic_N italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = | Nâ¢TNâ¢ğœ¶âŠ¤â¢(Î²^1â¢Nâˆ’Î²10)+Nâ¢TNâ¢ğ’ƒNâŠ¤â¢(Î²^2â¢Nâˆ’Î²20)ğ‘subscriptğ‘‡ğ‘superscriptğœ¶topsubscript^ğ›½1ğ‘subscriptğ›½10ğ‘subscriptğ‘‡ğ‘superscriptsubscriptğ’ƒğ‘topsubscript^ğ›½2ğ‘subscriptğ›½20\displaystyle\sqrt{NT_{N}}\boldsymbol{\alpha}^{\top}(\hat{\beta}_{1N}-\beta_{1% 0})+\sqrt{NT_{N}}\boldsymbol{b}_{N}^{\top}(\hat{\beta}_{2N}-\beta_{20})square-root start_ARG italic_N italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT ) + square-root start_ARG italic_N italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG bold_italic_b start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 20 end_POSTSUBSCRIPT ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢TNâ¢ğœ¶âŠ¤â¢(Î²^1â¢Nâˆ’Î²10)+Nâ¢TNâ¢ğ’ƒNâŠ¤â¢Î²^2â¢N,ğ‘subscriptğ‘‡ğ‘superscriptğœ¶topsubscript^ğ›½1ğ‘subscriptğ›½10ğ‘subscriptğ‘‡ğ‘superscriptsubscriptğ’ƒğ‘topsubscript^ğ›½2ğ‘\displaystyle\sqrt{NT_{N}}\boldsymbol{\alpha}^{\top}(\hat{\beta}_{1N}-\beta_{1% 0})+\sqrt{NT_{N}}\boldsymbol{b}_{N}^{\top}\hat{\beta}_{2N},square-root start_ARG italic_N italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT ) + square-root start_ARG italic_N italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG bold_italic_b start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT , |   
  
if we can show that

| Nâ¢TNâ¢ğ’ƒNâŠ¤â¢Î²^2â¢Nâ†’ğ‘0ğ‘â†’ğ‘subscriptğ‘‡ğ‘superscriptsubscriptğ’ƒğ‘topsubscript^ğ›½2ğ‘0\sqrt{NT_{N}}\boldsymbol{b}_{N}^{\top}\hat{\beta}_{2N}\xrightarrow{p}0square-root start_ARG italic_N italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG bold_italic_b start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT start_ARROW overitalic_p â†’ end_ARROW 0 |   
---|---|---  
  
then the result follows from Theorem 2(ii) from Kock [2013] (in particular,
Equation 7.5 in the proof) and Slutskyâ€™s theorem. Theorem 2(i) from Kock
[2013] establishes that

| limNâ†’âˆâ„™â¢(Î²^2â¢N=ğŸ)=1.subscriptâ†’ğ‘â„™subscript^ğ›½2ğ‘01\displaystyle\lim_{N\to\infty}\mathbb{P}\left(\hat{\beta}_{2N}=\boldsymbol{0}% \right)=1.roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT = bold_0 ) = 1 . |   
---|---|---  
  
Since for any Nğ‘Nitalic_N

| {Î²^2â¢N=ğŸ}âŠ†{Nâ¢TNâ¢âˆ‘j=1pNâˆ’k|(ğ’ƒN)jâ¢(Î²^2â¢N)j|=0},subscript^ğ›½2ğ‘0ğ‘subscriptğ‘‡ğ‘superscriptsubscriptğ‘—1subscriptğ‘ğ‘ğ‘˜subscriptsubscriptğ’ƒğ‘ğ‘—subscriptsubscript^ğ›½2ğ‘ğ‘—0\left\\{\hat{\beta}_{2N}=\boldsymbol{0}\right\\}\subseteq\left\\{\sqrt{NT_{N}}% \sum_{j=1}^{p_{N}-k}\left|(\boldsymbol{b}_{N})_{j}(\hat{\beta}_{2N})_{j}\right% |=0\right\\},{ over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT = bold_0 } âŠ† { square-root start_ARG italic_N italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG âˆ‘ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_k end_POSTSUPERSCRIPT | ( bold_italic_b start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | = 0 } , |   
---|---|---  
  
we have

| â„™â¢(Î²^2â¢N=ğŸ)â‰¤â„™â¢(Nâ¢TNâ¢âˆ‘j=1pNâˆ’k|(ğ’ƒN)jâ¢(Î²^2â¢N)j|=0),â„™subscript^ğ›½2ğ‘0â„™ğ‘subscriptğ‘‡ğ‘superscriptsubscriptğ‘—1subscriptğ‘ğ‘ğ‘˜subscriptsubscriptğ’ƒğ‘ğ‘—subscriptsubscript^ğ›½2ğ‘ğ‘—0\displaystyle\mathbb{P}\left(\hat{\beta}_{2N}=\boldsymbol{0}\right)\leq\mathbb% {P}\left(\sqrt{NT_{N}}\sum_{j=1}^{p_{N}-k}\left|(\boldsymbol{b}_{N})_{j}(\hat{% \beta}_{2N})_{j}\right|=0\right),blackboard_P ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT = bold_0 ) â‰¤ blackboard_P ( square-root start_ARG italic_N italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG âˆ‘ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_k end_POSTSUPERSCRIPT | ( bold_italic_b start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | = 0 ) , |   
---|---|---  
  
so

| 1â‰¥limNâ†’âˆâ„™â¢(Nâ¢TNâ¢âˆ‘j=1pNâˆ’k|(ğ’ƒN)jâ¢Î²^2â¢N|=0)â‰¥limNâ†’âˆâ„™â¢(Î²^2â¢N=ğŸ)=1,1subscriptâ†’ğ‘â„™ğ‘subscriptğ‘‡ğ‘superscriptsubscriptğ‘—1subscriptğ‘ğ‘ğ‘˜subscriptsubscriptğ’ƒğ‘ğ‘—subscript^ğ›½2ğ‘0subscriptâ†’ğ‘â„™subscript^ğ›½2ğ‘011\geq\lim_{N\to\infty}\mathbb{P}\left(\sqrt{NT_{N}}\sum_{j=1}^{p_{N}-k}\left|(% \boldsymbol{b}_{N})_{j}\hat{\beta}_{2N}\right|=0\right)\geq\lim_{N\to\infty}% \mathbb{P}\left(\hat{\beta}_{2N}=\boldsymbol{0}\right)=1,1 â‰¥ roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( square-root start_ARG italic_N italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG âˆ‘ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_k end_POSTSUPERSCRIPT | ( bold_italic_b start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT | = 0 ) â‰¥ roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT = bold_0 ) = 1 , |   
---|---|---  
  
establishing

| limNâ†’âˆâ„™â¢(Nâ¢TNâ¢âˆ‘j=1pNâˆ’k|(ğ’ƒN)jâ¢(Î²^2â¢N)j|=0)=1.subscriptâ†’ğ‘â„™ğ‘subscriptğ‘‡ğ‘superscriptsubscriptğ‘—1subscriptğ‘ğ‘ğ‘˜subscriptsubscriptğ’ƒğ‘ğ‘—subscriptsubscript^ğ›½2ğ‘ğ‘—01\lim_{N\to\infty}\mathbb{P}\left(\sqrt{NT_{N}}\sum_{j=1}^{p_{N}-k}\left|(% \boldsymbol{b}_{N})_{j}(\hat{\beta}_{2N})_{j}\right|=0\right)=1.roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( square-root start_ARG italic_N italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG âˆ‘ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_k end_POSTSUPERSCRIPT | ( bold_italic_b start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | = 0 ) = 1 . |   
---|---|---  
  
Since this notion of convergence is stronger than convergence in probability,
it follows that

| Nâ¢TNâ¢âˆ‘j=1pNâˆ’k(ğ’ƒN)jâ¢(Î²^2â¢N)jâ†’ğ‘ğ‘â†’ğ‘subscriptğ‘‡ğ‘superscriptsubscriptğ‘—1subscriptğ‘ğ‘ğ‘˜subscriptsubscriptğ’ƒğ‘ğ‘—subscriptsubscript^ğ›½2ğ‘ğ‘—absent\displaystyle\sqrt{NT_{N}}\sum_{j=1}^{p_{N}-k}(\boldsymbol{b}_{N})_{j}(\hat{% \beta}_{2N})_{j}\xrightarrow{p}\leavevmode\nobreak\ square-root start_ARG italic_N italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG âˆ‘ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_k end_POSTSUPERSCRIPT ( bold_italic_b start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_ARROW overitalic_p â†’ end_ARROW | 0,0\displaystyle 0,0 , |   
---|---|---|---  
  
proving the result.

  2. (b)

Since by the consistency of the sample covariance matrix and the continuous
mapping theorem

| 1Ïƒâ¢Tğœ¶â¢(ğ’®)âŠ¤â¢(ğšº^â¢(ğ‘¿(â‹…â‹…)â£ğ’®))âˆ’1â¢ğœ¶â¢(ğ’®)â†’ğ‘1Ïƒâ¢Tğœ¶â¢(ğ’®)âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶â¢(ğ’®),ğ‘â†’1ğœğ‘‡ğœ¶superscriptğ’®topsuperscriptbold-^ğšºsubscriptğ‘¿â‹…absentâ‹…ğ’®1ğœ¶ğ’®1ğœğ‘‡ğœ¶superscriptğ’®topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶ğ’®\frac{1}{\sigma}\sqrt{\frac{T}{\boldsymbol{\alpha}(\mathcal{S})^{\top}\left(% \boldsymbol{\hat{\Sigma}}(\boldsymbol{X}_{(\cdot\cdot)\mathcal{S}})\right)^{-1% }\boldsymbol{\alpha}(\mathcal{S})}}\xrightarrow{p}\frac{1}{\sigma}\sqrt{\frac{% T}{\boldsymbol{\alpha}(\mathcal{S})^{\top}\left(\lim_{N\to\infty}\mathbb{E}% \left[\Sigma_{1N}\right]\right)^{-1}\boldsymbol{\alpha}(\mathcal{S})}},divide start_ARG 1 end_ARG start_ARG italic_Ïƒ end_ARG square-root start_ARG divide start_ARG italic_T end_ARG start_ARG bold_italic_Î± ( caligraphic_S ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_X start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± ( caligraphic_S ) end_ARG end_ARG start_ARROW overitalic_p â†’ end_ARROW divide start_ARG 1 end_ARG start_ARG italic_Ïƒ end_ARG square-root start_ARG divide start_ARG italic_T end_ARG start_ARG bold_italic_Î± ( caligraphic_S ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± ( caligraphic_S ) end_ARG end_ARG , |   
---|---|---  
  
by part (a) and Slutskyâ€™s theorem we have that
Ubâ¢(ğ’®)subscriptğ‘ˆğ‘ğ’®U_{b}(\mathcal{S})italic_U start_POSTSUBSCRIPT
italic_b end_POSTSUBSCRIPT ( caligraphic_S ) converges in distribution to a
standard Gaussian random variable. Further,
â„™â¢(Ubâ¢(ğ’®^N)âˆ’Ubâ¢(ğ’®)=0)â‰¥â„™â¢(ğ’®^N=ğ’®)â„™subscriptğ‘ˆğ‘subscript^ğ’®ğ‘subscriptğ‘ˆğ‘ğ’®0â„™subscript^ğ’®ğ‘ğ’®\mathbb{P}(U_{b}(\hat{\mathcal{S}}_{N})-U_{b}(\mathcal{S})=0)\geq\mathbb{P}(%
\hat{\mathcal{S}}_{N}=\mathcal{S})blackboard_P ( italic_U start_POSTSUBSCRIPT
italic_b end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S end_ARG
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) - italic_U
start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( caligraphic_S ) = 0 ) â‰¥
blackboard_P ( over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT = caligraphic_S ), so from Theorem F.4 we have

| 1â‰¥limNâ†’âˆâ„™â¢(Ubâ¢(ğ’®^N)âˆ’Ubâ¢(ğ’®)=0)â‰¥limNâ†’âˆâ„™â¢(ğ’®^N=ğ’®)=1,1subscriptâ†’ğ‘â„™subscriptğ‘ˆğ‘subscript^ğ’®ğ‘subscriptğ‘ˆğ‘ğ’®0subscriptâ†’ğ‘â„™subscript^ğ’®ğ‘ğ’®11\geq\lim_{N\to\infty}\mathbb{P}(U_{b}(\hat{\mathcal{S}}_{N})-U_{b}(\mathcal{S% })=0)\geq\lim_{N\to\infty}\mathbb{P}(\hat{\mathcal{S}}_{N}=\mathcal{S})=1,1 â‰¥ roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( italic_U start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) - italic_U start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( caligraphic_S ) = 0 ) â‰¥ roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_P ( over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = caligraphic_S ) = 1 , |   
---|---|---  
  
which implies
Ubâ¢(ğ’®^N)âˆ’Ubâ¢(ğ’®)â†’ğ‘0ğ‘â†’subscriptğ‘ˆğ‘subscript^ğ’®ğ‘subscriptğ‘ˆğ‘ğ’®0U_{b}(\hat{\mathcal{S}}_{N})-U_{b}(\mathcal{S})\xrightarrow{p}0italic_U
start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S
end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) - italic_U
start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( caligraphic_S ) start_ARROW
overitalic_p â†’ end_ARROW 0. Therefore by Slutskyâ€™s theorem,

| Ubâ¢(ğ’®^N)=Ubâ¢(ğ’®)+(Ubâ¢(ğ’®^N)âˆ’Ubâ¢(ğ’®))â†’ğ‘‘ğ’©â¢(0,1).subscriptğ‘ˆğ‘subscript^ğ’®ğ‘subscriptğ‘ˆğ‘ğ’®subscriptğ‘ˆğ‘subscript^ğ’®ğ‘subscriptğ‘ˆğ‘ğ’®ğ‘‘â†’ğ’©01U_{b}(\hat{\mathcal{S}}_{N})=U_{b}(\mathcal{S})+\left(U_{b}(\hat{\mathcal{S}}_% {N})-U_{b}(\mathcal{S})\right)\xrightarrow{d}\mathcal{N}(0,1).italic_U start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) = italic_U start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( caligraphic_S ) + ( italic_U start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) - italic_U start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( caligraphic_S ) ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , 1 ) . |   
---|---|---  
  
  3. (c)

We begin by decomposing our sequence of random variables:

| Ucâ¢(ğ’œ)=subscriptğ‘ˆğ‘ğ’œabsent\displaystyle U_{c}(\mathcal{A})=\leavevmode\nobreak\ italic_U start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( caligraphic_A ) = | Nâ¢Tâ¢(ğ^Nâ¢(ğ’œ)âŠ¤â¢Î²^âˆ’ğNâ¢(ğ’œ)âŠ¤â¢Î²0)ğ‘ğ‘‡subscriptbold-^ğğ‘superscriptğ’œtop^ğ›½subscriptğğ‘superscriptğ’œtopsubscriptğ›½0\displaystyle\sqrt{NT}\left(\boldsymbol{\hat{\psi}}_{N}(\mathcal{A})^{\top}% \hat{\beta}-\boldsymbol{\psi}_{N}(\mathcal{A})^{\top}\beta_{0}\right)square-root start_ARG italic_N italic_T end_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG italic_Î² end_ARG - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢Tâ¢(ğNâ¢(ğ’œ)âŠ¤â¢Î²^âˆ’ğNâ¢(ğ’œ)âŠ¤â¢Î²0+(ğ^Nâ¢(ğ’œ)âˆ’ğNâ¢(ğ’œ))âŠ¤â¢Î²^)ğ‘ğ‘‡subscriptğğ‘superscriptğ’œtop^ğ›½subscriptğğ‘superscriptğ’œtopsubscriptğ›½0superscriptsubscriptbold-^ğğ‘ğ’œsubscriptğğ‘ğ’œtop^ğ›½\displaystyle\sqrt{NT}\left(\boldsymbol{\psi}_{N}(\mathcal{A})^{\top}\hat{% \beta}-\boldsymbol{\psi}_{N}(\mathcal{A})^{\top}\beta_{0}+\left(\boldsymbol{% \hat{\psi}}_{N}(\mathcal{A})-\boldsymbol{\psi}_{N}(\mathcal{A})\right)^{\top}% \hat{\beta}\right)square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG italic_Î² end_ARG - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT over^ start_ARG italic_Î² end_ARG ) |   
| =\displaystyle=\leavevmode\nobreak\ = | Nâ¢T(ğN(ğ’œ)âŠ¤(Î²^âˆ’Î²0)+(ğ^N(ğ’œ)âˆ’ğN(ğ’œ))âŠ¤Î²0\displaystyle\sqrt{NT}\bigg{(}\boldsymbol{\psi}_{N}(\mathcal{A})^{\top}\left(% \hat{\beta}-\beta_{0}\right)+\left(\boldsymbol{\hat{\psi}}_{N}(\mathcal{A})-% \boldsymbol{\psi}_{N}(\mathcal{A})\right)^{\top}\beta_{0}square-root start_ARG italic_N italic_T end_ARG ( bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG - italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) + ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT |   
|  | +(ğ^N(ğ’œ)âˆ’ğN(ğ’œ))âŠ¤(Î²^âˆ’Î²0)).\displaystyle+\left(\boldsymbol{\hat{\psi}}_{N}(\mathcal{A})-\boldsymbol{\psi}% _{N}(\mathcal{A})\right)^{\top}\left(\hat{\beta}-\beta_{0}\right)\bigg{)}.\+ ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG - italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ) . |  | (H.4)  
  
We examine these terms one at a time. By part (a),

| Nâ¢Tâ¢ğNâ¢(ğ’®)âŠ¤â¢(Î²^Nâˆ’Î²0)â†’ğ‘‘ğ’©â¢(0,Ïƒ2â¢ğœ¶âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶).ğ‘‘â†’ğ‘ğ‘‡subscriptğğ‘superscriptğ’®topsubscript^ğ›½ğ‘subscriptğ›½0ğ’©0superscriptğœ2superscriptğœ¶topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶\sqrt{NT}\boldsymbol{\psi}_{N}(\mathcal{S})^{\top}(\hat{\beta}_{N}-\beta_{0})% \xrightarrow{d}\mathcal{N}\left(0,\sigma^{2}\boldsymbol{\alpha}^{\top}\left(% \lim_{N\to\infty}\mathbb{E}\left[\Sigma_{1N}\right]\right)^{-1}\boldsymbol{% \alpha}\right).square-root start_ARG italic_N italic_T end_ARG bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± ) . |   
---|---|---  
  
By assumption, for any
Î²0âˆˆâ„pNsubscriptğ›½0superscriptâ„subscriptğ‘ğ‘\beta_{0}\in\mathbb{R}^{p_{N}}italic_Î²
start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT
italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT
with kğ‘˜kitalic_k entries nonzero and finite and the remaining entries equal
to 0,

| Nâ¢Tâ¢(ğ^Nâ¢(ğ’®)âˆ’ğNâ¢(ğ’®))âŠ¤â¢Î²0â†’ğ‘‘ğ’©â¢(0,vÏˆâ¢(Î²0,ğ’®)).ğ‘‘â†’ğ‘ğ‘‡superscriptsubscriptbold-^ğğ‘ğ’®subscriptğğ‘ğ’®topsubscriptğ›½0ğ’©0subscriptğ‘£ğœ“subscriptğ›½0ğ’®\sqrt{NT}\left(\boldsymbol{\hat{\psi}}_{N}(\mathcal{S})-\boldsymbol{\psi}_{N}(% \mathcal{S})\right)^{\top}\beta_{0}\xrightarrow{d}\mathcal{N}(0,v_{\psi}(\beta% _{0},\mathcal{S})).square-root start_ARG italic_N italic_T end_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) ) . |   
---|---|---  
  
Finally, similarly to Kock [2013] we partition
ğ^Nâ¢(ğ’œ)subscriptbold-^ğğ‘ğ’œ\boldsymbol{\hat{\psi}}_{N}(\mathcal{A})overbold_^
start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_A ) into component
ğ^1â¢Nâ¢(ğ’œ)subscriptbold-^ğ1ğ‘ğ’œ\boldsymbol{\hat{\psi}}_{1N}(\mathcal{A})overbold_^
start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT ( caligraphic_A ) that corresponds to the nonzero
coefficients
Î²10âˆˆâ„ksubscriptğ›½10superscriptâ„ğ‘˜\beta_{10}\in\mathbb{R}^{k}italic_Î²
start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT and component
ğ^2â¢Nâ¢(ğ’œ)subscriptbold-^ğ2ğ‘ğ’œ\boldsymbol{\hat{\psi}}_{2N}(\mathcal{A})overbold_^
start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT 2 italic_N
end_POSTSUBSCRIPT ( caligraphic_A ) corresponding to
Î²20=ğŸâˆˆâ„pNâˆ’ksubscriptğ›½200superscriptâ„subscriptğ‘ğ‘ğ‘˜\beta_{20}=\boldsymbol{0}\in\mathbb{R}^{p_{N}-k}italic_Î²
start_POSTSUBSCRIPT 20 end_POSTSUBSCRIPT = bold_0 âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
- italic_k end_POSTSUPERSCRIPT, and likewise for
ğNâ¢(ğ’œ)subscriptğğ‘ğ’œ\boldsymbol{\psi}_{N}(\mathcal{A})bold_italic_Ïˆ
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ). Then we have

|  | (ğ^Nâ¢(ğ’œ)âˆ’ğNâ¢(ğ’œ))âŠ¤â¢(Î²^âˆ’Î²0)superscriptsubscriptbold-^ğğ‘ğ’œsubscriptğğ‘ğ’œtop^ğ›½subscriptğ›½0\displaystyle\left(\boldsymbol{\hat{\psi}}_{N}(\mathcal{A})-\boldsymbol{\psi}_% {N}(\mathcal{A})\right)^{\top}\left(\hat{\beta}-\beta_{0}\right)( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG - italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | (ğ^1â¢Nâ¢(ğ’œ)âˆ’ğ1â¢Nâ¢(ğ’œ))âŠ¤â¢(Î²^1â¢Nâˆ’Î²10)+(ğ^2â¢Nâ¢(ğ’œ)âˆ’ğ2â¢Nâ¢(ğ’œ))âŠ¤â¢(Î²^2â¢Nâˆ’Î²20)superscriptsubscriptbold-^ğ1ğ‘ğ’œsubscriptğ1ğ‘ğ’œtopsubscript^ğ›½1ğ‘subscriptğ›½10superscriptsubscriptbold-^ğ2ğ‘ğ’œsubscriptğ2ğ‘ğ’œtopsubscript^ğ›½2ğ‘subscriptğ›½20\displaystyle\left(\boldsymbol{\hat{\psi}}_{1N}(\mathcal{A})-\boldsymbol{\psi}% _{1N}(\mathcal{A})\right)^{\top}\left(\hat{\beta}_{1N}-\beta_{10}\right)+\left% (\boldsymbol{\hat{\psi}}_{2N}(\mathcal{A})-\boldsymbol{\psi}_{2N}(\mathcal{A})% \right)^{\top}\left(\hat{\beta}_{2N}-\beta_{20}\right)( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) - bold_italic_Ïˆ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT ) + ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) - bold_italic_Ïˆ start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 20 end_POSTSUBSCRIPT ) |   
| =\displaystyle=\leavevmode\nobreak\ = | (ğ^1â¢Nâ¢(ğ’œ)âˆ’ğ1â¢Nâ¢(ğ’œ))âŠ¤â¢(Î²^1â¢Nâˆ’Î²10)+(ğ^2â¢Nâ¢(ğ’œ)âˆ’ğ2â¢Nâ¢(ğ’œ))âŠ¤â¢(Î²^2â¢N).superscriptsubscriptbold-^ğ1ğ‘ğ’œsubscriptğ1ğ‘ğ’œtopsubscript^ğ›½1ğ‘subscriptğ›½10superscriptsubscriptbold-^ğ2ğ‘ğ’œsubscriptğ2ğ‘ğ’œtopsubscript^ğ›½2ğ‘\displaystyle\left(\boldsymbol{\hat{\psi}}_{1N}(\mathcal{A})-\boldsymbol{\psi}% _{1N}(\mathcal{A})\right)^{\top}\left(\hat{\beta}_{1N}-\beta_{10}\right)+\left% (\boldsymbol{\hat{\psi}}_{2N}(\mathcal{A})-\boldsymbol{\psi}_{2N}(\mathcal{A})% \right)^{\top}\left(\hat{\beta}_{2N}\right).( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) - bold_italic_Ïˆ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT ) + ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) - bold_italic_Ïˆ start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT ) . |   
  
For the first term, applying Theorem 2.4(i) in vanÂ der Vaart [2000] and
Proposition 1.8(iii) in GarcÃ­a-PortuguÃ©s [2023] termwise we have that

| (ğ^1â¢Nâ¢(ğ’œ)âˆ’ğ1â¢Nâ¢(ğ’œ))âŠ¤â¢(Î²^1â¢Nâˆ’Î²10)=superscriptsubscriptbold-^ğ1ğ‘ğ’œsubscriptğ1ğ‘ğ’œtopsubscript^ğ›½1ğ‘subscriptğ›½10absent\displaystyle\left(\boldsymbol{\hat{\psi}}_{1N}(\mathcal{A})-\boldsymbol{\psi}% _{1N}(\mathcal{A})\right)^{\top}\left(\hat{\beta}_{1N}-\beta_{10}\right)=% \leavevmode\nobreak\ ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) - bold_italic_Ïˆ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT ) = | ğ’ªâ„™â¢(1N)â¢ğ’ªâ„™â¢(1N)=ğ’ªâ„™â¢(1N)subscriptğ’ªâ„™1ğ‘subscriptğ’ªâ„™1ğ‘subscriptğ’ªâ„™1ğ‘\displaystyle\mathcal{O}_{\mathbb{P}}\left(\frac{1}{\sqrt{N}}\right)\mathcal{O% }_{\mathbb{P}}\left(\frac{1}{\sqrt{N}}\right)=\mathcal{O}_{\mathbb{P}}\left(% \frac{1}{N}\right)caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG ) caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG ) = caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ) |   
---|---|---|---  
| âŸ¹Nâ¢Tâ¢(ğ^1â¢Nâ¢(ğ’œ)âˆ’ğ1â¢Nâ¢(ğ’œ))âŠ¤â¢(Î²^1â¢Nâˆ’Î²10)=ğ‘ğ‘‡superscriptsubscriptbold-^ğ1ğ‘ğ’œsubscriptğ1ğ‘ğ’œtopsubscript^ğ›½1ğ‘subscriptğ›½10absent\displaystyle\implies\qquad\sqrt{NT}\left(\boldsymbol{\hat{\psi}}_{1N}(% \mathcal{A})-\boldsymbol{\psi}_{1N}(\mathcal{A})\right)^{\top}\left(\hat{\beta% }_{1N}-\beta_{10}\right)=\leavevmode\nobreak\ âŸ¹ square-root start_ARG italic_N italic_T end_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) - bold_italic_Ïˆ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT ) = | ğ’ªâ„™â¢(1N).subscriptğ’ªâ„™1ğ‘\displaystyle\mathcal{O}_{\mathbb{P}}\left(\frac{1}{\sqrt{N}}\right).caligraphic_O start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_N end_ARG end_ARG ) . |   
  
For the second term, by a similar argument to the one we used in part (a),
Theorem 2(i) from Kock [2013] gives us that the
Nâ¢Tâ¢(ğ^2â¢Nâ¢(ğ’œ)âˆ’ğ2â¢Nâ¢(ğ’œ))âŠ¤â¢(Î²^2â¢N)â†’ğ‘0ğ‘â†’ğ‘ğ‘‡superscriptsubscriptbold-^ğ2ğ‘ğ’œsubscriptğ2ğ‘ğ’œtopsubscript^ğ›½2ğ‘0\sqrt{NT}\left(\boldsymbol{\hat{\psi}}_{2N}(\mathcal{A})-\boldsymbol{\psi}_{2N%
}(\mathcal{A})\right)^{\top}\left(\hat{\beta}_{2N}\right)\xrightarrow{p}0square-
root start_ARG italic_N italic_T end_ARG ( overbold_^ start_ARG bold_italic_Ïˆ
end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT ( caligraphic_A ) -
bold_italic_Ïˆ start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT (
caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^
start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT 2 italic_N end_POSTSUBSCRIPT )
start_ARROW overitalic_p â†’ end_ARROW 0. Putting this together,

| Nâ¢Tâ¢(ğ^Nâ¢(ğ’œ)âˆ’ğNâ¢(ğ’œ))âŠ¤â¢(Î²^âˆ’Î²0)â†’ğ‘0.ğ‘â†’ğ‘ğ‘‡superscriptsubscriptbold-^ğğ‘ğ’œsubscriptğğ‘ğ’œtop^ğ›½subscriptğ›½00\sqrt{NT}\left(\boldsymbol{\hat{\psi}}_{N}(\mathcal{A})-\boldsymbol{\psi}_{N}(% \mathcal{A})\right)^{\top}\left(\hat{\beta}-\beta_{0}\right)\xrightarrow{p}0.square-root start_ARG italic_N italic_T end_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_A ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG - italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) start_ARROW overitalic_p â†’ end_ARROW 0 . |   
---|---|---  
  
Putting this all together, using Slutskyâ€™s theorem and the independence of
Î²^^ğ›½\hat{\beta}over^ start_ARG italic_Î² end_ARG and
ğ^Nâ¢(ğ’®)subscriptbold-^ğğ‘ğ’®\boldsymbol{\hat{\psi}}_{N}(\mathcal{S})overbold_^
start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_S ) we have from (H.4) that

| Ucâ¢(ğ’®)â†’ğ‘‘ğ’©â¢(0,Ïƒ2â¢ğœ¶âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶+vÏˆâ¢(Î²0,ğ’®)).ğ‘‘â†’subscriptğ‘ˆğ‘ğ’®ğ’©0superscriptğœ2superscriptğœ¶topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶subscriptğ‘£ğœ“subscriptğ›½0ğ’®U_{c}(\mathcal{S})\xrightarrow{d}\mathcal{N}\left(0,\sigma^{2}\boldsymbol{% \alpha}^{\top}\left(\lim_{N\to\infty}\mathbb{E}\left[\Sigma_{1N}\right]\right)% ^{-1}\boldsymbol{\alpha}+v_{\psi}(\beta_{0},\mathcal{S})\right).italic_U start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( caligraphic_S ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± + italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) ) . |   
---|---|---  
  
Finally, the same argument we used in part (b) yields
Ucâ¢(ğ’®^)â†’ğ‘‘ğ’©â¢(0,Ïƒ2â¢ğœ¶âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶+vÏˆâ¢(Î²0,ğ’®))ğ‘‘â†’subscriptğ‘ˆğ‘^ğ’®ğ’©0superscriptğœ2superscriptğœ¶topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶subscriptğ‘£ğœ“subscriptğ›½0ğ’®U_{c}(\hat{\mathcal{S}})\xrightarrow{d}\mathcal{N}(0,\sigma^{2}\boldsymbol{%
\alpha}^{\top}\left(\lim_{N\to\infty}\mathbb{E}\left[\Sigma_{1N}\right]\right)%
^{-1}\boldsymbol{\alpha}+v_{\psi}(\beta_{0},\mathcal{S}))italic_U
start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S
end_ARG ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , italic_Ïƒ
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î±
start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT
italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT
1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT
bold_italic_Î± + italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT (
italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) ).

  4. (d)

Using the consistency of the sample covariance matrix, the assumed consistency
of ğœ¶^â¢(ğ’®)bold-^ğœ¶ğ’®\boldsymbol{\hat{\alpha}}(\mathcal{S})overbold_^
start_ARG bold_italic_Î± end_ARG ( caligraphic_S ), the assumed consistency of
v^Ïˆâ¢(Î²^N,ğ’®)subscript^ğ‘£ğœ“subscript^ğ›½ğ‘ğ’®\hat{v}_{\psi}(\hat{\beta}_{N},\mathcal{S})over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT (
over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT , caligraphic_S ), and the continuous mapping theorem,

|  | 1v^Nâ¢(ğ’®)1subscript^ğ‘£ğ‘ğ’®\displaystyle\frac{1}{\sqrt{\hat{v}_{N}(\mathcal{S})}}divide start_ARG 1 end_ARG start_ARG square-root start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) end_ARG end_ARG |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | 1ğœ¶^â¢(ğ’®)âŠ¤â¢(ğšº^â¢(ğ‘¿(â‹…â‹…)â£ğ’®))âˆ’1â¢ğœ¶^â¢(ğ’®)+v^Ïˆâ¢(Î²^N,ğ’®)1bold-^ğœ¶superscriptğ’®topsuperscriptbold-^ğšºsubscriptğ‘¿â‹…absentâ‹…ğ’®1bold-^ğœ¶ğ’®subscript^ğ‘£ğœ“subscript^ğ›½ğ‘ğ’®\displaystyle\frac{1}{\sqrt{\boldsymbol{\hat{\alpha}}(\mathcal{S})^{\top}\left% (\boldsymbol{\hat{\Sigma}}(\boldsymbol{X}_{(\cdot\cdot)\mathcal{S}})\right)^{-% 1}\boldsymbol{\hat{\alpha}}(\mathcal{S})+\hat{v}_{\psi}(\hat{\beta}_{N},% \mathcal{S})}}divide start_ARG 1 end_ARG start_ARG square-root start_ARG overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_S ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_X start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_S ) + over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , caligraphic_S ) end_ARG end_ARG |   
| â†’ğ‘ğ‘â†’\displaystyle\xrightarrow{p}\leavevmode\nobreak\ start_ARROW overitalic_p â†’ end_ARROW | 1ğœ¶âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶+vÏˆâ¢(Î²0,ğ’®),1superscriptğœ¶topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶subscriptğ‘£ğœ“subscriptğ›½0ğ’®\displaystyle\frac{1}{\sqrt{\boldsymbol{\alpha}^{\top}\left(\lim_{N\to\infty}% \mathbb{E}[\Sigma_{1N}]\right)^{-1}\boldsymbol{\alpha}+v_{\psi}(\beta_{0},% \mathcal{S})}},divide start_ARG 1 end_ARG start_ARG square-root start_ARG bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± + italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) end_ARG end_ARG , |   
  
so part (c)ğ‘(c)( italic_c ) and Slutskyâ€™s theorem yield that
Udâ¢(ğ’®)=1v^Nâ¢(ğ’®)â¢Ucâ¢(ğ’®)â†’ğ‘‘ğ’©â¢(0,1)subscriptğ‘ˆğ‘‘ğ’®1subscript^ğ‘£ğ‘ğ’®subscriptğ‘ˆğ‘ğ’®ğ‘‘â†’ğ’©01U_{d}(\mathcal{S})=\frac{1}{\sqrt{\hat{v}_{N}(\mathcal{S})}}U_{c}(\mathcal{S})%
\xrightarrow{d}\mathcal{N}(0,1)italic_U start_POSTSUBSCRIPT italic_d
end_POSTSUBSCRIPT ( caligraphic_S ) = divide start_ARG 1 end_ARG start_ARG
square-root start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT ( caligraphic_S ) end_ARG end_ARG italic_U
start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ( caligraphic_S ) start_ARROW
overitalic_d â†’ end_ARROW caligraphic_N ( 0 , 1 ), where our finite-sample
variance estimator v^Nâ¢(ğ’®)subscript^ğ‘£ğ‘ğ’®\hat{v}_{N}(\mathcal{S})over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT (
caligraphic_S ) was defined in (F.4). Finally, the same argument we used in
part (b) yields
Udâ¢(ğ’®^)â†’ğ‘‘ğ’©â¢(0,1)ğ‘‘â†’subscriptğ‘ˆğ‘‘^ğ’®ğ’©01U_{d}(\hat{\mathcal{S}})\xrightarrow{d}\mathcal{N}(0,1)italic_U
start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S
end_ARG ) start_ARROW overitalic_d â†’ end_ARROW caligraphic_N ( 0 , 1 ).

  5. (e)

If Î²^Nsubscript^ğ›½ğ‘\hat{\beta}_{N}over^ start_ARG italic_Î² end_ARG
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT and
ğ^Nâ¢(ğ’®)subscriptbold-^ğğ‘ğ’®\boldsymbol{\hat{\psi}}_{N}(\mathcal{S})overbold_^
start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT ( caligraphic_S ) are estimated on the same data set, they
are not independent. So by the same argument we used in part (c)ğ‘(c)(
italic_c ) we still have

|  | Nâ¢Tâ¢(ğ^Nâ¢(ğ’®)âŠ¤â¢(Î²^Nâˆ’Î²0)+(ğ^Nâ¢(ğ’®)âˆ’ğNâ¢(ğ’®))âŠ¤â¢Î²0)ğ‘ğ‘‡subscriptbold-^ğğ‘superscriptğ’®topsubscript^ğ›½ğ‘subscriptğ›½0superscriptsubscriptbold-^ğğ‘ğ’®subscriptğğ‘ğ’®topsubscriptğ›½0\displaystyle\sqrt{NT}\left(\boldsymbol{\hat{\psi}}_{N}(\mathcal{S})^{\top}(% \hat{\beta}_{N}-\beta_{0})+\left(\boldsymbol{\hat{\psi}}_{N}(\mathcal{S})-% \boldsymbol{\psi}_{N}(\mathcal{S})\right)^{\top}\beta_{0}\right)square-root start_ARG italic_N italic_T end_ARG ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT - italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) + ( overbold_^ start_ARG bold_italic_Ïˆ end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) - bold_italic_Ïˆ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ( caligraphic_S ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) |   
---|---|---|---  
| â†’ğ‘‘ğ‘‘â†’\displaystyle\xrightarrow{d}\leavevmode\nobreak\ start_ARROW overitalic_d â†’ end_ARROW | ğ’©â¢(0,Ïƒ2â¢ğœ¶âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶)+ğ’©â¢(0,vÏˆâ¢(Î²0,ğ’®)),ğ’©0superscriptğœ2superscriptğœ¶topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶ğ’©0subscriptğ‘£ğœ“subscriptğ›½0ğ’®\displaystyle\mathcal{N}\left(0,\sigma^{2}\boldsymbol{\alpha}^{\top}\left(\lim% _{N\to\infty}\mathbb{E}[\Sigma_{1N}]\right)^{-1}\boldsymbol{\alpha}\right)+% \mathcal{N}\left(0,v_{\psi}(\beta_{0},\mathcal{S})\right),caligraphic_N ( 0 , italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± ) + caligraphic_N ( 0 , italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) ) , |   
  
but because the two Gaussian random variables are neither independent nor do
we know that they are jointly Gaussian, we cannot say as much about the
distribution of their sum. However, due to Lemma H.2 we do know that they are
subgaussian.

######  Lemma H.2.

If Xğ‘‹Xitalic_X and Yğ‘ŒYitalic_Y are mean-zero subgaussian random variables,
then X+Yğ‘‹ğ‘ŒX+Yitalic_X + italic_Y is mean zero and subgaussian.

###### Proof.

Provided in Appendix I. âˆ

Further, since for any two random variables with finite variance by Cauchy-
Schwarz

| Varâ¢(X+Y)=Varğ‘‹ğ‘Œabsent\displaystyle\mathrm{Var}(X+Y)=\leavevmode\nobreak\ roman_Var ( italic_X + italic_Y ) = | Varâ¢(X)+2â¢Câ¢oâ¢vâ¢(X,Y)+Varâ¢(Y)Varğ‘‹2Covğ‘‹ğ‘ŒVarğ‘Œ\displaystyle\mathrm{Var}(X)+2\mathrm{Cov}(X,Y)+\mathrm{Var}(Y)roman_Var ( italic_X ) + 2 roman_C roman_o roman_v ( italic_X , italic_Y ) + roman_Var ( italic_Y ) |   
---|---|---|---  
| â‰¤\displaystyle\leq\leavevmode\nobreak\ â‰¤ | Varâ¢(X)+2â¢Varâ¢(X)â¢Varâ¢(Y)+Varâ¢(Y),Varğ‘‹2Varğ‘‹Varğ‘ŒVarğ‘Œ\displaystyle\mathrm{Var}(X)+2\sqrt{\mathrm{Var}(X)\mathrm{Var}(Y)}+\mathrm{% Var}(Y),roman_Var ( italic_X ) + 2 square-root start_ARG roman_Var ( italic_X ) roman_Var ( italic_Y ) end_ARG + roman_Var ( italic_Y ) , |   
  
we have that the above sequence of random variables converges in distribution
to a subgaussian random variable with variance at most

| Ïƒ2â¢ğœ¶âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶+2â¢Ïƒ2â¢ğœ¶âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶â‹…vÏˆâ¢(Î²0,ğ’®)+vÏˆâ¢(Î²0,ğ’®).superscriptğœ2superscriptğœ¶topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶2â‹…superscriptğœ2superscriptğœ¶topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶subscriptğ‘£ğœ“subscriptğ›½0ğ’®subscriptğ‘£ğœ“subscriptğ›½0ğ’®\sigma^{2}\boldsymbol{\alpha}^{\top}\left(\lim_{N\to\infty}\mathbb{E}[\Sigma_{% 1N}]\right)^{-1}\boldsymbol{\alpha}+2\sqrt{\sigma^{2}\boldsymbol{\alpha}^{\top% }\left(\lim_{N\to\infty}\mathbb{E}[\Sigma_{1N}]\right)^{-1}\boldsymbol{\alpha}% \cdot v_{\psi}(\beta_{0},\mathcal{S})}+v_{\psi}(\beta_{0},\mathcal{S}).italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± + 2 square-root start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± â‹… italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) end_ARG + italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) . |   
---|---|---  
  
Using the assumed consistency of
v^Ïˆâ¢(Î²^N,ğ’®)subscript^ğ‘£ğœ“subscript^ğ›½ğ‘ğ’®\hat{v}_{\psi}(\hat{\beta}_{N},\mathcal{S})over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT (
over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT , caligraphic_S ), we have by the continuous mapping theorem
that for
v^N(cons)â¢(ğ’œ)superscriptsubscript^ğ‘£ğ‘consğ’œ\hat{v}_{N}^{(\text{cons})}(\mathcal{A})over^
start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT ( cons ) end_POSTSUPERSCRIPT ( caligraphic_A ) as
defined in (F.5),

|  | v^N(cons)â¢(ğ’®)superscriptsubscript^ğ‘£ğ‘consğ’®\displaystyle\hat{v}_{N}^{(\text{cons})}(\mathcal{S})over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( cons ) end_POSTSUPERSCRIPT ( caligraphic_S ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | Ïƒ2â¢ğœ¶^â¢(ğ’®)âŠ¤â¢(ğšº^â¢(ğ‘¿(â‹…â‹…)â£ğ’®))âˆ’1â¢ğœ¶^â¢(ğ’®)+v^Ïˆâ¢(Î²^N,ğ’®)+2â¢Ïƒ2â¢ğœ¶^â¢(ğ’®)âŠ¤â¢(ğšº^â¢(ğ‘¿(â‹…â‹…)â£ğ’®))âˆ’1â¢ğœ¶^â¢(ğ’®)â‹…v^Ïˆâ¢(Î²^N,ğ’®)superscriptğœ2bold-^ğœ¶superscriptğ’®topsuperscriptbold-^ğšºsubscriptğ‘¿â‹…absentâ‹…ğ’®1bold-^ğœ¶ğ’®subscript^ğ‘£ğœ“subscript^ğ›½ğ‘ğ’®2â‹…superscriptğœ2bold-^ğœ¶superscriptğ’®topsuperscriptbold-^ğšºsubscriptğ‘¿â‹…absentâ‹…ğ’®1bold-^ğœ¶ğ’®subscript^ğ‘£ğœ“subscript^ğ›½ğ‘ğ’®\displaystyle\sigma^{2}\boldsymbol{\hat{\alpha}}(\mathcal{S})^{\top}\left(% \boldsymbol{\hat{\Sigma}}(\boldsymbol{X}_{(\cdot\cdot)\mathcal{S}})\right)^{-1% }\boldsymbol{\hat{\alpha}}(\mathcal{S})+\hat{v}_{\psi}(\hat{\beta}_{N},% \mathcal{S})+2\sqrt{\sigma^{2}\boldsymbol{\hat{\alpha}}(\mathcal{S})^{\top}% \left(\boldsymbol{\hat{\Sigma}}(\boldsymbol{X}_{(\cdot\cdot)\mathcal{S}})% \right)^{-1}\boldsymbol{\hat{\alpha}}(\mathcal{S})\cdot\hat{v}_{\psi}(\hat{% \beta}_{N},\mathcal{S})}italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_S ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_X start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_S ) + over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , caligraphic_S ) + 2 square-root start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_S ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( overbold_^ start_ARG bold_Î£ end_ARG ( bold_italic_X start_POSTSUBSCRIPT ( â‹… â‹… ) caligraphic_S end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT overbold_^ start_ARG bold_italic_Î± end_ARG ( caligraphic_S ) â‹… over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( over^ start_ARG italic_Î² end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , caligraphic_S ) end_ARG |   
| â†’ğ‘ğ‘â†’\displaystyle\xrightarrow{p}\leavevmode\nobreak\ start_ARROW overitalic_p â†’ end_ARROW | Ïƒ2â¢ğœ¶âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶+vÏˆâ¢(Î²0,ğ’®)+2â¢Ïƒ2â¢ğœ¶âŠ¤â¢(limNâ†’âˆğ”¼â¢[Î£1â¢N])âˆ’1â¢ğœ¶â‹…vÏˆâ¢(Î²0,ğ’®).superscriptğœ2superscriptğœ¶topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶subscriptğ‘£ğœ“subscriptğ›½0ğ’®2â‹…superscriptğœ2superscriptğœ¶topsuperscriptsubscriptâ†’ğ‘ğ”¼delimited-[]subscriptÎ£1ğ‘1ğœ¶subscriptğ‘£ğœ“subscriptğ›½0ğ’®\displaystyle\sigma^{2}\boldsymbol{\alpha}^{\top}\left(\lim_{N\to\infty}% \mathbb{E}[\Sigma_{1N}]\right)^{-1}\boldsymbol{\alpha}+v_{\psi}(\beta_{0},% \mathcal{S})+2\sqrt{\sigma^{2}\boldsymbol{\alpha}^{\top}\left(\lim_{N\to\infty% }\mathbb{E}[\Sigma_{1N}]\right)^{-1}\boldsymbol{\alpha}\cdot v_{\psi}(\beta_{0% },\mathcal{S})}.italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± + italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) + 2 square-root start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_Î± start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( roman_lim start_POSTSUBSCRIPT italic_N â†’ âˆ end_POSTSUBSCRIPT blackboard_E [ roman_Î£ start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT ] ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT bold_italic_Î± â‹… italic_v start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_Î² start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , caligraphic_S ) end_ARG . |   
  
Therefore by Slutskyâ€™s theorem,
Ueâ¢(ğ’®)subscriptğ‘ˆğ‘’ğ’®U_{e}(\mathcal{S})italic_U start_POSTSUBSCRIPT
italic_e end_POSTSUBSCRIPT ( caligraphic_S ) converges in distribution to a
mean-zero subgaussian random variable with variance at most 1. Finally, once
again a similar argument to the one we used in part (b) yields that
Ueâ¢(ğ’®^)subscriptğ‘ˆğ‘’^ğ’®U_{e}(\hat{\mathcal{S}})italic_U
start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( over^ start_ARG caligraphic_S
end_ARG ) converges in distribution to the same random variable as
Ueâ¢(ğ’®)subscriptğ‘ˆğ‘’ğ’®U_{e}(\mathcal{S})italic_U start_POSTSUBSCRIPT
italic_e end_POSTSUBSCRIPT ( caligraphic_S ).

âˆ

##  Appendix I Statements and Proofs of Other Results

###### Proof of Lemma H.2.

The sum X+Yğ‘‹ğ‘ŒX+Yitalic_X + italic_Y has mean zero due to linearity of
expectation. To show subgaussianity, it is enough to show that
ğ”¼â¢expâ¡{tâ¢(X+Y)}â‰¤expâ¡{K2â¢t2}ğ”¼ğ‘¡ğ‘‹ğ‘Œsuperscriptğ¾2superscriptğ‘¡2\mathbb{E}\exp\left\\{t(X+Y)\right\\}\leq\exp\left\\{K^{2}t^{2}\right\\}blackboard_E
roman_exp { italic_t ( italic_X + italic_Y ) } â‰¤ roman_exp { italic_K
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_t start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT } for some finite K2superscriptğ¾2K^{2}italic_K
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT for all
tâˆˆâ„ğ‘¡â„t\in\mathbb{R}italic_t âˆˆ blackboard_R [Vershynin, 2018,
Proposition 2.5.2]. Because Xğ‘‹Xitalic_X and Yğ‘ŒYitalic_Y are subgaussian,
we have that
ğ”¼â¢[expâ¡{tâ¢X}]â‰¤expâ¡{KX2â¢t2}ğ”¼delimited-[]ğ‘¡ğ‘‹superscriptsubscriptğ¾ğ‘‹2superscriptğ‘¡2\mathbb{E}\left[\exp\left\\{tX\right\\}\right]\leq\exp\left\\{K_{X}^{2}t^{2}\right\\}blackboard_E
[ roman_exp { italic_t italic_X } ] â‰¤ roman_exp { italic_K
start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT } and
ğ”¼â¢[expâ¡{tâ¢Y}]â‰¤expâ¡{KY2â¢t2}ğ”¼delimited-[]ğ‘¡ğ‘Œsuperscriptsubscriptğ¾ğ‘Œ2superscriptğ‘¡2\mathbb{E}\left[\exp\left\\{tY\right\\}\right]\leq\exp\left\\{K_{Y}^{2}t^{2}\right\\}blackboard_E
[ roman_exp { italic_t italic_Y } ] â‰¤ roman_exp { italic_K
start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT } for
all tâˆˆâ„ğ‘¡â„t\in\mathbb{R}italic_t âˆˆ blackboard_R. So using these facts
and Cauchy-Schwarz, we have for any tâˆˆâ„›ğ‘¡â„›t\in\mathcal{R}italic_t âˆˆ
caligraphic_R

| ğ”¼â¢expâ¡{tâ¢(X+Y)}=ğ”¼ğ‘¡ğ‘‹ğ‘Œabsent\displaystyle\mathbb{E}\exp\left\\{t(X+Y)\right\\}=\leavevmode\nobreak\ blackboard_E roman_exp { italic_t ( italic_X + italic_Y ) } = | ğ”¼â¢[expâ¡{tâ¢X}â¢expâ¡{tâ¢Y}]ğ”¼delimited-[]ğ‘¡ğ‘‹ğ‘¡ğ‘Œ\displaystyle\mathbb{E}\left[\exp\left\\{tX\right\\}\exp\left\\{tY\right\\}\right]blackboard_E [ roman_exp { italic_t italic_X } roman_exp { italic_t italic_Y } ] |   
---|---|---|---  
| â‰¤\displaystyle\leq\leavevmode\nobreak\ â‰¤ | ğ”¼â¢[expâ¡{2â¢tâ¢X}]â¢ğ”¼â¢[expâ¡{2â¢tâ¢Y}]ğ”¼delimited-[]2ğ‘¡ğ‘‹ğ”¼delimited-[]2ğ‘¡ğ‘Œ\displaystyle\sqrt{\mathbb{E}\left[\exp\left\\{2tX\right\\}\right]\mathbb{E}% \left[\exp\left\\{2tY\right\\}\right]}square-root start_ARG blackboard_E [ roman_exp { 2 italic_t italic_X } ] blackboard_E [ roman_exp { 2 italic_t italic_Y } ] end_ARG |   
| â‰¤\displaystyle\leq\leavevmode\nobreak\ â‰¤ | expâ¡{KX2â‹…4â¢t2}â¢expâ¡{KY2â‹…4â¢t2}â‹…superscriptsubscriptğ¾ğ‘‹24superscriptğ‘¡2â‹…superscriptsubscriptğ¾ğ‘Œ24superscriptğ‘¡2\displaystyle\sqrt{\exp\left\\{K_{X}^{2}\cdot 4t^{2}\right\\}\exp\left\\{K_{Y}^{2% }\cdot 4t^{2}\right\\}}square-root start_ARG roman_exp { italic_K start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‹… 4 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT } roman_exp { italic_K start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‹… 4 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT } end_ARG |   
| =\displaystyle=\leavevmode\nobreak\ = | expâ¡{2â¢t2â¢(KX2+KY2)},2superscriptğ‘¡2superscriptsubscriptğ¾ğ‘‹2superscriptsubscriptğ¾ğ‘Œ2\displaystyle\exp\left\\{2t^{2}\left(K_{X}^{2}+K_{Y}^{2}\right)\right\\},roman_exp { 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_K start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_K start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) } , |   
  
and the result is proven with
K2:=2â¢(KX2+KY2)assignsuperscriptğ¾22superscriptsubscriptğ¾ğ‘‹2superscriptsubscriptğ¾ğ‘Œ2K^{2}:=2\left(K_{X}^{2}+K_{Y}^{2}\right)italic_K
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT := 2 ( italic_K
start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2
end_POSTSUPERSCRIPT + italic_K start_POSTSUBSCRIPT italic_Y end_POSTSUBSCRIPT
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ).

âˆ

######  Lemma I.1.

The smallest and largest singular values of
ğ†Nsubscriptğ†ğ‘\boldsymbol{G}_{N}bold_italic_G start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT are bounded as follows:
Ïƒmaxâ¢(ğ†N)â‰¤2subscriptğœmaxsubscriptğ†ğ‘2\sigma_{\text{max}}(\boldsymbol{G}_{N})\leq\sqrt{2}italic_Ïƒ
start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_italic_G start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT ) â‰¤ square-root start_ARG 2 end_ARG and
Ïƒminâ¢(ğ†N)â‰¥Ïƒ/Tâ¢Ïƒc2+Ïƒ2subscriptğœminsubscriptğ†ğ‘ğœğ‘‡superscriptsubscriptğœğ‘2superscriptğœ2\sigma_{\text{min}}\left(\boldsymbol{G}_{N}\right)\geq\sigma/\sqrt{T\sigma_{c}%
^{2}+\sigma^{2}}italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT (
bold_italic_G start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) â‰¥ italic_Ïƒ /
square-root start_ARG italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_Ïƒ
start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG.

###### Proof of Lemma I.1.

We will prove the result in a similar way to the proof of Lemma F.1. By
properties of the Kronecker product, it is enough to bound the singular values
of ğ›€ğ›€\boldsymbol{\Omega}bold_Î©. We have

| Ïƒmaxâ¢(ğ›€)â‰¤âˆ¥ğ›€âˆ¥1â¢âˆ¥ğ›€âˆ¥âˆâ‰¤[Tâ‹…Ïƒc2+Ïƒ2]2=Tâ‹…Ïƒc2+Ïƒ2,subscriptğœmaxğ›€subscriptdelimited-âˆ¥âˆ¥ğ›€1subscriptdelimited-âˆ¥âˆ¥ğ›€superscriptdelimited-[]â‹…ğ‘‡superscriptsubscriptğœğ‘2superscriptğœ22â‹…ğ‘‡superscriptsubscriptğœğ‘2superscriptğœ2\sigma_{\text{max}}(\boldsymbol{\Omega})\leq\sqrt{\lVert\boldsymbol{\Omega}% \rVert_{1}\lVert\boldsymbol{\Omega}\rVert_{\infty}}\leq\sqrt{[T\cdot\sigma_{c}% ^{2}+\sigma^{2}]^{2}}=T\cdot\sigma_{c}^{2}+\sigma^{2},italic_Ïƒ start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_Î© ) â‰¤ square-root start_ARG âˆ¥ bold_Î© âˆ¥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT âˆ¥ bold_Î© âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT end_ARG â‰¤ square-root start_ARG [ italic_T â‹… italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG = italic_T â‹… italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , |   
---|---|---  
  
where for matrices âˆ¥â‹…âˆ¥1subscriptdelimited-
âˆ¥âˆ¥â‹…1\lVert\cdot\rVert_{1}âˆ¥ â‹… âˆ¥ start_POSTSUBSCRIPT 1
end_POSTSUBSCRIPT denotes the maximum absolute column sum of a matrix and
âˆ¥â‹…âˆ¥âˆsubscriptdelimited-âˆ¥âˆ¥â‹…\lVert\cdot\rVert_{\infty}âˆ¥ â‹… âˆ¥
start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT denotes the maximum absolute row sum.
We will use (H.1) to lower-bound
Ïƒminâ¢(ğ›€)subscriptğœminğ›€\sigma_{\text{min}}(\boldsymbol{\Omega})italic_Ïƒ
start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_Î© ). First we will find
ğ›€âˆ’1superscriptğ›€1\boldsymbol{\Omega}^{-1}bold_Î© start_POSTSUPERSCRIPT -
1 end_POSTSUPERSCRIPT. Observe that we can express
ğ›€ğ›€\boldsymbol{\Omega}bold_Î© as

| ğ›€=Ïƒ2â¢ğ‘°T+ğ’—â¢ğ’—âŠ¤ğ›€superscriptğœ2subscriptğ‘°ğ‘‡ğ’—superscriptğ’—top\boldsymbol{\Omega}=\sigma^{2}\boldsymbol{I}_{T}+\boldsymbol{v}\boldsymbol{v}^% {\top}bold_Î© = italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT + bold_italic_v bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT |   
---|---|---  
  
where
ğ’—=(Ïƒc,â€¦,Ïƒc)âˆˆâ„Tğ’—subscriptğœğ‘â€¦subscriptğœğ‘superscriptâ„ğ‘‡\boldsymbol{v}=(\sigma_{c},\ldots,\sigma_{c})\in\mathbb{R}^{T}bold_italic_v
= ( italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , â€¦ , italic_Ïƒ
start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) âˆˆ blackboard_R
start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT. Therefore we can invert
ğ›€ğ›€\boldsymbol{\Omega}bold_Î© using the Sherman-Morrison formula:

| ğ›€âˆ’1=superscriptğ›€1absent\displaystyle\boldsymbol{\Omega}^{-1}=\leavevmode\nobreak\ bold_Î© start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT = | 1Ïƒ2â¢ğ‘°Tâˆ’1Ïƒ2â¢ğ‘°Tâ¢ğ’—â¢ğ’—âŠ¤â¢1Ïƒ2â¢ğ‘°T1+ğ’—âŠ¤â¢1Ïƒ2â¢ğ‘°Tâ¢ğ’—=1Ïƒ2â¢(ğ‘°Tâˆ’1Ïƒ2â¢ğ’—â¢ğ’—âŠ¤1+1Ïƒ2â¢ğ’—âŠ¤â¢ğ’—)=1Ïƒ2â¢(ğ‘°Tâˆ’ğ’—â¢ğ’—âŠ¤Ïƒ2+Tâ¢Ïƒc2)1superscriptğœ2subscriptğ‘°ğ‘‡1superscriptğœ2subscriptğ‘°ğ‘‡ğ’—superscriptğ’—top1superscriptğœ2subscriptğ‘°ğ‘‡1superscriptğ’—top1superscriptğœ2subscriptğ‘°ğ‘‡ğ’—1superscriptğœ2subscriptğ‘°ğ‘‡1superscriptğœ2ğ’—superscriptğ’—top11superscriptğœ2superscriptğ’—topğ’—1superscriptğœ2subscriptğ‘°ğ‘‡ğ’—superscriptğ’—topsuperscriptğœ2ğ‘‡superscriptsubscriptğœğ‘2\displaystyle\frac{1}{\sigma^{2}}\boldsymbol{I}_{T}-\frac{\frac{1}{\sigma^{2}}% \boldsymbol{I}_{T}\boldsymbol{v}\boldsymbol{v}^{\top}\frac{1}{\sigma^{2}}% \boldsymbol{I}_{T}}{1+\boldsymbol{v}^{\top}\frac{1}{\sigma^{2}}\boldsymbol{I}_% {T}\boldsymbol{v}}=\frac{1}{\sigma^{2}}\left(\boldsymbol{I}_{T}-\frac{\frac{1}% {\sigma^{2}}\boldsymbol{v}\boldsymbol{v}^{\top}}{1+\frac{1}{\sigma^{2}}% \boldsymbol{v}^{\top}\boldsymbol{v}}\right)=\frac{1}{\sigma^{2}}\left(% \boldsymbol{I}_{T}-\frac{\boldsymbol{v}\boldsymbol{v}^{\top}}{\sigma^{2}+T% \sigma_{c}^{2}}\right)divide start_ARG 1 end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG bold_italic_I start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT - divide start_ARG divide start_ARG 1 end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG bold_italic_I start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT bold_italic_v bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG bold_italic_I start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_ARG start_ARG 1 + bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG bold_italic_I start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT bold_italic_v end_ARG = divide start_ARG 1 end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( bold_italic_I start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT - divide start_ARG divide start_ARG 1 end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG bold_italic_v bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_ARG start_ARG 1 + divide start_ARG 1 end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v end_ARG ) = divide start_ARG 1 end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( bold_italic_I start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT - divide start_ARG bold_italic_v bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | 1Ïƒ2â¢(1âˆ’Ïƒc2Ïƒ2+Tâ¢Ïƒc2âˆ’Ïƒc2Ïƒ2+Tâ¢Ïƒc2â‹¯âˆ’Ïƒc2Ïƒ2+Tâ¢Ïƒc2âˆ’Ïƒc2Ïƒ2+Tâ¢Ïƒc21âˆ’Ïƒc2Ïƒ2+Tâ¢Ïƒc2â‹¯âˆ’Ïƒc2Ïƒ2+Tâ¢Ïƒc2â‹®â‹®â‹±â‹®âˆ’Ïƒc2Ïƒ2+Tâ¢Ïƒc2âˆ’Ïƒc2Ïƒ2+Tâ¢Ïƒc2â‹¯1âˆ’Ïƒc2Ïƒ2+Tâ¢Ïƒc2).1superscriptğœ2matrix1superscriptsubscriptğœğ‘2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘2superscriptsubscriptğœğ‘2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘2â‹¯superscriptsubscriptğœğ‘2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘2superscriptsubscriptğœğ‘2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘21superscriptsubscriptğœğ‘2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘2â‹¯superscriptsubscriptğœğ‘2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘2â‹®â‹®â‹±â‹®superscriptsubscriptğœğ‘2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘2superscriptsubscriptğœğ‘2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘2â‹¯1superscriptsubscriptğœğ‘2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘2\displaystyle\frac{1}{\sigma^{2}}\begin{pmatrix}1-\frac{\sigma_{c}^{2}}{\sigma% ^{2}+T\sigma_{c}^{2}}&-\frac{\sigma_{c}^{2}}{\sigma^{2}+T\sigma_{c}^{2}}&% \cdots&-\frac{\sigma_{c}^{2}}{\sigma^{2}+T\sigma_{c}^{2}}\\\ -\frac{\sigma_{c}^{2}}{\sigma^{2}+T\sigma_{c}^{2}}&1-\frac{\sigma_{c}^{2}}{% \sigma^{2}+T\sigma_{c}^{2}}&\cdots&-\frac{\sigma_{c}^{2}}{\sigma^{2}+T\sigma_{% c}^{2}}\\\ \vdots&\vdots&\ddots&\vdots\\\ -\frac{\sigma_{c}^{2}}{\sigma^{2}+T\sigma_{c}^{2}}&-\frac{\sigma_{c}^{2}}{% \sigma^{2}+T\sigma_{c}^{2}}&\cdots&1-\frac{\sigma_{c}^{2}}{\sigma^{2}+T\sigma_% {c}^{2}}\end{pmatrix}.divide start_ARG 1 end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( start_ARG start_ROW start_CELL 1 - divide start_ARG italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL - divide start_ARG italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL â‹¯ end_CELL start_CELL - divide start_ARG italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL end_ROW start_ROW start_CELL - divide start_ARG italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL 1 - divide start_ARG italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL â‹¯ end_CELL start_CELL - divide start_ARG italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL end_ROW start_ROW start_CELL â‹® end_CELL start_CELL â‹® end_CELL start_CELL â‹± end_CELL start_CELL â‹® end_CELL end_ROW start_ROW start_CELL - divide start_ARG italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL - divide start_ARG italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL start_CELL â‹¯ end_CELL start_CELL 1 - divide start_ARG italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_CELL end_ROW end_ARG ) . |   
  
Therefore

| Ïƒminâ¢(ğ›€)â‰¥subscriptğœminğ›€absent\displaystyle\sigma_{\text{min}}\left(\boldsymbol{\Omega}\right)\geq% \leavevmode\nobreak\ italic_Ïƒ start_POSTSUBSCRIPT min end_POSTSUBSCRIPT ( bold_Î© ) â‰¥ | 1âˆ¥ğ›€âˆ’1âˆ¥1â¢âˆ¥ğ›€âˆ’1âˆ¥âˆâ‰¥Ïƒ2â¢(1+Tâ¢Ïƒc2Ïƒ2+Tâ¢Ïƒc2)âˆ’1=Ïƒ2â¢(Ïƒ2+2â¢Tâ¢Ïƒc2Ïƒ2+Tâ¢Ïƒc2)âˆ’11subscriptdelimited-âˆ¥âˆ¥superscriptğ›€11subscriptdelimited-âˆ¥âˆ¥superscriptğ›€1superscriptğœ2superscript1ğ‘‡superscriptsubscriptğœğ‘2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘21superscriptğœ2superscriptsuperscriptğœ22ğ‘‡superscriptsubscriptğœğ‘2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘21\displaystyle\frac{1}{\sqrt{\lVert\boldsymbol{\Omega}^{-1}\rVert_{1}\lVert% \boldsymbol{\Omega}^{-1}\rVert_{\infty}}}\geq\sigma^{2}\left(1+T\frac{\sigma_{% c}^{2}}{\sigma^{2}+T\sigma_{c}^{2}}\right)^{-1}=\sigma^{2}\left(\frac{\sigma^{% 2}+2T\sigma_{c}^{2}}{\sigma^{2}+T\sigma_{c}^{2}}\right)^{-1}divide start_ARG 1 end_ARG start_ARG square-root start_ARG âˆ¥ bold_Î© start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT âˆ¥ bold_Î© start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT âˆ end_POSTSUBSCRIPT end_ARG end_ARG â‰¥ italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( 1 + italic_T divide start_ARG italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT = italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( divide start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ) start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | Ïƒ2â¢(Ïƒ2+Tâ¢Ïƒc2)Ïƒ2+2â¢Tâ¢Ïƒc2â‰¥Ïƒ2â¢(Ïƒ2+Tâ¢Ïƒc2)2â¢(Ïƒ2+Tâ¢Ïƒc2)=Ïƒ22.superscriptğœ2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘2superscriptğœ22ğ‘‡superscriptsubscriptğœğ‘2superscriptğœ2superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘22superscriptğœ2ğ‘‡superscriptsubscriptğœğ‘2superscriptğœ22\displaystyle\frac{\sigma^{2}\left(\sigma^{2}+T\sigma_{c}^{2}\right)}{\sigma^{% 2}+2T\sigma_{c}^{2}}\geq\frac{\sigma^{2}\left(\sigma^{2}+T\sigma_{c}^{2}\right% )}{2\left(\sigma^{2}+T\sigma_{c}^{2}\right)}=\frac{\sigma^{2}}{2}.divide start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_ARG start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG â‰¥ divide start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_ARG start_ARG 2 ( italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_T italic_Ïƒ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_ARG = divide start_ARG italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG 2 end_ARG . |   
  
Finally, using these results we have
Ïƒminâ¢(ğ›€âˆ’1/2)â‰¥1/Tâ¢Ïƒc2+Ïƒ2subscriptğœminsuperscriptğ›€121ğ‘‡superscriptsubscriptğœğ‘2superscriptğœ2\sigma_{\text{min}}\left(\boldsymbol{\Omega}^{-1/2}\right)\geq
1/\sqrt{T\sigma% _{c}^{2}+\sigma^{2}}italic_Ïƒ start_POSTSUBSCRIPT min
end_POSTSUBSCRIPT ( bold_Î© start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT
) â‰¥ 1 / square-root start_ARG italic_T italic_Ïƒ start_POSTSUBSCRIPT
italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT +
italic_Ïƒ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG and
Ïƒmaxâ¢(ğ›€âˆ’1/2)â‰¤2/Ïƒsubscriptğœmaxsuperscriptğ›€122ğœ\sigma_{\text{max}}\left(\boldsymbol{\Omega}^{-1/2}\right)\leq\sqrt{2}/\sigmaitalic_Ïƒ
start_POSTSUBSCRIPT max end_POSTSUBSCRIPT ( bold_Î© start_POSTSUPERSCRIPT - 1
/ 2 end_POSTSUPERSCRIPT ) â‰¤ square-root start_ARG 2 end_ARG / italic_Ïƒ. By
properties of the Kronecker product, these bounds hold for
ğ‘®N=Ïƒâ¢ğ‘°TâŠ—ğ›€âˆ’1/2subscriptğ‘®ğ‘tensor-
productğœsubscriptğ‘°ğ‘‡superscriptğ›€12\boldsymbol{G}_{N}=\sigma\boldsymbol{I}_{T}\otimes\boldsymbol{\Omega}^{-1/2}bold_italic_G
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = italic_Ïƒ bold_italic_I
start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT âŠ— bold_Î©
start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT as well after multiplying by
Ïƒğœ\sigmaitalic_Ïƒ.

âˆ

######  Lemma I.2.

Suppose one treated cohort has fewer than dN+1subscriptğ‘‘ğ‘1d_{N}+1italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT + 1 units. Then
ğ™~bold-~ğ™\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG
does not have full column rank.

###### Proof of Lemma I.2.

The treatment effect dummies can be seen as interaction effects between the
cohort dummies and (a subset of) the time dummies. In particular, the
treatment effect for cohort rğ‘Ÿritalic_r at time tğ‘¡titalic_t is equal to
the column for the rthsuperscriptğ‘Ÿthr^{\text{th}}italic_r
start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT cohort dummy, but with entries
for all times except tğ‘¡titalic_t set equal to 0. The
Tâˆ’r+1ğ‘‡ğ‘Ÿ1T-r+1italic_T - italic_r + 1 treatment dummies for cohort
rğ‘Ÿritalic_r are mutually orthogonal and span a (Tâˆ’r+1)ğ‘‡ğ‘Ÿ1(T-r+1)(
italic_T - italic_r + 1 )-dimensional subspace, and they occupy an
Nrâ¢(Tâˆ’r+1)subscriptğ‘ğ‘Ÿğ‘‡ğ‘Ÿ1N_{r}(T-r+1)italic_N start_POSTSUBSCRIPT
italic_r end_POSTSUBSCRIPT ( italic_T - italic_r + 1 )-dimensional subspace,
where Nrsubscriptğ‘ğ‘ŸN_{r}italic_N start_POSTSUBSCRIPT italic_r
end_POSTSUBSCRIPT is the number of units in cohort rğ‘Ÿritalic_r.

Because the covariates (like the cohort indicators) are time-invariant, the
time-covariate interactions are closely related to the treatment effect
dummies. The covariate-time interactions for cohort rğ‘Ÿritalic_r lie in the
same Nrâ¢(Tâˆ’r+1)subscriptğ‘ğ‘Ÿğ‘‡ğ‘Ÿ1N_{r}(T-r+1)italic_N
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_T - italic_r + 1
)-dimensional subspace as the treatment effects for cohort rğ‘Ÿritalic_r and
are either linearly dependent or span a subspace of dimension
dNâ¢(Tâˆ’r+1)subscriptğ‘‘ğ‘ğ‘‡ğ‘Ÿ1d_{N}(T-r+1)italic_d start_POSTSUBSCRIPT
italic_N end_POSTSUBSCRIPT ( italic_T - italic_r + 1 ).
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG is
rank deficient in the former setting, so we assume the latter. Then the
treatment dummies and covariate-time interactions for cohort rğ‘Ÿritalic_r
span a subspace of dimension
(dN+1)â¢(Tâˆ’r+1)subscriptğ‘‘ğ‘1ğ‘‡ğ‘Ÿ1(d_{N}+1)(T-r+1)( italic_d
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT + 1 ) ( italic_T - italic_r + 1
) within this Nrâ¢(Tâˆ’r+1)subscriptğ‘ğ‘Ÿğ‘‡ğ‘Ÿ1N_{r}(T-r+1)italic_N
start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_T - italic_r + 1
)-dimensional subspace. So if
Nr<dN+1subscriptğ‘ğ‘Ÿsubscriptğ‘‘ğ‘1N_{r}<d_{N}+1italic_N start_POSTSUBSCRIPT
italic_r end_POSTSUBSCRIPT < italic_d start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT + 1, these columns must be linearly dependent, and
ğ’~bold-~ğ’\boldsymbol{\tilde{Z}}overbold_~ start_ARG bold_italic_Z end_ARG
does not have full column rank.

âˆ

######  Lemma I.3.

Suppose e1â¢Nsubscriptğ‘’1ğ‘e_{1N}italic_e start_POSTSUBSCRIPT 1 italic_N
end_POSTSUBSCRIPT is bounded away from 0 with high probability: for some
finite Nâˆ—,c>0superscriptğ‘ğ‘0N^{*},c>0italic_N start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT , italic_c > 0, for all
N>Nâˆ—ğ‘superscriptğ‘N>N^{*}italic_N > italic_N start_POSTSUPERSCRIPT âˆ—
end_POSTSUPERSCRIPT it holds that
â„™â¢(e1â¢N<c)<aNâ„™subscriptğ‘’1ğ‘ğ‘subscriptğ‘ğ‘\mathbb{P}(e_{1N}<c)<a_{N}blackboard_P
( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT < italic_c ) <
italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT for some vanishing
sequence {aN}subscriptğ‘ğ‘\\{a_{N}\\}{ italic_a start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT }. Let {XN}subscriptğ‘‹ğ‘\\{X_{N}\\}{ italic_X
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT } be a sequence of random
variables, and suppose that
XN=ğ’ªâ„™â¢(1e1â¢Nâ¢pN/N)subscriptğ‘‹ğ‘subscriptğ’ªâ„™1subscriptğ‘’1ğ‘subscriptğ‘ğ‘ğ‘X_{N}=\mathcal{O}_{\mathbb{P}}(\frac{1}{e_{1N}}\sqrt{p_{N}/N})italic_X
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = caligraphic_O
start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( divide start_ARG 1
end_ARG start_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT
end_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT / italic_N end_ARG ). Then
XN=ğ’ªâ„™â¢(pN/N)subscriptğ‘‹ğ‘subscriptğ’ªâ„™subscriptğ‘ğ‘ğ‘X_{N}=\mathcal{O}_{\mathbb{P}}(\sqrt{p_{N}/N})italic_X
start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = caligraphic_O
start_POSTSUBSCRIPT blackboard_P end_POSTSUBSCRIPT ( square-root start_ARG
italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG ).

###### Proof of Lemma I.3.

By assumption, for every Ïµ>0italic-Ïµ0\epsilon>0italic_Ïµ > 0 there exists a
finite MÏµ(1)>0subscriptsuperscriptğ‘€1italic-Ïµ0M^{(1)}_{\epsilon}>0italic_M
start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_Ïµ
end_POSTSUBSCRIPT > 0 and NÏµ(1)>0subscriptsuperscriptğ‘1italic-
Ïµ0N^{(1)}_{\epsilon}>0italic_N start_POSTSUPERSCRIPT ( 1 )
end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT > 0 such
that for all N>NÏµ(1)ğ‘subscriptsuperscriptğ‘1italic-
ÏµN>N^{(1)}_{\epsilon}italic_N > italic_N start_POSTSUPERSCRIPT ( 1 )
end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT,

| â„™â¢(|e1â¢Nâ¢XNpN/N|>MÏµ(1))<Ïµ.â„™subscriptğ‘’1ğ‘subscriptğ‘‹ğ‘subscriptğ‘ğ‘ğ‘subscriptsuperscriptğ‘€1italic-Ïµitalic-Ïµ\mathbb{P}\left(\left|\frac{e_{1N}X_{N}}{\sqrt{p_{N}/N}}\right|>M^{(1)}_{% \epsilon}\right)<\epsilon.blackboard_P ( | divide start_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG end_ARG | > italic_M start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ) < italic_Ïµ . |   
---|---|---  
  
Now for all
N>maxâ¡{Nâˆ—,NÏµ/2(1)}ğ‘superscriptğ‘subscriptsuperscriptğ‘1italic-
Ïµ2N>\max\\{N^{*},N^{(1)}_{\epsilon/2}\\}italic_N > roman_max { italic_N
start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , italic_N start_POSTSUPERSCRIPT
( 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_Ïµ / 2 end_POSTSUBSCRIPT
},

|  | â„™â¢(|XNpN/N|>MÏµ/2(1)c)â„™subscriptğ‘‹ğ‘subscriptğ‘ğ‘ğ‘superscriptsubscriptğ‘€italic-Ïµ21ğ‘\displaystyle\mathbb{P}\left(\left|\frac{X_{N}}{\sqrt{p_{N}/N}}\right|>\frac{M% _{\epsilon/2}^{(1)}}{c}\right)blackboard_P ( | divide start_ARG italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG end_ARG | > divide start_ARG italic_M start_POSTSUBSCRIPT italic_Ïµ / 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT end_ARG start_ARG italic_c end_ARG ) |   
---|---|---|---  
| =\displaystyle=\leavevmode\nobreak\ = | â„™â¢(|XNpN/N|>MÏµ/2(1)câˆ£e1â¢Nâ‰¥c)â¢â„™â¢(e1â¢Nâ‰¥c)+â„™â¢(|XNpN/N|>MÏµ/2(1)câˆ£e1â¢N<c)â¢â„™â¢(e1â¢N<c)â„™subscriptğ‘‹ğ‘subscriptğ‘ğ‘ğ‘conditionalsuperscriptsubscriptğ‘€italic-Ïµ21ğ‘subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘‹ğ‘subscriptğ‘ğ‘ğ‘conditionalsuperscriptsubscriptğ‘€italic-Ïµ21ğ‘subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘’1ğ‘ğ‘\displaystyle\mathbb{P}\left(\left|\frac{X_{N}}{\sqrt{p_{N}/N}}\right|>\frac{M% _{\epsilon/2}^{(1)}}{c}\mid e_{1N}\geq c\right)\mathbb{P}(e_{1N}\geq c)+% \mathbb{P}\left(\left|\frac{X_{N}}{\sqrt{p_{N}/N}}\right|>\frac{M_{\epsilon/2}% ^{(1)}}{c}\mid e_{1N}<c\right)\mathbb{P}(e_{1N}<c)blackboard_P ( | divide start_ARG italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG end_ARG | > divide start_ARG italic_M start_POSTSUBSCRIPT italic_Ïµ / 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT end_ARG start_ARG italic_c end_ARG âˆ£ italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT â‰¥ italic_c ) blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT â‰¥ italic_c ) + blackboard_P ( | divide start_ARG italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG end_ARG | > divide start_ARG italic_M start_POSTSUBSCRIPT italic_Ïµ / 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT end_ARG start_ARG italic_c end_ARG âˆ£ italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT < italic_c ) blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT < italic_c ) |   
| â‰¤\displaystyle\leq\leavevmode\nobreak\ â‰¤ | â„™â¢(|XNpN/N|>MÏµ/2(1)câˆ£e1â¢Nâ‰¥c)â¢â„™â¢(e1â¢Nâ‰¥c)+â„™â¢(e1â¢N<c)â„™subscriptğ‘‹ğ‘subscriptğ‘ğ‘ğ‘conditionalsuperscriptsubscriptğ‘€italic-Ïµ21ğ‘subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘’1ğ‘ğ‘\displaystyle\mathbb{P}\left(\left|\frac{X_{N}}{\sqrt{p_{N}/N}}\right|>\frac{M% _{\epsilon/2}^{(1)}}{c}\mid e_{1N}\geq c\right)\mathbb{P}(e_{1N}\geq c)+% \mathbb{P}(e_{1N}<c)blackboard_P ( | divide start_ARG italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG end_ARG | > divide start_ARG italic_M start_POSTSUBSCRIPT italic_Ïµ / 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT end_ARG start_ARG italic_c end_ARG âˆ£ italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT â‰¥ italic_c ) blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT â‰¥ italic_c ) + blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT < italic_c ) |   
| â‰¤\displaystyle\leq\leavevmode\nobreak\ â‰¤ | â„™â¢(|XNpN/N|>MÏµ/2(1)e1â¢Nâˆ£e1â¢Nâ‰¥c)â¢â„™â¢(e1â¢Nâ‰¥c)+â„™â¢(e1â¢N<c)â„™subscriptğ‘‹ğ‘subscriptğ‘ğ‘ğ‘conditionalsuperscriptsubscriptğ‘€italic-Ïµ21subscriptğ‘’1ğ‘subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘’1ğ‘ğ‘\displaystyle\mathbb{P}\left(\left|\frac{X_{N}}{\sqrt{p_{N}/N}}\right|>\frac{M% _{\epsilon/2}^{(1)}}{e_{1N}}\mid e_{1N}\geq c\right)\mathbb{P}(e_{1N}\geq c)+% \mathbb{P}(e_{1N}<c)blackboard_P ( | divide start_ARG italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG end_ARG | > divide start_ARG italic_M start_POSTSUBSCRIPT italic_Ïµ / 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT end_ARG start_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT end_ARG âˆ£ italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT â‰¥ italic_c ) blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT â‰¥ italic_c ) + blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT < italic_c ) |   
| =\displaystyle=\leavevmode\nobreak\ = | â„™â¢(|e1â¢Nâ¢XNpN/N|>MÏµ/2(1)âˆ£e1â¢Nâ‰¥c)â¢â„™â¢(e1â¢Nâ‰¥c)+â„™â¢(e1â¢N<c)â„™subscriptğ‘’1ğ‘subscriptğ‘‹ğ‘subscriptğ‘ğ‘ğ‘conditionalsuperscriptsubscriptğ‘€italic-Ïµ21subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘’1ğ‘ğ‘\displaystyle\mathbb{P}\left(\left|\frac{e_{1N}X_{N}}{\sqrt{p_{N}/N}}\right|>M% _{\epsilon/2}^{(1)}\mid e_{1N}\geq c\right)\mathbb{P}(e_{1N}\geq c)+\mathbb{P}% (e_{1N}<c)blackboard_P ( | divide start_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG end_ARG | > italic_M start_POSTSUBSCRIPT italic_Ïµ / 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT âˆ£ italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT â‰¥ italic_c ) blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT â‰¥ italic_c ) + blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT < italic_c ) |   
| â‰¤\displaystyle\leq\leavevmode\nobreak\ â‰¤ | â„™â¢(|e1â¢Nâ¢XNpN/N|>MÏµ/2(1)âˆ£e1â¢Nâ‰¥c)â¢â„™â¢(e1â¢Nâ‰¥c)+â„™â¢(|e1â¢Nâ¢XNpN/N|>MÏµ/2(1)âˆ£e1â¢N<c)â¢â„™â¢(e1â¢N<c)â„™subscriptğ‘’1ğ‘subscriptğ‘‹ğ‘subscriptğ‘ğ‘ğ‘conditionalsuperscriptsubscriptğ‘€italic-Ïµ21subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘’1ğ‘subscriptğ‘‹ğ‘subscriptğ‘ğ‘ğ‘conditionalsuperscriptsubscriptğ‘€italic-Ïµ21subscriptğ‘’1ğ‘ğ‘â„™subscriptğ‘’1ğ‘ğ‘\displaystyle\mathbb{P}\left(\left|\frac{e_{1N}X_{N}}{\sqrt{p_{N}/N}}\right|>M% _{\epsilon/2}^{(1)}\mid e_{1N}\geq c\right)\mathbb{P}(e_{1N}\geq c)+\mathbb{P}% \left(\left|\frac{e_{1N}X_{N}}{\sqrt{p_{N}/N}}\right|>M_{\epsilon/2}^{(1)}\mid e% _{1N}<c\right)\mathbb{P}(e_{1N}<c)blackboard_P ( | divide start_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG end_ARG | > italic_M start_POSTSUBSCRIPT italic_Ïµ / 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT âˆ£ italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT â‰¥ italic_c ) blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT â‰¥ italic_c ) + blackboard_P ( | divide start_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG end_ARG | > italic_M start_POSTSUBSCRIPT italic_Ïµ / 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT âˆ£ italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT < italic_c ) blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT < italic_c ) |   
|  | +â„™â¢(e1â¢N<c)â„™subscriptğ‘’1ğ‘ğ‘\displaystyle+\mathbb{P}(e_{1N}<c)\+ blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT < italic_c ) |   
| =\displaystyle=\leavevmode\nobreak\ = | â„™â¢(|e1â¢Nâ¢XNpN/N|>MÏµ/2(1))+â„™â¢(e1â¢N<c)â„™subscriptğ‘’1ğ‘subscriptğ‘‹ğ‘subscriptğ‘ğ‘ğ‘superscriptsubscriptğ‘€italic-Ïµ21â„™subscriptğ‘’1ğ‘ğ‘\displaystyle\mathbb{P}\left(\left|\frac{e_{1N}X_{N}}{\sqrt{p_{N}/N}}\right|>M% _{\epsilon/2}^{(1)}\right)+\mathbb{P}(e_{1N}<c)blackboard_P ( | divide start_ARG italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG end_ARG | > italic_M start_POSTSUBSCRIPT italic_Ïµ / 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ) + blackboard_P ( italic_e start_POSTSUBSCRIPT 1 italic_N end_POSTSUBSCRIPT < italic_c ) |   
| <\displaystyle<\leavevmode\nobreak\ < | Ïµ2+aN.italic-Ïµ2subscriptğ‘ğ‘\displaystyle\frac{\epsilon}{2}+a_{N}.divide start_ARG italic_Ïµ end_ARG start_ARG 2 end_ARG + italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT . |   
  
Since aNsubscriptğ‘ğ‘a_{N}italic_a start_POSTSUBSCRIPT italic_N
end_POSTSUBSCRIPT is vanishing, there exists a finite
NÏµ(2)subscriptsuperscriptğ‘2italic-ÏµN^{(2)}_{\epsilon}italic_N
start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_Ïµ
end_POSTSUBSCRIPT so that aNâ‰¤Ïµ/2subscriptğ‘ğ‘italic-
Ïµ2a_{N}\leq\epsilon/2italic_a start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT
â‰¤ italic_Ïµ / 2 for all N>NÏµ(2)ğ‘subscriptsuperscriptğ‘2italic-
ÏµN>N^{(2)}_{\epsilon}italic_N > italic_N start_POSTSUPERSCRIPT ( 2 )
end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT. Then we
have established that for any Ïµ>0italic-Ïµ0\epsilon>0italic_Ïµ > 0, for
MÏµ:=MÏµ/2(1)/cassignsubscriptğ‘€italic-Ïµsuperscriptsubscriptğ‘€italic-
Ïµ21ğ‘M_{\epsilon}:=M_{\epsilon/2}^{(1)}/citalic_M start_POSTSUBSCRIPT
italic_Ïµ end_POSTSUBSCRIPT := italic_M start_POSTSUBSCRIPT italic_Ïµ / 2
end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT / italic_c
and NÏµ:=maxâ¡{Nâˆ—,NÏµ/2(1),NÏµ(2)}assignsubscriptğ‘italic-
Ïµsuperscriptğ‘subscriptsuperscriptğ‘1italic-Ïµ2subscriptsuperscriptğ‘2italic-
ÏµN_{\epsilon}:=\max\\{N^{*},N^{(1)}_{\epsilon/2},N^{(2)}_{\epsilon}\\}italic_N
start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT := roman_max { italic_N
start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , italic_N start_POSTSUPERSCRIPT
( 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_Ïµ / 2 end_POSTSUBSCRIPT
, italic_N start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT
italic_Ïµ end_POSTSUBSCRIPT }, for all N>NÏµğ‘subscriptğ‘italic-
ÏµN>N_{\epsilon}italic_N > italic_N start_POSTSUBSCRIPT italic_Ïµ
end_POSTSUBSCRIPT it holds that

| â„™â¢(|XNpN/N|>MÏµ)<â„™subscriptğ‘‹ğ‘subscriptğ‘ğ‘ğ‘subscriptğ‘€italic-Ïµabsent\displaystyle\mathbb{P}\left(\left|\frac{X_{N}}{\sqrt{p_{N}/N}}\right|>M_{% \epsilon}\right)<\leavevmode\nobreak\ blackboard_P ( | divide start_ARG italic_X start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT / italic_N end_ARG end_ARG | > italic_M start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ) < | Ïµ.italic-Ïµ\displaystyle\epsilon.italic_Ïµ . |   
---|---|---|---  
  
âˆ
